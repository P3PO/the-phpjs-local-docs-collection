<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head><title>db.collection.findAndModify() &mdash; MongoDB Manual 2.4.3</title><link rel="shortcut icon" href="http://media.mongodb.org/favicon.ico" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="robots" content="index" />
  <meta name="release" content="2.4.3"/>
  <meta name="DC.Source" content="https://github.com/mongodb/docs/blob/master/source/reference/method/db.collection.findAndModify.txt"/>
      <link rel="canonical" href="http://docs.mongodb.org/manual/reference/method/db.collection.findAndModify" />
  
   <link rel="stylesheet" href="../../_static/mongodb-docs.css" type="text/css" />
   <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      
   <script type="text/javascript">
     var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../../',
         VERSION:     '2.4',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  false,
     };
   </script>
       <script type="text/javascript" src="../../_static/jquery.js"></script>
       <script type="text/javascript" src="../../_static/underscore.js"></script>
       <script type="text/javascript" src="../../_static/doctools.js"></script>
          <link rel="search" type="application/opensearchdescription+xml" href="http://docs.mongodb.org/osd.xml" title="MongoDB Help"/>
<link rel="author" title="About these documents" href="../../about.html" />
<link rel="top" title="MongoDB Manual" href="../../index.html" />
<link rel="up" title="Collection Methods" href="js-collection.html" />
<link rel="next" title="db.collection.findOne()" href="db.collection.findOne.html" />
<link rel="prev" title="db.collection.find()" href="db.collection.find.html" />
          <script>
            (function() {
               var cx = '017213726194841070573:WMX6838984';
               var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
               gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=' + cx;
               var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
            })();
          </script></head>
<body>
      <div id="header-db" class="spread">
        <div class="split">
          <div id="logo">
            <div><a href="http://www.mongodb.org/"><img class="logo" src="http://media.mongodb.org/logo-mongodb.png" alt="MongoDB Logo"/></a></div>
          </div>
        </div>
      </div>  
      <div class="document">
           <div class="documentwrapper"><div class="bodywrapper">
               <div class="body">
                 
    <div class="bc">
      <ul>
          <li><a href="../../reference.html">Reference</a><span class="bcpoint"> > </span></li>
          
          <li><a href="../method.html"><tt class="docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal docutils literal"><span class="pre">mongo</span></tt> Shell Methods</a><span class="bcpoint"> > </span></li>
          
          <li><a href="js-collection.html">Collection Methods</a><span class="bcpoint"> > </span></li>
          <li>db.collection.findAndModify()</li> 
      </ul>
    </div>
                 <div id="cse-results">
                   <gcse:searchresults linkTarget="_top"></gcse:searchresults>
                 </div>
                 
  <div class="section" id="db-collection-findandmodify">
<h1>db.collection.findAndModify()<a class="headerlink" href="#db-collection-findandmodify" title="Permalink to this headline">¶</a></h1>
<dl class="method">
<dt id="db.collection.findAndModify">
<tt class="descclassname">db.collection.</tt><tt class="descname">findAndModify</tt><big>(</big><big>)</big><a class="headerlink" href="#db.collection.findAndModify" title="Permalink to this definition">¶</a></dt>
<dd><p>The <tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> method atomically
modifies and returns a single document. By default, the returned
document does not include the modifications made on the update. To
return the document with the modifications made on the update, use
the <tt class="docutils literal"><span class="pre">new</span></tt> option. The <tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> method is a shell
helper around the <a class="reference internal" href="../command/findAndModify.html#dbcmd.findAndModify" title="findAndModify"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">findAndModify</span></tt></a> command.</p>
<div class="highlight-none"><div class="highlight"><pre>db.collection.findAndModify( {
                               query: &lt;document&gt;,
                               sort: &lt;document&gt;,
                               remove: &lt;boolean&gt;,
                               update: &lt;document&gt;,
                               new: &lt;boolean&gt;,
                               fields: &lt;document&gt;,
                               upsert: &lt;boolean&gt;
                           } );
</pre></div>
</div>
<p>The <tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.findAndModify()</span></tt> method takes a document
parameter with the following subdocument fields:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Fields:</th><td class="field-body"><ul class="first last simple">
<li><strong>query</strong> (<em>document</em>) &#8211; Optional. Specifies the selection criteria for the
modification. The <tt class="docutils literal"><span class="pre">query</span></tt> field employs the same
<a class="reference internal" href="../operator.html#query-selectors"><em>query selectors</em></a> as used in the
<a class="reference internal" href="db.collection.find.html#db.collection.find" title="db.collection.find()"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.find()</span></tt></a> method. Although the query may
match multiple documents,
<tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> will only select one
document to modify.</li>
<li><strong>sort</strong> (<em>document</em>) &#8211; Optional. Determines which document the operation will modify
if the query selects multiple documents.
<tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> will modify the
first document in the sort order specified by this argument.</li>
<li><strong>remove</strong> (<em>boolean</em>) &#8211; Optional if <tt class="docutils literal"><span class="pre">update</span></tt> field exists. When <tt class="docutils literal"><span class="pre">true</span></tt>, removes
the selected document. The default is <tt class="docutils literal"><span class="pre">false</span></tt>.</li>
<li><strong>update</strong> (<em>document</em>) &#8211; Optional if <tt class="docutils literal"><span class="pre">remove</span></tt> field exists. Performs an update of
the selected document. The <tt class="docutils literal"><span class="pre">update</span></tt> field employs the same
<a class="reference internal" href="../operator.html#update-operators"><em>update operators</em></a> or <tt class="docutils literal"><span class="pre">field:</span> <span class="pre">value</span></tt>
specifications to modify the selected document.</li>
<li><strong>new</strong> (<em>boolean</em>) &#8211; Optional. When <tt class="docutils literal"><span class="pre">true</span></tt>, returns the modified document rather
than the original. The
<tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> method ignores the
<tt class="docutils literal"><span class="pre">new</span></tt> option for <tt class="docutils literal"><span class="pre">remove</span></tt> operations. The default is
<tt class="docutils literal"><span class="pre">false</span></tt>.</li>
<li><strong>fields</strong> (<em>document</em>) &#8211; <p>Optional. A subset of fields to return. The <tt class="docutils literal"><span class="pre">fields</span></tt>
document specifies an inclusion of a field with <tt class="docutils literal"><span class="pre">1</span></tt>, as in
the following:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">fields</span><span class="o">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="nx">field1</span><span class="o">&gt;:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">&lt;</span><span class="nx">field2</span><span class="o">&gt;:</span> <span class="mi">1</span><span class="p">,</span> <span class="p">...</span> <span class="p">}</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../../core/read-operations.html#read-operations-projection"><em>projection</em></a>.</p>
</li>
<li><strong>upsert</strong> (<em>boolean</em>) &#8211; Optional. Used in conjunction with the <tt class="docutils literal"><span class="pre">update</span></tt> field. When
<tt class="docutils literal"><span class="pre">true</span></tt>, <tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> creates a
new document if the <tt class="docutils literal"><span class="pre">query</span></tt> returns no documents. The
default is <tt class="docutils literal"><span class="pre">false</span></tt>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The <tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> method returns either:</p>
<ul class="simple">
<li>the pre-modification document or,</li>
<li>if the <tt class="docutils literal"><span class="pre">new:</span> <span class="pre">true</span></tt> option is set, the modified document.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">If no document is found for the <tt class="docutils literal"><span class="pre">update</span></tt> or <tt class="docutils literal"><span class="pre">remove</span></tt>, the
method returns <tt class="docutils literal"><span class="pre">null</span></tt>.</p>
</li>
<li><p class="first">If no document is found for an <tt class="docutils literal"><span class="pre">upsert</span></tt>, which means the
command performs an insert, and <tt class="docutils literal"><span class="pre">new</span></tt> is <tt class="docutils literal"><span class="pre">false</span></tt>, <strong>and</strong>
the <tt class="docutils literal"><span class="pre">sort</span></tt> option is <strong>NOT</strong> specified, the method returns
<tt class="docutils literal"><span class="pre">null</span></tt>.</p>
<p class="versionchanged">
<span class="versionmodified">Changed in version 2.2: </span>Previously returned an empty document <tt class="docutils literal"><span class="pre">{}</span></tt>. See <a class="reference internal" href="../../release-notes/2.2.html#findandmodify-returns-null"><em>the
2.2 release notes</em></a> for more
information.</p>
</li>
<li><p class="first">If no document is found for an <tt class="docutils literal"><span class="pre">upsert</span></tt>, which means the
command performs an insert, and <tt class="docutils literal"><span class="pre">new</span></tt> is <tt class="docutils literal"><span class="pre">false</span></tt>, <strong>and</strong> a
<tt class="docutils literal"><span class="pre">sort</span></tt> option is specified, the method returns an empty
document <tt class="docutils literal"><span class="pre">{}</span></tt>.</p>
</li>
</ul>
</div>
<p>Consider the following examples:</p>
<ul>
<li><p class="first">The following method updates an existing document in the people
collection where the document matches the query criteria:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">people</span><span class="p">.</span><span class="nx">findAndModify</span><span class="p">(</span> <span class="p">{</span>
    <span class="nx">query</span><span class="o">:</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Tom&quot;</span><span class="p">,</span> <span class="nx">state</span><span class="o">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span> <span class="nx">rating</span><span class="o">:</span> <span class="p">{</span> <span class="nx">$gt</span><span class="o">:</span> <span class="mi">10</span> <span class="p">}</span> <span class="p">},</span>
    <span class="nx">sort</span><span class="o">:</span> <span class="p">{</span> <span class="nx">rating</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span>
    <span class="nx">update</span><span class="o">:</span> <span class="p">{</span> <span class="nx">$inc</span><span class="o">:</span> <span class="p">{</span> <span class="nx">score</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
<p>This method performs the following actions:</p>
<ol class="arabic">
<li><p class="first">The <tt class="docutils literal"><span class="pre">query</span></tt> finds a document in the <tt class="docutils literal"><span class="pre">people</span></tt> collection
where the <tt class="docutils literal"><span class="pre">name</span></tt> field has the value <tt class="docutils literal"><span class="pre">Tom</span></tt>, the <tt class="docutils literal"><span class="pre">state</span></tt>
field has the value <tt class="docutils literal"><span class="pre">active</span></tt> and the <tt class="docutils literal"><span class="pre">rating</span></tt> field has a
value <a class="reference internal" href="../operator/gt.html#op._S_gt" title="$gt"><tt class="xref mongodb mongodb-operator docutils literal"><span class="pre">greater</span> <span class="pre">than</span></tt></a> 10.</p>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">sort</span></tt> orders the results of the query in ascending order.
If multiple documents meet the <tt class="docutils literal"><span class="pre">query</span></tt> condition, the method
will select for modification the first document as ordered by
this <tt class="docutils literal"><span class="pre">sort</span></tt>.</p>
</li>
<li><p class="first">The update <a class="reference internal" href="../operator/inc.html#op._S_inc" title="$inc"><tt class="xref mongodb mongodb-operator docutils literal"><span class="pre">increments</span></tt></a> the value of the
<tt class="docutils literal"><span class="pre">score</span></tt> field by 1.</p>
</li>
<li><p class="first">The method returns the original (i.e. pre-modification) document
selected for this update:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&quot;50f1e2c99beb36a0f45c6453&quot;</span><span class="p">),</span>
  <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Tom&quot;</span><span class="p">,</span>
  <span class="s2">&quot;state&quot;</span> <span class="o">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span>
  <span class="s2">&quot;rating&quot;</span> <span class="o">:</span> <span class="mi">100</span><span class="p">,</span>
  <span class="s2">&quot;score&quot;</span> <span class="o">:</span> <span class="mi">5</span>
<span class="p">}</span>
</pre></div>
</div>
<p>To return the modified document, add the <tt class="docutils literal"><span class="pre">new:true</span></tt> option to
the method.</p>
<p>If no document matched the <tt class="docutils literal"><span class="pre">query</span></tt> condition, the method
returns <tt class="docutils literal"><span class="pre">null</span></tt>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kc">null</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p class="first">The following method includes the <tt class="docutils literal"><span class="pre">upsert:</span> <span class="pre">true</span></tt> option to
insert a new document if no document matches the <tt class="docutils literal"><span class="pre">query</span></tt>
condition:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">people</span><span class="p">.</span><span class="nx">findAndModify</span><span class="p">(</span> <span class="p">{</span>
    <span class="nx">query</span><span class="o">:</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Gus&quot;</span><span class="p">,</span> <span class="nx">state</span><span class="o">:</span> <span class="s2">&quot;active&quot;</span><span class="p">,</span> <span class="nx">rating</span><span class="o">:</span> <span class="mi">100</span> <span class="p">},</span>
    <span class="nx">sort</span><span class="o">:</span> <span class="p">{</span> <span class="nx">rating</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span>
    <span class="nx">update</span><span class="o">:</span> <span class="p">{</span> <span class="nx">$inc</span><span class="o">:</span> <span class="p">{</span> <span class="nx">score</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">},</span>
    <span class="nx">upsert</span><span class="o">:</span> <span class="kc">true</span>
  <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
<p>If the method does <strong>not</strong> find a matching document, the method
performs an upsert. Because the method included the <tt class="docutils literal"><span class="pre">sort</span></tt>
option, it returns an empty document <tt class="docutils literal"><span class="pre">{</span> <span class="pre">}</span></tt> as the original
(pre-modification) document:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span> <span class="p">}</span>
</pre></div>
</div>
<p>If the method did <strong>not</strong> include a <tt class="docutils literal"><span class="pre">sort</span></tt> option, the method returns
<tt class="docutils literal"><span class="pre">null</span></tt>.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kc">null</span>
</pre></div>
</div>
</li>
<li><p class="first">The following method includes both the <tt class="docutils literal"><span class="pre">upsert:</span> <span class="pre">true</span></tt> option and
the <tt class="docutils literal"><span class="pre">new:true</span></tt> option to return the newly inserted document if a
document matching the <tt class="docutils literal"><span class="pre">query</span></tt> is not found:</p>
<div class="highlight-none"><div class="highlight"><pre>db.people.findAndModify( {
    query: { name: &quot;Pascal&quot;, state: &quot;active&quot;, rating: 25 },
    sort: { rating: 1 },
    update: { $inc: { score: 1 } },
    upsert: true,
    new: true
  }
)
</pre></div>
</div>
</li>
</ul>
<blockquote>
<div><p>The method returns the newly inserted document:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&quot;50f49ad6444c11ac2448a5d6&quot;</span><span class="p">),</span>
  <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Pascal&quot;</span><span class="p">,</span>
  <span class="s2">&quot;rating&quot;</span> <span class="o">:</span> <span class="mi">25</span><span class="p">,</span>
  <span class="s2">&quot;score&quot;</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s2">&quot;state&quot;</span> <span class="o">:</span> <span class="s2">&quot;active&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>When <tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> includes the <tt class="docutils literal"><span class="pre">upsert:</span>
<span class="pre">true</span></tt> option <strong>and</strong> the query field(s) is not uniquely indexed, the
method could insert a document multiple times in certain
circumstances. For instance, if multiple clients each invoke the
method with the same <tt class="docutils literal"><span class="pre">query</span></tt> condition and these methods complete
the <tt class="docutils literal"><span class="pre">find</span></tt> phase before any of methods perform the <tt class="docutils literal"><span class="pre">modify</span></tt>
phase, these methods could insert the same document.</p>
<p>Consider an example where no document with the name <tt class="docutils literal"><span class="pre">Andy</span></tt> exists
and multiple clients issue the following command:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">people</span><span class="p">.</span><span class="nx">findAndModify</span><span class="p">(</span>
                         <span class="p">{</span>
                           <span class="nx">query</span><span class="o">:</span> <span class="p">{</span> <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;Andy&quot;</span> <span class="p">},</span>
                           <span class="nx">sort</span><span class="o">:</span> <span class="p">{</span> <span class="nx">rating</span><span class="o">:</span> <span class="mi">1</span> <span class="p">},</span>
                           <span class="nx">update</span><span class="o">:</span> <span class="p">{</span> <span class="nx">$inc</span><span class="o">:</span> <span class="p">{</span> <span class="nx">score</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">},</span>
                           <span class="nx">upsert</span><span class="o">:</span> <span class="kc">true</span>
                         <span class="p">}</span>
                       <span class="p">)</span>
</pre></div>
</div>
<p>If all the methods finish the <tt class="docutils literal"><span class="pre">query</span></tt> phase before any command
starts the <tt class="docutils literal"><span class="pre">modify</span></tt> phase, <strong>and</strong> there is no unique index on the
<tt class="docutils literal"><span class="pre">name</span></tt> field, the commands may all perform an upsert. To prevent
this condition, create a <a class="reference internal" href="../../core/indexes.html#index-type-unique"><em>unique index</em></a> on
the <tt class="docutils literal"><span class="pre">name</span></tt> field. With the unique index in place, the multiple
methods would observe one of the following behaviors:</p>
<ul class="simple">
<li>Exactly one <tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> would
successfully insert a new document.</li>
<li>Zero or more <tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> methods
would update the newly inserted document.</li>
<li>Zero or more <tt class="xref mongodb mongodb-method docutils literal"><span class="pre">findAndModify()</span></tt> methods
would fail when they attempted to insert a duplicate. If the
method fails due to a unique index constraint violation, you can
retry the method. Absent a delete of the document, the retry
should not fail.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last simple">
<li>When using <a class="reference internal" href="../command/findAndModify.html#dbcmd.findAndModify" title="findAndModify"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">findAndModify</span></tt></a> in a <a class="reference internal" href="../glossary.html#term-sharding"><em class="xref std std-term">sharded</em></a> environment, the <tt class="docutils literal"><span class="pre">query</span></tt> must contain the
<a class="reference internal" href="../glossary.html#term-shard-key"><em class="xref std std-term">shard key</em></a> for all operations against the shard cluster.
<a class="reference internal" href="../command/findAndModify.html#dbcmd.findAndModify" title="findAndModify"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">findAndModify</span></tt></a> operations issued against
<a class="reference internal" href="../program/mongos.html#bin.mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> instances for non-sharded collections
function normally.</li>
</ul>
</div>
</dd></dl>

</div>


    <div id="btnv">
        <ul id="btnvl">
              <li id="btnvpr"><a href="db.collection.find.html" title="Previous Section: db.collection.find()">&lt; &nbsp; db.collection.find()</a></li>
              <li id="btnvup"><a href="../../reference.html" title="Parent Section: Reference" >&#47;&#92;&nbsp; Reference</a></li>
              <li id="btnvnx"><a href="db.collection.findOne.html" title="Next Section: db.collection.findOne()">db.collection.findOne() &nbsp;&gt;</a></li>
        </ul>
    </div></div></div>
           </div>
       <div class="sphinxsidebar">
         <div class="sphinxsidebarwrapper">
  <h3>
    <a href="../../index.html">MongoDB Manual</a> <span id="vn">2.4</span>
  </h3>



<div class="site-contents"><a href="../../contents.html">Contents</a></div>


<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Install MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../administration.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../crud.html">Core MongoDB Operations (CRUD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-modeling.html">Data Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aggregation.html">Aggregation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../indexes.html">Indexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../replication.html">Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sharding.html">Sharding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../applications.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mongo.html">The <tt class="docutils literal"><span class="pre">mongo</span></tt> Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../use-cases.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../reference.html">Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../operator.html">Query, Update and Projection Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../command.html">Database Commands</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../method.html"><tt class="docutils literal"><span class="pre">mongo</span></tt> Shell Methods</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="js-collection.html">Collection Methods</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="db.collection.aggregate.html">db.collection.aggregate()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.count.html">db.collection.count()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.createIndex.html">db.collection.createIndex()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.dataSize.html">db.collection.dataSize()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.distinct.html">db.collection.distinct()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.drop.html">db.collection.drop()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.dropIndexes.html">db.collection.dropIndexes()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.dropIndexes.html">db.collection.dropIndexes()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.ensureIndex.html">db.collection.ensureIndex()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.find.html">db.collection.find()</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="">db.collection.findAndModify()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.findOne.html">db.collection.findOne()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.getIndexStats.html">db.collection.getIndexStats()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.getIndexes.html">db.collection.getIndexes()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.getShardDistribution.html">db.collection.getShardDistribution()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.getShardVersion.html">db.collection.getShardVersion()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.group.html">db.collection.group()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.insert.html">db.collection.insert()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.isCapped.html">db.collection.isCapped()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.mapReduce.html">db.collection.mapReduce()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.reIndex.html">db.collection.reIndex()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.remove.html">db.collection.remove()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.renameCollection.html">db.collection.renameCollection()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.save.html">db.collection.save()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.stats.html">db.collection.stats()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.storageSize.html">db.collection.storageSize()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.storageSize.html">db.collection.storageSize()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.totalSize.html">db.collection.totalSize()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.update.html">db.collection.update()</a></li>
<li class="toctree-l4"><a class="reference internal" href="db.collection.validate.html">db.collection.validate()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="js-cursor.html">Cursor Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="js-database.html">Database Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="js-replication.html">Replication Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="js-sharding.html">Sharding Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="js-connection.html">Connection Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="js-subprocess.html">Subprocess Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="js-native.html">Native Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sql-comparison.html">SQL to MongoDB Mapping Chart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../program.html">MongoDB Package Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../local-database.html">The <tt class="docutils literal"><span class="pre">local</span></tt> Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../system-collections.html">System Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database-profiler.html">Database Profiler Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exit-codes.html">Exit Codes and Statuses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../limits.html">MongoDB Limits and Thresholds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../connection-string.html">Connection String URI Format</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mongodb-extended-json.html">MongoDB Extended JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database-references.html">Database References</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gridfs.html">GridFS Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About MongoDB Documentation</a></li>
</ul>



<div class="site-index"><a href="../../genindex.html">Index</a></div>
<h3>Formats</h3>
<ul class="this-page-menu">
  <li><a href="/manual/single/">MongoDB Manual, Single HTML Page</a></li>
  <li><a href="http://docs.mongodb.org/master/MongoDB-Manual-master.pdf" rel="nofollow">MongoDB Manual, PDF Format</a></li>
  <li><a href="http://docs.mongodb.org/master/MongoDB-Manual-master.epub" rel="nofollow">MongoDB Manual, ePub Format</a></li>
</ul>
<h3><a href="http://www.mongodb.org/about/">About MongoDB</a></h3>
<ul>
  <li><a href="http://www.mongodb.org/about/introduction">Introduction</a></li>
  <li><a href="http://www.mongodb.org/about/community">User Community</a></li>
  <li><a href="http://mongodb.org/about/community/masters">MongoDB Masters</a></li>
  <li><a href="http://planet.mongodb.org">Planet MongoDB</a></li>
</ul>
<h3><a href="http://docs.mongodb.org/ecosystem/">MongoDB Ecosystem</a></h3>
<ul>
 <li><a href="http://docs.mongodb.org/ecosystem/drivers/">Drivers and Client libraries</a>
   <ul>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/c">C</a> (<a href="http://api.mongodb.org/c/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/cpp">C++</a> (<a href="http://api.mongodb.org/cplusplus/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/csharp">C#</a> (<a href="http://api.mongodb.org/csharp/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/erlang">Erlang</a> (<a href="http://api.mongodb.org/erlang">docs</a>)</li>
     <li><a href="http://hackage.haskell.org/package/mongoDB">Haskell</a> (<a href="http://api.mongodb.org/haskell">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/java">Java</a> (<a href="http://api.mongodb.org/java/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/javascript">JavaScript</a> (<a href="http://api.mongodb.org/js/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/perl">Perl</a> (<a href="http://api.mongodb.org/perl/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/php">PHP</a> (<a href="http://php.net/mongo/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/python">Python</a> (<a href="http://api.mongodb.org/python/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/ruby">Ruby</a> (<a href="http://api.mongodb.org/ruby/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/scala">Scala</a> (<a href="http://api.mongodb.org/scala/casbah/current/">docs</a>)</li>
   </ul>
 </li>
 <li><a href="http://docs.mongodb.org/ecosystem/tools/">Tools and Integration</a></li>
 <li><a href="http://docs.mongodb.org/ecosystem/platforms/">Platform Integration</a></li>
</ul><h3>MongoDB Resources</h3>
<ul>
  <li><a href="http://www.mongodb.org/downloads">Downloads</a></li>
  <li><a href="http://www.10gen.com/events">MongoDB Events</a></li>
  <li><a href="http://www.10gen.com/presentations">Slides and Video</a></li>
  <li><a href="http://www.10gen.com/products/mms/">MongoDB Monitoring Service</a> (<a href="http://mms.10gen.com/help/">docs</a>)</li>
</ul>
         </div>
       </div>
        <div class="clearer"></div>
      </div><div id="top-right">
        <div class="user-right">
          <ul id="header-menu-bar" class="ajs-menu-bar">
            <li class="normal"><a target="_blank" href="http://groups.google.com/group/mongodb-user">Forums</a></li>
            <li class="normal"><a target="_blank" href="http://blog.mongodb.org/">Blog</a></li>
            <li class="normal"><a href="http://www.mongodb.org/downloads">Download</a></li>
            <li class="normal"><a href="http://docs.mongodb.org/ecosystem/drivers/">Drivers</a></li>
            <li class="normal"><a href="http://www.10gen.com/events">Events</a></li>
            <li class="normal last"><a class="last" href="http://docs.mongodb.org/manual/meta/translation">Translations</a></li>
          </ul>
        </div>
      </div>
      <div class="search-db"><gcse:searchbox></gcse:searchbox></div>
          <div id="etp">
            <ul>
              <li><a href="https://github.com/mongodb/docs/blob/master/source/reference/method/db.collection.findAndModify.txt" target="_blank" title="Edit reference/method/db.collection.findAndModify.txt on GitHub">Edit this Page</a></li>
              <li><a href="http://github.com/mongodb/docs" target="_blank" title="Fork the documentation on GitHub and contribute.">GitHub</a></li>
              <li><a id="jirafeedback" href="https://jira.mongodb.org/secure/CreateIssueDetails!init.jspa?pid=10380&issuetype=4&priority=4&summary=Comment+on%3a+%22reference/method/db.collection.findAndModify%2Etxt%22" target="_blank" title="Report a problem with reference/method/db.collection.findAndModify.txt on Jira">Report a Problem</a></li>
            </ul>
          </div>
      <div class="footer">
        <p>
          &copy; <a href="">Copyright</a> 2011-2013, 10gen, Inc. 
          MongoDB&reg;, Mongo&reg;, and the leaf logo are registered trademarks of <a href="http://www.10gen.com/">10gen, Inc.</a>
        </p>
      </div><script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_require', 'inpage_linkid', pluginUrl]);
_gaq.push(['_setAccount', 'UA-7301842-8']);
_gaq.push(['_setDomainName', 'docs.mongodb.org']);
_gaq.push(['_trackPageview']);
(function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
        })();
</script>

<script type="text/javascript">var _kiq = _kiq || [];</script>
<script type="text/javascript">
(function(){
setTimeout(function(){ var d = document, f = d.getElementsByTagName('script')[0], s = d.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//s3.amazonaws.com/ki.js/49119/a7n.js'; f.parentNode.insertBefore(s, f); }, 1);
})();
</script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-7301842-14', 'mongodb.org');
ga('send', 'pageview');
</script>

<script type="text/javascript">
document.write(unescape("%3Cscript src='" + document.location.protocol + "//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>try { mktoMunchkin("017-HGS-593"); } catch(e) {}</script><script type="text/javascript">
jQuery.ajax({
	 url: "https://jira.mongodb.org/s/en_UScn8g8x/782/6/1.2.5/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?collectorId=298ba4e7",
	 type: "get",
	 cache: true,
	 dataType: "script"
	});
window.ATL_JQ_PAGE_PROPS =  {
	"triggerFunction": function(showCollectorDialog) {
		jQuery("#jirafeedback").click(function(e) {e.preventDefault();showCollectorDialog();});},
		fieldValues: {component: 'mongodb-manual', summary: 'Comment on: "manual/reference/method/db.collection.findAndModify.txt"'},
		environment: {'repo': 'docs','source': 'reference/method/db.collection.findAndModify'}
		};
</script><script type="text/javascript">
var versions = [{'t': '2.4 (current)', 'v': 'v2.4'}, {'t': '2.2', 'v': 'v2.2'}]
var pagename = 'reference/method/db.collection.findAndModify'
var stable = 'v2.4'

function vfnav() {
    if ( pagename=='index' ) {
        pn = ''
    }
    else {
        pn = pagename
    }

    v = $(this).children("option:selected").attr('value')

    if ( (v==0) || (v==stable) ) {
        uri = '/manual/' + pn
    }
    else {
        uri = '/' + v + '/' + pn
    }
    window.location.href= uri;
}

$(document).ready(function(){
    $("#vn").html(function(){
        s=$("<select/>");
        o='<option/>';

        $.each(versions,function(index, version) {
            if ( version.v==stable ) {
                dv=true;
            }
            $(o,{value:version.v,text: version.t}).appendTo(s);
        });

        if ( dv==false ) {
            $(o, {value:0,text:'(stable)'}).appendTo(s);
        }
        return(s);
    });

    $("#vn select").bind('change', vfnav);
    $('#vn select').val('v2.4');
});
</script>
</body>
</html>