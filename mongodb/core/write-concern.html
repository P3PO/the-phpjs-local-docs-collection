<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head><title>Write Concern &mdash; MongoDB Manual 2.4.3</title><link rel="shortcut icon" href="http://media.mongodb.org/favicon.ico" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="robots" content="index" />
  <meta name="release" content="2.4.3"/>
  <meta name="DC.Source" content="https://github.com/mongodb/docs/blob/master/source/core/write-concern.txt"/>
      <link rel="canonical" href="http://docs.mongodb.org/manual/core/write-concern" />
  
   <link rel="stylesheet" href="../_static/mongodb-docs.css" type="text/css" />
   <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      
   <script type="text/javascript">
     var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
         VERSION:     '2.4',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  false,
     };
   </script>
       <script type="text/javascript" src="../_static/jquery.js"></script>
       <script type="text/javascript" src="../_static/underscore.js"></script>
       <script type="text/javascript" src="../_static/doctools.js"></script>
          <link rel="search" type="application/opensearchdescription+xml" href="http://docs.mongodb.org/osd.xml" title="MongoDB Help"/>
<link rel="author" title="About these documents" href="../about.html" />
<link rel="top" title="MongoDB Manual" href="../index.html" />
<link rel="up" title="Replica Set Considerations and Behaviors for Applications and Development" href="../applications/replication.html" />
<link rel="next" title="Read Preference" href="read-preference.html" />
<link rel="prev" title="Replica Set Considerations and Behaviors for Applications and Development" href="../applications/replication.html" />
          <script>
            (function() {
               var cx = '017213726194841070573:WMX6838984';
               var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
               gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=' + cx;
               var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
            })();
          </script></head>
<body>
      <div id="header-db" class="spread">
        <div class="split">
          <div id="logo">
            <div><a href="http://www.mongodb.org/"><img class="logo" src="http://media.mongodb.org/logo-mongodb.png" alt="MongoDB Logo"/></a></div>
          </div>
        </div>
      </div>  
      <div class="document">
           <div class="documentwrapper"><div class="bodywrapper">
               <div class="body">
                 
    <div class="bc">
      <ul>
          <li><a href="../replication.html">Replication</a><span class="bcpoint"> > </span></li>
          
          <li><a href="../applications/replication.html">Replica Set Considerations and Behaviors for Applications and Development</a><span class="bcpoint"> > </span></li>
          <li>Write Concern</li> 
      </ul>
    </div>
                 <div id="cse-results">
                   <gcse:searchresults linkTarget="_top"></gcse:searchresults>
                 </div>
                 
  <div class="section" id="write-concern">
<span id="index-0"></span><span id="id1"></span><h1>Write Concern<a class="headerlink" href="#write-concern" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="../reference/glossary.html#term-write-concern"><em class="xref std std-term">Write concern</em></a> is a quality of every write operation issued to
a MongoDB deployment, and describes the amount of <em>concern</em> the
application has for the outcome of the write operation. With weak or
disabled write concern, the application can send an write operation to
MongoDB and then continue without waiting for a response from the
database. With stronger write concerns, write operations wait until
MongoDB acknowledges or confirms a successful write operation. MongoDB
provides different levels of write concern to better address the
specific needs of applications.</p>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../reference/write-concern.html"><em>Write Concern Reference</em></a> for a reference of
specific write concern configuration. Also consider
<a class="reference internal" href="write-operations.html"><em>Write Operations</em></a> for a general overview of write
operations with MongoDB.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">After the <a class="reference internal" href="../release-notes/drivers-write-concern.html"><em>driver write concern change</em></a> all officially supported
MongoDB drivers enable write concern by default.</p>
</div>
<div class="section" id="types-of-write-concern">
<h2>Types of Write Concern<a class="headerlink" href="#types-of-write-concern" title="Permalink to this headline">¶</a></h2>
<p>Clients issue write operations with some level of <a class="reference internal" href="../reference/glossary.html#term-write-concern"><em class="xref std std-term">write
concern</em></a>, which describes the level of concern or guarantee the server
will provide in its response to a write operation.  Consider the
following levels of conceptual write concern, listed from weakest to
strongest:</p>
<div class="section" id="errors-ignored">
<span id="write-concern-errors-ignored"></span><h3>Errors Ignored<a class="headerlink" href="#errors-ignored" title="Permalink to this headline">¶</a></h3>
<p>With a <em>errors ignored</em> write concern, write operations are not
acknowledged by MongoDB. Write operations may not succeed in the case
of connection errors that the client is not yet aware of, or if the
<a class="reference internal" href="../reference/program/mongod.html#bin.mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> produces an exception (e.g. a duplicate key
exception for <a class="reference internal" href="indexes.html#index-type-unique"><em>unique indexes</em></a>.) While this
operation is efficient because it does not require the database to
respond to every write operation, it also incurs a significant risk
with regards to the persistence and durability of the data.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do not use this option in normal operation.</p>
</div>
</div>
<div class="section" id="unacknowledged">
<span id="write-concern-unacknowledged"></span><h3>Unacknowledged<a class="headerlink" href="#unacknowledged" title="Permalink to this headline">¶</a></h3>
<p>With a <em>unacknowledged</em> write concern, MongoDB does not acknowledge
the receipt of write operation as with a write concern level of
<em>ignore</em>; however, the driver will receive and handle network errors,
as possible given system networking configuration.</p>
<p>Before the releases outlined in <a class="reference internal" href="../release-notes/drivers-write-concern.html#driver-write-concern-change"><em>Default Write Concern Change</em></a>,
this was the default write concern.</p>
</div>
<div class="section" id="acknowledged">
<span id="write-concern-acknowledged"></span><h3>Acknowledged<a class="headerlink" href="#acknowledged" title="Permalink to this headline">¶</a></h3>
<p>With a receipt <em>acknowledged</em> write concern, the <a class="reference internal" href="../reference/program/mongod.html#bin.mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a>
confirms the receipt of the write operation. With this level of write
concern, clients can catch network, duplicate key, and other
exceptions.</p>
<p>This is the default write concern, after the releases outlined in
<a class="reference internal" href="../release-notes/drivers-write-concern.html#driver-write-concern-change"><em>Default Write Concern Change</em></a>.</p>
<p>Internally, the default write concern is to call
<a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> with no arguments. For replica sets, you can
define the default write concern settings in the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></tt></a> If
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></tt></a> does not
define a default write concern setting, <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a>
defaults to basic receipt acknowledgment.</p>
</div>
<div class="section" id="journaled">
<span id="write-concern-replica-journaled"></span><h3>Journaled<a class="headerlink" href="#journaled" title="Permalink to this headline">¶</a></h3>
<p>With a <em>journaled</em> write concern, the <a class="reference internal" href="../reference/program/mongod.html#bin.mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> will confirm
the write operation only after it has written the operation to the
<a class="reference internal" href="../reference/glossary.html#term-journal"><em class="xref std std-term">journal</em></a>. This confirms that the write operation can survive a
<a class="reference internal" href="../reference/program/mongod.html#bin.mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> shutdown and ensures that the write operation is
durable.</p>
<p>While receipt <em>acknowledged</em> without <em>journaled</em> provides the
fundamental basis for write concern, there is a window between
journal commits where the write operation is not fully durable. See
<a class="reference internal" href="../reference/configuration-options.html#journalCommitInterval" title="journalCommitInterval"><tt class="xref mongodb mongodb-setting docutils literal"><span class="pre">journalCommitInterval</span></tt></a> for more information on this
window. Require <em>journaled</em> as part of the write concern to provide
this durability guarantee.</p>
</div>
<div class="section" id="replica-acknowledged">
<span id="replica-set-write-concern"></span><span id="write-concern-replica-acknowledged"></span><h3>Replica Acknowledged<a class="headerlink" href="#replica-acknowledged" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../reference/glossary.html#term-replica-set"><em class="xref std std-term">Replica sets</em></a> present an additional layer of
consideration for write concern. Basic write concern levels affect the
write operation on only one <a class="reference internal" href="../reference/program/mongod.html#bin.mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> instance. The <tt class="docutils literal"><span class="pre">w</span></tt>
argument to <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> provides a <em>replica
acknowledged</em> level of write concern. With <em>replica acknowledged</em> you
can guarantee that the write operation has propagated to the members
of a replica set. See the <a class="reference internal" href="#replica-set-write-concern"><em>Write Concern for Replica Sets</em></a> document for more information.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requiring <em>journaled</em> write concern in a replica set only requires
a journal commit of the write operation to the <a class="reference internal" href="../reference/glossary.html#term-primary"><em class="xref std std-term">primary</em></a> of the
set regardless of the level of <em>replica acknowledged</em> write
concern.</p>
</div>
</div>
</div>
<div class="section" id="write-concern-for-replica-sets">
<h2>Write Concern for Replica Sets<a class="headerlink" href="#write-concern-for-replica-sets" title="Permalink to this headline">¶</a></h2>
<p>MongoDB&#8217;s built-in <a class="reference internal" href="../reference/glossary.html#term-write-concern"><em class="xref std std-term">write concern</em></a> confirms the success of write
operations to a <a class="reference internal" href="../reference/glossary.html#term-replica-set"><em class="xref std std-term">replica set&#8217;s</em></a> <a class="reference internal" href="../reference/glossary.html#term-primary"><em class="xref std std-term">primary</em></a>.
Write concern uses the <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> command after write
operations to return an object with error information or confirmation
that there are no errors.</p>
<p>From the perspective of a client application, whether a MongoDB
instance is running as a single server (i.e. &#8220;standalone&#8221;) or a
<a class="reference internal" href="../reference/glossary.html#term-replica-set"><em class="xref std std-term">replica set</em></a> is transparent. However, replica sets offer some
configuration options for write and read operations. <a class="footnote-reference" href="#sharded-clusters" id="id2">[1]</a></p>
<table class="docutils footnote" frame="void" id="sharded-clusters" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td><a class="reference internal" href="../reference/glossary.html#term-sharded-cluster"><em class="xref std std-term">Sharded clusters</em></a> where the
shards are also replica sets provide the same configuration options
with regards to write and read operations.</td></tr>
</tbody>
</table>
<div class="section" id="verify-write-operations">
<h3>Verify Write Operations<a class="headerlink" href="#verify-write-operations" title="Permalink to this headline">¶</a></h3>
<p>The default write concern confirms write operations only on the
primary.  You can configure write concern to confirm write operations
to additional replica set members as well by issuing the
<a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> command with the <tt class="docutils literal"><span class="pre">w</span></tt> option.</p>
<p>The <tt class="docutils literal"><span class="pre">w</span></tt> option confirms that write operations have replicated to the
specified number of replica set members, including the primary. You can
either specify a number or specify <tt class="docutils literal"><span class="pre">majority</span></tt>, which ensures the write
propagates to a majority of set members.</p>
<p>If you specify a <tt class="docutils literal"><span class="pre">w</span></tt> value greater than the number of members that
hold a copy of the data (i.e., greater than the number of
non-<a class="reference internal" href="../reference/glossary.html#term-arbiter"><em class="xref std std-term">arbiter</em></a> members), the operation blocks until those members
become available. This can cause the operation to block forever. To
specify a timeout threshold for the <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> operation,
use the <tt class="docutils literal"><span class="pre">wtimeout</span></tt> argument.</p>
<p>See <a class="reference internal" href="../reference/command/getLastError.html#gle-examples"><em>getLastError Examples</em></a> for example
invocations.</p>
</div>
<div class="section" id="modify-default-write-concern">
<h3>Modify Default Write Concern<a class="headerlink" href="#modify-default-write-concern" title="Permalink to this headline">¶</a></h3>
<p>You can configure your own &#8220;default&#8221; <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a>
behavior for a replica set. Use the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></tt></a> setting in
the <a class="reference internal" href="../reference/replica-configuration.html"><em>replica set configuration</em></a>. The following sequence of
commands creates a configuration that waits for the write operation to
complete on a majority of the set members before returning:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="p">{}</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">getLastErrorDefaults</span> <span class="o">=</span> <span class="p">{</span><span class="nx">w</span><span class="o">:</span> <span class="s2">&quot;majority&quot;</span><span class="p">}</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></tt></a>
setting affects only those <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> commands that
have <em>no</em> other arguments.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use of insufficient write concern can lead to <a class="reference internal" href="replication.html#replica-set-rollbacks"><em>rollbacks</em></a> in the case of <a class="reference internal" href="replication.html#replica-set-failover"><em>replica set failover</em></a>. Always ensure that your operations have
specified the required write concern for your application.</p>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="write-operations.html#write-operations-write-concern"><em>Write Concern</em></a> and
<a class="reference internal" href="../reference/connection-string.html#connections-write-concern"><em>Write Concern Options</em></a></p>
</div>
</div>
<div class="section" id="custom-write-concerns">
<h3>Custom Write Concerns<a class="headerlink" href="#custom-write-concerns" title="Permalink to this headline">¶</a></h3>
<p>You can use replica set tags to create custom write concerns using the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></tt></a> and
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorModes" title="local.system.replset.settings.getLastErrorModes"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorModes</span></tt></a> replica set
settings.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Custom write concern modes specify the field name and a number of
<em>distinct</em> values for that field. By contrast, read preferences use
the value of fields in the tag document to direct read operations.</p>
<p class="last">In some cases, you may be able to use the same tags for read
preferences and write concerns; however, you may need to create
additional tags for write concerns depending on the requirements of
your application.</p>
</div>
</div>
<div class="section" id="single-tag-write-concerns">
<h3>Single Tag Write Concerns<a class="headerlink" href="#single-tag-write-concerns" title="Permalink to this headline">¶</a></h3>
<p>Consider a five member replica set, where each member has one of the
following tag sets:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="o">:</span> <span class="s2">&quot;reporting&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="o">:</span> <span class="s2">&quot;backup&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="o">:</span> <span class="s2">&quot;application&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="o">:</span> <span class="s2">&quot;application&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="o">:</span> <span class="s2">&quot;application&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>You could create a custom write concern mode that will ensure that
applicable write operations will not return until members with two
different values of the <tt class="docutils literal"><span class="pre">use</span></tt> tag have acknowledged the write
operation. Create the mode with the following sequence of operations
in the <a class="reference internal" href="../reference/program/mongo.html#bin.mongo" title="mongo"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongo</span></tt></a> shell:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">getLastErrorModes</span><span class="o">:</span> <span class="p">{</span> <span class="nx">use2</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="o">:</span> <span class="mi">2</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
<p>To use this mode pass the string <tt class="docutils literal"><span class="pre">multiUse</span></tt> to the <tt class="docutils literal"><span class="pre">w</span></tt> option of
<a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> as follows:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">runCommand</span><span class="p">(</span> <span class="p">{</span> <span class="nx">getLastError</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="nx">use2</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="specific-custom-write-concerns">
<h3>Specific Custom Write Concerns<a class="headerlink" href="#specific-custom-write-concerns" title="Permalink to this headline">¶</a></h3>
<p>If you have a three member replica with the following tag sets:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;disk&quot;</span><span class="o">:</span> <span class="s2">&quot;ssd&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;disk&quot;</span><span class="o">:</span> <span class="s2">&quot;san&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;disk&quot;</span><span class="o">:</span> <span class="s2">&quot;spinning&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>You cannot specify a custom
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorModes" title="local.system.replset.settings.getLastErrorModes"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorModes</span></tt></a> value to
ensure that the write propagates to the <tt class="docutils literal"><span class="pre">san</span></tt> before
returning. However, you may implement this write concern policy by
creating the following additional tags, so that the set resembles the
following:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span> <span class="s2">&quot;disk&quot;</span><span class="o">:</span> <span class="s2">&quot;ssd&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;disk&quot;</span><span class="o">:</span> <span class="s2">&quot;san&quot;</span><span class="p">,</span> <span class="s2">&quot;disk.san&quot;</span><span class="o">:</span> <span class="s2">&quot;san&quot;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;disk&quot;</span><span class="o">:</span> <span class="s2">&quot;spinning&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>Then, create a custom
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorModes" title="local.system.replset.settings.getLastErrorModes"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorModes</span></tt></a> value, as
follows:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">getLastErrorModes</span><span class="o">:</span> <span class="p">{</span> <span class="nx">san</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;disk.san&quot;</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
<p>To use this mode pass the string <tt class="docutils literal"><span class="pre">san</span></tt> to the <tt class="docutils literal"><span class="pre">w</span></tt> option of
<a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a> as follows:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">runCommand</span><span class="p">(</span> <span class="p">{</span> <span class="nx">getLastError</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="nx">san</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
<p>This operation will not return until a replica set member with the tag
<tt class="docutils literal"><span class="pre">disk.san</span></tt> returns.</p>
<p>You may set a custom write concern mode as the default write concern
mode using <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></tt></a>
replica set as in the following setting:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">getLastErrorDefaults</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">ssd</span><span class="o">:</span><span class="mi">1</span> <span class="p">}</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../tutorial/configure-replica-set-tag-sets.html#replica-set-configuration-tag-sets"><em>Configure Replica Set Tag Sets</em></a> for further
information about replica set reconfiguration and tag sets.</p>
</div>
</div>
</div>
</div>


    <div id="btnv">
        <ul id="btnvl">
              <li id="btnvpr"><a href="../applications/replication.html" title="Previous Section: Replica Set Considerations and Behaviors for Applications and Development">&lt; &nbsp; Replica Set Considerations and Behaviors for Applications and Development</a></li>
              <li id="btnvup"><a href="../replication.html" title="Parent Section: Replication" >&#47;&#92;&nbsp; Replication</a></li>
              <li id="btnvnx"><a href="read-preference.html" title="Next Section: Read Preference">Read Preference &nbsp;&gt;</a></li>
        </ul>
    </div></div></div>
           </div>
       <div class="sphinxsidebar">
         <div class="sphinxsidebarwrapper">
  <h3>
    <a href="../index.html">MongoDB Manual</a> <span id="vn">2.4</span>
  </h3>



<div class="site-contents"><a href="../contents.html">Contents</a></div>


<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Install MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crud.html">Core MongoDB Operations (CRUD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data-modeling.html">Data Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aggregation.html">Aggregation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indexes.html">Indexes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../replication.html">Replication</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="replication.html">Replica Set Fundamental Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="replica-set-architectures.html">Replica Set Architectures and Deployment Patterns</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../applications/replication.html">Replica Set Considerations and Behaviors for Applications and Development</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="">Write Concern</a><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="read-preference.html">Read Preference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="replication-internals.html">Replica Set Internals and Behaviors</a></li>
<li class="toctree-l2"><a class="reference internal" href="master-slave.html">Master Slave Replication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../administration/replica-sets.html">Replica Set Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/replica-configuration.html">Replica Set Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/replica-commands.html">Replica Set Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../release-notes/replica-set-features.html">Replica Set Features and Version Compatibility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../sharding.html">Sharding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mongo.html">The <tt class="docutils literal"><span class="pre">mongo</span></tt> Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use-cases.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About MongoDB Documentation</a></li>
</ul>



<div class="site-index"><a href="../genindex.html">Index</a></div>
<h3>Formats</h3>
<ul class="this-page-menu">
  <li><a href="/manual/single/">MongoDB Manual, Single HTML Page</a></li>
  <li><a href="http://docs.mongodb.org/master/MongoDB-Manual-master.pdf" rel="nofollow">MongoDB Manual, PDF Format</a></li>
  <li><a href="http://docs.mongodb.org/master/MongoDB-Manual-master.epub" rel="nofollow">MongoDB Manual, ePub Format</a></li>
</ul>
<h3><a href="http://www.mongodb.org/about/">About MongoDB</a></h3>
<ul>
  <li><a href="http://www.mongodb.org/about/introduction">Introduction</a></li>
  <li><a href="http://www.mongodb.org/about/community">User Community</a></li>
  <li><a href="http://mongodb.org/about/community/masters">MongoDB Masters</a></li>
  <li><a href="http://planet.mongodb.org">Planet MongoDB</a></li>
</ul>
<h3><a href="http://docs.mongodb.org/ecosystem/">MongoDB Ecosystem</a></h3>
<ul>
 <li><a href="http://docs.mongodb.org/ecosystem/drivers/">Drivers and Client libraries</a>
   <ul>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/c">C</a> (<a href="http://api.mongodb.org/c/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/cpp">C++</a> (<a href="http://api.mongodb.org/cplusplus/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/csharp">C#</a> (<a href="http://api.mongodb.org/csharp/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/erlang">Erlang</a> (<a href="http://api.mongodb.org/erlang">docs</a>)</li>
     <li><a href="http://hackage.haskell.org/package/mongoDB">Haskell</a> (<a href="http://api.mongodb.org/haskell">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/java">Java</a> (<a href="http://api.mongodb.org/java/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/javascript">JavaScript</a> (<a href="http://api.mongodb.org/js/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/perl">Perl</a> (<a href="http://api.mongodb.org/perl/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/php">PHP</a> (<a href="http://php.net/mongo/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/python">Python</a> (<a href="http://api.mongodb.org/python/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/ruby">Ruby</a> (<a href="http://api.mongodb.org/ruby/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/scala">Scala</a> (<a href="http://api.mongodb.org/scala/casbah/current/">docs</a>)</li>
   </ul>
 </li>
 <li><a href="http://docs.mongodb.org/ecosystem/tools/">Tools and Integration</a></li>
 <li><a href="http://docs.mongodb.org/ecosystem/platforms/">Platform Integration</a></li>
</ul><h3>MongoDB Resources</h3>
<ul>
  <li><a href="http://www.mongodb.org/downloads">Downloads</a></li>
  <li><a href="http://www.10gen.com/events">MongoDB Events</a></li>
  <li><a href="http://www.10gen.com/presentations">Slides and Video</a></li>
  <li><a href="http://www.10gen.com/products/mms/">MongoDB Monitoring Service</a> (<a href="http://mms.10gen.com/help/">docs</a>)</li>
</ul>
         </div>
       </div>
        <div class="clearer"></div>
      </div><div id="top-right">
        <div class="user-right">
          <ul id="header-menu-bar" class="ajs-menu-bar">
            <li class="normal"><a target="_blank" href="http://groups.google.com/group/mongodb-user">Forums</a></li>
            <li class="normal"><a target="_blank" href="http://blog.mongodb.org/">Blog</a></li>
            <li class="normal"><a href="http://www.mongodb.org/downloads">Download</a></li>
            <li class="normal"><a href="http://docs.mongodb.org/ecosystem/drivers/">Drivers</a></li>
            <li class="normal"><a href="http://www.10gen.com/events">Events</a></li>
            <li class="normal last"><a class="last" href="http://docs.mongodb.org/manual/meta/translation">Translations</a></li>
          </ul>
        </div>
      </div>
      <div class="search-db"><gcse:searchbox></gcse:searchbox></div>
          <div id="etp">
            <ul>
              <li><a href="https://github.com/mongodb/docs/blob/master/source/core/write-concern.txt" target="_blank" title="Edit core/write-concern.txt on GitHub">Edit this Page</a></li>
              <li><a href="http://github.com/mongodb/docs" target="_blank" title="Fork the documentation on GitHub and contribute.">GitHub</a></li>
              <li><a id="jirafeedback" href="https://jira.mongodb.org/secure/CreateIssueDetails!init.jspa?pid=10380&issuetype=4&priority=4&summary=Comment+on%3a+%22core/write-concern%2Etxt%22" target="_blank" title="Report a problem with core/write-concern.txt on Jira">Report a Problem</a></li>
            </ul>
          </div>
      <div class="footer">
        <p>
          &copy; <a href="">Copyright</a> 2011-2013, 10gen, Inc. 
          MongoDB&reg;, Mongo&reg;, and the leaf logo are registered trademarks of <a href="http://www.10gen.com/">10gen, Inc.</a>
        </p>
      </div><script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_require', 'inpage_linkid', pluginUrl]);
_gaq.push(['_setAccount', 'UA-7301842-8']);
_gaq.push(['_setDomainName', 'docs.mongodb.org']);
_gaq.push(['_trackPageview']);
(function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
        })();
</script>

<script type="text/javascript">var _kiq = _kiq || [];</script>
<script type="text/javascript">
(function(){
setTimeout(function(){ var d = document, f = d.getElementsByTagName('script')[0], s = d.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//s3.amazonaws.com/ki.js/49119/a7n.js'; f.parentNode.insertBefore(s, f); }, 1);
})();
</script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-7301842-14', 'mongodb.org');
ga('send', 'pageview');
</script>

<script type="text/javascript">
document.write(unescape("%3Cscript src='" + document.location.protocol + "//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>try { mktoMunchkin("017-HGS-593"); } catch(e) {}</script><script type="text/javascript">
jQuery.ajax({
	 url: "https://jira.mongodb.org/s/en_UScn8g8x/782/6/1.2.5/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?collectorId=298ba4e7",
	 type: "get",
	 cache: true,
	 dataType: "script"
	});
window.ATL_JQ_PAGE_PROPS =  {
	"triggerFunction": function(showCollectorDialog) {
		jQuery("#jirafeedback").click(function(e) {e.preventDefault();showCollectorDialog();});},
		fieldValues: {component: 'mongodb-manual', summary: 'Comment on: "manual/core/write-concern.txt"'},
		environment: {'repo': 'docs','source': 'core/write-concern'}
		};
</script><script type="text/javascript">
var versions = [{'t': '2.4 (current)', 'v': 'v2.4'}, {'t': '2.2', 'v': 'v2.2'}]
var pagename = 'core/write-concern'
var stable = 'v2.4'

function vfnav() {
    if ( pagename=='index' ) {
        pn = ''
    }
    else {
        pn = pagename
    }

    v = $(this).children("option:selected").attr('value')

    if ( (v==0) || (v==stable) ) {
        uri = '/manual/' + pn
    }
    else {
        uri = '/' + v + '/' + pn
    }
    window.location.href= uri;
}

$(document).ready(function(){
    $("#vn").html(function(){
        s=$("<select/>");
        o='<option/>';

        $.each(versions,function(index, version) {
            if ( version.v==stable ) {
                dv=true;
            }
            $(o,{value:version.v,text: version.t}).appendTo(s);
        });

        if ( dv==false ) {
            $(o, {value:0,text:'(stable)'}).appendTo(s);
        }
        return(s);
    });

    $("#vn select").bind('change', vfnav);
    $('#vn select').val('v2.4');
});
</script>
</body>
</html>