<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head><title>Write Operations &mdash; MongoDB Manual 2.4.3</title><link rel="shortcut icon" href="http://media.mongodb.org/favicon.ico" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="robots" content="index" />
  <meta name="release" content="2.4.3"/>
  <meta name="DC.Source" content="https://github.com/mongodb/docs/blob/master/source/core/write-operations.txt"/>
      <link rel="canonical" href="http://docs.mongodb.org/manual/core/write-operations" />
  
   <link rel="stylesheet" href="../_static/mongodb-docs.css" type="text/css" />
   <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      
   <script type="text/javascript">
     var DOCUMENTATION_OPTIONS = {
         URL_ROOT:    '../',
         VERSION:     '2.4',
         COLLAPSE_INDEX: false,
         FILE_SUFFIX: '.html',
         HAS_SOURCE:  false,
     };
   </script>
       <script type="text/javascript" src="../_static/jquery.js"></script>
       <script type="text/javascript" src="../_static/underscore.js"></script>
       <script type="text/javascript" src="../_static/doctools.js"></script>
          <link rel="search" type="application/opensearchdescription+xml" href="http://docs.mongodb.org/osd.xml" title="MongoDB Help"/>
<link rel="author" title="About these documents" href="../about.html" />
<link rel="top" title="MongoDB Manual" href="../index.html" />
<link rel="up" title="Core MongoDB Operations (CRUD)" href="../crud.html" />
<link rel="next" title="Write Concern Reference" href="../reference/write-concern.html" />
<link rel="prev" title="Read Operations" href="read-operations.html" />
          <script>
            (function() {
               var cx = '017213726194841070573:WMX6838984';
               var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
               gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//www.google.com/cse/cse.js?cx=' + cx;
               var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
            })();
          </script></head>
<body>
      <div id="header-db" class="spread">
        <div class="split">
          <div id="logo">
            <div><a href="http://www.mongodb.org/"><img class="logo" src="http://media.mongodb.org/logo-mongodb.png" alt="MongoDB Logo"/></a></div>
          </div>
        </div>
      </div>  
      <div class="document">
           <div class="documentwrapper"><div class="bodywrapper">
               <div class="body">
                 
    <div class="bc">
      <ul>
          <li><a href="../crud.html">Core MongoDB Operations (CRUD)</a><span class="bcpoint"> > </span></li>
          <li>Write Operations</li> 
      </ul>
    </div>
                 <div id="cse-results">
                   <gcse:searchresults linkTarget="_top"></gcse:searchresults>
                 </div>
                 
  <span class="target" id="index-0"></span><div class="section" id="write-operations">
<span id="index-1"></span><h1>Write Operations<a class="headerlink" href="#write-operations" title="Permalink to this headline">¶</a></h1>
<p>All operations that create or modify data in the MongoDB instance are
write operations. MongoDB represents data as <a class="reference internal" href="../reference/glossary.html#term-document"><em class="xref std std-term">BSON documents</em></a> stored in <a class="reference internal" href="../reference/glossary.html#term-collection"><em class="xref std std-term">collections</em></a>. Write
operations target one collection and are atomic on the level of a
single document: no single write operation can atomically affect more
than one document or more than one collection.</p>
<p>This document introduces the write operators available in MongoDB as
well as presents strategies to increase the efficiency of writes in
applications.</p>
<div class="section" id="write-operators">
<span id="write-operations-operators"></span><span id="index-2"></span><h2>Write Operators<a class="headerlink" href="#write-operators" title="Permalink to this headline">¶</a></h2>
<p>For information on write operators and how to write data to a MongoDB
database, see the following pages:</p>
<ul class="simple">
<li><a class="reference internal" href="create.html"><em>Create</em></a></li>
<li><a class="reference internal" href="update.html"><em>Update</em></a></li>
<li><a class="reference internal" href="delete.html"><em>Delete</em></a></li>
</ul>
<p>For information on specific methods used to perform write operations in the
<a class="reference internal" href="../reference/program/mongo.html#bin.mongo" title="mongo"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongo</span></tt></a> shell, see the following:</p>
<ul class="simple">
<li><a class="reference internal" href="../reference/method/db.collection.insert.html#db.collection.insert" title="db.collection.insert()"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.insert()</span></tt></a></li>
<li><a class="reference internal" href="../reference/method/db.collection.update.html#db.collection.update" title="db.collection.update()"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.update()</span></tt></a></li>
<li><a class="reference internal" href="../reference/method/db.collection.save.html#db.collection.save" title="db.collection.save()"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.save()</span></tt></a></li>
<li><a class="reference internal" href="../reference/method/db.collection.findAndModify.html#db.collection.findAndModify" title="db.collection.findAndModify()"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.findAndModify()</span></tt></a></li>
<li><a class="reference internal" href="../reference/method/db.collection.remove.html#db.collection.remove" title="db.collection.remove()"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.remove()</span></tt></a></li>
</ul>
<p>For information on how to perform write operations from within an
application, see the <a class="reference internal" href="../applications/drivers.html"><em>MongoDB Drivers and Client Libraries</em></a> documentation or the
documentation for your client library.</p>
</div>
<div class="section" id="write-concern">
<span id="write-operations-write-concern"></span><h2>Write Concern<a class="headerlink" href="#write-concern" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../reference/glossary.html#term-write-concern"><em class="xref std std-term">Write concern</em></a> is a quality of every write operation issued to
a MongoDB deployment, and describes the amount of <em>concern</em> the
application has for the outcome of the write operation. With weak or
disabled write concern, the application can send an write operation to
MongoDB and then continue without waiting for a response from the
database. With stronger write concerns, write operations wait until
MongoDB acknowledges or confirms a successful write operation. MongoDB
provides different levels of write concern to better address the
specific needs of applications.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="../release-notes/drivers-write-concern.html"><em>driver write concern</em></a>
change created a new connection class in all of the MongoDB
drivers, called <tt class="docutils literal"><span class="pre">MongoClient</span></tt> with a different default write
concern. See the <a class="reference internal" href="../release-notes/drivers-write-concern.html"><em>release notes</em></a>
for this change, and the release notes for the driver you&#8217;re using
for more information about your driver&#8217;s release.</p>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="write-concern.html"><em>Write Concern</em></a> and
<a class="reference internal" href="../reference/write-concern.html"><em>Write Concern Reference</em></a>.</p>
</div>
</div>
<div class="section" id="bulk-inserts">
<span id="write-operations-bulk-insert"></span><h2>Bulk Inserts<a class="headerlink" href="#bulk-inserts" title="Permalink to this headline">¶</a></h2>
<p>In some situations you may need to insert or ingest a large amount of
data into a MongoDB database. These <em>bulk inserts</em> have some
special considerations that are different from other write
operations.</p>
<p>The <a class="reference internal" href="../reference/method/db.collection.insert.html#db.collection.insert" title="db.collection.insert()"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">insert()</span></tt></a> method, when passed an
array of documents, will perform a bulk insert, and inserts each
document atomically. <a class="reference internal" href="../applications/drivers.html"><em>Drivers</em></a>
provide their own interface for this kind of operation.</p>
<p class="versionadded">
<span class="versionmodified">New in version 2.2: </span><a class="reference internal" href="../reference/method/db.collection.insert.html#db.collection.insert" title="db.collection.insert()"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">insert()</span></tt></a> in the <a class="reference internal" href="../reference/program/mongo.html#bin.mongo" title="mongo"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongo</span></tt></a>
shell gained support for bulk inserts in version 2.2.</p>
<p>Bulk insert can significantly increase performance by amortizing
<a class="reference internal" href="#write-operations-write-concern"><em>write concern</em></a> costs. In the
drivers, you can configure write concern for batches rather than on a
per-document level.</p>
<p>Drivers also have a <tt class="docutils literal"><span class="pre">ContinueOnError</span></tt> option in their insert
operation, so that the bulk operation will continue to insert
remaining documents in a batch even if an insert fails.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last versionadded">
<span class="versionmodified">New in version 2.0: </span>Support for <tt class="docutils literal"><span class="pre">ContinueOnError</span></tt> depends on version 2.0 of the
core <a class="reference internal" href="../reference/program/mongod.html#bin.mongod" title="mongod"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongod</span></tt></a> and <a class="reference internal" href="../reference/program/mongos.html#bin.mongos" title="mongos"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongos</span></tt></a> components.</p>
</div>
<p>If the bulk insert process generates more than one error in a batch
job, the client will only receive the most recent error. All bulk
operations to a <a class="reference internal" href="../reference/glossary.html#term-sharded-cluster"><em class="xref std std-term">sharded collection</em></a> run with
<tt class="docutils literal"><span class="pre">ContinueOnError</span></tt>, which applications cannot disable. See
<a class="reference internal" href="../tutorial/manage-chunks-in-sharded-cluster.html#sharding-bulk-inserts"><em>Strategies for Bulk Inserts in Sharded Clusters</em></a> section for more information on
consideration for bulk inserts in sharded clusters.</p>
<p>For more information see your <a class="reference internal" href="../applications/drivers.html"><em>driver documentation</em></a> for details on performing bulk inserts in
your application. Also consider the following resources:
<a class="reference internal" href="#write-operations-sharded-clusters"><em>Sharded Clusters</em></a>,
<a class="reference internal" href="../tutorial/manage-chunks-in-sharded-cluster.html#sharding-bulk-inserts"><em>Strategies for Bulk Inserts in Sharded Clusters</em></a>, and
<a class="reference internal" href="import-export.html"><em>Import and Export MongoDB Data</em></a>.</p>
</div>
<div class="section" id="indexing">
<span id="write-operations-indexing"></span><h2>Indexing<a class="headerlink" href="#indexing" title="Permalink to this headline">¶</a></h2>
<p>After every insert, update, or delete operation, MongoDB must update
<em>every</em> index associated with the collection in addition to the data
itself. Therefore, every index on a collection adds some amount of
overhead for the performance of write operations. <a class="footnote-reference" href="#exceptions" id="id1">[1]</a></p>
<p>In general, the performance gains that indexes provide for <em>read
operations</em> are worth the insertion penalty; however, when optimizing
write performance, be careful when creating new indexes and always
evaluate the indexes on the collection and ensure that your queries are
actually using these indexes.</p>
<p>For more information on indexes in MongoDB consider <a class="reference internal" href="../indexes.html"><em>Indexes</em></a>
and <a class="reference internal" href="../applications/indexes.html"><em>Indexing Strategies</em></a>.</p>
<table class="docutils footnote" frame="void" id="exceptions" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>The overhead for <a class="reference internal" href="indexes.html#index-type-sparse"><em>sparse indexes</em></a> inserts and updates to un-indexed fields
is less than for non-sparse indexes. Also for non-sparse indexes,
updates that don&#8217;t change the record size have less indexing
overhead.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="isolation">
<span id="write-operations-isolation"></span><h2>Isolation<a class="headerlink" href="#isolation" title="Permalink to this headline">¶</a></h2>
<p>When a single write operation modifies multiple documents, the
operation as a whole is not atomic, and other operations may
interleave. The modification of a single document, or record, is always
atomic, even if the write operation modifies multiple sub-document
<em>within</em> the single record.</p>
<p>No other operations are atomic; however, you can attempt to isolate a
write operation that affects multiple documents using the
<a class="reference internal" href="../reference/operator/isolated.html"><em>isolation operator</em></a>.</p>
<p>To isolate a sequence of write operations from other read and write
operations, see <a class="reference internal" href="../tutorial/perform-two-phase-commits.html"><em>Perform Two Phase Commits</em></a>.</p>
</div>
<div class="section" id="updates">
<h2>Updates<a class="headerlink" href="#updates" title="Permalink to this headline">¶</a></h2>
<p>Each document in a MongoDB collection has allocated <em>record</em> space
which includes the entire document <em>and</em> a small amount of
padding. This padding makes it possible for update operations to
increase the size of a document slightly without causing the document
to outgrow the allocated record size.</p>
<p>Documents in MongoDB can grow up to the full maximum <a class="reference internal" href="../reference/limits.html#BSON Document Size" title="BSON Document Size"><tt class="xref mongodb mongodb-limit docutils literal"><span class="pre">BSON</span>
<span class="pre">document</span> <span class="pre">size</span></tt></a>. However, when documents outgrow
their allocated record size MongoDB must allocate a new record and
move the document to the new record. Update operations that do not
cause a document to grow, (i.e. <em>in-place</em> updates,) are significantly
more efficient than those updates that cause document growth. Use
<a class="reference internal" href="data-modeling.html"><em>data models</em></a> that minimize the need for
document growth when possible.</p>
<p>For complete examples of update operations, see
<a class="reference internal" href="update.html"><em>Update</em></a>.</p>
</div>
<div class="section" id="padding-factor">
<span id="write-operations-padding-factor"></span><h2>Padding Factor<a class="headerlink" href="#padding-factor" title="Permalink to this headline">¶</a></h2>
<p>If an update operation does not cause the document to increase in
size, MongoDB can apply the update in-place. Some updates
change the size of the document, for example using the
<a class="reference internal" href="../reference/operator/push.html#op._S_push" title="$push"><tt class="xref mongodb mongodb-operator docutils literal"><span class="pre">$push</span></tt></a> operator to append a sub-document to an array can
cause the top level document to grow beyond its allocated space.</p>
<p>When documents grow, MongoDB relocates the document on disk with
enough contiguous space to hold the document. These relocations
take longer than in-place updates, particularly if the collection has
indexes that MongoDB must update all index entries. If
collection has many indexes, the move will impact write throughput.</p>
<p>To minimize document movements, MongoDB employs padding. MongoDB
adaptively learns if documents in a collection tend to grow, and if
they do, adds a <a class="reference internal" href="../reference/command/collStats.html#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a> so that the documents
have room to grow on subsequent writes. The
<a class="reference internal" href="../reference/command/collStats.html#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a> indicates the padding for new inserts
and moves.</p>
<p class="versionadded">
<span class="versionmodified">New in version 2.2: </span>You can use the <a class="reference internal" href="../reference/command/collMod.html#dbcmd.collMod" title="collMod"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">collMod</span></tt></a> command
with the <a class="reference internal" href="../reference/command/collMod.html#usePowerOf2Sizes" title="usePowerOf2Sizes"><tt class="xref mongodb mongodb-collflag docutils literal"><span class="pre">usePowerOf2Sizes</span></tt></a> flag so that MongoDB
allocates document space in sizes that are powers of 2. This helps
ensure that MongoDB can efficiently reuse the space freed as a
result of deletions or document relocations. As with all padding,
using document space allocations with power of 2 sizes minimizes,
but does not eliminate, document movements.</p>
<p>To check the current <a class="reference internal" href="../reference/command/collStats.html#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a> on a collection, you can
run the <a class="reference internal" href="../reference/method/db.collection.stats.html#db.collection.stats" title="db.collection.stats()"><tt class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.stats()</span></tt></a> operation in the
<a class="reference internal" href="../reference/program/mongo.html#bin.mongo" title="mongo"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongo</span></tt></a> shell, as in the following example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">db</span><span class="p">.</span><span class="nx">myCollection</span><span class="p">.</span><span class="nx">stats</span><span class="p">()</span>
</pre></div>
</div>
<p>Since MongoDB writes each document at a different point in time, the
padding for each document will not be the same. You can calculate the
padding size by subtracting 1 from the <a class="reference internal" href="../reference/command/collStats.html#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a>, for
example:</p>
<div class="highlight-none"><div class="highlight"><pre>padding size = (paddingFactor - 1) * &lt;document size&gt;.
</pre></div>
</div>
<p>For example, a <a class="reference internal" href="../reference/command/collStats.html#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a> of <tt class="docutils literal"><span class="pre">1.0</span></tt> specifies no padding
whereas a paddingFactor of <tt class="docutils literal"><span class="pre">1.5</span></tt> specifies a padding size of <tt class="docutils literal"><span class="pre">0.5</span></tt> or 50
percent (50%) of the document size.</p>
<p>Because the <a class="reference internal" href="../reference/command/collStats.html#collStats.paddingFactor" title="collStats.paddingFactor"><tt class="xref mongodb mongodb-data docutils literal"><span class="pre">paddingFactor</span></tt></a> is relative to the size of each
document, you cannot calculate the exact amount of padding for a
collection based on the average document size and padding factor.</p>
<p>If an update operation causes the document to <em>decrease</em> in size, for
instance if you perform an <a class="reference internal" href="../reference/operator/unset.html#op._S_unset" title="$unset"><tt class="xref mongodb mongodb-operator docutils literal"><span class="pre">$unset</span></tt></a> or a <a class="reference internal" href="../reference/operator/pop.html#op._S_pop" title="$pop"><tt class="xref mongodb mongodb-operator docutils literal"><span class="pre">$pop</span></tt></a>
update, the document remains in place and effectively has more
padding. If the document remains this size, the space is not reclaimed
until you perform a <a class="reference internal" href="../reference/command/compact.html#dbcmd.compact" title="compact"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">compact</span></tt></a> or a
<a class="reference internal" href="../reference/command/repairDatabase.html#dbcmd.repairDatabase" title="repairDatabase"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">repairDatabase</span></tt></a> operation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The following operations remove padding:</p>
<ul class="simple">
<li><a class="reference internal" href="../reference/command/compact.html#dbcmd.compact" title="compact"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">compact</span></tt></a>,</li>
<li><a class="reference internal" href="../reference/command/repairDatabase.html#dbcmd.repairDatabase" title="repairDatabase"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">repairDatabase</span></tt></a>, and</li>
<li>initial replica sync operations.</li>
</ul>
<p>However, with the <a class="reference internal" href="../reference/command/compact.html#dbcmd.compact" title="compact"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">compact</span></tt></a> command, you can run the
command with a <tt class="docutils literal"><span class="pre">paddingFactor</span></tt> or a <tt class="docutils literal"><span class="pre">paddingBytes</span></tt> parameter.</p>
<p>Padding is also removed if you use <a class="reference internal" href="../reference/program/mongoexport.html#bin.mongoexport" title="mongoexport"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongoexport</span></tt></a> from a
collection. If you use <a class="reference internal" href="../reference/program/mongoimport.html#bin.mongoimport" title="mongoimport"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongoimport</span></tt></a> into a new
collection, <a class="reference internal" href="../reference/program/mongoimport.html#bin.mongoimport" title="mongoimport"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongoimport</span></tt></a> will not add padding.  If you
use <a class="reference internal" href="../reference/program/mongoimport.html#bin.mongoimport" title="mongoimport"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongoimport</span></tt></a> with an existing collection with
padding, <a class="reference internal" href="../reference/program/mongoimport.html#bin.mongoimport" title="mongoimport"><tt class="xref mongodb mongodb-program docutils literal"><span class="pre">mongoimport</span></tt></a> will not affect the existing
padding.</p>
<p class="last">When a database operation removes padding, subsequent update that
require changes in record sizes will have reduced throughput until
the collection&#8217;s padding factor grows. Padding does not affect
in-place, and after <a class="reference internal" href="../reference/command/compact.html#dbcmd.compact" title="compact"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">compact</span></tt></a>,
<a class="reference internal" href="../reference/command/repairDatabase.html#dbcmd.repairDatabase" title="repairDatabase"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">repairDatabase</span></tt></a>, and replica set initial sync
the collection will require less storage.</p>
</div>
<div class="admonition-see-also admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="../faq/developers.html#faq-developers-manual-padding"><em>Can I manually pad documents to prevent moves during updates?</em></a></li>
<li>The <a class="reference internal" href="../reference/operator/inc.html#op._S_inc" title="$inc"><tt class="xref mongodb mongodb-operator docutils literal"><span class="pre">$inc</span></tt></a> for in-place updates.</li>
</ul>
</div>
</div>
<div class="section" id="architecture">
<h2>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
<div class="section" id="replica-sets">
<span id="write-operations-replica-sets"></span><h3>Replica Sets<a class="headerlink" href="#replica-sets" title="Permalink to this headline">¶</a></h3>
<p>In <a class="reference internal" href="../reference/glossary.html#term-replica-set"><em class="xref std std-term">replica sets</em></a>, all write operations go to the
set&#8217;s <a class="reference internal" href="../reference/glossary.html#term-primary"><em class="xref std std-term">primary</em></a>, which applies the write operation then records
the operations on the primary&#8217;s operation log or <a class="reference internal" href="../reference/glossary.html#term-oplog"><em class="xref std std-term">oplog</em></a>. The
oplog is a reproducible sequence of operations to the data
set. <a class="reference internal" href="../reference/glossary.html#term-secondary"><em class="xref std std-term">Secondary</em></a> members of the set are continuously replicating the
oplog and applying the operations to themselves in an asynchronous
process.</p>
<p>Large volumes of write operations, particularly bulk operations, may
create situations where the secondary members have difficulty applying
the replicating operations from the primary at a sufficient rate: this
can cause the secondary&#8217;s state to fall behind that of the primary. Secondaries
that are significantly behind the primary present problems for normal
operation of the replica set, particularly <a class="reference internal" href="replication.html#replica-set-failover-administration"><em>failover</em></a> in the form of <a class="reference internal" href="replication.html#replica-set-rollback"><em>rollbacks</em></a> as well as general <a class="reference internal" href="replication.html#replica-set-consistency"><em>read consistency</em></a>.</p>
<p>To help avoid this issue, you can customize the <a class="reference internal" href="#write-operations-write-concern"><em>write concern</em></a> to return confirmation of the write
operation to another member <a class="footnote-reference" href="#write-concern-throttling" id="id2">[2]</a> of the replica
set every 100 or 1,000 operations. This provides an opportunity for
secondaries to catch up with the primary. Write concern can slow the
overall progress of write operations but ensure that the secondaries
can maintain a largely current state with respect to the primary.</p>
<p>For more information on replica sets and write operations, see
<a class="reference internal" href="write-concern.html#replica-set-write-concern"><em>Replica Acknowledged</em></a>, <a class="reference internal" href="replication.html#replica-set-oplog-sizing"><em>Oplog</em></a>,
<a class="reference internal" href="replication-internals.html#replica-set-oplog"><em>Oplog Internals</em></a>, and <a class="reference internal" href="../tutorial/change-oplog-size.html"><em>Change the Size of the Oplog</em></a>.</p>
<table class="docutils footnote" frame="void" id="write-concern-throttling" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td>Calling <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><tt class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></tt></a>
intermittently with a <tt class="docutils literal"><span class="pre">w</span></tt> value of <tt class="docutils literal"><span class="pre">2</span></tt> or <tt class="docutils literal"><span class="pre">majority</span></tt> will
slow the throughput of write traffic; however, this practice will
allow the secondaries to remain current with the state of the
primary.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="sharded-clusters">
<span id="write-operations-sharded-clusters"></span><h3>Sharded Clusters<a class="headerlink" href="#sharded-clusters" title="Permalink to this headline">¶</a></h3>
<p>In a <a class="reference internal" href="../reference/glossary.html#term-sharded-cluster"><em class="xref std std-term">sharded cluster</em></a>, MongoDB directs a given write operation to
a <a class="reference internal" href="../reference/glossary.html#term-shard"><em class="xref std std-term">shard</em></a> and then performs the write on a particular
<a class="reference internal" href="../reference/glossary.html#term-chunk"><em class="xref std std-term">chunk</em></a> on that shard. Shards and chunks are range-based.
<a class="reference internal" href="../reference/glossary.html#term-shard-key"><em class="xref std std-term">Shard keys</em></a> affect how MongoDB distributes documents
among shards. Choosing the correct shard key can have a great impact on
the performance, capability, and functioning of your database and
cluster.</p>
<p>For more information, see <a class="reference internal" href="../administration/sharded-clusters.html"><em>Sharded Cluster Administration</em></a> and
<a class="reference internal" href="#write-operations-bulk-insert"><em>Bulk Inserts</em></a>.</p>
</div>
</div>
</div>


    <div id="btnv">
        <ul id="btnvl">
              <li id="btnvpr"><a href="read-operations.html" title="Previous Section: Read Operations">&lt; &nbsp; Read Operations</a></li>
              <li id="btnvup"><a href="../crud.html" title="Parent Section: Core MongoDB Operations (CRUD)" >&#47;&#92;&nbsp; Core MongoDB Operations (CRUD)</a></li>
              <li id="btnvnx"><a href="../reference/write-concern.html" title="Next Section: Write Concern Reference">Write Concern Reference &nbsp;&gt;</a></li>
        </ul>
    </div></div></div>
           </div>
       <div class="sphinxsidebar">
         <div class="sphinxsidebarwrapper">
  <h3>
    <a href="../index.html">MongoDB Manual</a> <span id="vn">2.4</span>
  </h3>



<div class="site-contents"><a href="../contents.html">Contents</a></div>


<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Install MongoDB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../crud.html">Core MongoDB Operations (CRUD)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="read-operations.html">Read Operations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Write Operations</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../reference/write-concern.html">Write Concern Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">BSON Documents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/object-id.html">ObjectId</a></li>
<li class="toctree-l2"><a class="reference internal" href="gridfs.html">GridFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/database-references.html">Database References</a></li>
<li class="toctree-l2"><a class="reference internal" href="create.html">Create</a></li>
<li class="toctree-l2"><a class="reference internal" href="read.html">Read</a></li>
<li class="toctree-l2"><a class="reference internal" href="update.html">Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="delete.html">Delete</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data-modeling.html">Data Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aggregation.html">Aggregation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../indexes.html">Indexes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../replication.html">Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sharding.html">Sharding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../applications.html">Application Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mongo.html">The <tt class="docutils literal"><span class="pre">mongo</span></tt> Shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use-cases.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release-notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About MongoDB Documentation</a></li>
</ul>



<div class="site-index"><a href="../genindex.html">Index</a></div>
<h3>Formats</h3>
<ul class="this-page-menu">
  <li><a href="/manual/single/">MongoDB Manual, Single HTML Page</a></li>
  <li><a href="http://docs.mongodb.org/master/MongoDB-Manual-master.pdf" rel="nofollow">MongoDB Manual, PDF Format</a></li>
  <li><a href="http://docs.mongodb.org/master/MongoDB-Manual-master.epub" rel="nofollow">MongoDB Manual, ePub Format</a></li>
</ul>
<h3><a href="http://www.mongodb.org/about/">About MongoDB</a></h3>
<ul>
  <li><a href="http://www.mongodb.org/about/introduction">Introduction</a></li>
  <li><a href="http://www.mongodb.org/about/community">User Community</a></li>
  <li><a href="http://mongodb.org/about/community/masters">MongoDB Masters</a></li>
  <li><a href="http://planet.mongodb.org">Planet MongoDB</a></li>
</ul>
<h3><a href="http://docs.mongodb.org/ecosystem/">MongoDB Ecosystem</a></h3>
<ul>
 <li><a href="http://docs.mongodb.org/ecosystem/drivers/">Drivers and Client libraries</a>
   <ul>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/c">C</a> (<a href="http://api.mongodb.org/c/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/cpp">C++</a> (<a href="http://api.mongodb.org/cplusplus/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/csharp">C#</a> (<a href="http://api.mongodb.org/csharp/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/erlang">Erlang</a> (<a href="http://api.mongodb.org/erlang">docs</a>)</li>
     <li><a href="http://hackage.haskell.org/package/mongoDB">Haskell</a> (<a href="http://api.mongodb.org/haskell">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/java">Java</a> (<a href="http://api.mongodb.org/java/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/javascript">JavaScript</a> (<a href="http://api.mongodb.org/js/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/perl">Perl</a> (<a href="http://api.mongodb.org/perl/current/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/php">PHP</a> (<a href="http://php.net/mongo/">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/python">Python</a> (<a href="http://api.mongodb.org/python/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/ruby">Ruby</a> (<a href="http://api.mongodb.org/ruby/current">docs</a>)</li>
     <li><a href="http://docs.mongodb.org/ecosystem/drivers/scala">Scala</a> (<a href="http://api.mongodb.org/scala/casbah/current/">docs</a>)</li>
   </ul>
 </li>
 <li><a href="http://docs.mongodb.org/ecosystem/tools/">Tools and Integration</a></li>
 <li><a href="http://docs.mongodb.org/ecosystem/platforms/">Platform Integration</a></li>
</ul><h3>MongoDB Resources</h3>
<ul>
  <li><a href="http://www.mongodb.org/downloads">Downloads</a></li>
  <li><a href="http://www.10gen.com/events">MongoDB Events</a></li>
  <li><a href="http://www.10gen.com/presentations">Slides and Video</a></li>
  <li><a href="http://www.10gen.com/products/mms/">MongoDB Monitoring Service</a> (<a href="http://mms.10gen.com/help/">docs</a>)</li>
</ul>
         </div>
       </div>
        <div class="clearer"></div>
      </div><div id="top-right">
        <div class="user-right">
          <ul id="header-menu-bar" class="ajs-menu-bar">
            <li class="normal"><a target="_blank" href="http://groups.google.com/group/mongodb-user">Forums</a></li>
            <li class="normal"><a target="_blank" href="http://blog.mongodb.org/">Blog</a></li>
            <li class="normal"><a href="http://www.mongodb.org/downloads">Download</a></li>
            <li class="normal"><a href="http://docs.mongodb.org/ecosystem/drivers/">Drivers</a></li>
            <li class="normal"><a href="http://www.10gen.com/events">Events</a></li>
            <li class="normal last"><a class="last" href="http://docs.mongodb.org/manual/meta/translation">Translations</a></li>
          </ul>
        </div>
      </div>
      <div class="search-db"><gcse:searchbox></gcse:searchbox></div>
          <div id="etp">
            <ul>
              <li><a href="https://github.com/mongodb/docs/blob/master/source/core/write-operations.txt" target="_blank" title="Edit core/write-operations.txt on GitHub">Edit this Page</a></li>
              <li><a href="http://github.com/mongodb/docs" target="_blank" title="Fork the documentation on GitHub and contribute.">GitHub</a></li>
              <li><a id="jirafeedback" href="https://jira.mongodb.org/secure/CreateIssueDetails!init.jspa?pid=10380&issuetype=4&priority=4&summary=Comment+on%3a+%22core/write-operations%2Etxt%22" target="_blank" title="Report a problem with core/write-operations.txt on Jira">Report a Problem</a></li>
            </ul>
          </div>
      <div class="footer">
        <p>
          &copy; <a href="">Copyright</a> 2011-2013, 10gen, Inc. 
          MongoDB&reg;, Mongo&reg;, and the leaf logo are registered trademarks of <a href="http://www.10gen.com/">10gen, Inc.</a>
        </p>
      </div><script type="text/javascript">
var _gaq = _gaq || [];
var pluginUrl = (('https:' == document.location.protocol) ? 'https://ssl.' : 'http://www.') + 'google-analytics.com/plugins/ga/inpage_linkid.js';
_gaq.push(['_require', 'inpage_linkid', pluginUrl]);
_gaq.push(['_setAccount', 'UA-7301842-8']);
_gaq.push(['_setDomainName', 'docs.mongodb.org']);
_gaq.push(['_trackPageview']);
(function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
        })();
</script>

<script type="text/javascript">var _kiq = _kiq || [];</script>
<script type="text/javascript">
(function(){
setTimeout(function(){ var d = document, f = d.getElementsByTagName('script')[0], s = d.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//s3.amazonaws.com/ki.js/49119/a7n.js'; f.parentNode.insertBefore(s, f); }, 1);
})();
</script>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-7301842-14', 'mongodb.org');
ga('send', 'pageview');
</script>

<script type="text/javascript">
document.write(unescape("%3Cscript src='" + document.location.protocol + "//munchkin.marketo.net/munchkin.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script>try { mktoMunchkin("017-HGS-593"); } catch(e) {}</script><script type="text/javascript">
jQuery.ajax({
	 url: "https://jira.mongodb.org/s/en_UScn8g8x/782/6/1.2.5/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?collectorId=298ba4e7",
	 type: "get",
	 cache: true,
	 dataType: "script"
	});
window.ATL_JQ_PAGE_PROPS =  {
	"triggerFunction": function(showCollectorDialog) {
		jQuery("#jirafeedback").click(function(e) {e.preventDefault();showCollectorDialog();});},
		fieldValues: {component: 'mongodb-manual', summary: 'Comment on: "manual/core/write-operations.txt"'},
		environment: {'repo': 'docs','source': 'core/write-operations'}
		};
</script><script type="text/javascript">
var versions = [{'t': '2.4 (current)', 'v': 'v2.4'}, {'t': '2.2', 'v': 'v2.2'}]
var pagename = 'core/write-operations'
var stable = 'v2.4'

function vfnav() {
    if ( pagename=='index' ) {
        pn = ''
    }
    else {
        pn = pagename
    }

    v = $(this).children("option:selected").attr('value')

    if ( (v==0) || (v==stable) ) {
        uri = '/manual/' + pn
    }
    else {
        uri = '/' + v + '/' + pn
    }
    window.location.href= uri;
}

$(document).ready(function(){
    $("#vn").html(function(){
        s=$("<select/>");
        o='<option/>';

        $.each(versions,function(index, version) {
            if ( version.v==stable ) {
                dv=true;
            }
            $(o,{value:version.v,text: version.t}).appendTo(s);
        });

        if ( dv==false ) {
            $(o, {value:0,text:'(stable)'}).appendTo(s);
        }
        return(s);
    });

    $("#vn select").bind('change', vfnav);
    $('#vn select').val('v2.4');
});
</script>
</body>
</html>