<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>PHPUnit Manual</title><link rel="stylesheet" type="text/css" href="../../twitter-bootstrap/docs/assets/css/bootstrap.css" /><link rel="stylesheet" type="text/css" href="../docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.0" /></head>
<body>
<div class="container-fluid">

<div xml:lang="en" class="book" lang="en"><div class="titlepage"><div><div><h1 class="title"><a id="phpunit"></a>PHPUnit Manual</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Sebastian</span> <span class="surname">Bergmann</span></h3></div></div><div><p class="copyright">Copyright © 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013 Sebastian Bergmann</p></div><div><div class="legalnotice"><a id="idp26102848"></a><p>This work is licensed under the Creative Commons Attribution 3.0 Unported License.</p></div></div><div><p class="pubdate">Edition for PHPUnit 3.7. Updated on 2013-05-20.</p></div></div><hr /></div>

<div class="row">
    <div class="span4">

<div class="toc"><dl class="toc"><dt><span class="chapter"><a href="#automating-tests">1. Automatizando Testes</a></span></dt><dt><span class="chapter"><a href="#goals">2. Objetivos do PHPUnit</a></span></dt><dt><span class="chapter"><a href="#installation">3. Instalando o PHPUnit</a></span></dt><dd><dl><dt><span class="section"><a href="#installation.pear">PEAR</a></span></dt><dt><span class="section"><a href="#installation.composer">Composer</a></span></dt><dt><span class="section"><a href="#installation.phar">PHP Archive (PHAR)</a></span></dt><dt><span class="section"><a href="#installation.optional-packages">Pacotes opcionais</a></span></dt><dt><span class="section"><a href="#installing.upgrading">Atualizando</a></span></dt></dl></dd><dt><span class="chapter"><a href="#writing-tests-for-phpunit">4. Escrevendo Testes para o PHPUnit</a></span></dt><dd><dl><dt><span class="section"><a href="#writing-tests-for-phpunit.test-dependencies">Dependências de Testes</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.data-providers">Provedores de Dados</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.exceptions">Testando Exceções</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.errors">Testando Erros PHP</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.output">Testando Saídas</a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions">Asserções</a></span></dt><dd><dl><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertArrayHasKey"><code class="literal">assertArrayHasKey()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertClassHasAttribute"><code class="literal">assertClassHasAttribute()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertClassHasStaticAttribute"><code class="literal">assertClassHasStaticAttribute()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertContains"><code class="literal">assertContains()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertContainsOnly"><code class="literal">assertContainsOnly()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertContainsOnlyInstancesOf"><code class="literal">assertContainsOnlyInstancesOf()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertCount"><code class="literal">assertCount()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertEmpty"><code class="literal">assertEmpty()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertEqualXMLStructure"><code class="literal">assertEqualXMLStructure()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertEquals"><code class="literal">assertEquals()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertFalse"><code class="literal">assertFalse()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertFileEquals"><code class="literal">assertFileEquals()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertFileExists"><code class="literal">assertFileExists()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertGreaterThan"><code class="literal">assertGreaterThan()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertGreaterThanOrEqual"><code class="literal">assertGreaterThanOrEqual()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertInstanceOf"><code class="literal">assertInstanceOf()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertInternalType"><code class="literal">assertInternalType()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertJsonFileEqualsJsonFile"><code class="literal">assertJsonFileEqualsJsonFile()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonFile"><code class="literal">assertJsonStringEqualsJsonFile()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonString"><code class="literal">assertJsonStringEqualsJsonString()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertLessThan"><code class="literal">assertLessThan()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertLessThanOrEqual"><code class="literal">assertLessThanOrEqual()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertNull"><code class="literal">assertNull()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertObjectHasAttribute"><code class="literal">assertObjectHasAttribute()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertRegExp"><code class="literal">assertRegExp()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormat"><code class="literal">assertStringMatchesFormat()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormatFile"><code class="literal">assertStringMatchesFormatFile()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertSame"><code class="literal">assertSame()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertSelectCount"><code class="literal">assertSelectCount()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertSelectEquals"><code class="literal">assertSelectEquals()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertSelectRegExp"><code class="literal">assertSelectRegExp()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertStringEndsWith"><code class="literal">assertStringEndsWith()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertStringEqualsFile"><code class="literal">assertStringEqualsFile()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertStringStartsWith"><code class="literal">assertStringStartsWith()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertTag"><code class="literal">assertTag()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertThat"><code class="literal">assertThat()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertTrue"><code class="literal">assertTrue()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertXmlFileEqualsXmlFile"><code class="literal">assertXmlFileEqualsXmlFile()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlFile"><code class="literal">assertXmlStringEqualsXmlFile()</code></a></span></dt><dt><span class="section"><a href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlString"><code class="literal">assertXmlStringEqualsXmlString()</code></a></span></dt></dl></dd><dt><span class="section"><a href="#writing-tests-for-phpunit.error-output">Saída de Erro</a></span></dt><dd><dl><dt><span class="section"><a href="#writing-tests-for-phpunit.error-output.edge-cases">Casos Extremos</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#textui">5. O executor de testes em linha-de-comando</a></span></dt><dd><dl><dt><span class="section"><a href="#textui.clioptions">Comutadores de linha-de-comando</a></span></dt></dl></dd><dt><span class="chapter"><a href="#fixtures">6. Ambientes</a></span></dt><dd><dl><dt><span class="section"><a href="#fixtures.more-setup-than-teardown">Mais setUp() que tearDown()</a></span></dt><dt><span class="section"><a href="#fixtures.variations">Variantes</a></span></dt><dt><span class="section"><a href="#fixtures.sharing-fixture">Compartilhando Ambientes</a></span></dt><dt><span class="section"><a href="#fixtures.global-state">Estado Global</a></span></dt></dl></dd><dt><span class="chapter"><a href="#organizing-tests">7. Organizando Testes</a></span></dt><dd><dl><dt><span class="section"><a href="#organizing-tests.filesystem">Compondo uma Suíte de Testes usando o Sistema de Arquivos</a></span></dt><dt><span class="section"><a href="#organizing-tests.xml-configuration">Compondo uma Suíte de Testes Usando uma Configuração XML</a></span></dt></dl></dd><dt><span class="chapter"><a href="#database">8. Testando Bancos de Dados</a></span></dt><dd><dl><dt><span class="section"><a href="#supported-vendors-for-database-testing">Fornecedores Suportados para Testes de Banco de Dados</a></span></dt><dt><span class="section"><a href="#difficulties-in-database-testing">Dificuldades em Testes de Bancos de Dados</a></span></dt><dt><span class="section"><a href="#the-four-stages-of-a-database-test">Os quatro estágios dos testes com banco de dados</a></span></dt><dd><dl><dt><span class="section"><a href="#clean-up-database">1. Limpar o Banco de Dados</a></span></dt><dt><span class="section"><a href="#set-up-fixture">2. Configurar o ambiente</a></span></dt><dt><span class="section"><a href="#run-test-verify-outcome-and-teardown">3–5. Executar Teste, Verificar saída e Teardown</a></span></dt></dl></dd><dt><span class="section"><a href="#configuration-of-a-phpunit-database-testcase">Configuração de Caso de Teste de Banco de Dados do PHPUnit</a></span></dt><dd><dl><dt><span class="section"><a href="#implementing-getconnection">Implementando <code class="literal">getConnection()</code></a></span></dt><dt><span class="section"><a href="#implementing-getdataset">Implementando <code class="literal">getDataSet()</code></a></span></dt><dt><span class="section"><a href="#what-about-the-database-schema-ddl">E quanto ao Esquema do Banco de Dados (DDL)?</a></span></dt><dt><span class="section"><a href="#tip:-use-your-own-abstract-database-testcase">Dica: Use seu próprio Caso Abstrato de Teste de Banco de Dados</a></span></dt></dl></dd><dt><span class="section"><a href="#understanding-datasets-and-datatables">Entendendo Conjunto de Dados e Tabelas de Dados</a></span></dt><dd><dl><dt><span class="section"><a href="#available-implementations">Implementações disponíveis</a></span></dt><dt><span class="section"><a href="#beware-of-foreign-keys">Cuidado com Chaves Estrangeiras</a></span></dt><dt><span class="section"><a href="#implementing-your-own-datasetsdatatables">Implementando seus próprios Conjuntos de Dados/ Tabelas de Dados</a></span></dt></dl></dd><dt><span class="section"><a href="#the-connection-api">A API de Conexão</a></span></dt><dt><span class="section"><a href="#database-assertions-api">API de Asserções de Banco de Dados</a></span></dt><dd><dl><dt><span class="section"><a href="#asserting-the-row-count-of-a-table">Assertando a contagem de linhas de uma Tabela</a></span></dt><dt><span class="section"><a href="#asserting-the-state-of-a-table">Assertando o Estado de uma Tabela</a></span></dt><dt><span class="section"><a href="#asserting-the-result-of-a-query">Assertando o Resultado de uma Query</a></span></dt><dt><span class="section"><a href="#asserting-the-state-of-multiple-tables">Assertando o Estado de Múltiplas Tabelas</a></span></dt></dl></dd><dt><span class="section"><a href="#frequently-asked-questions">Perguntas Mais Frequentes</a></span></dt><dd><dl><dt><span class="section"><a href="#will-phpunit-re-create-the-database-schema-for-each-test">O PHPUnit vai (re)criar o esquema do banco de dados para cada teste?</a></span></dt><dt><span class="section"><a href="#am-i-required-to-use-pdo-in-my-application-for-the-database-extension-to-work">Sou forçado a usar PDO em minha aplicação para que a Extensão para Banco de Dados funcione?</a></span></dt><dt><span class="section"><a href="#what-can-i-do-when-i-get-a-too-much-connections-error">O que posso fazer quando recebo um Erro 
             <span class="quote">“<span class="quote">Too much Connections</span>”</span>?</a></span></dt><dt><span class="section"><a href="#how-to-handle-null-with-flat-xml-csv-datasets">Como lidar com NULL usando Conjuntos de Dados XML Plano / CSV?</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#incomplete-and-skipped-tests">9. Testes Incompletos e Pulados</a></span></dt><dd><dl><dt><span class="section"><a href="#incomplete-and-skipped-tests.incomplete-tests">Testes Incompletos</a></span></dt><dt><span class="section"><a href="#incomplete-and-skipped-tests.skipping-tests">Pulando Testes</a></span></dt><dt><span class="section"><a href="#incomplete-and-skipped-tests.skipping-tests-using-requires">Pulando Testes usando @requires</a></span></dt></dl></dd><dt><span class="chapter"><a href="#test-doubles">10. Dublês de Testes</a></span></dt><dd><dl><dt><span class="section"><a href="#test-doubles.stubs">Esboços (stubs)</a></span></dt><dt><span class="section"><a href="#test-doubles.mock-objects">Objetos Falsos</a></span></dt><dt><span class="section"><a href="#test-doubles.stubbing-and-mocking-web-services">Esboçando e Falsificando Serviços Web</a></span></dt><dt><span class="section"><a href="#test-doubles.mocking-the-filesystem">Esboçando o Sistema de Arquivos</a></span></dt></dl></dd><dt><span class="chapter"><a href="#testing-practices">11. Práticas de Teste</a></span></dt><dd><dl><dt><span class="section"><a href="#testing-practices.during-development">Durante o Desenvolvimento</a></span></dt><dt><span class="section"><a href="#testing-practices.during-debugging">Durante a Depuração</a></span></dt></dl></dd><dt><span class="chapter"><a href="#test-driven-development">12. Desenvolvimento Guiado por Testes</a></span></dt><dd><dl><dt><span class="section"><a href="#test-driven-development.bankaccount-example">Exemplo da Conta Bancária</a></span></dt></dl></dd><dt><span class="chapter"><a href="#behaviour-driven-development">13. Desenvolvimento Guiado por Comportamento</a></span></dt><dd><dl><dt><span class="section"><a href="#behaviour-driven-development.bowlinggame-example">Exemplo do Jogo de Boliche</a></span></dt></dl></dd><dt><span class="chapter"><a href="#code-coverage-analysis">14. Análise de Cobertura de Código</a></span></dt><dd><dl><dt><span class="section"><a href="#code-coverage-analysis.specifying-covered-methods">Especificando métodos cobertos</a></span></dt><dt><span class="section"><a href="#code-coverage-analysis.ignoring-code-blocks">Ignorando Blocos de Código</a></span></dt><dt><span class="section"><a href="#code-coverage-analysis.including-excluding-files">Incluindo e Excluindo Arquivos</a></span></dt><dt><span class="section"><a href="#code-coverage-analysis.edge-cases">Casos Extremos</a></span></dt></dl></dd><dt><span class="chapter"><a href="#other-uses-for-tests">15. Outros Usos para Testes</a></span></dt><dd><dl><dt><span class="section"><a href="#other-uses-for-tests.agile-documentation">Documentação Ágil</a></span></dt><dt><span class="section"><a href="#other-uses-for-tests.cross-team-tests">Testes Inter-Equipes</a></span></dt></dl></dd><dt><span class="chapter"><a href="#skeleton-generator">16. Gerador de Esqueleto</a></span></dt><dd><dl><dt><span class="section"><a href="#skeleton-generator.test">Gerando um Esqueleto de Classe de Caso de Teste</a></span></dt><dt><span class="section"><a href="#skeleton-generator.class">Gerando uma Classe Esqueleto de uma Classe de Caso de Teste</a></span></dt></dl></dd><dt><span class="chapter"><a href="#selenium">17. PHPUnit e Selenium</a></span></dt><dd><dl><dt><span class="section"><a href="#selenium.selenium-rc">Servidor Selenium</a></span></dt><dt><span class="section"><a href="#selenium.installation">Instalação</a></span></dt><dt><span class="section"><a href="#selenium.selenium2testcase">PHPUnit_Extensions_Selenium2TestCase</a></span></dt><dt><span class="section"><a href="#selenium.seleniumtestcase">PHPUnit_Extensions_SeleniumTestCase</a></span></dt></dl></dd><dt><span class="chapter"><a href="#logging">18. Registrando</a></span></dt><dd><dl><dt><span class="section"><a href="#logging.xml">Resultados de Teste (XML)</a></span></dt><dt><span class="section"><a href="#logging.tap">Resultados de Teste (TAP)</a></span></dt><dt><span class="section"><a href="#logging.json">Resultados de Teste (JSON)</a></span></dt><dt><span class="section"><a href="#logging.codecoverage.xml">Cobertura de Código (XML)</a></span></dt><dt><span class="section"><a href="#logging.codecoverage.text">Cobertura de Código (TEXTO)</a></span></dt></dl></dd><dt><span class="chapter"><a href="#extending-phpunit">19. Estendendo o PHPUnit</a></span></dt><dd><dl><dt><span class="section"><a href="#extending-phpunit.PHPUnit_Framework_TestCase">Subclasse PHPUnit_Framework_TestCase</a></span></dt><dt><span class="section"><a href="#extending-phpunit.custom-assertions">Escreva asserções personalizadas</a></span></dt><dt><span class="section"><a href="#extending-phpunit.PHPUnit_Framework_TestListener">Implementando PHPUnit_Framework_TestListener</a></span></dt><dt><span class="section"><a href="#extending-phpunit.PHPUnit_Extensions_TestDecorator">Subclasse PHPUnit_Extensions_TestDecorator</a></span></dt><dt><span class="section"><a href="#extending-phpunit.PHPUnit_Framework_Test">Implementando PHPUnit_Framework_Test</a></span></dt></dl></dd><dt><span class="appendix"><a href="#appendixes.assertions">A. Assertions</a></span></dt><dt><span class="appendix"><a href="#appendixes.annotations">B. Anotações</a></span></dt><dd><dl><dt><span class="section"><a href="#appendixes.annotations.author"><code class="literal">@author</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.backupGlobals"><code class="literal">@backupGlobals</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.backupStaticAttributes"><code class="literal">@backupStaticAttributes</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.codeCoverageIgnore"><code class="literal">@codeCoverageIgnore*</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.covers"><code class="literal">@covers</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.coversNothing"><code class="literal">@coversNothing</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.dataProvider"><code class="literal">@dataProvider</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.depends"><code class="literal">@depends</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.expectedException"><code class="literal">@expectedException</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.expectedExceptionCode"><code class="literal">@expectedExceptionCode</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.expectedExceptionMessage"><code class="literal">@expectedExceptionMessage</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.group"><code class="literal">@group</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.outputBuffering"><code class="literal">@outputBuffering</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.requires"><code class="literal">@requires</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.runTestsInSeparateProcesses"><code class="literal">@runTestsInSeparateProcesses</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.runInSeparateProcess"><code class="literal">@runInSeparateProcess</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.test"><code class="literal">@test</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.testdox"><code class="literal">@testdox</code></a></span></dt><dt><span class="section"><a href="#appendixes.annotations.ticket"><code class="literal">@ticket</code></a></span></dt></dl></dd><dt><span class="appendix"><a href="#appendixes.configuration">C. O arquivo de configuração XML</a></span></dt><dd><dl><dt><span class="section"><a href="#appendixes.configuration.phpunit">PHPUnit</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.testsuites">Suítes de Teste</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.groups">Grupos</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.blacklist-whitelist">Incluindo e Excluindo Arquivos para Cobertura de Código</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.logging">Registrando</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.test-listeners">Ouvintes de Teste</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.php-ini-constants-variables">Setting PHP INI settings, Constants and Global Variables</a></span></dt><dt><span class="section"><a href="#appendixes.configuration.selenium-rc">Configurando Navegadores para Selenium RC</a></span></dt></dl></dd><dt><span class="appendix"><a href="#appendixes.index">D. Índice</a></span></dt><dd><dl><dt><span class="index"><a href="#appendixes.index.index"></a></span></dt></dl></dd><dt><span class="appendix"><a href="#appendixes.bibliography">E. Bibliografia</a></span></dt><dt><span class="appendix"><a href="#appendixes.copyright">F. Copyright</a></span></dt></dl></div>

    </div>
    <div class="span8">

<div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="automating-tests"></a>Capítulo 1. Automatizando Testes</h1></div></div></div><p>
    Mesmo bons programadores cometem erros. A diferença entre um bom programador e um mau programador é que o bom programador usa testes para detectar seus erros o mais cedo possível. Quanto antes você testar por um erro, maiores são suas chances de encontrá-lo e consertá-lo. Isso explica porque deixar os testes para um momento logo antes do lançamento do programa é tão problemático. A maioria dos erros nem sequer chega a ser encontrado, e o custo de consertar aqueles que você encontra é tão alto que você tem que fazer uma triagem com os erros porque você simplesmente não consegue consertar todos.
  </p><p>
    <a id="idp26106256" class="indexterm"></a>

    Testar com o PHPUnit não é uma atividade totalmente diferente do que você já costuma fazer. É apenas uma forma diferente de fazê-lo. A diferença está entre <span class="emphasis"><em>testar</em></span>, isto é, verificar que seu programa se comporta como o esperado, e <span class="emphasis"><em>fazer uma bateria de testes</em></span>, fragmentos de código executáveis que automaticamente testam se as partes (unidades) do programa estão corretas. Esses fragmentos de código executáveis são chamados de testes unitários.
  </p><p>
    Neste capítulo vamos de um simples código de teste baseado em <code class="literal">print</code>até um teste totalmente automatizado. Imagine que nos peçam para testar um <code class="literal">vetor</code>embutido do PHP. Uma pequena funcionalidade a se testar é a função <code class="literal">count()</code>. Para um vetor criado recentemente esperamos que a função <code class="literal">count()</code> retorne
    <code class="literal">0</code>. Após adicionarmos um elemento, <code class="literal">count()</code>
    deverá retornar <code class="literal">1</code>.
    <a class="xref" href="#automating-tests.examples.array-test.php" title="Exemplo 1.1: Testando operações de vetores">Exemplo 1.1</a> mostra o que queremos testar.
  </p><div class="example"><a id="automating-tests.examples.array-test.php"></a><p class="title"><strong>Exemplo 1.1: Testando operações de vetores</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="default">$componente</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="comment">//&nbsp;espera-se&nbsp;que&nbsp;$componente&nbsp;esteja&nbsp;vazio.</span><br />&nbsp;<br /><span class="default">$componente</span><span class="keyword">[</span><span class="keyword">]</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'elemento'</span><span class="keyword">;</span><br /><span class="comment">//&nbsp;espera-se&nbsp;que&nbsp;$componente&nbsp;contenha&nbsp;um&nbsp;elemento.</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
    Um jeito bem simples de verificar se estamos obtendo os resultados que esperamos é imprimir o resultado de <code class="literal">count()</code> antes e depois de adicionar o elemento (veja
    <a class="xref" href="#automating-tests.examples.array-test2.php" title="Exemplo 1.2: Usando print para testar operações de um vetor">Exemplo 1.2</a>).
    Se obtivermos <code class="literal">0</code> e depois <code class="literal">1</code>,
    <code class="literal">array</code> e <code class="literal">count()</code> se comportaram como esperado.
  </p><div class="example"><a id="automating-tests.examples.array-test2.php"></a><p class="title"><strong>Exemplo 1.2: Usando print para testar operações de um vetor</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="default">$componente</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">print</span><span class="default">&nbsp;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$componente</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$componente</span><span class="keyword">[</span><span class="keyword">]</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'elemento'</span><span class="keyword">;</span><br /><span class="default">print</span><span class="default">&nbsp;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$componente</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">;</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen">0
1</pre></div></div><br class="example-break" /><p>
    Agora gostaríamos de mudar de testes que exigem interpretação manual para testes que podem executar automaticamente. Em <a class="xref" href="#automating-tests.examples.array-test3.php" title="Exemplo 1.3: Comparando os valores esperado e real para testar operações de vetores">Exemplo 1.3</a>, escrevemos a comparação do valor esperado e do real em nosso código de teste e imprimimos <code class="literal">ok</code> se os valores forem iguais. Se alguma vez virmos uma mensagem
    <code class="literal">não ok</code> saberemos que algo está errado.
  </p><div class="example"><a id="automating-tests.examples.array-test3.php"></a><p class="title"><strong>Exemplo 1.3: Comparando os valores esperado e real para testar operações de vetores</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="default">$componente</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">print</span><span class="default">&nbsp;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$componente</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">==</span><span class="default">&nbsp;</span><span class="default">0</span><span class="default">&nbsp;</span><span class="keyword">?</span><span class="default">&nbsp;</span><span class="string">&quot;ok\n&quot;</span><span class="default">&nbsp;</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="string">&quot;não&nbsp;ok\n&quot;</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$componente</span><span class="keyword">[</span><span class="keyword">]</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'elemento'</span><span class="keyword">;</span><br /><span class="default">print</span><span class="default">&nbsp;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$componente</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">==</span><span class="default">&nbsp;</span><span class="default">1</span><span class="default">&nbsp;</span><span class="keyword">?</span><span class="default">&nbsp;</span><span class="string">&quot;ok\n&quot;</span><span class="default">&nbsp;</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="string">&quot;não&nbsp;ok\n&quot;</span><span class="keyword">;</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen">ok
ok</pre></div></div><br class="example-break" /><p>
    <a id="idp30779360" class="indexterm"></a>

    Agora fatoramos a saída de comparação dos valores esperado e real em uma função que gera uma Exceção (Exception) onde há uma discrepância
    (<a class="xref" href="#automating-tests.examples.array-test4.php" title="Exemplo 1.4: Usando uma função de asserção para testar operações de vetores">Exemplo 1.4</a>). Isso nos traz dois benefícios: a escrita dos testes se torna mais fácil e só obteremos saída quando algo estiver errado.
  </p><div class="example"><a id="automating-tests.examples.array-test4.php"></a><p class="title"><strong>Exemplo 1.4: Usando uma função de asserção para testar operações de vetores</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="default">$componente</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$componente</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">==</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$componente</span><span class="keyword">[</span><span class="keyword">]</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'elemento'</span><span class="keyword">;</span><br /><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">count</span><span class="keyword">(</span><span class="default">$componente</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">==</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">$condicao</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="keyword">!</span><span class="default">$condicao</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">throw</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Exception</span><span class="keyword">(</span><span class="string">'Asserção&nbsp;falhou.'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
    <a id="idp30783440" class="indexterm"></a>

    O teste agora está totalmente automatizado. Em vez de apenas
    <span class="emphasis"><em>testar</em></span> como fizemos em nossa primeira versão, com esta versão temos um <span class="emphasis"><em>teste automatizado</em></span>.
  </p><p>
    O objetivo de usar testes automatizados é cometer menos erros. Ainda que seu código não fique perfeito, mesmo com testes excelentes, você perceberá uma redução dramática nos defeitos assim que começar a automatizar os testes. Testes automatizados darão a você uma justificada confiança em seu código. Você poderá usar essa confiança para atravessar barreiras mais difíceis de design (Refatoração), melhorar as relações com sua equipe (Testes Inter-Equipes) e clientes, além de voltar para casa toda noite com a prova de que seu sistema está melhor agora do que estava de manhã, graças aos seus esforços.
  </p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="goals"></a>Capítulo 2. Objetivos do PHPUnit</h1></div></div></div><p>
    Até agora só tivemos dois testes para o <code class="literal">vetor</code> embutido e a função <code class="literal">count()</code> . Quando começarmos a testar as numerosas funções <code class="literal">array_*()</code> que o PHP oferece, precisaremos escrever um teste para cada um deles. Podemos escrever a infraestrutura para todos esses testes do zero, porém é muito melhor escrever uma infraestrutura de testes uma vez e então escrever apenas as partes únicas de cada teste. O PHPUnit é essa infraestrutura.
  </p><p>
    Um framework como o PHPUnit tem que resolver uma série de restrições, sendo que algumas delas parecem sempre conflitar umas com as outras. Ao mesmo tempo, os testes devem ser:
  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="emphasis"><em>Fáceis de aprender a escrever.</em></span></span></dt><dd><p>
          Se for difícil aprender a escrever testes, os desenvolvedores não aprenderão a escrevê-los.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Fáceis de escrever.</em></span></span></dt><dd><p>
          Se os testes não forem fáceis de escrever, os desenvolvedores não vão escrevê-los.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Fáceis de ler.</em></span></span></dt><dd><p>
          Os códigos de teste não devem conter cabeçalhos estranhos, de forma que o próprio teste não se perca no meio do "ruído" que o envolve.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Fáceis de executar.</em></span></span></dt><dd><p>
          Os testes devem executar ao toque de um botão e apresentar seus resultados de uma forma clara e inequívoca.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Rápidos de executar.</em></span></span></dt><dd><p>
          Testes devem executar tão rápido que possam ser executados centenas ou milhares de vezes por dia.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Isolados.</em></span></span></dt><dd><p>
          Os testes não devem afetar uns aos outros. Se a ordem na qual os testes estão for alterada, os resultados dos testes não devem mudar.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Combináveis.</em></span></span></dt><dd><p>
          Nós devemos ser capazes de executar qualquer quantidade ou combinação de testes juntos. Isso é uma consequência do isolamento.
        </p></dd></dl></div><p>
    Existem dois principais conflitos nessas restrições:
  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="emphasis"><em>Fácil de aprender a escrever versus fácil de escrever.</em></span></span></dt><dd><p>
          Testes geralmente não precisam de toda a flexibilidade de uma linguagem de programação. Muitas ferramentas de teste fornecem suas próprias linguagens que só incluem o mínimo necessário de funções para escrever testes. Os testes resultantes são fáceis de ler e escrever porque eles não têm o "ruído" para distrair você do conteúdo dos testes. Porém aprender mais uma linguagem de programação e ajustar as ferramentas é um inconveniente que tumultua a mente.
        </p></dd><dt><span class="term"><span class="emphasis"><em>Isolado versus rápido de executar.</em></span></span></dt><dd><p>
          Se você quer que os resultados de um teste não afetem os resultados de outro teste, cada teste deve criar o ambiente completo antes de começar a executar e retornar o ambiente ao seu estado original quando terminar. Porém ajustar o ambiente pode levar um longo tempo: por exemplo, conectar a um banco de dados e inicializá-lo para um estado conhecido usando dados realistas.
        </p></dd></dl></div><p>
    O PHPUnit tenta resolver esses conflitos usando o próprio PHP como linguagem de testes. Algumas vezes o poder total do PHP é demais para escrever pequenos testes de uma só linha, mas ao usar PHP aproveitamos toda a experiência e ferramentas que os programadores já possuem. Já que estamos tentando convencer testadores desconfiados, quebrar a barreira de escrever esses testes iniciais é particularmente importante.
  </p><p>
    O PHPUnit peca no lado do isolamento sobre execução rápida. Testes isolados são valiosos porque eles fornecem uma resposta de alta qualidade. Você não precisa pegar um relatório com uma porção de falhas, que foram de fato causadas por um teste da suíte que falhou lá no começo e deixou o resto do ambiente bagunçado pelo resto dos testes. Esta orientação através de testes isolados encoraja designs com um grande número de objetos simples. Cada objeto pode ser testado rapidamente em isolamento. O resultado é melhores designs e resultados mais rápidos.
  </p><p>
    O PHPUnit assume que a maioria dos testes passam e não vale a pena informar os detalhes dos testes bem sucedidos. Quando um teste falha, é importante relatar esse fato. A grande maioria dos testes deve passar e não vale a pena comentá-los, mas contar o número de testes que executaram, vale. Esta é uma suposição realmente baseada nas classes de relatório, e não no núcleo do PHPUnit. Quando os resultados de um teste são relatados, você vê quantos deles foram executados, mas você só vê detalhes daqueles que falharam.
  </p><p>
    Espera-se que os testes sejam refinados, testando cada aspecto de um objeto. Por isso, na primeira vez que um teste falha, a execução de testes é interrompida e o PHPUnit informa a falha. É uma arte testar executando vários testes pequenos. Testes refinados melhoram o design geral do sistema.
  </p><p>
    Quando você testa um objeto com o PHPUnit, você só o faz através da interface pública dos objetos. Testar baseado apenas no comportamento público visível encoraja você a confrontar e resolver mais cedo problemas difíceis de design, antes que os resultados de um design pobre possam infectar grandes partes do sistema.
  </p></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="installation"></a>Capítulo 3. Instalando o PHPUnit</h1></div></div></div><p>
    Existem três formas suportadas de instalar o PHPUnit. Você pode usar o Instalador <a class="ulink" href="http://pear.php.net/manual/en/guide.users.commandline.cli.php" target="_top">PEAR
    Installer</a> ou <a class="ulink" href="http://getcomposer.org/" target="_top">Composer</a>
    para baixar e instalar o PHPUnit assim como suas dependências. Você também pode baixar um <a class="ulink" href="http://php.net/phar" target="_top">PHP Archive (PHAR)</a> do PHPUnit que tem todas as dependências exigidas (assim como algumas opcionais) do PHPUnit em um único arquivo.
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
      O suporte ao Composer e PHP Archive (PHAR) foi adicionado no PHPUnit 3.7 (tido como estável desde o PHPUnit 3.7.5). Versões anteriores do PHPUnit não estão disponíveis através desses canais de distribuição.
    </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
      O PHPUnit 3.7 exige PHP 5.3.3 (ou superior) mas PHP 5.4.7 (ou superior) é altamente recomendável.
    </p><p>
      A biblioteca PHP_CodeCoverage que é usada pelo PHPUnit para coletar e processar a informação de cobertura de código, depende do Xdebug 2.0.5 (ou superior) mas o Xdebug 2.2.0 (ou superior) é altamente recomendável.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installation.pear"></a>PEAR</h2></div></div></div><p>
      Os dois comandos seguintes (que talvez você tenha que executar como
      <code class="literal">root</code>) são todo o necessário para instalar o PHPUnit usando o Instalador PEAR:
    </p><pre class="screen"><strong class="userinput"><code>pear config-set auto_discover 1</code></strong>
<strong class="userinput"><code>pear install pear.phpunit.de/PHPUnit</code></strong></pre><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Cuidado</h3><p>
        Dependendo da distribuição do seu Sistema Operacional e/ou seu ambiente PHP, você pode ter que instalar o PEAR ou atualizar sua instalação PEAR já existente antes que você possa proceder com as instruções desta seção.
      </p><p>
        <strong class="userinput"><code>sudo pear upgrade PEAR</code></strong> geralmente é o suficiente para atualizar uma instalação PEAR existente. O <a class="ulink" href="http://pear.php.net/manual/en/installation.getting.php" target="_top">Manual do PEAR</a>
        explica como fazer uma instalação nova do PEAR.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installation.composer"></a>Composer</h2></div></div></div><p>
      Para adicionar o PHPUnit como uma dependência local por-projeto ao seu projeto, simplesmente adicione a dependência que está em <code class="literal">phpunit/phpunit</code> ao arquivo
      <code class="filename">composer.json</code> do seu projeto. Aqui está um exemplo mínimo de um arquivo
      <code class="filename">composer.json</code> que apenas define uma dependência em tempo de desenvolvimento do PHPUnit 3.7:
    </p><pre class="programlisting"><code>{
"require-dev": {
"phpunit/phpunit": "3.7.*"
}
}</code></pre><p>
      Para uma instalação autônoma para um sistema inteiro via Composer, um
      <code class="filename">composer.json</code> similar ao mostrado abaixo pode ser usado para um diretório arbitrário.
    </p><pre class="programlisting"><code>{
"require": {
"phpunit/phpunit": "3.7.*"
},
"config": {
"bin-dir": "/usr/local/bin/"
}
}</code></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installation.phar"></a>PHP Archive (PHAR)</h2></div></div></div><p>
      Você também pode baixar um PHP Archive (PHAR) do PHPUnit que tem todas as dependências exigidas (assim como algumas opcionais) do PHPUnit em apenas um arquivo
    </p><pre class="screen"><strong class="userinput"><code>wget http://pear.phpunit.de/get/phpunit.phar</code></strong>
<strong class="userinput"><code>chmod +x phpunit.phar</code></strong></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installation.optional-packages"></a>Pacotes opcionais</h2></div></div></div><p>
      Os seguintes pacotes opcionais estão disponíveis:
    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">
          <code class="literal">DbUnit</code>
        </span></dt><dd><p>
            porta DbUnit para PHP/PHPUnit para suportar interação com o banco de dados de teste.
          </p><p>
            Este pacote pode ser instalado via PEAR usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/DbUnit</code></strong></pre><p>
            Este pacote pode ser instalado via Composer adicionando a seguinte dependência
            <code class="literal">"require-dev"</code>:
          </p><pre class="screen"><strong class="userinput"><code>"phpunit/dbunit": "&gt;=1.2"</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHP_Invoker</code>
        </span></dt><dd><p>
            Uma classe utilitária para invocações com limite de tempo. Este pacote é exigido para forçar limites de tempo dos testes de um modo específico.
          </p><p>
            Este pacote pode ser instalado usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHP_Invoker</code></strong></pre><p>
            Este pacote pode ser instalado via Composer adicionando a seguinte dependência
            <code class="literal">"require-dev"</code>:
          </p><pre class="screen"><strong class="userinput"><code>"phpunit/php-invoker": "*"</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHPUnit_Selenium</code>
        </span></dt><dd><p>
            Integração do Selenium RC para PHPUnit.
          </p><p>
            Este pacote pode ser instalado via PEAR usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_Selenium</code></strong></pre><p>
            Este pacote pode ser instalado via Composer adicionando a seguinte dependência
            <code class="literal">"require-dev"</code>:
          </p><pre class="screen"><strong class="userinput"><code>"phpunit/phpunit-selenium": "&gt;=1.2"</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHPUnit_Story</code>
        </span></dt><dd><p>
            Executor de testes baseados em histórico para Desenvolvimento Guiado por Comportamentos com PHPUnit.
          </p><p>
            Este pacote pode ser instalado via PEAR usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_Story</code></strong></pre><p>
            Este pacote pode ser instalado via Composer adicionando a seguinte dependência
            <code class="literal">"require-dev"</code>:
          </p><pre class="screen"><strong class="userinput"><code>"phpunit/phpunit-story": "*"</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHPUnit_SkeletonGenerator</code>
        </span></dt><dd><p>
            Ferramenta que gera classes de esqueleto de teste a partir das classes dos códigos de produção e vice-versa.
          </p><p>
            Este pacote pode ser instalado usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_SkeletonGenerator</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHPUnit_TestListener_DBUS</code>
        </span></dt><dd><p>
            Um ouvinte de testes que envia eventos para DBUS.
          </p><p>
            Este pacote pode ser instalado usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_TestListener_DBUS</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHPUnit_TestListener_XHProf</code>
        </span></dt><dd><p>
            Um ouvinte de testes que usa XHProf para perfilar automaticamente o código de teste.
          </p><p>
            Este pacote pode ser instalado usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_TestListener_XHProf</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHPUnit_TicketListener_Fogbugz</code>
        </span></dt><dd><p>
            Um ouvinte de tickets que interage com a API de problemas Fogbugz.
          </p><p>
            Este pacote pode ser instalado usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_TicketListener_Fogbugz</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHPUnit_TicketListener_GitHub</code>
        </span></dt><dd><p>
            Um ouvinte de tickets que interage com a API de problemas do GitHub.
          </p><p>
            Este pacote pode ser instalado usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_TicketListener_GitHub</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHPUnit_TicketListener_GoogleCode</code>
        </span></dt><dd><p>
            Um ouvinte de tickets que interage com a API de problemas do Google Code.
          </p><p>
            Este pacote pode ser instalado usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_TicketListener_GoogleCode</code></strong></pre></dd><dt><span class="term">
          <code class="literal">PHPUnit_TicketListener_Trac</code>
        </span></dt><dd><p>
            Um ouvinte de tickets que interage com a API de problemas do Track.
          </p><p>
            Este pacote pode ser instalado usando o seguinte comando:
          </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_TicketListener_Trac</code></strong></pre></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="installing.upgrading"></a>Atualizando</h2></div></div></div><p>
      Esta seção serve como uma coleção de problemas menores de BC pelos quais alguém poderia passar ao atualizar do PHPUnit 3.6 para o PHPUnit 3.7.
    </p><p>
      A atualização deve tanto ser fácil quanto trabalhar sem qualquer problema, já que foi testada em todos os principais frameworks OpenSource e não houve qualquer problema com eles. Ainda assim, cada projeto é diferente e se você ainda não experimentou uma das versões candidatas a lançamento e enfrentou um problema, este documento pode fornecer alguma ajuda.
    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><span class="strong"><strong>Remoção do obsoleto OutputTestCase</strong></span></span></dt><dd><p>
            A classe <code class="literal">PHPUnit_Extensions_OutputTestCase</code> foi removida. O PHPUnit 3.6 emitia uma notificação de obsolescência quando era usada. Para ver como a saída pode ser testada agora, veja
            <a class="xref" href="#writing-tests-for-phpunit.output" title="Testando Saídas">“Testando Saídas”</a>.
          </p></dd><dt><span class="term"><span class="strong"><strong>O diretório de trabalho atual será restaurado após cada caso de teste</strong></span></span></dt><dd><p>
            Se um teste mudasse o diretório de trabalho atual
            (<code class="literal">cwd</code>) o PHPUnit incorria em erros quando gerava a cobertura da saída de código. Agora que o cwd é restaurado após cada caso de teste, você pode descobrir se um dos seus testes depende de outro teste alterando o cwd. Algo que não é desejável de qualquer forma, e deveria ser fácil de resolver.
          </p></dd><dt><span class="term"><span class="strong"><strong>Ouvintes de Teste disparam uma chamada de auto-carregamento</strong></span></span></dt><dd><p>
            Ao usar ouvintes de testes como descrito em
            <a class="xref" href="#appendixes.configuration.test-listeners" title="Ouvintes de Teste">“Ouvintes de Teste”</a>, o PHPUnit ignorava silenciosamente os ouvintes de teste perdidos e era bem difícil para o usuário resolver esses problemas. Agora uma chamada de auto-carregamento será disparada tentando localizar a classe. Se seu auto-carregador produzir um erro quando ele não encontrar um ouvinte de teste, você poderá incorrer em um problema aqui. Remover o ouvinte ou confirmar que ele está sendo carregado em seu
            <code class="literal">bootstrap.php</code> vai resolver isso.
          </p></dd><dt><span class="term"><span class="strong"><strong>Parâmetros para objetos falsos não são mais clonáveis</strong></span></span></dt><dd><p>
            Anteriormente todos os parâmetros de objetos eram clonados quando falsificados. Isso causava problemas quando testes tentavam verificar se o mesmo objeto foi passado ou não a um método e outro problema com objetos não-clonáveis. Como uma longa e constante requisição de função, este comportamento foi mudado por muitos.
            <a class="xref" href="#test-doubles.mock-objects.examples.clone-object-parameters-usecase.php" title="Exemplo 10.14: Testando se um método é chamado uma vez e com o objeto idêntico ao que foi passado">Exemplo 10.14</a>
            mostra onde a nova implementação pode ser útil.
            <a class="xref" href="#test-doubles.mock-objects.examples.enable-clone-object-parameters.php" title="Exemplo 10.15: Criando um objeto falso com clonagem de parâmetros ativada">Exemplo 10.15</a>
            mostra como voltar para o comportamento anterior.
          </p></dd><dt><span class="term"><span class="strong"><strong>
          <code class="literal">addUncoveredFilesFromWhitelist</code>
          foi substituído por
          <code class="literal">processUncoveredFilesFromWhitelist</code></strong></span>
        </span></dt><dd><p>
            Ao gerar uma cobertura de código e usar
            <code class="literal">&lt;whitelist addUncoveredFilesFromWhitelist="true"&gt;</code>
            todos os arquivos da lista-branca eram incluídos pelo PHPUnit. Esse era um problema para pessoas com código executável nesses arquivos. O PHPUnit agora vai escanear o arquivo e descobrir qual código é executável e qual não é, sem incluí-lo. Isto pode levar a diferentes relatórios de cobertura.
          </p><p>
            Para voltar ao antigo comportamento a configuração
            <code class="literal">&lt;whitelist processUncoveredFilesFromWhitelist=="true"&gt;</code>
            pode ser usada. Se você quer o comportamento com PHPUnit 3.6 e 3.7 é possível usar ambas as configurações por um tempo.
          </p></dd><dt><span class="term"><span class="strong"><strong>
          Valor padrão de <code class="literal">cacheTokens</code> mudou para
          <code class="literal">false</code></strong></span>
        </span></dt><dd><p>
            Desde o PHPUnit <code class="literal">3.7.2</code> desligamos o cache de arquivos tokenizados por padrão. Ao processar coberturas de código para projetos grandes esse cache consumia muita memória e devido à mudança no comportamento da lista-branca, era problemático para pessoas com bases de código com mais de alguns milhares de classes.
          </p><p>
            Se seu projeto é menor ou você tem memória suficiente você vai ganhar um benefício em tempo de execução por adicionar <code class="literal">cacheTokens="true"</code>
            no seu arquivo <code class="literal">phpunit.xml</code>. Veja
            <a class="xref" href="#appendixes.configuration.phpunit" title="PHPUnit">“PHPUnit”</a>.
          </p></dd></dl></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="writing-tests-for-phpunit"></a>Capítulo 4. Escrevendo Testes para o PHPUnit</h1></div></div></div><p>
    <a id="idp31048448" class="indexterm"></a>

    <a class="xref" href="#writing-tests-for-phpunit.examples.PilhaTest.php" title="Exemplo 4.1: Testando operações de vetores com o PHPUnit">Exemplo 4.1</a> mostra como podemos escrever testes usando o PHPUnit que exercita operações de vetor do PHP. O exemplo introduz as convenções básicas e passos para escrever testes com o PHPUnit:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Os testes para uma classe <code class="literal">Classe</code> vão dentro de uma classe <code class="literal">ClasseTest</code>.</p></li><li class="listitem"><p><code class="literal">ClasseTest</code> herda (na maioria das vezes) de <code class="literal">PHPUnit_Framework_TestCase</code>.</p></li><li class="listitem"><a id="idp31092000" class="indexterm"></a><a id="idp31092624" class="indexterm"></a><p>Os testes são métodos públicos nomeados como <code class="literal">test*</code>.</p><p><a id="idp31094368" class="indexterm"></a>Alternativamente, você pode usar a anotação <code class="literal">@test</code> em um bloco de documentação de um método para marcá-lo como um método de teste.</p></li><li class="listitem"><p>Dentro dos métodos de teste, métodos de confirmação como <code class="literal">assertEquals()</code> (veja <a class="xref" href="#writing-tests-for-phpunit.assertions" title="Asserções">“Asserções”</a>) são usados para confirmar que um valor real equivale a um valor esperado.</p></li></ol></div><div class="example"><a id="writing-tests-for-phpunit.examples.PilhaTest.php"></a><p class="title"><strong>Exemplo 4.1: Testando operações de vetores com o PHPUnit</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">PilhaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testPushEPop</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$pilha</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">array_push</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$pilha</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">)</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">count</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
      Sempre que você estiver tentado a escrever algo em uma declaração
      <code class="literal">print</code> ou uma expressão depuradora, escreva como um teste em vez disso.
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Martin Fowler</span></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.test-dependencies"></a>Dependências de Testes</h2></div></div></div><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
        Testes Unitários são primeiramente escritos como uma boa prática para ajudar desenvolvedores a identificar e corrigir defeitos, a refatorar o código e servir como documentação para uma unidade de programa sob teste. Para conseguir esses benefícios, testes unitários idealmente deveriam cobrir todos os caminhos possíveis em um programa. Um teste unitário geralmente cobre um caminho específico em uma função ou método. Porém um método de teste não é necessariamente uma entidade encapsulada e independente. Às vezes existem dependências implícitas entre métodos de teste, escondidas no cenário de implementação de um teste.
      </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Adrian Kuhn et. al.</span></td></tr></table></div><p>
      <a id="idp31105968" class="indexterm"></a>

      O PHPUnit suporta a declaração explícita de dependências entre métodos de teste. Tais dependências não definem a ordem em que os métodos de teste devem ser executados, mas permitem o retorno de uma instância do ambiente do teste por um produtor e a passagem dele para os consumidores dependentes.
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Um produtor é um método de teste que dá como resultado sua unidade sob teste como um valor retornado.</p></li><li class="listitem"><p>Um consumidor é um método de teste que depende de um ou mais produtores e seus valores retornados.</p></li></ul></div><p>
      <a id="idp31109616" class="indexterm"></a>
      <a id="idp31110368" class="indexterm"></a>

      <a class="xref" href="#writing-tests-for-phpunit.examples.StackTest2.php" title="Exemplo 4.2: Usando a anotação @depends para expressar dependências">Exemplo 4.2</a> mostra como usar a anotação <code class="literal">@depends</code> para expressar dependências entre métodos de teste.
    </p><div class="example"><a id="writing-tests-for-phpunit.examples.StackTest2.php"></a><p class="title"><strong>Exemplo 4.2: Usando a anotação <code class="literal">@depends</code> para expressar dependências</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">PilhaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testVazio</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$pilha</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEmpty</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$pilha</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@depends&nbsp;testVazio</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testPush</span><span class="keyword">(</span><span class="keyword">array</span><span class="default">&nbsp;</span><span class="default">$pilha</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">array_push</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$pilha</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">)</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertNotEmpty</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$pilha</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@depends&nbsp;testPush</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testPop</span><span class="keyword">(</span><span class="keyword">array</span><span class="default">&nbsp;</span><span class="default">$pilha</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEmpty</span><span class="keyword">(</span><span class="default">$pilha</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      No exemplo acima o primeiro teste, <code class="literal">testVazio()</code>, cria um novo vetor e assegura que o mesmo é vazio. O teste então retorna o ambiente como resultado. O segundo teste, <code class="literal">testPush()</code>,
      depende de <code class="literal">testVazio()</code> e lhe é passado o resultado do qual ele depende como um argumento. Finalmente, <code class="literal">testPop()</code>
      depdende de <code class="literal">testPush()</code>.
    </p><p>
      <a id="idp31119360" class="indexterm"></a>

      Para localizar defeitos rapidamente, queremos nossa atenção focada nas falhas relevantes dos testes. É por isso que o PHPUnit pula a execução de um teste quando um teste do qual ele depende falha. Isso melhora a localização de defeitos por explorar as dependências entre os testes como mostrado em
      <a class="xref" href="#writing-tests-for-phpunit.examples.FalhaDependenciaTest.php" title="Exemplo 4.3: Explorando as dependências entre os testes">Exemplo 4.3</a>.
    </p><div class="example"><a id="writing-tests-for-phpunit.examples.FalhaDependenciaTest.php"></a><p class="title"><strong>Exemplo 4.3: Explorando as dependências entre os testes</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">FalhaDependenciaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testUm</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">FALSE</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@depends&nbsp;testUm</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testDois</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit --verbose FalhaDependenciaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FS

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) FalhaDependenciaTest::testUm
Failed asserting that false is true.

/home/sb/FalhaDependenciaTest.php:6

There was 1 skipped test:

1) FalhaDependenciaTest::testDois
This test depends on "FalhaDependenciaTest::testUm" to pass.


FAILURES!
Tests: 1, Assertions: 1, Failures: 1, Skipped: 1.</pre></div></div><br class="example-break" /><p>
      Um teste pode ter mais de uma anotação <code class="literal">@depends</code>. O PHPUnit não muda a ordem em que os testes são executados, portanto você deve se certificar de que as dependências de um teste podem realmente ser encontradas antes de executar o teste.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.data-providers"></a>Provedores de Dados</h2></div></div></div><p>
      <a id="idp31127584" class="indexterm"></a>
      <a id="idp31128336" class="indexterm"></a>
      Um método de teste pode aceitar argumentos arbitrários. Esses argumentos devem ser fornecidos por um método provedor de dados (<code class="literal">provedor()</code> em
      <a class="xref" href="#writing-tests-for-phpunit.data-providers.examples.DadosTest.php" title="Exemplo 4.4: Usando um provedor de dados que retorna um vetor de vetores">Exemplo 4.4</a>).
      O método provedor de dados a ser usado é especificado usando a anotação
      <code class="literal">@dataProvider</code>.
    </p><p>
      Um método provedor de dados deve ser <code class="literal">public</code> e ou retornar um vetor de vetores ou um objeto que implementa a interface <code class="literal">Iterator</code> e produz um vetor para cada passo da iteração. Para cada vetor que é parte da coleção o método de teste será chamado com os conteúdos do vetor como seus argumentos.
    </p><div class="example"><a id="writing-tests-for-phpunit.data-providers.examples.DadosTest.php"></a><p class="title"><strong>Exemplo 4.4: Usando um provedor de dados que retorna um vetor de vetores</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">DadosTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@dataProvider&nbsp;provedor</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testSoma</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$b</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$c</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$a</span><span class="default">&nbsp;</span><span class="keyword">+</span><span class="default">&nbsp;</span><span class="default">$b</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">provedor</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">3</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit DadosTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

...F

Time: 0 seconds, Memory: 5.75Mb

There was 1 failure:

1) DadosTest::testSoma with data set #3 (1, 1, 3)
Failed asserting that 2 matches expected 3.

/home/sb/DadosTest.php:9

FAILURES!
Tests: 4, Assertions: 4, Failures: 1.</pre></div></div><br class="example-break" /><div class="example"><a id="writing-tests-for-phpunit.data-providers.examples.DataTest2.php"></a><p class="title"><strong>Exemplo 4.5: Usando um provedor de dados que retorna um objeto Iterador</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require</span><span class="default">&nbsp;</span><span class="string">'ArquivoCsvIterador.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">DadosTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@dataProvider&nbsp;provedor</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testSoma</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$b</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$c</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">$c</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$a</span><span class="default">&nbsp;</span><span class="keyword">+</span><span class="default">&nbsp;</span><span class="default">$b</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">provedor</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">ArquivoCsvIterador</span><span class="keyword">(</span><span class="string">'dados.csv'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit DadosTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

...F

Time: 0 seconds, Memory: 5.75Mb

There was 1 failure:

1) DadosTest::testSoma with data set #3 ('1', '1', '3')
Failed asserting that 2 matches expected '3'.

/home/sb/DadosTest.php:11

FAILURES!
Tests: 4, Assertions: 4, Failures: 1.</pre></div></div><br class="example-break" /><div class="example"><a id="writing-tests-for-phpunit.data-providers.examples.ArquivoCsvIterador.php"></a><p class="title"><strong>Exemplo 4.6: A classe ArquivoCsvIterador</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ArquivoCsvIterador</span><span class="default">&nbsp;</span><span class="default">implements</span><span class="default">&nbsp;</span><span class="default">Iterator</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$arquivo</span><span class="keyword">;</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$chave</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">;</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$atual</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$arquivo</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arquivo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$arquivo</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'r'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">__destruct</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">fclose</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arquivo</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">rebobinar</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">rebobinar</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arquivo</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">atual</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">fgetcsv</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arquivo</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">chave</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">valido</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="keyword">!</span><span class="default">feof</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arquivo</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">chave</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">chave</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">atual</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">atual</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">proximo</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">atual</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">fgetcsv</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arquivo</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">chave</span><span class="keyword">++</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        <a id="idp31142864" class="indexterm"></a>
        <a id="idp31143616" class="indexterm"></a>
        <a id="idp31144368" class="indexterm"></a>

        Quando um teste recebe uma entrada tanto de um método <code class="literal">@dataProvider</code>
        quanto de um ou mais testes dos quais ele <code class="literal">@depends</code>, os argumentos do provedor de dados virão antes daqueles dos quais ele é dependente.
      </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        <a id="idp31147488" class="indexterm"></a>
        <a id="idp31148240" class="indexterm"></a>
        <a id="idp31148992" class="indexterm"></a>

        Quando um teste depende de um teste que usa provedores de dados, o teste dependente será executado quando o teste do qual ele depende for bem sucedido em pelo menos uma seção de dados. O resultado de um teste que usa provedores de dados não pode ser injetado dentro de um teste dependente.
      </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        <a id="idp31151152" class="indexterm"></a>
        <a id="idp31151904" class="indexterm"></a>
        <a id="idp31152656" class="indexterm"></a>

        Todos os provedores de dados são executados antes da primeira chamada à função
        <code class="literal">setUp</code>. Por isso você não pode acessar quaisquer variáveis que criar ali de dentro de um provedor de dados.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.exceptions"></a>Testando Exceções</h2></div></div></div><p>
      <a id="idp31156016" class="indexterm"></a>
      <a id="idp31156768" class="indexterm"></a>

      <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExcecaoTest.php" title="Exemplo 4.7: Usando a anotação @expectedException">Exemplo 4.7</a>
      mostra como usar a anotação <code class="literal">@expectedException</code> para testar se uma exceção foi lançada dentro do código de teste.
    </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.ExcecaoTest.php"></a><p class="title"><strong>Exemplo 4.7: Usando a anotação @expectedException</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ExcecaoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@expectedException&nbsp;InvalidArgumentException</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testExcecao</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ExcecaoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) ExcecaoTest::testExcecao
Expected exception InvalidArgumentException


FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
      <a id="idp31162448" class="indexterm"></a>
      <a id="idp31163200" class="indexterm"></a>
      <a id="idp31163952" class="indexterm"></a>
      <a id="idp31164704" class="indexterm"></a>

      Adicionalmente, você pode usar <code class="literal">@expectedExceptionMessage</code>
      e <code class="literal">@expectedExceptionCode</code> em combinação com
      <code class="literal">@expectedException</code> para testar a mensagem de exceção e o código de exceção como mostrado em
      <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExceptionTest2.php" title="Exemplo 4.8: Usando as anotações @expectedExceptionMessage e @expectedExceptionCode">Exemplo 4.8</a>.
    </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.ExceptionTest2.php"></a><p class="title"><strong>Exemplo 4.8: Usando as anotações @expectedExceptionMessage e @expectedExceptionCode</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ExcecaoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@expectedException&nbsp;InvalidArgumentException</span><br /><span class="comment">*&nbsp;@expectedExceptionMessage&nbsp;Mensagem&nbsp;Certa</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testExcecaoTemMensagemCerta</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">throw</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">InvalidArgumentException</span><span class="keyword">(</span><span class="string">'Alguma&nbsp;Mensagem'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@expectedException&nbsp;InvalidArgumentException</span><br /><span class="comment">*&nbsp;@expectedExceptionCode&nbsp;20</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testExcecaoTemCodigoCerto</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">throw</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">InvalidArgumentException</span><span class="keyword">(</span><span class="string">'Alguma&nbsp;Mensagem'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ExcecaoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FF

Time: 0 seconds, Memory: 3.00Mb

There were 2 failures:

1) ExcecaoTest::testExcecaoTemMensagemCerta
Failed asserting that exception message 'Alguma Mensagem' contains 'Mensagem Certa'.


2) ExcecaoTest::testExcecaoTemCodigoCerto
Failed asserting that expected exception code 20 is equal to 10.


FAILURES!
Tests: 2, Assertions: 4, Failures: 2.</pre></div></div><br class="example-break" /><p>
      Mais exemplos de <code class="literal">@expectedExceptionMessage</code> e <code class="literal">@expectedExceptionCode</code>
      são mostrados em <a class="xref" href="#appendixes.annotations.expectedExceptionMessage" title="@expectedExceptionMessage">“<code class="literal">@expectedExceptionMessage</code>”</a> e
      <a class="xref" href="#appendixes.annotations.expectedExceptionCode" title="@expectedExceptionCode">“<code class="literal">@expectedExceptionCode</code>”</a> respectivamente.
    </p><p>
      Alternativamente, você pode usar o método <code class="literal">setExpectedException()</code>
      para definir a exceção esperada como mostrado em <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExceptionTest3.php" title="Exemplo 4.9: Esperando uma exceção surgir do código de teste">Exemplo 4.9</a>.
    </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.ExceptionTest3.php"></a><p class="title"><strong>Exemplo 4.9: Esperando uma exceção surgir do código de teste</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ExcecaoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testExcecao</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setExpectedException</span><span class="keyword">(</span><span class="string">'InvalidArgumentException'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testExcecaoTemMensagemCerta</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setExpectedException</span><span class="keyword">(</span><br /><span class="string">'InvalidArgumentException'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'Mensagem&nbsp;Certa'</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">throw</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">InvalidArgumentException</span><span class="keyword">(</span><span class="string">'Alguma&nbsp;Mensagem'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testExcecaoTemCodigoCerto</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setExpectedException</span><span class="keyword">(</span><br /><span class="string">'InvalidArgumentException'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'Mensagem&nbsp;Certa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">20</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">throw</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">InvalidArgumentException</span><span class="keyword">(</span><span class="string">'A&nbsp;Mensagem&nbsp;Certa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ExcecaoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFF

Time: 0 seconds, Memory: 3.00Mb

There were 3 failures:

1) ExcecaoTest::testExcecao
Expected exception InvalidArgumentException


2) ExcecaoTest::testExcecaoTemMensagemCerta
Failed asserting that exception message 'Alguma Mensagem' contains 'Mensagem Certa'.


3) ExcecaoTest::testExcecaoTemCodigoCerto
Failed asserting that expected exception code 20 is equal to 10.


FAILURES!
Tests: 3, Assertions: 6, Failures: 3.</pre></div></div><br class="example-break" /><p>
      <a class="xref" href="#writing-tests-for-phpunit.exceptions.tables.api" title="Tabela 4.1. Métodos para testar exceções">Tabela 4.1</a>
      mostra os métodos fornecidos para testar exceções.
    </p><div class="table"><a id="writing-tests-for-phpunit.exceptions.tables.api"></a><p class="title"><strong>Tabela 4.1. Métodos para testar exceções</strong></p><div class="table-contents"><table summary="Métodos para testar exceções" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Método</th><th align="left">Significado</th></tr></thead><tbody><tr><td align="left"><code class="literal">void setExpectedException(string $nomeExcecao[, string $mensagemExcecao = '', inteiro $codigoExcecao = NULL])</code></td><td align="left">Define os <code class="literal">$nomeExcecao</code>, <code class="literal">$mensagemExcecao</code>, e <code class="literal">$codigoExcecao.</code> esperados.</td></tr><tr><td align="left"><code class="literal">String getExpectedException()</code></td><td align="left">Retorna o nome da exceção esperada.</td></tr></tbody></table></div></div><br class="table-break" /><p>
      Você também pode usar a abordagem mostrada em
      <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExceptionTest4.php" title="Exemplo 4.10: Abordagem alternativa para testar exceções">Exemplo 4.10</a>
      para testar exceções
    </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.ExceptionTest4.php"></a><p class="title"><strong>Exemplo 4.10: Abordagem alternativa para testar exceções</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ExcecaoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testExcecao</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">try</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="comment">//&nbsp;...&nbsp;Código&nbsp;que&nbsp;se&nbsp;espera&nbsp;que&nbsp;lance&nbsp;uma&nbsp;exceção&nbsp;...</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">catch</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">InvalidArgumentException</span><span class="default">&nbsp;</span><span class="default">$esperado</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">return</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fail</span><span class="keyword">(</span><span class="string">'Uma&nbsp;exceção&nbsp;esperada&nbsp;não&nbsp;foi&nbsp;criada.'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Se o código que se espera que crie uma exceção em <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ExceptionTest4.php" title="Exemplo 4.10: Abordagem alternativa para testar exceções">Exemplo 4.10</a>
      não criá-la, a chamada subsequente ao
      <code class="literal">fail()</code> vai parar o teste e sinalizar um problema com o teste. Se a exceção esperada aparecer, o bloco <code class="literal">catch</code> será executado, e o teste terminará com sucesso.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.errors"></a>Testando Erros PHP</h2></div></div></div><p>
      <a id="idp31198032" class="indexterm"></a>
      <a id="idp31198784" class="indexterm"></a>
      <a id="idp31199536" class="indexterm"></a>
      <a id="idp31200288" class="indexterm"></a>
      <a id="idp31201040" class="indexterm"></a>

      Por padrão o PHPUnit converte os erros, avisos e notificações do PHP que são disparados durante a execução de um teste para uma exceção. Usando essas exceções você pode, por exemplo, esperar que um teste dispare um erro PHP como mostrado <a class="xref" href="#writing-tests-for-phpunit.exceptions.examples.ErrorTest.php" title="Exemplo 4.11: Esperando um erro PHP usando @expectedException">Exemplo 4.11</a>.
    </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.ErrorTest.php"></a><p class="title"><strong>Exemplo 4.11: Esperando um erro PHP usando @expectedException</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ErroEsperadoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@expectedException&nbsp;PHPUnit_Framework_Error</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalhaInclusao</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">include</span><span class="default">&nbsp;</span><span class="string">'arquivo_nao_existente.php'</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ErroEsperadoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.

Time: 0 seconds, Memory: 5.25Mb

OK (1 test, 1 assertion)</pre></div></div><br class="example-break" /><p>
      <a id="idp31206144" class="indexterm"></a>
      <a id="idp31206896" class="indexterm"></a>

      <code class="literal">PHPUnit_Framework_Error_Notice</code> e
      <code class="literal">PHPUnit_Framework_Error_Warning</code> representam notificações e avisos do PHP, respectivamente.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        Você deve ser o mais específico possível quando testar exceções. Testar por classes que são muito genéricas pode causar efeitos colaterais indesejáveis. Da mesma forma, testar para a classe <code class="literal">Exception</code>
        com <code class="literal">@expectedException</code> ou
        <code class="literal">setExpectedException()</code> não é mais permitido.
      </p></div><p>
        Ao testar com funções que dependem de funções php que disparam erros como
        <code class="literal">fopen</code> pode ser útil algumas vezes usar a supressão de erros enquanto testa. Isso permite a você verificar os valores retornados por suprimir notificações que levariam a um
        <code class="literal">PHPUnit_Framework_Error_Notice</code>.
        </p><div class="example"><a id="writing-tests-for-phpunit.exceptions.examples.TriggerErrorReturnValue.php"></a><p class="title"><strong>Exemplo 4.12: Testando valores retornados do código que utiliza PHP Errors</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">SupressaoErroTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testEscrevendoArquivo</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$escritor</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">EscritorArquivo</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertFalse</span><span class="keyword">(</span><span class="keyword">@</span><span class="default">$escritor</span><span class="keyword">-&gt;</span><span class="default">escrever</span><span class="keyword">(</span><span class="string">'/nao-pode-escrever/arquivo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'coisas'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">EscritorArquivo</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">escrever</span><span class="keyword">(</span><span class="default">$arquivo</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$conteudo</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$arquivo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">fopen</span><span class="keyword">(</span><span class="default">$arquivo</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'w'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">if</span><span class="keyword">(</span><span class="default">$arquivo</span><span class="default">&nbsp;</span><span class="keyword">==</span><span class="default">&nbsp;</span><span class="default">false</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">false</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="comment">//&nbsp;...</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit SupressaoErroTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.

Time: 1 seconds, Memory: 5.25Mb

OK (1 test, 1 assertion)</pre></div></div><p><br class="example-break" />
    Sem a supressão de erros o teste teria relatado uma falha
    <code class="literal">fopen(/nao-pode-escrever/arquivo): failed to open stream:
    No such file or directory</code>.

    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.output"></a>Testando Saídas</h2></div></div></div><p>
      Às vezes você quer assegurar que a execução de um método, por exemplo, gera uma saída esperada (via <code class="literal">echo</code> ou <code class="literal">print</code>, por exemplo). A classe
      <code class="literal">PHPUnit_Framework_TestCase</code> usa a função
      <a class="ulink" href="http://www.php.net/manual/en/ref.outcontrol.php" target="_top">Output
      Buffering</a> para prover a funcionalidade necessária para isso.
    </p><p>
      <a class="xref" href="#writing-tests-for-phpunit.output.examples.SaidaTest.php" title="Exemplo 4.13: Testando a saída de uma função ou método">Exemplo 4.13</a>
      mostra como usar o método <code class="literal">expectOutputString()</code> para definir a saída esperada. Se essa saída esperada não for gerada, o teste será contado como uma falha.
    </p><div class="example"><a id="writing-tests-for-phpunit.output.examples.SaidaTest.php"></a><p class="title"><strong>Exemplo 4.13: Testando a saída de uma função ou método</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">SaidaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testEsperadoFooRealFoo</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">expectOutputString</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">print</span><span class="default">&nbsp;</span><span class="string">'foo'</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testEsperadoBarRealBaz</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">expectOutputString</span><span class="keyword">(</span><span class="string">'bar'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">print</span><span class="default">&nbsp;</span><span class="string">'baz'</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit SaidaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.F

Time: 0 seconds, Memory: 5.75Mb

There was 1 failure:

1) SaidaTest::testEsperadoBarRealBaz
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'bar'
+'baz'


FAILURES!
Tests: 2, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /><p>
      <a class="xref" href="#writing-tests-for-phpunit.output.tables.api" title="Tabela 4.2. Métodos para testar a saída">Tabela 4.2</a>
      mostra os métodos fornecidos para testar saídas.
    </p><div class="table"><a id="writing-tests-for-phpunit.output.tables.api"></a><p class="title"><strong>Tabela 4.2. Métodos para testar a saída</strong></p><div class="table-contents"><table summary="Métodos para testar a saída" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Método</th><th align="left">Significado</th></tr></thead><tbody><tr><td align="left"><code class="literal">void expectOutputRegex(string $expressaoRegular)</code></td><td align="left">Define a saída que se espera combinar com a <code class="literal">$expressaoRegular</code>.</td></tr><tr><td align="left"><code class="literal">void expectOutputString(string $stringEsperada)</code></td><td align="left">Define a saída que se espera ser igual a uma <code class="literal">$stringEsperada</code>.</td></tr><tr><td align="left"><code class="literal">booleano setOutputCallback(callable $callback)</code></td><td align="left">Define um retorno que é usado, por exemplo, para normalizar a saída real.</td></tr></tbody></table></div></div><br class="table-break" /><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        Por favor, note que o PHPUnit engole todas as saídas que são emitidas durante a execução de um teste. Para ser mais exato, um teste que emite uma saída vai falhar.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.assertions"></a>Asserções</h2></div></div></div><p>
      Esta seção lista os vários métodos de asserção (assertion) disponíveis.
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertArrayHasKey"></a><code class="literal">assertArrayHasKey()</code></h3></div></div></div><a id="idp31243120" class="indexterm"></a><a id="idp31243872" class="indexterm"></a><p><code class="literal">assertArrayHasKey(misto $chave, vetor $vetor[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$vetor</code> não tiver a <code class="literal">$chave</code>.</p><p><code class="literal">assertArrayNotHasKey()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertArrayHasKey.example"></a><p class="title"><strong>Exemplo 4.14: Uso de assertArrayHasKey()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">VetorTemChaveTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertArrayHasKey</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'bar'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'baz'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit VetorTemChaveTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) VetorTemChaveTest::testFalha
Failed asserting that an array has the key 'foo'.

/home/sb/VetorTemChaveTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertClassHasAttribute"></a><code class="literal">assertClassHasAttribute()</code></h3></div></div></div><a id="idp31253232" class="indexterm"></a><a id="idp31253984" class="indexterm"></a><p><code class="literal">assertClassHasAttribute(string $nomeAtributo, string $nomeClasse[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$nomeClasse::nomeAtributo</code> não existir.</p><p><code class="literal">assertClassNotHasAttribute()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertClassHasAttribute.example"></a><p class="title"><strong>Exemplo 4.15: Uso de assertClassHasAttribute()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ClasseTemAtributoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertClassHasAttribute</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'stdClass'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ClasseTemAtributoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) ClasseTemAtributoTest::testFalha
Failed asserting that class "stdClass" has attribute "foo".

/home/sb/ClasseTemAtributoTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertClassHasStaticAttribute"></a><code class="literal">assertClassHasStaticAttribute()</code></h3></div></div></div><a id="idp31262720" class="indexterm"></a><a id="idp31263472" class="indexterm"></a><p><code class="literal">assertClassHasStaticAttribute(string $nomeAtributo, string $nomeClasse[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$nomeClasse::nomeAtributo</code> não existir.</p><p><code class="literal">assertClassNotHasStaticAttribute()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertClassHasStaticAttribute.example"></a><p class="title"><strong>Exemplo 4.16: Uso de assertClassHasStaticAttribute()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ClasseTemAtributoEstaticoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertClassHasStaticAttribute</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'stdClass'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ClasseTemAtributoEstaticoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) ClasseTemAtributoEstaticoTest::testFalha
Failed asserting that class "stdClass" has static attribute "foo".

/home/sb/ClasseTemAtributoEstaticoTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertContains"></a><code class="literal">assertContains()</code></h3></div></div></div><a id="idp31272304" class="indexterm"></a><a id="idp31273056" class="indexterm"></a><a id="idp31273808" class="indexterm"></a><a id="idp31274560" class="indexterm"></a><p><code class="literal">assertContains(misto $agulha, Iterador|vetor $bateria[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$agulha</code> não for um elemento de <code class="literal">$bateria</code>.</p><p><code class="literal">assertNotContains()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><p><code class="literal">assertAttributeContains()</code> e <code class="literal">assertAttributeNotContains()</code> são empacotadores de conveniência que usam um atributo <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto como a bateria (vetor que é um conjunto de pilhas).</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertContains.example"></a><p class="title"><strong>Exemplo 4.17: Uso de assertContains()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContemTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertContains</span><span class="keyword">(</span><span class="default">4</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">2</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">3</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ContemTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) ContemTest::testFalha
Failed asserting that an array contains 4.

/home/sb/ContemTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p><code class="literal">assertContains(string $agulha, string $bateria[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$agulha</code> não for uma substring de <code class="literal">$bateria</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertContains.example2"></a><p class="title"><strong>Exemplo 4.18: Uso de assertContains()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContemTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertContains</span><span class="keyword">(</span><span class="string">'baz'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'foobar'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ContemTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) ContemTest::testFalha
Failed asserting that 'foobar' contains "baz".

/home/sb/ContemTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertContainsOnly"></a><code class="literal">assertContainsOnly()</code></h3></div></div></div><a id="idp31293232" class="indexterm"></a><a id="idp31293984" class="indexterm"></a><a id="idp31294736" class="indexterm"></a><a id="idp31295488" class="indexterm"></a><p><code class="literal">assertContainsOnly(string $tipo, Iterador|vetor $bateria[, booleano $ehTipoNativo = NULL, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$bateria</code> não contiver apenas variáveis do tipo <code class="literal">$tipo</code>.</p><p><code class="literal">$ehTipoNativo</code> é uma bandeira usada para indicar se <code class="literal">$tipo</code> é um tipo nativo do PHP ou não.</p><p><code class="literal">assertNotContainsOnly()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><p><code class="literal">assertAttributeContainsOnly()</code> e <code class="literal">assertAttributeNotContainsOnly()</code> são empacotadores de conveniência que usam um atributo <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto como o valor real.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertContainsOnly.example"></a><p class="title"><strong>Exemplo 4.19: Uso de assertContainsOnly()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContemApenasTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertContainsOnly</span><span class="keyword">(</span><span class="string">'string'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'1'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'2'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">3</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ContemApenasTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) ContemApenasTest::testFalha
Failed asserting that Array (
0 =&gt; '1'
1 =&gt; '2'
2 =&gt; 3
) contains only values of type "string".

/home/sb/ContemApenasTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertContainsOnlyInstancesOf"></a><code class="literal">assertContainsOnlyInstancesOf()</code></h3></div></div></div><a id="idp31310096" class="indexterm"></a><p><code class="literal">assertContainsOnlyInstancesOf(string $nomeclasse, Traversable|vetor $bateria[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$bateria</code> não contiver apenas instâncias da classe <code class="literal">$nomeclasse</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertContainsOnlyInstancesOf.example"></a><p class="title"><strong>Exemplo 4.20: Uso de assertContainsOnlyInstancesOf()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContemApenasInstanciasDeTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertContainsOnlyInstancesOf</span><span class="keyword">(</span><span class="string">'Foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Foo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Bar</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Foo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ContemApenasInstanciasDeTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) ContemApenasInstanciasDeTest::testFalha
Failed asserting that Array ([0]=&gt; Bar Object(...)) is an instance of class "Foo".

/home/sb/ContemApenasInstanciasDeTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertCount"></a><code class="literal">assertCount()</code></h3></div></div></div><a id="idp31318624" class="indexterm"></a><a id="idp31319376" class="indexterm"></a><p><code class="literal">assertCount($contaEsperada, $bateria[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o número de elementos em <code class="literal">$bateria</code> não for <code class="literal">$contaEsperada</code>.</p><p><code class="literal">assertNotCount()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertCount.example"></a><p class="title"><strong>Exemplo 4.21: Uso de assertCount()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertCount</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ContaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) ContaTest::testFalha
Failed asserting that actual size 1 matches expected size 0.

/home/sb/ContaTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertEmpty"></a><code class="literal">assertEmpty()</code></h3></div></div></div><a id="idp31328624" class="indexterm"></a><a id="idp31329376" class="indexterm"></a><a id="idp31330128" class="indexterm"></a><a id="idp31330880" class="indexterm"></a><p><code class="literal">assertEmpty(misto $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$real</code> não estiver vazio.</p><p><code class="literal">assertNotEmpty()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><p><code class="literal">assertAttributeEmpty()</code> e <code class="literal">assertAttributeNotEmpty()</code> são empacotadores de conveniência que podem ser aplicados a um atributo <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEmpty.example"></a><p class="title"><strong>Exemplo 4.22: Uso de assertEmpty()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">VazioTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEmpty</span><span class="keyword">(</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit VazioTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) VazioTest::testFalha
Failed asserting that an array is empty.

/home/sb/VazioTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertEqualXMLStructure"></a><code class="literal">assertEqualXMLStructure()</code></h3></div></div></div><a id="idp31342784" class="indexterm"></a><p><code class="literal">assertEqualXMLStructure(DOMElement $elementoEsperado, DOMElement $elementoReal[, booleano $verificarAtributos = FALSE, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se a Estrutura XML do DOMElement em <code class="literal">$elementoReal</code> não é igual à estrutura XML do DOMElement em <code class="literal">$elementoEsperado</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEqualXMLStructure.example"></a><p class="title"><strong>Exemplo 4.23: Uso de assertEqualXMLStructure()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">IgualaEstruturaXMLTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalhaComNomesDeNosDiferentes</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$esperado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DOMElement</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$real</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DOMElement</span><span class="keyword">(</span><span class="string">'bar'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEqualXMLStructure</span><span class="keyword">(</span><span class="default">$esperado</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$real</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalhaComAtributosDeNosDiferentes</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$esperado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DOMDocument</span><span class="keyword">;</span><br /><span class="default">$esperado</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;foo&nbsp;bar=&quot;true&quot;&nbsp;/&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$real</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DOMDocument</span><span class="keyword">;</span><br /><span class="default">$real</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;foo/&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEqualXMLStructure</span><span class="keyword">(</span><br /><span class="default">$esperado</span><span class="keyword">-&gt;</span><span class="default">firstChild</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$real</span><span class="keyword">-&gt;</span><span class="default">firstChild</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">TRUE</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalhaComContagemDeFilhosDiferente</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$esperado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DOMDocument</span><span class="keyword">;</span><br /><span class="default">$esperado</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;/foo&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$real</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DOMDocument</span><span class="keyword">;</span><br /><span class="default">$real</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;&lt;bar/&gt;&lt;/foo&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEqualXMLStructure</span><span class="keyword">(</span><br /><span class="default">$esperado</span><span class="keyword">-&gt;</span><span class="default">firstChild</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$real</span><span class="keyword">-&gt;</span><span class="default">firstChild</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalhaComFilhosDiferentes</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$esperado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DOMDocument</span><span class="keyword">;</span><br /><span class="default">$esperado</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;/foo&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$real</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DOMDocument</span><span class="keyword">;</span><br /><span class="default">$real</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;&lt;baz/&gt;&lt;baz/&gt;&lt;baz/&gt;&lt;/foo&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEqualXMLStructure</span><span class="keyword">(</span><br /><span class="default">$esperado</span><span class="keyword">-&gt;</span><span class="default">firstChild</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$real</span><span class="keyword">-&gt;</span><span class="default">firstChild</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit IgualaEstruturaXMLTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFFF

Time: 0 seconds, Memory: 5.75Mb

There were 4 failures:

1) IgualaEstruturaXMLTest::testFalhaComNomesDeNosDiferentes
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'foo'
+'bar'

/home/sb/IgualaEstruturaXMLTest.php:9

2) IgualaEstruturaXMLTest::testFalhaComAtributosDeNosDiferentes
Number of attributes on node "foo" does not match
Failed asserting that 0 matches expected 1.

/home/sb/IgualaEstruturaXMLTest.php:22

3) IgualaEstruturaXMLTest::testFalhaComContagemDeFilhosDiferente
Number of child nodes of "foo" differs
Failed asserting that 1 matches expected 3.

/home/sb/IgualaEstruturaXMLTest.php:35

4) IgualaEstruturaXMLTest::testFalhaComFilhosDiferentes
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'bar'
+'baz'

/home/sb/IgualaEstruturaXMLTest.php:48

FAILURES!
Tests: 4, Assertions: 8, Failures: 4.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertEquals"></a><code class="literal">assertEquals()</code></h3></div></div></div><a id="idp31351952" class="indexterm"></a><a id="idp31353760" class="indexterm"></a><a id="idp31354512" class="indexterm"></a><a id="idp31355264" class="indexterm"></a><p><code class="literal">assertEquals(misto $esperado, misto $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se as duas variáveis <code class="literal">$esperado</code> e <code class="literal">$real</code> não forem iguais.</p><p><code class="literal">assertNotEquals()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><p><code class="literal">assertAttributeEquals()</code> e <code class="literal">assertAttributeNotEquals()</code> são empacotadores de conveniência que usam um atributo <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto como valor real.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEquals.example"></a><p class="title"><strong>Exemplo 4.24: Uso de assertEquals()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">IgualaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha2</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'baz'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha3</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">&quot;foo\nbar\nbaz\n&quot;</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">&quot;foo\nbah\nbaz\n&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit IgualaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFF

Time: 0 seconds, Memory: 5.25Mb

There were 3 failures:

1) IgualaTest::testFalha
Failed asserting that 0 matches expected 1.

/home/sb/IgualaTest.php:6

2) IgualaTest::testFalha2
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'bar'
+'baz'

/home/sb/IgualaTest.php:11

3) IgualaTest::testFalha3
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
 'foo
-bar
+bah
 baz
 '

/home/sb/IgualaTest.php:16

FAILURES!
Tests: 3, Assertions: 3, Failures: 3.</pre></div></div><br class="example-break" /><p>Veja abaixo comparações mais especializadas são usadas para tipos específicos de argumentos para <code class="literal">$esperado</code> e <code class="literal">$real</code>.</p><p><code class="literal">assertEquals(float $esperado, float $real[, string $mensagem = '', float $delta = 0])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se os dois ponto-flutuantes <code class="literal">$esperado</code> e <code class="literal">$real</code> não estiverem contidos no <code class="literal">$delta</code> de cada um.</p><p>Por favor, leia "<a class="ulink" href="http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html" target="_top">O que cada cientista da computação deveria saber sobre aritmética de ponto-flutuante</a>" para entender porque <code class="literal">$delta</code> é necessário.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEquals.example2"></a><p class="title"><strong>Exemplo 4.25: Uso de assertEquals() com ponto-flutuantes</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">IgualaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testPassa</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">1.0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1.1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">''</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">0.2</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">1.0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1.1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit IgualaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.F

Time: 0 seconds, Memory: 5.75Mb

There was 1 failure:

1) IgualaTest::testFalha
Failed asserting that 1.1 matches expected 1.0.

/home/sb/IgualaTest.php:11

FAILURES!
Tests: 2, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /><p><code class="literal">assertEquals(DOMDocument $esperado, DOMDocument $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o canônico não-comentado dos documentos XML representados pelos dois objetos DOMDocument <code class="literal">$esperado</code> e <code class="literal">$real</code> não forem iguais.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEquals.example3"></a><p class="title"><strong>Exemplo 4.26: Uso de assertEquals() com objetos DOMDocument</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">IgualaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$esperado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DOMDocument</span><span class="keyword">;</span><br /><span class="default">$esperado</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;&lt;bar/&gt;&lt;/foo&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$real</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DOMDocument</span><span class="keyword">;</span><br /><span class="default">$real</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;bar&gt;&lt;foo/&gt;&lt;/bar&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">$esperado</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$real</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit IgualaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) IgualaTest::testFalha
Failed asserting that two DOM documents are equal.
--- Expected
+++ Actual
@@ @@
&lt;?xml version="1.0"?&gt;
-&lt;foo&gt;
- &lt;bar/&gt;
-&lt;/foo&gt;
+&lt;bar&gt;
+ &lt;foo/&gt;
+&lt;/bar&gt;

/home/sb/IgualaTest.php:12

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p><code class="literal">assertEquals(objeto $esperado, objeto $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se os dois objetos <code class="literal">$esperado</code> e <code class="literal">$real</code> não tiverem os mesmos valores de atributos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEquals.example4"></a><p class="title"><strong>Exemplo 4.27: Uso de assertEquals() com objetos</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">IgualaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$esperado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">stdClass</span><span class="keyword">;</span><br /><span class="default">$esperado</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'foo'</span><span class="keyword">;</span><br /><span class="default">$esperado</span><span class="keyword">-&gt;</span><span class="default">bar</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'bar'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$real</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">stdClass</span><span class="keyword">;</span><br /><span class="default">$real</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'bar'</span><span class="keyword">;</span><br /><span class="default">$real</span><span class="keyword">-&gt;</span><span class="default">baz</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'bar'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">$esperado</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$real</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit IgualaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) IgualaTest::testFalha
Failed asserting that two objects are equal.
--- Expected
+++ Actual
@@ @@
stdClass Object (
- 'foo' =&gt; 'foo'
- 'bar' =&gt; 'bar'
+ 'foo' =&gt; 'bar'
+ 'baz' =&gt; 'bar'
)

/home/sb/IgualaTest.php:14

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p><code class="literal">assertEquals(vetor $esperado, vetor $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se os dois vetores <code class="literal">$esperado</code> e <code class="literal">$real</code> não forem iguais.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertEquals.example5"></a><p class="title"><strong>Exemplo 4.28: Uso de assertEquals() com vetores</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">IgualaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'a'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'b'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'c'</span><span class="keyword">)</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'a'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'c'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'d'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit IgualaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) IgualaTest::testFalha
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
Array (
0 =&gt; 'a'
- 1 =&gt; 'b'
- 2 =&gt; 'c'
+ 1 =&gt; 'c'
+ 2 =&gt; 'd'
)

/home/sb/IgualaTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertFalse"></a><code class="literal">assertFalse()</code></h3></div></div></div><a id="idp31397760" class="indexterm"></a><p><code class="literal">assertFalse(booleano $condicao[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$condicao</code> for <code class="literal">TRUE</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertFalse.example"></a><p class="title"><strong>Exemplo 4.29: Uso de assertFalse()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">FalsoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertFalse</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit FalsoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) FalsoTest::testFalha
Failed asserting that true is false.

/home/sb/FalsoTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertFileEquals"></a><code class="literal">assertFileEquals()</code></h3></div></div></div><a id="idp31405808" class="indexterm"></a><a id="idp31406560" class="indexterm"></a><p><code class="literal">assertFileEquals(string $esperado, string $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o arquivo especificado por <code class="literal">$esperado</code> não tiver o mesmo conteúdo que o arquivo especificado por <code class="literal">$real</code>.</p><p><code class="literal">assertFileNotEquals()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertFileEquals.example"></a><p class="title"><strong>Exemplo 4.30: Uso de assertFileEquals()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ArquivoIgualaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertFileEquals</span><span class="keyword">(</span><span class="string">'/home/sb/esperado'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'/home/sb/real'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ArquivoIgualaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) ArquivoIgualaTest::testFalha
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'esperado
+'real
 '

/home/sb/ArquivoIgualaTest.php:6

FAILURES!
Tests: 1, Assertions: 3, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertFileExists"></a><code class="literal">assertFileExists()</code></h3></div></div></div><a id="idp31415888" class="indexterm"></a><a id="idp31416640" class="indexterm"></a><p><code class="literal">assertFileExists(string $nomearquivo[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o arquivo especificado por <code class="literal">$nomearquivo</code> não existir.</p><p><code class="literal">assertFileNotExists()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertFileExists.example"></a><p class="title"><strong>Exemplo 4.31: Uso de assertFileExists()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ArquivoExisteTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertFileExists</span><span class="keyword">(</span><span class="string">'/caminho/para/arquivo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ArquivoExisteTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) ArquivoExisteTest::testFalha
Failed asserting that file "/caminho/para/arquivo" exists.

/home/sb/ArquivoExisteTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertGreaterThan"></a><code class="literal">assertGreaterThan()</code></h3></div></div></div><a id="idp31425184" class="indexterm"></a><a id="idp31425936" class="indexterm"></a><p><code class="literal">assertGreaterThan(misto $esperado, misto $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o valor de <code class="literal">$real</code> não for maior que o valor de <code class="literal">$esperado</code>.</p><p><code class="literal">assertAttributeGreaterThan()</code> é um empacotador de conveniência que usa um atributo <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto como valor real.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertGreaterThan.example"></a><p class="title"><strong>Exemplo 4.32: Uso de assertGreaterThan()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">MaiorQueTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertGreaterThan</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit MaiorQueTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) MaiorQueTest::testFalha
Failed asserting that 1 is greater than 2.

/home/sb/MaiorQueTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertGreaterThanOrEqual"></a><code class="literal">assertGreaterThanOrEqual()</code></h3></div></div></div><a id="idp31437040" class="indexterm"></a><a id="idp31437792" class="indexterm"></a><p><code class="literal">assertGreaterThanOrEqual(misto $esperado, misto $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o valor de <code class="literal">$real</code> não for maior ou igual ao valor de <code class="literal">$esperado</code>.</p><p><code class="literal">assertAttributeGreaterThanOrEqual()</code> é um empacotador de conveniência que usa <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto como o valor real.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertGreaterThanOrEqual.example"></a><p class="title"><strong>Exemplo 4.33: Uso de assertGreaterThanOrEqual()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">MaiorOuIgualTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertGreaterThanOrEqual</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit MaiorOuIgualTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) MaiorOuIgualTest::testFalha
Failed asserting that 1 is equal to 2 or is greater than 2.

/home/sb/MaiorOuIgualTest.php:6

FAILURES!
Tests: 1, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertInstanceOf"></a><code class="literal">assertInstanceOf()</code></h3></div></div></div><a id="idp31448944" class="indexterm"></a><a id="idp31449696" class="indexterm"></a><a id="idp31450448" class="indexterm"></a><a id="idp31451200" class="indexterm"></a><p><code class="literal">assertInstanceOf($esperado, $real[, $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$real</code> não for uma instância de <code class="literal">$esperado</code>.</p><p><code class="literal">assertNotInstanceOf()</code> é o inverso desta asserção e recebe os mesmos argumentos..</p><p><code class="literal">assertAttributeInstanceOf()</code> e <code class="literal">assertAttributeNotInstanceOf()</code> são empacotadores de conveniência que podem ser aplicados a atributos <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertInstanceOf.example"></a><p class="title"><strong>Exemplo 4.34: Uso de assertInstanceOf()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">InstanciaDeTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertInstanceOf</span><span class="keyword">(</span><span class="string">'RuntimeException'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Exception</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit InstanciaDeTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) InstanciaDeTest::testFalha
Failed asserting that Exception Object (...) is an instance of class "RuntimeException".

/home/sb/InstanciaDeTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertInternalType"></a><code class="literal">assertInternalType()</code></h3></div></div></div><a id="idp31463936" class="indexterm"></a><a id="idp31464688" class="indexterm"></a><a id="idp31465440" class="indexterm"></a><a id="idp31466192" class="indexterm"></a><p><code class="literal">assertInternalType($esperado, $real[, $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$real</code> não for do tipo <code class="literal">$esperado</code>.</p><p><code class="literal">assertNotInternalType()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><p><code class="literal">assertAttributeInternalType()</code> e <code class="literal">assertAttributeNotInternalType()</code> são empacotadores de conveniência que podem ser aplicados a atributos <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertInternalType.example"></a><p class="title"><strong>Exemplo 4.35: Uso de assertInternalType()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">TipoInternoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertInternalType</span><span class="keyword">(</span><span class="string">'string'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">42</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit TipoInternoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) TipoInternoTest::testFalha
Failed asserting that 42 is of type "string".

/home/sb/TipoInternoTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertJsonFileEqualsJsonFile"></a><code class="literal">assertJsonFileEqualsJsonFile()</code></h3></div></div></div><a id="idp31478864" class="indexterm"></a><a id="idp31479616" class="indexterm"></a><p><code class="literal">assertJsonFileEqualsJsonFile(misto $arquivoEsperado, misto $arquivoReal[, string $mensagem = ''])</code></p><p>
        Relata um erro identificado por <code class="literal">$mensagem</code> se o valor de <code class="literal">$arquivoReal</code> equivaler ao valor de <code class="literal">$arquivoEsperado</code>.
      </p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertJsonFileEqualsJsonFile.example"></a><p class="title"><strong>Exemplo 4.36: Uso de assertJsonFileEqualsJsonFile()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ArquivoJsonIgualaArquivoJsonTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertJsonFileEqualsJsonFile</span><span class="keyword">(</span><br /><span class="string">'caminho/para/arquivo/esperado'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'caminho/para/arquivo/real'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ArquivoJsonIgualaArquivoJsonTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) JsonFileEqualsJsonFile::testFalha
Failed asserting that '{"Mascott":"Tux"}' matches JSON string "["Mascott", "Tux", "OS", "Linux"]".

/home/sb/ArquivoJsonIgualaArquivoJsonTest.php:5

FAILURES!
Tests: 1, Assertions: 3, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonFile"></a><code class="literal">assertJsonStringEqualsJsonFile()</code></h3></div></div></div><a id="idp31488208" class="indexterm"></a><a id="idp31488960" class="indexterm"></a><p><code class="literal">assertJsonStringEqualsJsonFile(misto $arquivoEsperado, misto $jsonReal[, string $mensagem = ''])</code></p><p>
        Relata um erro identificado por <code class="literal">$mensagem</code> se o valor de <code class="literal">$jsonReal</code> equivaler ao valor de
        <code class="literal">$arquivoEsperado</code>.
      </p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonFile.example"></a><p class="title"><strong>Exemplo 4.37: Uso de assertJsonStringEqualsJsonFile()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">StringJsonIgualaArquivoJsonTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertJsonStringEqualsJsonFile</span><span class="keyword">(</span><br /><span class="string">'caminho/para/arquivo/ambiente'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">json_encode</span><span class="keyword">(</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">&quot;Mascott&quot;</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">&quot;ux&quot;</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit StringJsonIgualaArquivoJsonTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) JsonStringEqualsJsonFile::testFalha
Failed asserting that '{"Mascott":"ux"}' matches JSON string "{"Mascott":"Tux"}".

/home/sb/StringJsonIgualaArquivoJsonTest.php:5

FAILURES!
Tests: 1, Assertions: 3, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonString"></a><code class="literal">assertJsonStringEqualsJsonString()</code></h3></div></div></div><a id="idp31497440" class="indexterm"></a><a id="idp31498192" class="indexterm"></a><p><code class="literal">assertJsonStringEqualsJsonString(misto $jsonEsperado, misto $jsonReal[, string $mensagem = ''])</code></p><p>
        Relata um erro identificado por <code class="literal">$mensagem</code> se o valor de <code class="literal">$jsonReal</code> equivaler ao valor de
        <code class="literal">$jsonEsperado</code>.
      </p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonString.example"></a><p class="title"><strong>Exemplo 4.38: Uso de assertJsonStringEqualsJsonString()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">StringJsonIgualaStringJsonTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertJsonStringEqualsJsonString</span><span class="keyword">(</span><br /><span class="default">json_encode</span><span class="keyword">(</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">&quot;Mascott&quot;</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">&quot;Tux&quot;</span><span class="keyword">)</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">json_encode</span><span class="keyword">(</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">&quot;Mascott&quot;</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">&quot;ux&quot;</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit StringJsonIgualaStringJsonTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) StringJsonIgualaStringJsonTest::testFalha
Failed asserting that two objects are equal.
--- Expected
+++ Actual
@@ @@
 stdClass Object (
 - 'Mascott' =&gt; 'Tux'
 + 'Mascott' =&gt; 'ux'
)

/home/sb/StringJsonIgualaStringJsonTest.php:5

FAILURES!
Tests: 1, Assertions: 3, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertLessThan"></a><code class="literal">assertLessThan()</code></h3></div></div></div><a id="idp31506592" class="indexterm"></a><a id="idp31507344" class="indexterm"></a><p><code class="literal">assertLessThan(misto $esperado, misto $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o valor de <code class="literal">$real</code> não for menor que o valor de <code class="literal">$esperado</code>.</p><p><code class="literal">assertAttributeLessThan()</code> é um empacotador de conveniência que usa um atributo <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto como valor real.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertLessThan.example"></a><p class="title"><strong>Exemplo 4.39: Uso de assertLessThan()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">MenorQueTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertLessThan</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">2</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit MenorQueTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) MenorQueTest::testFalha
Failed asserting that 2 is less than 1.

/home/sb/MenorQueTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertLessThanOrEqual"></a><code class="literal">assertLessThanOrEqual()</code></h3></div></div></div><a id="idp31518512" class="indexterm"></a><a id="idp31519264" class="indexterm"></a><p><code class="literal">assertLessThanOrEqual(misto $esperado, misto $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o valor de <code class="literal">$real</code> não for menor ou igual ao valor de <code class="literal">$esperado</code>.</p><p><code class="literal">assertAttributeLessThanOrEqual()</code> é um empacotador de conveniência que usa um atributo <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto como valor real.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertLessThanOrEqual.example"></a><p class="title"><strong>Exemplo 4.40: Uso de assertLessThanOrEqual()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">MenorOuIgualTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertLessThanOrEqual</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">2</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit MenorOuIgualTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) MenorOuIgualTest::testFalha
Failed asserting that 2 is equal to 1 or is less than 1.

/home/sb/LessThanOrEqualTest.php:6

FAILURES!
Tests: 1, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertNull"></a><code class="literal">assertNull()</code></h3></div></div></div><a id="idp31530336" class="indexterm"></a><a id="idp31531088" class="indexterm"></a><p><code class="literal">assertNull(misto $variavel[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$variavel</code> não for <code class="literal">NULL</code>.</p><p><code class="literal">assertNotNull()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertNull.example"></a><p class="title"><strong>Exemplo 4.41: Uso de assertNull()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">NuloTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertNull</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit NaoNuloTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) NuloTest::testFalha
Failed asserting that 'foo' is null.

/home/sb/NuloTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertObjectHasAttribute"></a><code class="literal">assertObjectHasAttribute()</code></h3></div></div></div><a id="idp31539984" class="indexterm"></a><a id="idp31540736" class="indexterm"></a><p><code class="literal">assertObjectHasAttribute(string $nomeAtributo, objeto $objeto[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$objeto-&gt;nomeAtributo</code> não existir.</p><p><code class="literal">assertObjectNotHasAttribute()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertObjectHasAttribute.example"></a><p class="title"><strong>Exemplo 4.42: Uso de assertObjectHasAttribute()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ObjetoTemAtributoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertObjectHasAttribute</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">stdClass</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ObjetoTemAtributoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) ObjetoTemAtributoTest::testFalha
Failed asserting that object of class "stdClass" has attribute "foo".

/home/sb/ObjetoTemAtributoTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertRegExp"></a><code class="literal">assertRegExp()</code></h3></div></div></div><a id="idp31549472" class="indexterm"></a><a id="idp31550224" class="indexterm"></a><p><code class="literal">assertRegExp(string $padrao, string $string[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$string</code> não combinar com a expressão regular <code class="literal">$padrao</code>.</p><p><code class="literal">assertNotRegExp()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertRegExp.example"></a><p class="title"><strong>Exemplo 4.43: Uso de assertRegExp()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ExpressaoRegularTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertRegExp</span><span class="keyword">(</span><span class="string">'/foo/'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'bar'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ExpressaoRegularTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) ExpressaoRegularTest::testFalha
Failed asserting that 'bar' matches PCRE pattern "/foo/".

/home/sb/ExpressaoRegularTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertStringMatchesFormat"></a><code class="literal">assertStringMatchesFormat()</code></h3></div></div></div><a id="idp31559552" class="indexterm"></a><a id="idp31560304" class="indexterm"></a><p><code class="literal">assertStringMatchesFormat(string $formato, string $string[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se a <code class="literal">$string</code> não combinar com a string <code class="literal">$formato</code>.</p><p><code class="literal">assertStringNotMatchesFormat()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertStringMatchesFormat.example"></a><p class="title"><strong>Exemplo 4.44: Uso de assertStringMatchesFormat()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">StringEquivaleFormatoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertStringMatchesFormat</span><span class="keyword">(</span><span class="string">'%i'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit StringEquivaleFormatoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) StringEquivaleFormatoTest::testFalha
Failed asserting that 'foo' matches PCRE pattern "/^[+-]?\d+$/s".

/home/sb/StringEquivaleFormatoTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>A string de formato pode conter os seguintes espaços reservados:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">%e</code>: Representa um separador de diretório, por exemplo <code class="literal">/</code> no Linux. </p></li><li class="listitem"><p><code class="literal">%s</code>: Um ou mais de qualquer coisa (caractere ou espaço em branco) exceto no último caractere da linha.</p></li><li class="listitem"><p><code class="literal">%S</code>: Zero ou mais de qualquer coisa (caractere ou espaço em branco) exceto no último caractere da linha.</p></li><li class="listitem"><p><code class="literal">%a</code>: Um ou mais de qualquer coisa (caractere ou espaço em branco) inclusive no último caractere da linha.</p></li><li class="listitem"><p><code class="literal">%A</code>: Zero ou mais de qualquer coisa (caractere ou espaço em branco) inclusive no último caractere da linha.</p></li><li class="listitem"><p><code class="literal">%w</code>: Zero ou mais caracteres de espaço em branco.</p></li><li class="listitem"><p><code class="literal">%i</code>: Um valor inteiro sinalizado, por exemplo <code class="literal">+3142</code>, <code class="literal">-3142</code>.</p></li><li class="listitem"><p><code class="literal">%d</code>: Um valor inteiro não-sinalizado, por exemplo <code class="literal">123456</code>.</p></li><li class="listitem"><p><code class="literal">%x</code>: Um ou mais caracteres hexadecimais. Isto é, caracteres dentro de <code class="literal">0-9</code>, <code class="literal">a-f</code>, <code class="literal">A-F</code>.</p></li><li class="listitem"><p><code class="literal">%f</code>: Um número de ponto flutuante, por exemplo: <code class="literal">3.142</code>, <code class="literal">-3.142</code>, <code class="literal">3.142E-10</code>, <code class="literal">3.142e+10</code>.</p></li><li class="listitem"><p><code class="literal">%c</code>: Um caractere único de qualquer tipo.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertStringMatchesFormatFile"></a><code class="literal">assertStringMatchesFormatFile()</code></h3></div></div></div><a id="idp31590224" class="indexterm"></a><a id="idp31590976" class="indexterm"></a><p><code class="literal">assertStringMatchesFormatFile(string $formatoArquivo, string $string[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se a <code class="literal">$string</code> não combinar com os conteúdos de <code class="literal">$formatoArquivo</code>.</p><p><code class="literal">assertStringNotMatchesFormatFile()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertStringMatchesFormatFile.example"></a><p class="title"><strong>Exemplo 4.45: Uso de assertStringMatchesFormatFile()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">StringEquivaleFormatoArquivoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertStringMatchesFormatFile</span><span class="keyword">(</span><span class="string">'/caminho/para/esperado.txt'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit StringEquivaleFormatoArquivoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) StringEquivaleFormatoArquivoTest::testFalha
Failed asserting that 'foo' matches PCRE pattern "/^[+-]?\d+
$/s".

/home/sb/StringEquivaleFormatoArquivoTest.php:6

FAILURES!
Tests: 1, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertSame"></a><code class="literal">assertSame()</code></h3></div></div></div><a id="idp31600544" class="indexterm"></a><a id="idp31601296" class="indexterm"></a><a id="idp31602048" class="indexterm"></a><a id="idp31602800" class="indexterm"></a><p><code class="literal">assertSame(misto $esperado, misto $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se as duas variáveis <code class="literal">$esperado</code> e <code class="literal">$real</code> não tiverem o mesmo tipo e valor.</p><p><code class="literal">assertNotSame()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><p><code class="literal">assertAttributeSame()</code> e <code class="literal">assertAttributeNotSame()</code> são empacotadores de conveniência que usam um atributo <code class="literal">public</code>, <code class="literal">protected</code>, ou <code class="literal">private</code> de uma classe ou objeto como valor real.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertSame.example"></a><p class="title"><strong>Exemplo 4.46: Uso de assertSame()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">IdenticoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSame</span><span class="keyword">(</span><span class="string">'2204'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">2204</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit IdenticoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) IdenticoTest::testFalha
Failed asserting that 2204 is identical to '2204'.

/home/sb/IdenticoTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p><code class="literal">assertSame(objeto $esperado, objeto $real[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se as duas variáveis <code class="literal">$esperado</code> e <code class="literal">$real</code> não referenciarem ao mesmo objeto.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertSame.example2"></a><p class="title"><strong>Exemplo 4.47: Uso de assertSame() with objects</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">IdenticoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSame</span><span class="keyword">(</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">stdClass</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">stdClass</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit IdenticoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 4.75Mb

There was 1 failure:

1) IdenticoTest::testFalha
Failed asserting that two variables reference the same object.

/home/sb/IdenticoTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertSelectCount"></a><code class="literal">assertSelectCount()</code></h3></div></div></div><a id="idp31621280" class="indexterm"></a><p><code class="literal">assertSelectCount(vetor $seletor, inteiro $conta, misto $real[, string $mensagem = '', booleano $ehHtml = TRUE])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o seletor CSS <code class="literal">$seletor</code> não combinar com <code class="literal">$conta</code> elementos no DOMNode <code class="literal">$real</code>.</p><p><code class="literal">$conta</code> pode ser um dos seguintes tipos:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">booleano</code>: assegura para a presença de elementos que batam com seletor (<code class="literal">TRUE</code>) ou falta de elementos (<code class="literal">FALSE</code>).</li><li class="listitem"><code class="literal">integer</code>: assegura a contagem de elementos.</li><li class="listitem"><code class="literal">array</code>: assegura que a contagem está dentro do âmbito especificada ao usar <code class="literal">&lt;</code>, <code class="literal">&gt;</code>, <code class="literal">&lt;=</code>, e <code class="literal">&gt;=</code> como chaves.</li></ul></div><div class="example"><a id="writing-tests-for-phpunit.assertions.assertSelectCount.example"></a><p class="title"><strong>Exemplo 4.48: Uso de assertSelectCount()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">SelecionaContaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DomDocument</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;bar/&gt;&lt;/foo&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testAusenciaFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectCount</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">FALSE</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testPresencaFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectCount</span><span class="keyword">(</span><span class="string">'foo&nbsp;baz'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">TRUE</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testContaExataFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectCount</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">5</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testAmbitoFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectCount</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'&gt;'</span><span class="keyword">=&gt;</span><span class="default">6</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'&lt;'</span><span class="keyword">=&gt;</span><span class="default">8</span><span class="keyword">)</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit SelecionaContaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFFF

Time: 0 seconds, Memory: 5.50Mb

There were 4 failures:

1) SelecionaContaTest::testAusenciaFalha
Failed asserting that true is false.

/home/sb/SelecionaContaTest.php:12

2) SelecionaContaTest::testPresencaFalha
Failed asserting that false is true.

/home/sb/SelecionaContaTest.php:17

3) SelecionaContaTest::testContaExataFalha
Failed asserting that 3 matches expected 5.

/home/sb/SelecionaContaTest.php:22

4) SelecionaContaTest::testAmbitoFalha
Failed asserting that false is true.

/home/sb/SelecionaContaTest.php:27

FAILURES!
Tests: 4, Assertions: 4, Failures: 4.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertSelectEquals"></a><code class="literal">assertSelectEquals()</code></h3></div></div></div><a id="idp31638784" class="indexterm"></a><p><code class="literal">assertSelectEquals(vetor $seletor, string $conteudo, inteiro $conta, misto $real[, string $mensagem = '', booleano $ehHtml = TRUE])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o seletor CSS <code class="literal">$seletor</code> não combinar com <code class="literal">$conta</code> elementos in the DOMNode <code class="literal">$real</code> com o valor <code class="literal">$conteudo</code>.</p><p><code class="literal">$conta</code> pode ser de um dos seguintes tipos:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">boolean</code>: assegura para a presença de elementos que combinam com o seletor (<code class="literal">TRUE</code>) ou falta de elementos (<code class="literal">FALSE</code>).</li><li class="listitem"><code class="literal">integer</code>: assegura a contagem de elementos.</li><li class="listitem"><code class="literal">array</code>: assegura que a contagem está dentro do âmbito especificado ao usar <code class="literal">&lt;</code>, <code class="literal">&gt;</code>, <code class="literal">&lt;=</code>, e <code class="literal">&gt;=</code> como chaves.</li></ul></div><div class="example"><a id="writing-tests-for-phpunit.assertions.assertSelectEquals.example"></a><p class="title"><strong>Exemplo 4.49: Uso de assertSelectEquals()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">SelecionaIgualaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DomDocument</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;&lt;bar&gt;Baz&lt;/bar&gt;&lt;bar&gt;Baz&lt;/bar&gt;&lt;/foo&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testAusenciaFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectEquals</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'Baz'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">FALSE</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testPresencaFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectEquals</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'Bat'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">TRUE</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testContaExataFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectEquals</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'Baz'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">5</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testAmbitoFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectEquals</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'Baz'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'&gt;'</span><span class="keyword">=&gt;</span><span class="default">6</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'&lt;'</span><span class="keyword">=&gt;</span><span class="default">8</span><span class="keyword">)</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit SelecionaIgualaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFFF

Time: 0 seconds, Memory: 5.50Mb

There were 4 failures:

1) SelecionaIgualaTest::testAusenciaFalha
Failed asserting that true is false.

/home/sb/SelecionaIgualaTest.php:12

2) SelecionaIgualaTest::testPresencaFalha
Failed asserting that false is true.

/home/sb/SelecionaIgualaTest.php:17

3) SelecionaIgualaTest::testContaExataFalha
Failed asserting that 2 matches expected 5.

/home/sb/SelecionaIgualaTest.php:22

4) SelecionaIgualaTest::testAmbitoFalha
Failed asserting that false is true.

/home/sb/SelecionaIgualaTest.php:27

FAILURES!
Tests: 4, Assertions: 4, Failures: 4.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertSelectRegExp"></a><code class="literal">assertSelectRegExp()</code></h3></div></div></div><a id="idp31657056" class="indexterm"></a><p><code class="literal">assertSelectRegExp(vetor $seletor, string $padrao, inteiro $conta, misto $real[, string $mensagem = '', booleano $ehHtml = TRUE])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o seletor CSS <code class="literal">$seletor</code> não combinar com <code class="literal">$conta</code> elementos no DOMNode <code class="literal">$real</code> com um valor que combine com <code class="literal">$padrao</code>.</p><p><code class="literal">$conta</code> pode ser de um dos seguintes tipos:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">boolean</code>: assegura para a presença de elementos que combinem com o seletor (<code class="literal">TRUE</code>) ou falta de elementos (<code class="literal">FALSE</code>).</li><li class="listitem"><code class="literal">integer</code>: assegura a contagem de elementos.</li><li class="listitem"><code class="literal">array</code>: assegura que a contagem está dentro do âmbito especificada ao usar <code class="literal">&lt;</code>, <code class="literal">&gt;</code>, <code class="literal">&lt;=</code>, e <code class="literal">&gt;=</code> como chaves.</li></ul></div><div class="example"><a id="writing-tests-for-phpunit.assertions.assertSelectRegExp.example"></a><p class="title"><strong>Exemplo 4.50: Uso de assertSelectRegExp()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">SelecionaExpressaoRegularTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">DomDocument</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">-&gt;</span><span class="default">loadXML</span><span class="keyword">(</span><span class="string">'&lt;foo&gt;&lt;bar&gt;Baz&lt;/bar&gt;&lt;bar&gt;Baz&lt;/bar&gt;&lt;/foo&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testAusenciaFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectRegExp</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'/Ba.*/'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">FALSE</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testPresencaFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectRegExp</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'/B[oe]z]/'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">TRUE</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testContaExataFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectRegExp</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'/Ba.*/'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">5</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testAmbitoFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSelectRegExp</span><span class="keyword">(</span><span class="string">'foo&nbsp;bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'/Ba.*/'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'&gt;'</span><span class="keyword">=&gt;</span><span class="default">6</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'&lt;'</span><span class="keyword">=&gt;</span><span class="default">8</span><span class="keyword">)</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">xml</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit SelecionaExpressaoRegularTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

FFFF

Time: 0 seconds, Memory: 5.50Mb

There were 4 failures:

1) SelecionaExpressaoRegularTest::testAusenciaFalha
Failed asserting that true is false.

/home/sb/SelecionaExpressaoRegularTest.php:12

2) SelecionaExpressaoRegularTest::testPresencaFalha
Failed asserting that false is true.

/home/sb/SelecionaExpressaoRegularTest.php:17

3) SelecionaExpressaoRegularTest::testContaExataFalha
Failed asserting that 2 matches expected 5.

/home/sb/SelecionaExpressaoRegularTest.php:22

4) SelecionaExpressaoRegularTest::testAmbitoFalha
Failed asserting that false is true.

/home/sb/SelecionaExpressaoRegularTest.php:27

FAILURES!
Tests: 4, Assertions: 4, Failures: 4.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertStringEndsWith"></a><code class="literal">assertStringEndsWith()</code></h3></div></div></div><a id="idp31675600" class="indexterm"></a><a id="idp31676352" class="indexterm"></a><p><code class="literal">assertStringEndsWith(string $sufixo, string $string[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se a <code class="literal">$string</code> não terminar com <code class="literal">$sufixo</code>.</p><p><code class="literal">assertStringEndsNotWith()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertStringEndsWith.example"></a><p class="title"><strong>Exemplo 4.51: Uso de assertStringEndsWith()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">StringTerminaComTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertStringEndsWith</span><span class="keyword">(</span><span class="string">'sufixo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit StringTerminaComTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 1 second, Memory: 5.00Mb

There was 1 failure:

1) StringTerminaComTest::testFalha
Failed asserting that 'foo' ends with "sufixo".

/home/sb/StringTerminaComTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertStringEqualsFile"></a><code class="literal">assertStringEqualsFile()</code></h3></div></div></div><a id="idp31685696" class="indexterm"></a><a id="idp31686448" class="indexterm"></a><p><code class="literal">assertStringEqualsFile(string $arquivoEsperado, string $stringReal[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o arquivo especificado por <code class="literal">$arquivoEsperado</code> não tiver <code class="literal">$stringReal</code> como seu conteúdo.</p><p><code class="literal">assertStringNotEqualsFile()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertStringEqualsFile.example"></a><p class="title"><strong>Exemplo 4.52: Uso de assertStringEqualsFile()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">StringIgualaArquivoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertStringEqualsFile</span><span class="keyword">(</span><span class="string">'/home/sb/esperado'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'real'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit StringIgualaArquivoTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) StringIgualaArquivoTest::testFalha
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'esperado
-'
+'real'

/home/sb/StringIgualaArquivoTest.php:6

FAILURES!
Tests: 1, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertStringStartsWith"></a><code class="literal">assertStringStartsWith()</code></h3></div></div></div><a id="idp31695840" class="indexterm"></a><a id="idp31696592" class="indexterm"></a><p><code class="literal">assertStringStartsWith(string $prefixo, string $string[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se a <code class="literal">$string</code> não começar com <code class="literal">$prefixo</code>.</p><p><code class="literal">assertStringStartsNotWith()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertStringStartsWith.example"></a><p class="title"><strong>Exemplo 4.53: Uso de assertStringStartsWith()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">StringComecaComTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertStringStartsWith</span><span class="keyword">(</span><span class="string">'prefixo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit StringComecaComTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) StringComecaComTest::testFalha
Failed asserting that 'foo' starts with "prefixo".

/home/sb/StringComecaComTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertTag"></a><code class="literal">assertTag()</code></h3></div></div></div><a id="idp31705856" class="indexterm"></a><a id="idp31706608" class="indexterm"></a><p><code class="literal">assertTag(vetor $equiparador, string $real[, string $mensagem = '', booleano $ehHtml = TRUE])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$real</code> não combinar com <code class="literal">$equiparador</code>.</p><p><code class="literal">$equiparador</code> é um vetor associativo que especifica o critério de combinação para a asserção:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">id</code>: O nó com o atributo <code class="literal">id</code> fornecido que deve combinar com o valor correspondente.</li><li class="listitem"><code class="literal">tag</code>: O tipo de nó deve combinar com o valor correspondente.</li><li class="listitem"><code class="literal">attributes</code>: O atributo do nó deve combinar com o valor correspondente no vetor associativo <code class="literal">$atributos</code>.</li><li class="listitem"><code class="literal">content</code>: O conteúdo do texto deve combinar com o valor fornecido.</li><li class="listitem"><code class="literal">parent</code>: O pai do nó deve combinar com o vetor associativo <code class="literal">$pai</code>.</li><li class="listitem"><code class="literal">child</code>: Pelo menos um dos filhos imediatos do nó deve combinar com o critério descrito no vetor associativo <code class="literal">$filho</code>.</li><li class="listitem"><code class="literal">ancestor</code>: Pelo menos um dos ancestrais do nó deve combinar com o critério descrito pelo vetor associativo <code class="literal">$ancestral</code>.</li><li class="listitem"><code class="literal">descendant</code>: Pelo menos um dos ancestrais do nó deve combinar com o critério descrito pelo vetor associativo <code class="literal">$descendente</code>.</li><li class="listitem"><code class="literal">children</code>: vetor associativo para contagem de filhos de um nó.
          <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><code class="literal">count</code>: O número de filhos que combinam deve ser igual a este número.</li><li class="listitem"><code class="literal">less_than</code>: O número de filhos que combinam deve ser menor que este número.</li><li class="listitem"><code class="literal">greater_than</code>: O número de filhos que combinam deve ser maior que este número.</li><li class="listitem"><code class="literal">only</code>: Outro vetor associativo que consiste de chaves a serem usadas para combinar em um filho, e apenas filhos que combinem serão contados.</li></ul></div></li></ul></div><p><code class="literal">assertNotTag()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertTag.example"></a><p class="title"><strong>Exemplo 4.54: Uso de assertTag()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="comment">//&nbsp;Equiparador&nbsp;que&nbsp;assegura&nbsp;que&nbsp;há&nbsp;um&nbsp;elemento&nbsp;com&nbsp;uma&nbsp;id=&quot;minha_id&quot;.</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'id'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'minha_id'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Equiparador&nbsp;que&nbsp;assegura&nbsp;que&nbsp;há&nbsp;uma&nbsp;tag&nbsp;&quot;span&quot;.</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'span'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Equiparador&nbsp;que&nbsp;assegura&nbsp;que&nbsp;há&nbsp;uma&nbsp;tag&nbsp;&quot;span&quot;&nbsp;com&nbsp;o&nbsp;conteúdo</span><br /><span class="comment">//&nbsp;&quot;Olá&nbsp;Mundo&quot;.</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'span'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'content'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'Hello&nbsp;World'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Equiparador&nbsp;que&nbsp;assegura&nbsp;que&nbsp;há&nbsp;uma&nbsp;tag&nbsp;&quot;span&quot;&nbsp;com&nbsp;o&nbsp;conteúdo</span><br /><span class="comment">//&nbsp;correspondendo&nbsp;ao&nbsp;padrão&nbsp;da&nbsp;expressão&nbsp;regular</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'span'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'content'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'regexp:/Try&nbsp;P(HP|ython)/'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Equiparador&nbsp;que&nbsp;assegura&nbsp;que&nbsp;há&nbsp;um&nbsp;&quot;span&quot;&nbsp;com&nbsp;um&nbsp;atributo&nbsp;de</span><br /><span class="comment">//&nbsp;classe&nbsp;&quot;list&quot;.</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'span'</span><span class="keyword">,</span><br /><span class="string">'attributes'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'class'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'list'</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Equiparador&nbsp;que&nbsp;assegura&nbsp;que&nbsp;há&nbsp;um&nbsp;&quot;span&quot;&nbsp;dentro&nbsp;de&nbsp;uma&nbsp;&quot;div&quot;.</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'span'</span><span class="keyword">,</span><br /><span class="string">'parent'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'div'</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Equiparador&nbsp;que&nbsp;assegura&nbsp;que&nbsp;há&nbsp;um&nbsp;&quot;span&quot;&nbsp;em&nbsp;algum&nbsp;lugar&nbsp;dentro</span><br /><span class="comment">//&nbsp;de&nbsp;uma&nbsp;&quot;table&quot;.</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'span'</span><span class="keyword">,</span><br /><span class="string">'ancestor'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'table'</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Equiparador&nbsp;que&nbsp;assegura&nbsp;que&nbsp;há&nbsp;um&nbsp;&quot;span&quot;&nbsp;com&nbsp;pelo&nbsp;menos&nbsp;um</span><br /><span class="comment">//&nbsp;filho&nbsp;&quot;em&quot;.</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'span'</span><span class="keyword">,</span><br /><span class="string">'child'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'em'</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Equiparador&nbsp;ue&nbsp;assegura&nbsp;que&nbsp;há&nbsp;um&nbsp;&quot;span&quot;&nbsp;contendo&nbsp;uma</span><br /><span class="comment">//&nbsp;(possivelmente&nbsp;aninhada)&nbsp;tag&nbsp;&quot;strong&quot;.</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'span'</span><span class="keyword">,</span><br /><span class="string">'descendant'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'strong'</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Equiparador&nbsp;que&nbsp;assegura&nbsp;que&nbsp;há&nbsp;um&nbsp;&quot;span&quot;&nbsp;contendo&nbsp;5-10&nbsp;tags</span><br /><span class="comment">//&nbsp;&quot;em&quot;&nbsp;como&nbsp;filhos&nbsp;imediatos.</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'span'</span><span class="keyword">,</span><br /><span class="string">'children'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'less_than'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="default">11</span><span class="keyword">,</span><br /><span class="string">'greater_than'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="default">4</span><span class="keyword">,</span><br /><span class="string">'only'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'em'</span><span class="keyword">)</span><br /><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Equiparador&nbsp;que&nbsp;assegura&nbsp;que&nbsp;há&nbsp;uma&nbsp;&quot;div&quot;,&nbsp;com&nbsp;um&nbsp;ancestral&nbsp;&quot;ul&quot;</span><br /><span class="comment">//&nbsp;e&nbsp;um&nbsp;pai&nbsp;&quot;li&quot;&nbsp;(com&nbsp;class=&quot;enum&quot;),&nbsp;e&nbsp;contendo&nbsp;um&nbsp;descendente&nbsp;&quot;span&quot;</span><br /><span class="comment">//&nbsp;que&nbsp;contém&nbsp;um&nbsp;elemento&nbsp;com&nbsp;id=&quot;meu_teste&quot;&nbsp;e&nbsp;o&nbsp;texto&nbsp;&quot;Olá&nbsp;Mundo&quot;.</span><br /><span class="default">$equiparador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'div'</span><span class="keyword">,</span><br /><span class="string">'ancestor'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'ul'</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="string">'parent'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'li'</span><span class="keyword">,</span><br /><span class="string">'attributes'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'class'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'enum'</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">,</span><br /><span class="string">'descendant'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'tag'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'span'</span><span class="keyword">,</span><br /><span class="string">'child'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'id'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'my_test'</span><span class="keyword">,</span><br /><span class="string">'content'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'Hello&nbsp;World'</span><br /><span class="keyword">)</span><br /><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Use&nbsp;assertTag()&nbsp;para&nbsp;aplicar&nbsp;um&nbsp;$equiparador&nbsp;a&nbsp;um&nbsp;pedaço&nbsp;do&nbsp;$html.</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTag</span><span class="keyword">(</span><span class="default">$equiparador</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$html</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Use&nbsp;assertTag()&nbsp;para&nbsp;aplicar&nbsp;um&nbsp;$equiparador&nbsp;a&nbsp;um&nbsp;pedaço&nbsp;do&nbsp;$xml.</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTag</span><span class="keyword">(</span><span class="default">$equiparador</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$xml</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">''</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">FALSE</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertThat"></a><code class="literal">assertThat()</code></h3></div></div></div><a id="idp31733344" class="indexterm"></a><p>
        Asserções mais complexas podem ser formuladas usando a classe
        <code class="literal">PHPUnit_Framework_Constraint</code>. Elas podem ser avaliados usando o método <code class="literal">assertThat()</code>.
        <a class="xref" href="#writing-tests-for-phpunit.assertions.assertThat.example" title="Exemplo 4.55: Uso de assertThat()">Exemplo 4.55</a> mostra como as restrições
        <code class="literal">logicalNot()</code> e <code class="literal">equalTo()</code>
        podem ser usados para expressar a mesma asserção que
        <code class="literal">assertNotEquals()</code>.
      </p><p><code class="literal">assertThat(misto $valor, PHPUnit_Framework_Constraint $restricao[, $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o <code class="literal">$valor</code> não combinar com <code class="literal">$restricao</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertThat.example"></a><p class="title"><strong>Exemplo 4.55: Uso de assertThat()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">BiscoitoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testEquals</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$oBiscoito</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Biscoito</span><span class="keyword">(</span><span class="string">'Gengibre'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$meuBiscoito</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Biscoito</span><span class="keyword">(</span><span class="string">'Gengibre'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertThat</span><span class="keyword">(</span><br /><span class="default">$oBiscoito</span><span class="keyword">,</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">logicalNot</span><span class="keyword">(</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">equalTo</span><span class="keyword">(</span><span class="default">$meuBiscoito</span><span class="keyword">)</span><br /><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
        <a class="xref" href="#writing-tests-for-phpunit.assertions.assertThat.tables.constraints" title="Tabela 4.3. Restrições">Tabela 4.3</a> mostra as classes <code class="literal">PHPUnit_Framework_Constraint</code> disponíveis.
      </p><div class="table"><a id="writing-tests-for-phpunit.assertions.assertThat.tables.constraints"></a><p class="title"><strong>Tabela 4.3. Restrições</strong></p><div class="table-contents"><table summary="Restrições" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Restrição</th><th align="left">Significado</th></tr></thead><tbody><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_Attribute attribute(PHPUnit_Framework_Constraint $restricao, $nomeAtributo)</code></td><td align="left">Restrição que aplica outro restritor a um atributo de uma classe ou objeto.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsAnything anything()</code></td><td align="left">Restrição que aceita a inserção de qualquer valor.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_ArrayHasKey arrayHasKey(misto $chave)</code></td><td align="left">Restrição que assegura que o vetor avaliado possui a chave fornecida.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_TraversableContains contains(misto $valor)</code></td><td align="left">Restrição que assegura que o <code class="literal">vetor</code> ou objeto que implementa a interface <code class="literal">Iterator</code> é avaliado por conter apenas um valor fornecido.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_TraversableContainsOnly containsOnly(string $tipo)</code></td><td align="left">Restrição que assegura que o <code class="literal">vetor</code> ou objeto que implementa a interface <code class="literal">Iterator</code> é avaliado por conter apenas os valores de um tipo fornecido.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_TraversableContainsOnly containsOnlyInstancesOf(string $nomeclasse)</code></td><td align="left">Restrição que assegura que o <code class="literal">array</code> ou objeto que implementa a interface <code class="literal">Iterator</code> é avaliado por conter apenas instâncias de um nome de classe fornecido.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsEqual equalTo($valor, $delta = 0, $profundidadeMaxima = 10)</code></td><td align="left">Restrição que verifica se um valor é igual a outro.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_Attribute attributeEqualTo($nomeAtributo, $valor, $delta = 0, $profundidadeMaxima = 10)</code></td><td align="left">Restrição que verifica se um valor é igual a um atributo de uma classe ou de um objeto.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_FileExists fileExists()</code></td><td align="left">Restrição que verifica se existe o arquivo(nome) que é avaliado.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_GreaterThan greaterThan(misto $valor)</code></td><td align="left">Restrição que assegura que o valor avaliado é maior que um valor fornecido.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_Or greaterThanOrEqual(misto $valor)</code></td><td align="left">Restrição que assegura que o valor avaliado é maior ou igual a um valor fornecido.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_ClassHasAttribute classHasAttribute(string $nomeAtributo)</code></td><td align="left">Restrição que assegura que a classe que é avaliada possui um atributo fornecido.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_ClassHasStaticAttribute classHasStaticAttribute(string $nomeAtributo)</code></td><td align="left">Restrição que assegura que a classe avaliada possui um atributo estático fornecido.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_ObjectHasAttribute hasAttribute(string $nomeAtributo)</code></td><td align="left">Restrição que assegura que o objeto avaliado possui um atributo fornecido.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsIdentical identicalTo(misto $valor)</code></td><td align="left">Restrição que assegura que um valor é idêntico a outro.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsFalse isFalse()</code></td><td align="left">Restrição que assegura que o valor avaliado é <code class="literal">FALSE</code>.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsInstanceOf isInstanceOf(string $nomeClasse)</code></td><td align="left">Restrição que assegura que o objeto avaliado é uma instância de uma classe fornecida.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsNull isNull()</code></td><td align="left">Restrição que assegura que o valor avaliado é <code class="literal">NULL</code>.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsTrue isTrue()</code></td><td align="left">Restrição que assegura que o valor avaliado é <code class="literal">TRUE</code>.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_IsType isType(string $tipo)</code></td><td align="left">Restrição que assegura que o valor avaliado é de um tipo especificado.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_LessThan lessThan(misto $valor)</code></td><td align="left">Restrição que assegura que o valor avaliado é menor que um valor fornecido.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_Or lessThanOrEqual(misto $valor)</code></td><td align="left">Restrição que assegura que o valor avaliado é menor ou igual a um valor fornecido.</td></tr><tr><td align="left"><code class="literal">logicalAnd()</code></td><td align="left">AND lógico.</td></tr><tr><td align="left"><code class="literal">logicalNot(PHPUnit_Framework_Constraint $restricao)</code></td><td align="left">NOT lógico.</td></tr><tr><td align="left"><code class="literal">logicalOr()</code></td><td align="left">OR lógico.</td></tr><tr><td align="left"><code class="literal">logicalXor()</code></td><td align="left">XOR lógico.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_PCREMatch matchesRegularExpression(string $padrao)</code></td><td align="left">Restrição que assegura que a string avaliada combina com uma expressão regular.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_StringContains stringContains(string $string, booleano $case)</code></td><td align="left">Restrição que assegura que a string avaliada contém uma string fornecida.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_StringEndsWith stringEndsWith(string $sufixo)</code></td><td align="left">Restrição que assegura que a string avaliada termina com um sufixo fornecido.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_Constraint_StringStartsWith stringStartsWith(string $prefixo)</code></td><td align="left">Restrição que assegura que a string avaliada começa com um prefixo fornecido.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertTrue"></a><code class="literal">assertTrue()</code></h3></div></div></div><a id="idp31833568" class="indexterm"></a><p><code class="literal">assertTrue(booleano $condicao[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se <code class="literal">$condicao</code> is <code class="literal">FALSE</code>.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertTrue.example"></a><p class="title"><strong>Exemplo 4.56: Uso de assertTrue()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">VerdadeiroTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">FALSE</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit VerdadeiroTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) VerdadeiroTest::testFalha
Failed asserting that false is true.

/home/sb/VerdadeiroTest.php:6

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertXmlFileEqualsXmlFile"></a><code class="literal">assertXmlFileEqualsXmlFile()</code></h3></div></div></div><a id="idp31841616" class="indexterm"></a><a id="idp31842368" class="indexterm"></a><p><code class="literal">assertXmlFileEqualsXmlFile(string $arquivoEsperado, string $arquivoReal[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o documento XML em <code class="literal">$arquivoReal</code> não for igual ao documento XML em <code class="literal">$arquivoEsperado</code>.</p><p><code class="literal">assertXmlFileNotEqualsXmlFile()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertXmlFileEqualsXmlFile.example"></a><p class="title"><strong>Exemplo 4.57: Uso de assertXmlFileEqualsXmlFile()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ArquivoXmlIgualaArquivoXmlTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertXmlFileEqualsXmlFile</span><span class="keyword">(</span><br /><span class="string">'/home/sb/esperado.xml'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'/home/sb/real.xml'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ArquivoXmlIgualaArquivoXmlTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) ArquivoXmlIgualaArquivoXmlTest::testFalha
Failed asserting that two DOM documents are equal.
--- Expected
+++ Actual
@@ @@
&lt;?xml version="1.0"?&gt;
&lt;foo&gt;
- &lt;bar/&gt;
+ &lt;baz/&gt;
&lt;/foo&gt;

/home/sb/ArquivoXmlIgualaArquivoXmlTest.php:7

FAILURES!
Tests: 1, Assertions: 3, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlFile"></a><code class="literal">assertXmlStringEqualsXmlFile()</code></h3></div></div></div><a id="idp31851984" class="indexterm"></a><a id="idp31852736" class="indexterm"></a><p><code class="literal">assertXmlStringEqualsXmlFile(string $arquivoEsperado, string $xmlReal[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o documento XML em <code class="literal">$xmlReal</code> não for igual ao documento XML em <code class="literal">$arquivoEsperado</code>.</p><p><code class="literal">assertXmlStringNotEqualsXmlFile()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlFile.example"></a><p class="title"><strong>Exemplo 4.58: Uso de assertXmlStringEqualsXmlFile()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">StringXmlIgualaArquivoXmlTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertXmlStringEqualsXmlFile</span><span class="keyword">(</span><br /><span class="string">'/home/sb/esperado.xml'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'&lt;foo&gt;&lt;baz/&gt;&lt;/foo&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit StringXmlIgualaArquivoXmlTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) StringXmlIgualaArquivoXmlTest::testFalha
Failed asserting that two DOM documents are equal.
--- Expected
+++ Actual
@@ @@
&lt;?xml version="1.0"?&gt;
&lt;foo&gt;
- &lt;bar/&gt;
+ &lt;baz/&gt;
&lt;/foo&gt;

/home/sb/StringXmlIgualaArquivoXmlTest.php:7

FAILURES!
Tests: 1, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlString"></a><code class="literal">assertXmlStringEqualsXmlString()</code></h3></div></div></div><a id="idp31862480" class="indexterm"></a><a id="idp31863232" class="indexterm"></a><p><code class="literal">assertXmlStringEqualsXmlString(string $xmlEsperado, string $xmlReal[, string $mensagem = ''])</code></p><p>Relata um erro identificado por <code class="literal">$mensagem</code> se o documento XML em <code class="literal">$xmlReal</code> não for igual ao documento XML em <code class="literal">$xmlEsperado</code>.</p><p><code class="literal">assertXmlStringNotEqualsXmlString()</code> é o inverso desta asserção e recebe os mesmos argumentos.</p><div class="example"><a id="writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlString.example"></a><p class="title"><strong>Exemplo 4.59: Uso de assertXmlStringEqualsXmlString()</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">StringXmlIgualaStringXmlTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testFalha</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertXmlStringEqualsXmlString</span><span class="keyword">(</span><br /><span class="string">'&lt;foo&gt;&lt;bar/&gt;&lt;/foo&gt;'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'&lt;foo&gt;&lt;baz/&gt;&lt;/foo&gt;'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit StringXmlIgualaStringXmlTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.00Mb

There was 1 failure:

1) StringXmlIgualaStringXmlTest::testFalha
Failed asserting that two DOM documents are equal.
--- Expected
+++ Actual
@@ @@
&lt;?xml version="1.0"?&gt;
&lt;foo&gt;
- &lt;bar/&gt;
+ &lt;baz/&gt;
&lt;/foo&gt;

/home/sb/StringXmlIgualaStringXmlTest.php:7

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="writing-tests-for-phpunit.error-output"></a>Saída de Erro</h2></div></div></div><p>
      Sempre que um teste falha o PHPUnit faz o melhor para fornecer a você o máximo possível de conteúdo que possa ajudar a identificar o problema.
    </p><div class="example"><a id="writing-tests-for-phpunit.error-output.examples.VetorDifereTest.php"></a><p class="title"><strong>Exemplo 4.60: Saída de erro gerada quando uma comparação de vetores falha</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">VetorDifereTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testIgualdade</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="default">&nbsp;</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">33</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit VetorDifereTest</code></strong>
PHPUnit 3.6.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) VetorDifereTest::testIgualdade
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
Array (
0 =&gt; 1
1 =&gt; 2
- 2 =&gt; 3
+ 2 =&gt; 33
3 =&gt; 4
4 =&gt; 5
5 =&gt; 6
)

/home/sb/VetorDifereTest.php:7

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
      Neste exemplo apenas um dos valores dos vetores diferem e os outros valores são exibidos para fornecer o contexto em que o erro ocorreu.
    </p><p>
      Quando a saída gerada for longa demais para ler o PHPUnit vai quebrá-la e fornecer algumas linhas de contexto ao redor de cada diferença.
    </p><div class="example"><a id="writing-tests-for-phpunit.error-output.examples.VetorLongoDifereTest.php"></a><p class="title"><strong>Exemplo 4.61: Saída de erro quando uma comparação de um vetor longo falha</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">VetorLongoDifereTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testIgualdade</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="default">&nbsp;</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">0</span><span class="keyword">,</span><span class="default">1</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">33</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit VetorLongoDifereTest</code></strong>
PHPUnit 3.6.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) VetorLongoDifereTest::testIgualdade
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
13 =&gt; 2
- 14 =&gt; 3
+ 14 =&gt; 33
15 =&gt; 4
16 =&gt; 5
17 =&gt; 6
)


/home/sb/VetorLongoDifereTest.php:7

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="writing-tests-for-phpunit.error-output.edge-cases"></a>Casos Extremos</h3></div></div></div><p>
        Quando uma comparação falha o PHPUnit cria uma representação textual da entrada de valores e as compara. Devido a essa implementação uma diferenciação pode mostrar mais problemas do que realmente existem.
      </p><p>
        Isso só acontece quando se usa assertEquals ou outra função 'fraca' de comparação em vetores ou objetos.
      </p><div class="example"><a id="writing-tests-for-phpunit.error-output.edge-cases.examples.ComparacaoFracaVetorTest.php"></a><p class="title"><strong>Exemplo 4.62: Caso extremo na geração de uma diferenciação quando se usa uma comparação fraca</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ComparacaoFracaVetorTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testIgualdade</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="default">1</span><span class="default">&nbsp;</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">3</span><span class="default">&nbsp;</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="string">'1'</span><span class="keyword">,</span><span class="default">2</span><span class="keyword">,</span><span class="default">33</span><span class="keyword">,</span><span class="default">4</span><span class="keyword">,</span><span class="default">5</span><span class="keyword">,</span><span class="default">6</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit ComparacaoFracaVetorTest</code></strong>
PHPUnit 3.6.0 by Sebastian Bergmann.

F

Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) ComparacaoFracaVetorTest::testIgualdade
Failed asserting that two arrays are equal.
--- Expected
+++ Actual
@@ @@
Array (
- 0 =&gt; 1
+ 0 =&gt; '1'
1 =&gt; 2
- 2 =&gt; 3
+ 2 =&gt; 33
3 =&gt; 4
4 =&gt; 5
5 =&gt; 6
)


/home/sb/ComparacaoFracaVetorTest.php:7

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
        Neste exemplo a diferença no primeiro índice entre
        <code class="literal">1</code> e <code class="literal">'1'</code> é relatada ainda que o assertEquals considere os valores como uma combinação.
      </p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="textui"></a>Capítulo 5. O executor de testes em linha-de-comando</h1></div></div></div><p>
    O executor de testes em linha-de-comando do PHPUnit pode ser invocado através do comando
    <code class="filename">phpunit</code> O código seguinte mostra como executar testes com o executor de testes em linha-de-comando do PHPUnit:
  </p><pre class="screen"><strong class="userinput"><code>phpunit VetorTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

..

Time: 0 seconds


OK (2 tests, 2 assertions)</pre><p>
    Para cada teste executado, a ferramenta de linha-de-comando do PHPUnit imprime um caractere para indicar progresso:
  </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">.</code></span></dt><dd><p>
          Impresso quando um teste é bem sucedido.
        </p></dd><dt><span class="term"><code class="literal">F</code></span></dt><dd><p>
          Impresso quando uma asserção falha enquanto o método de teste executa.
        </p></dd><dt><span class="term"><code class="literal">E</code></span></dt><dd><p>
          Impresso quando um erro ocorre enquanto o método de teste executa.
        </p></dd><dt><span class="term"><code class="literal">S</code></span></dt><dd><p>
          Impresso quando o teste é pulado (veja
          <a class="xref" href="#incomplete-and-skipped-tests" title="Capítulo 9. Testes Incompletos e Pulados">Capítulo 9</a>).
        </p></dd><dt><span class="term"><code class="literal">I</code></span></dt><dd><p>
          Impresso quando o teste é marcado como incompleto ou ainda não implementado (veja <a class="xref" href="#incomplete-and-skipped-tests" title="Capítulo 9. Testes Incompletos e Pulados">Capítulo 9</a>).
        </p></dd></dl></div><p>
    <a id="idp32757648" class="indexterm"></a>
    <a id="idp32758464" class="indexterm"></a>

    O PHPUnit distingue entre <span class="emphasis"><em>falhas</em></span> e
    <span class="emphasis"><em>erros</em></span>. Uma falha é uma asserção violada do PHPUnit assim como uma chamada falha ao <code class="literal">assertEquals()</code>.
    Um erro é uma exceção inesperada ou um erro do PHP. Às vezes essa distinção se mostra útil já que erros tendem a ser mais fáceis de consertar do que falhas. Se você tiver uma grande lista de problemas, é melhor enfrentar os erros primeiro e ver se quaisquer falhas continuam depois de todos consertados.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="textui.clioptions"></a>Comutadores de linha-de-comando</h2></div></div></div><p>
      Vamos dar uma olhada nas comutadores do executor de testes em linha-de-comando, no código seguinte:
    </p><pre class="screen"><strong class="userinput"><code>phpunit --help</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

Usage: phpunit [switches] UnitTest [UnitTest.php]
phpunit [switches] &lt;directory&gt;

--log-junit &lt;file&gt; Log test execution in JUnit XML format to file.
--log-tap &lt;file&gt; Log test execution in TAP format to file.
--log-json &lt;file&gt; Log test execution in JSON format.

--coverage-clover &lt;file&gt; Generate code coverage report in Clover XML format.
--coverage-html &lt;dir&gt; Generate code coverage report in HTML format.
--coverage-php &lt;file&gt; Serialize PHP_CodeCoverage object to file.
--coverage-text=&lt;file&gt; Generate code coverage report in text format.
Default to writing to the standard output.

--testdox-html &lt;file&gt; Write agile documentation in HTML format to file.
--testdox-text &lt;file&gt; Write agile documentation in Text format to file.

--filter &lt;pattern&gt; Filter which tests to run.
--group ... Only runs tests from the specified group(s).
--exclude-group ... Exclude tests from the specified group(s).
--list-groups List available test groups.

--loader &lt;loader&gt; TestSuiteLoader implementation to use.
--printer &lt;printer&gt; TestSuiteListener implementation to use.
--repeat &lt;times&gt; Runs the test(s) repeatedly.

--tap Report test execution progress in TAP format.
--testdox Report test execution progress in TestDox format.

--colors Use colors in output.
--stderr Write to STDERR instead of STDOUT.
--stop-on-error Stop execution upon first error.
--stop-on-failure Stop execution upon first error or failure.
--stop-on-skipped Stop execution upon first skipped test.
--stop-on-incomplete Stop execution upon first incomplete test.
--strict Run tests in strict mode.
-v|--verbose Output more verbose information.
--debug Display debbuging information during test execution.

--process-isolation Run each test in a separate PHP process.
--no-globals-backup Do not backup and restore $GLOBALS for each test.
--static-backup Backup and restore static attributes for each test.

--bootstrap &lt;file&gt; A "bootstrap" PHP file that is run before the tests.
-c|--configuration &lt;file&gt; Read configuration from XML file.
--no-configuration Ignore default configuration file (phpunit.xml).
--include-path &lt;path(s)&gt; Prepend PHP's include_path with given path(s).
-d key[=value] Sets a php.ini value.

-h|--help Prints this usage information.
--version Prints the version and exits.

--debug Output debugging information.</pre><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">phpunit UnitTest</code></span></dt><dd><p>
            Executa os testes que são fornecidos pela classe
            <code class="literal">UnitTest</code>. Espera-se que essa classe seja declarada no arquivo-fonte <code class="filename">UnitTest.php</code>.
          </p><p>
            <code class="literal">UnitTest</code> deve ser ou uma classe que herda de <code class="literal">PHPUnit_Framework_TestCase</code> ou uma classe que fornece um método <code class="literal">public static suite()</code> que retorna um objeto <code class="literal">PHPUnit_Framework_Test</code>, por exemplo uma instância da classe
            <code class="literal">PHPUnit_Framework_TestSuite</code>.
          </p></dd><dt><span class="term"><code class="literal">phpunit UnitTest UnitTest.php</code></span></dt><dd><p>
            Executa os testes fornecidos pela classe
            <code class="literal">UnitTest</code>. Espera-se que esta classe seja declarada no arquivo-fonte especificado.
          </p></dd><dt><span class="term"><code class="literal">--log-junit</code></span></dt><dd><p>
            Gera um arquivo de registro no formato Junit XML para a execução dos testes. Veja <a class="xref" href="#logging" title="Capítulo 18. Registrando">Capítulo 18</a> for more details.
          </p></dd><dt><span class="term"><code class="literal">--log-tap</code></span></dt><dd><p>
            Gera um arquivo de registro usando o formato <a class="ulink" href="http://testanything.org/" target="_top">Test Anything Protocol (TAP)</a>para a execução dos testes. Veja <a class="xref" href="#logging" title="Capítulo 18. Registrando">Capítulo 18</a> para mais detalhes.
          </p></dd><dt><span class="term"><code class="literal">--log-json</code></span></dt><dd><p>
            Gera um arquivo de registro usando o formato
            <a class="ulink" href="http://www.json.org/" target="_top">JSON</a>. Veja <a class="xref" href="#logging" title="Capítulo 18. Registrando">Capítulo 18</a> para mais detalhes.
          </p></dd><dt><span class="term"><code class="literal">--coverage-html</code></span></dt><dd><p>
            Gera um relatório de cobertura de código no formato HTML. Veja
            <a class="xref" href="#code-coverage-analysis" title="Capítulo 14. Análise de Cobertura de Código">Capítulo 14</a> para mais detalhes.
          </p><p>
            Por favor note que esta funcionalidade só está disponível quando as extensões tokenizer e Xdebug estão instaladas.
          </p></dd><dt><span class="term"><code class="literal">--coverage-clover</code></span></dt><dd><p>
            Gera um arquivo de registro no formato XML com a informação sobre a cobertura de código da execução dos testes. Veja <a class="xref" href="#logging" title="Capítulo 18. Registrando">Capítulo 18</a> para mais detalhes.
          </p><p>
            Por favor note que essa funcionalidade só está disponível quando as extensões tokenizer e Xdebug estão instaladas.
          </p></dd><dt><span class="term"><code class="literal">--coverage-php</code></span></dt><dd><p>
            Gera um objeto serializado PHP_CodeCoverage com a informação da cobertura de código.
          </p><p>
            Por favor note que essa funcionalidade só está disponível quando as extensões tokenizer e Xdebug estão instaladas.
          </p></dd><dt><span class="term"><code class="literal">--coverage-text</code></span></dt><dd><p>
            Gera um arquivo de registro ou saída em linha-de-comando em um formato humanamente legível com a informação de cobertura de código da execução dos testes. Veja <a class="xref" href="#logging" title="Capítulo 18. Registrando">Capítulo 18</a> para mais detalhes.
          </p><p>
            Por favor note que essa funcionalidade só está disponível quando as extensões tokenizer e Xdebug estão instaladas.
          </p></dd><dt><span class="term"><code class="literal">--testdox-html</code> e <code class="literal">--testdox-text</code></span></dt><dd><p>
            Gera documentação ágil em formato HTML ou texto plano para os testes que são executados. Veja <a class="xref" href="#other-uses-for-tests" title="Capítulo 15. Outros Usos para Testes">Capítulo 15</a> para mais detalhes.
          </p></dd><dt><span class="term"><code class="literal">--filter</code></span></dt><dd><p>
            Apenas executa os testes cujos nomes combinam com o padrão fornecido. O padrão pode tanto ser o nome de um único teste quanto uma <a class="ulink" href="http://www.php.net/pcre" target="_top">expressão regular</a>
            que combina múltiplos nomes de testes.
          </p></dd><dt><span class="term"><code class="literal">--group</code></span></dt><dd><p>
            Apenas executa os testes do(s) grupo(s) especificado(s). Um teste pode ser marcado como pertencente a um grupo usando a anotação <code class="literal">@group</code>.
          </p><p>
            A anotação <code class="literal">@author</code> é um apelido para
            <code class="literal">@group</code>, permitindo filtrar os testes com base em seus autores.
          </p></dd><dt><span class="term"><code class="literal">--exclude-group</code></span></dt><dd><p>
            Exclui testes do(s) grupo(s) especificado(s). Um teste pode ser marcado como pertencente a um grupo usando a anotação <code class="literal">@group</code>.
          </p></dd><dt><span class="term"><code class="literal">--list-groups</code></span></dt><dd><p>
            Lista os grupos disponíveis.
          </p></dd><dt><span class="term"><code class="literal">--loader</code></span></dt><dd><p>
            Especifica a implementação <code class="literal">PHPUnit_Runner_TestSuiteLoader</code>
            a ser usada.
          </p><p>
            A suíte de carregadores de teste padrão irá procurar pelo arquivo-fonte no diretório de trabalho atual e em cada diretório que está especificado na configuração de diretiva <code class="literal">include_path</code> do PHP.
            Seguindo as Convenções de Nomenclatura do PEAR, um nome de classe como
            <code class="literal">Project_Package_Class</code> é mapeado para o nome de arquivo-fonte <code class="filename">Project/Package/Class.php</code>.
          </p></dd><dt><span class="term"><code class="literal">--printer</code></span></dt><dd><p>
            Especifica o impressor de resultados a ser usado. A classe impressora deve estender
            <code class="literal">PHPUnit_Util_Printer</code> e implementa a interface
            <code class="literal">PHPUnit_Framework_TestListener</code>.
          </p></dd><dt><span class="term"><code class="literal">--repeat</code></span></dt><dd><p>
            Executa repetidamente o(s) teste(s) um determinado número de vezes.
          </p></dd><dt><span class="term"><code class="literal">--tap</code></span></dt><dd><p>
            Relata o progresso do teste usando o <a class="ulink" href="http://testanything.org/" target="_top">Test Anything Protocol (TAP)</a>.
            Veja <a class="xref" href="#logging" title="Capítulo 18. Registrando">Capítulo 18</a> para mais detalhes.
          </p></dd><dt><span class="term"><code class="literal">--testdox</code></span></dt><dd><p>
            Relata o progresso do teste como uma documentação ágil. Veja
            <a class="xref" href="#other-uses-for-tests" title="Capítulo 15. Outros Usos para Testes">Capítulo 15</a> para mais detalhes.
          </p></dd><dt><span class="term"><code class="literal">--colors</code></span></dt><dd><p>
            Usa cores na saída.
          </p></dd><dt><span class="term"><code class="literal">--stderr</code></span></dt><dd><p>
            Opcionalmente imprime para <code class="literal">STDERR</code> em vez de
            <code class="literal">STDOUT</code>.
          </p></dd><dt><span class="term"><code class="literal">--stop-on-error</code></span></dt><dd><p>
            Para a execução no primeiro erro.
          </p></dd><dt><span class="term"><code class="literal">--stop-on-failure</code></span></dt><dd><p>
            Para a execução no primeiro erro ou falha.
          </p></dd><dt><span class="term"><code class="literal">--stop-on-skipped</code></span></dt><dd><p>
            Para a execução no primeiro teste pulado.
          </p></dd><dt><span class="term"><code class="literal">--stop-on-incomplete</code></span></dt><dd><p>
            Para a execução no primeiro teste incompleto.
          </p></dd><dt><span class="term"><code class="literal">--strict</code></span></dt><dd><p>
            Executa os testes em modo estrito.
          </p></dd><dt><span class="term"><code class="literal">--verbose</code></span></dt><dd><p>
            Saída mais verbosa de informações, por exemplo os nomes dos testes que ficaram incompletos ou foram pulados.
          </p></dd><dt><span class="term"><code class="literal">--process-isolation</code></span></dt><dd><p>
            Executa cada teste em um processo PHP separado.
          </p></dd><dt><span class="term"><code class="literal">--no-globals-backup</code></span></dt><dd><p>
            Não faz backup e restaura $GLOBALS. Veja <a class="xref" href="#fixtures.global-state" title="Estado Global">“Estado Global”</a>
            para mais detalhes.
          </p></dd><dt><span class="term"><code class="literal">--static-backup</code></span></dt><dd><p>
            Faz backup e restaura atributos estáticos das classes definidas pelo usuário. Veja <a class="xref" href="#fixtures.global-state" title="Estado Global">“Estado Global”</a> para mais detalhes.
          </p></dd><dt><span class="term"><code class="literal">--bootstrap</code></span></dt><dd><p>
            Um arquivo PHP "bootstrap" que é executado antes dos testes.
          </p></dd><dt><span class="term"><code class="literal">--configuration</code>, </span><span class="term"><code class="literal">-c</code></span></dt><dd><p>
            Lê a configuração de um arquivo XML. Veja
            <a class="xref" href="#appendixes.configuration" title="Apêndice C. O arquivo de configuração XML">Apêndice C</a> para mais detalhes.
          </p><p>
            Se <code class="filename">phpunit.xml</code> ou
            <code class="filename">phpunit.xml.dist</code> (nessa ordem) existirem no diretório de trabalho atual e <code class="literal">--configuration</code> <span class="emphasis"><em>não</em></span> for usado, a configuração será lida automaticamente desse arquivo.
          </p></dd><dt><span class="term"><code class="literal">--no-configuration</code></span></dt><dd><p>
            Ignora <code class="filename">phpunit.xml</code> e
            <code class="filename">phpunit.xml.dist</code> do diretório de trabalho atual.
          </p></dd><dt><span class="term"><code class="literal">--include-path</code></span></dt><dd><p>
            Precede o <code class="literal">include_path</code> do PHP com o(s) caminho(s) fornecido(s).
          </p></dd><dt><span class="term"><code class="literal">-d</code></span></dt><dd><p>
            Define o valor da opção de configuração do PHP fornecida.
          </p></dd><dt><span class="term"><code class="literal">--debug</code></span></dt><dd><p>
            Informação da saída de depuração como o nome de um teste quando a execução inicia.
          </p></dd></dl></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="fixtures"></a>Capítulo 6. Ambientes</h1></div></div></div><p>
    <a id="idp33044144" class="indexterm"></a>

    Uma das partes que mais consomem tempo ao se escrever testes é escrever o código para ajustar o ambiente para um estado conhecido e então retorná-lo ao seu estado original quando o teste está completo. Esse estado conhecido é chamado de <span class="emphasis"><em>ambiente</em></span> do teste.
  </p><p>
    Em <a class="xref" href="#">???</a>, o ambiente era simplesmente o vetor que está guardado na variável <code class="literal">$ambiente</code>
    Na maior parte do tempo, porém, o ambiente será mais complexo que um simples vetor, e a quantidade de código necessária para defini-lo aumentará na mesma proporção. O conteúdo real do teste se perde na bagunça da configuração do ambiente. Esse problema piora ainda mais quando você escreve vários testes com ambientes similares. Sem alguma ajuda do framework de teste, teríamos que duplicar o código que define o ambiente para cada teste que escrevermos.
  </p><p>
    <a id="idp33086624" class="indexterm"></a>
    <a id="idp33087456" class="indexterm"></a>
    <a id="idp33088272" class="indexterm"></a>

    O PHPUnit suporta compartilhamento do código de configuração. Antes que um método de teste seja executado, um método modelo chamado <code class="literal">setUp()</code> é invocado.
    <code class="literal">setUp()</code> é onde você cria os objetos que serão alvo dos testes. Uma vez que o método de teste tenha terminado sua execução, seja bem-sucedido ou falho, outro método modelo chamado
    <code class="literal">tearDown()</code> é invocado. <code class="literal">tearDown()</code>
    é onde você limpa os objetos que foram alvo dos testes.
  </p><p>
    Em <a class="xref" href="#writing-tests-for-phpunit.examples.StackTest2.php" title="Exemplo 4.2: Usando a anotação @depends para expressar dependências">Exemplo 4.2</a> usamos a relação produtor-consumidor entre testes para compartilhar ambientes. Isso nem sempre é desejável, ou mesmo possível. <a class="xref" href="#fixtures.examples.StackTest.php" title="Exemplo 6.1: Usando setUp() para criar a pilha de ambientes">Exemplo 6.1</a>
    mostra como podemos escrever os testes do <code class="literal">PilhaTest</code> de forma que o próprio ambiente não é reutilizado, mas o código que o cria. Primeiro declaramos a variável de instância <code class="literal">$pilha</code>, que usaremos no lugar de uma variável do método local. Então colocamos a criação do ambiente <code class="literal">vetor</code> dentro do método
    <code class="literal">setUp()</code> Finalmente, removemos o código redundante dos métodos de teste e usamos a nova variável de instância,
    <code class="literal">$this-&gt;pilha</code>, em vez da variável de método local
    <code class="literal">$pilha</code> com o método de asserção <code class="literal">assertEquals()</code>.
  </p><div class="example"><a id="fixtures.examples.StackTest.php"></a><p class="title"><strong>Exemplo 6.1: Usando setUp() para criar a pilha de ambientes</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">PilhaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$pilha</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pilha</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testEmpty</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="keyword">empty</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pilha</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testPush</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">array_push</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pilha</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pilha</span><span class="keyword">[</span><span class="default">count</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pilha</span><span class="keyword">)</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">]</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertFalse</span><span class="keyword">(</span><span class="keyword">empty</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pilha</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testPop</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">array_push</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pilha</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">array_pop</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pilha</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="keyword">empty</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">pilha</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
    <a id="idp33102656" class="indexterm"></a>
    <a id="idp33104160" class="indexterm"></a>
    <a id="idp33104944" class="indexterm"></a>
    <a id="idp33105760" class="indexterm"></a>
    <a id="idp33106576" class="indexterm"></a>

    Os métodos-modelo <code class="literal">setUp()</code> e <code class="literal">tearDown()</code> ão executados uma vez para cada método de teste (e em novas instâncias) da classe do caso de teste.
  </p><p>
    <a id="idp33109440" class="indexterm"></a>
    <a id="idp33110272" class="indexterm"></a>
    <a id="idp33111088" class="indexterm"></a>
    <a id="idp33111904" class="indexterm"></a>
    <a id="idp33112720" class="indexterm"></a>
    <a id="idp33113536" class="indexterm"></a>
    <a id="idp33114352" class="indexterm"></a>
    <a id="idp33115168" class="indexterm"></a>

    Além disso, os métodos-modelo <code class="literal">setUpBeforeClass()</code> e
    <code class="literal">tearDownAfterClass()</code> são chamados antes de cada primeiro e depois do último teste da classe de casos de teste, respectivamente, serem executados.
  </p><p>
    <a id="idp33118144" class="indexterm"></a>

    O exemplo abaixo mostra todos os métodos-modelo que estão disponíveis em uma classe de casos de teste.
  </p><div class="example"><a id="fixtures.examples.TemplateMethodsTest.php"></a><p class="title"><strong>Exemplo 6.2: Exemplo mostrando todos os métodos-modelo disponíveis</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">MetodosModeloTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">static</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUpBeforeClass</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">fwrite</span><span class="keyword">(</span><span class="default">STDOUT</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">__METHOD__</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">fwrite</span><span class="keyword">(</span><span class="default">STDOUT</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">__METHOD__</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">assertPreConditions</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">fwrite</span><span class="keyword">(</span><span class="default">STDOUT</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">__METHOD__</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testUm</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">fwrite</span><span class="keyword">(</span><span class="default">STDOUT</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">__METHOD__</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testDois</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">fwrite</span><span class="keyword">(</span><span class="default">STDOUT</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">__METHOD__</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">FALSE</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">assertPostConditions</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">fwrite</span><span class="keyword">(</span><span class="default">STDOUT</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">__METHOD__</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">tearDown</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">fwrite</span><span class="keyword">(</span><span class="default">STDOUT</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">__METHOD__</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">static</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">tearDownAfterClass</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">fwrite</span><span class="keyword">(</span><span class="default">STDOUT</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">__METHOD__</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">onNotSuccessfulTest</span><span class="keyword">(</span><span class="default">Exception</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">fwrite</span><span class="keyword">(</span><span class="default">STDOUT</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">__METHOD__</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">&quot;\n&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">throw</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit MetodosModeloTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

MetodosModeloTest::setUpBeforeClass
MetodosModeloTest::setUp
MetodosModeloTest::assertPreConditions
MetodosModeloTest::testOne
MetodosModeloTest::assertPostConditions
MetodosModeloTest::tearDown
MetodosModeloTest::setUp
MetodosModeloTest::assertPreConditions
MetodosModeloTest::testTwo
MetodosModeloTest::tearDown
MetodosModeloTest::onNotSuccessfulTest
MetodosModeloTest::tearDownAfterClass


Time: 0 seconds, Memory: 5.25Mb

There was 1 failure:

1) MetodosModeloTest::testDois
Failed asserting that &lt;boolean:false&gt; is true.
/home/sb/MetodosModeloTest.php:30

FAILURES!
Tests: 2, Assertions: 2, Failures: 1.</pre></div></div><br class="example-break" /><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="fixtures.more-setup-than-teardown"></a>Mais setUp() que tearDown()</h2></div></div></div><p>
      <code class="literal">setUp()</code> e <code class="literal">tearDown()</code> são bastante simétricos em teoria, mas não na prática. Na prática, você só precisa implementar <code class="literal">tearDown()</code> se você tiver alocado recursos externos como arquivos ou sockets no <code class="literal">setUp()</code>.
      Se seu <code class="literal">setUp()</code> apenas cria objetos planos do PHP, você pode ignorar o <code class="literal">tearDown()</code>. de modo geral. Porém, se você criar muitos objetos em seu <code class="literal">setUp()</code>, você pode querer remover a configuração <code class="literal">unset()</code> você pode querer remover a configuração <code class="literal">tearDown()</code> para que eles possam ser coletados como lixo. A coleta de lixo dos objetos dos casos de teste não é previsível.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="fixtures.variations"></a>Variantes</h2></div></div></div><p>
      O que acontece quando você tem dois testes com definições (setups) ligeiramente diferentes? Existem duas possibilidades:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Se o código <code class="literal">setUp()</code> diferir só um pouco, mova o código que difere do código do <code class="literal">setUp()</code> para o método de teste.
        </p></li><li class="listitem"><p>
          Se você tiver um <code class="literal">setUp()</code>, realmente diferente, você precisará de uma classe de caso de teste diferente. Nomeie a classe após a diferença na configuração.
        </p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="fixtures.sharing-fixture"></a>Compartilhando Ambientes</h2></div></div></div><p>
      Existem algumas boas razões para compartilhar ambientes entre testes, mas na maioria dos casos a necessidade de compartilhar um ambiente entre testes deriva de um problema de design não resolvido.
    </p><p>
      Um bom exemplo de um ambiente que faz sentido compartilhar através de vários testes é a conexão ao banco de dados: você loga no banco de dados uma vez e reutiliza essa conexão em vez de criar uma nova conexão para cada teste. Isso faz seus testes serem executados mais rápido.
    </p><p>
      <a id="idp33142464" class="indexterm"></a>
      <a id="idp33143280" class="indexterm"></a>

      <a class="xref" href="#fixtures.sharing-fixture.examples.DatabaseTest.php" title="Exemplo 6.3: Compartilhando ambientes entre os testes de uma suíte de testes">Exemplo 6.3</a>
      usa os métodos-modelo <code class="literal">setUpBeforeClass()</code> e
      <code class="literal">tearDownAfterClass()</code> para conectar ao banco de dados antes do primeiro teste da classe de casos de teste e a desconectar do banco de dados após o último teste dos casos de teste, respectivamente.
    </p><div class="example"><a id="fixtures.sharing-fixture.examples.DatabaseTest.php"></a><p class="title"><strong>Exemplo 6.3: Compartilhando ambientes entre os testes de uma suíte de testes</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">BancoDeDadosTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">static</span><span class="default">&nbsp;</span><span class="default">$dbh</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">static</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUpBeforeClass</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">self</span><span class="keyword">::</span><span class="default">$dbh</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">PDO</span><span class="keyword">(</span><span class="string">'sqlite::memory:'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">static</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">tearDownAfterClass</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">self</span><span class="keyword">::</span><span class="default">$dbh</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">NULL</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Não dá pra enfatizar o suficiente o quanto o compartilhamento de ambientes entre testes reduz o custo dos testes. O problema de design subjacente é que objetos não são de baixo acoplamento. Você vai conseguir melhores resultados resolvendo o problema de design subjacente e então escrevendo testes usando pontas (veja <a class="xref" href="#test-doubles" title="Capítulo 10. Dublês de Testes">Capítulo 10</a>), do que criando dependências entre os testes em tempo de execução e ignorando a oportunidade de melhorar seu design.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="fixtures.global-state"></a>Estado Global</h2></div></div></div><p>
      <a class="ulink" href="http://googletesting.blogspot.com/2008/05/tott-using-dependancy-injection-to.html" target="_top">É difícil testar um código que usa singletons (instâncias únicas de objetos).</a>
      Isso também vale para os códigos que usam variáveis globais. Tipicamente, o código que você quer testar é fortemente acoplado com uma variável global e você não pode controlar sua criação. Um problema adicional é o fato de que uma mudança de um teste para uma variável global pode quebrar um outro teste.
    </p><p>
      Em PHP, variáveis globais trabalham desta forma:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Uma variável global <code class="literal">$foo = 'bar';</code> é guardada como <code class="literal">$GLOBALS['foo'] = 'bar';</code>.</p></li><li class="listitem"><p>A variável <code class="literal">$GLOBALS</code> é chamada de variável <span class="emphasis"><em>super-global</em></span>.</p></li><li class="listitem"><p>Variáveis super-globais são variáveis embutidas que estão sempre disponíveis em todos os escopos.</p></li><li class="listitem"><p>No escopo de uma função ou método, você pode acessar a variável global <code class="literal">$foo</code> tanto por acesso direto à <code class="literal">$GLOBALS['foo']</code> ou usando <code class="literal">global $foo;</code> para criar uma variável local com uma referência à variável global.</p></li></ul></div><p>
      Além das variáveis globais, atributos estáticos de classes também são parte do estado global.
    </p><p>
      <a id="idp33163184" class="indexterm"></a>
      <a id="idp33164016" class="indexterm"></a>

      Por padrão, o PHPUnit executa seus testes de forma que mudanças às variáveis globais ou super-globais (<code class="literal">$GLOBALS</code>,
      <code class="literal">$_ENV</code>, <code class="literal">$_POST</code>,
      <code class="literal">$_GET</code>, <code class="literal">$_COOKIE</code>,
      <code class="literal">$_SERVER</code>, <code class="literal">$_FILES</code>,
      <code class="literal">$_REQUEST</code>) não afetem outros testes. Opcionalmente, este isolamento pode ser estendido a atributos estáticos de classes.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        A implementação das operações de backup e restauração para atributos estáticos de classes exige PHP 5.3 (ou superior).
      </p><p>
        A implementação das operações de backup e restauração para variáveis globais e atributos estáticos de classes utiliza <code class="literal">serialize()</code>
        e <code class="literal">unserialize()</code>.
      </p><p>
        Objetos de algumas classes fornecidas pelo próprio PHP, como
        <code class="literal">PDO</code> por exemplo, não podem ser serializadas e a operação de backup vai quebrar quando esse tipo de objeto for guardado no vetor 
        <code class="literal">$GLOBALS</code>, por exemplo.
      </p></div><p>
      <a id="idp33176752" class="indexterm"></a>
      <a id="idp33177968" class="indexterm"></a>

      A anotação <code class="literal">@backupGlobals</code> que é discutida na seção chamada
      <a class="xref" href="#appendixes.annotations.backupGlobals" title="@backupGlobals">“<code class="literal">@backupGlobals</code>”</a> pode ser usada para controlar as operações de backup e restauração para variáveis globais. Alternativamente, você pode fornecer uma lista-negra de variáveis globais que deverão ser excluídas das operações de backup e restauração como esta:
      </p><pre class="programlisting"><code>class MeuTest extends PHPUnit_Framework_TestCase
{
    protected $backupListaNegraGlobais = array('variavelGlobal');

    // ...
}</code></pre><p>
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        Por favor, note que definir o atributo <code class="literal">$backupListaNegraGlobais</code>
        dentro do método <code class="literal">setUp()</code>, por exemplo, não tem efeito.
      </p></div><p>
      <a id="idp33184656" class="indexterm"></a>
      <a id="idp33185872" class="indexterm"></a>

      A anotação <code class="literal">@backupStaticAttributes</code> que é discutida na seção chamada <a class="xref" href="#appendixes.annotations.backupStaticAttributes" title="@backupStaticAttributes">“<code class="literal">@backupStaticAttributes</code>”</a>pode ser usada para controlar as operações de backup e restauração para atributos estáticos. Alternativamente, você pode fornecer uma lista-negra de atributos estáticos que deverão ser excluídos das operações de backup e restauração como esta:
</p><pre class="programlisting"><code>class MeuTest extends PHPUnit_Framework_TestCase
{
    protected $backupListaNegraAtributosEstaticos = array(
      'nomeClasse' =&gt; array('nomeAtributo')
    );

    // ...
}</code></pre><p>
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        Por favor, note que definir o atributo <code class="literal">$backupStaticAttributesBlacklist</code>
        dentro do método <code class="literal">setUp()</code> , por exemplo, não tem efeito.
      </p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="organizing-tests"></a>Capítulo 7. Organizando Testes</h1></div></div></div><p>
    <a id="idp33263168" class="indexterm"></a>

    Um dos objetivos do PHPUnit (veja <a class="xref" href="#goals" title="Capítulo 2. Objetivos do PHPUnit">Capítulo 2</a>) é que os testes devem ser combináveis: queremos ser capazes de executar qualquer quantidade ou combinação de testes juntos, por exemplo todos os testes para um projeto inteiro, ou os testes para todas as classes de um ambiente que é parte do projeto, ou apenas os testes para uma só classe.
  </p><p>
    O PHPUnit suporta diferentes formas de organizar testes e combiná-los em uma suíte de testes. Este capítulo mostra as abordagens mais comuns.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="organizing-tests.filesystem"></a>Compondo uma Suíte de Testes usando o Sistema de Arquivos</h2></div></div></div><p>
      Provavelmente o jeito mais fácil de compor uma suíte de testes é manter todos os arquivos-fonte dos casos de teste em um diretório de testes. O PHPUnit pode descobrir automaticamente e executar os testes atravessando recursivamente o diretório de testes.
    </p><p>
      Vamos dar uma olhada na suíte de testes da biblioteca <a class="ulink" href="http://github.com/sebastianbergmann/php-object-freezer/" target="_top">Object_Freezer</a>
      Observando a estrutura de diretórios desse projeto, podemos ver que as classes dos casos de teste no diretório <code class="filename">Testes</code> espelha o pacote e estrutura de classes do Sistema Sob Teste (SST – ou SST: System Under Teste) no diretório
      <code class="filename">Object</code>:
    </p><pre class="screen">Object                              Tests
|-- Freezer                         |-- Freezer
|   |-- HashGenerator               |   |-- HashGenerator
|   |   `-- NonRecursiveSHA1.php    |   |   `-- NonRecursiveSHA1Test.php
|   |-- HashGenerator.php           |   |
|   |-- IdGenerator                 |   |-- IdGenerator
|   |   `-- UUID.php                |   |   `-- UUIDTest.php
|   |-- IdGenerator.php             |   |
|   |-- LazyProxy.php               |   |
|   |-- Storage                     |   |-- Storage
|   |   `-- CouchDB.php             |   |   `-- CouchDB
|   |                               |   |       |-- WithLazyLoadTest.php
|   |                               |   |       `-- WithoutLazyLoadTest.php
|   |-- Storage.php                 |   |-- StorageTest.php
|   `-- Util.php                    |   `-- UtilTest.php
`-- Freezer.php                     `-- FreezerTest.php</pre><p>
      Para executar todos os testes para a biblioteca precisamos apenas apontar o executor de testes em linha-de-comando do PHPUnit para o diretório de teste:
    </p><pre class="screen"><strong class="userinput"><code>phpunit Tests</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

............................................................ 60 / 75
...............

Time: 0 seconds

OK (75 tests, 164 assertions)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        Se você apontar o executor de testes em linha-de-comando do PHPUnit para um diretório, ele irá procurar por arquivos <code class="filename">*Test.php</code>.
      </p></div><p>
      Para executar apenas os testes declarados na classe de casos de teste <code class="literal">Object_FreezerTest</code>
      em <code class="filename">Tests/FreezerTest.php</code>, podemos usar o seguinte comando:
    </p><pre class="screen"><strong class="userinput"><code>phpunit Tests/FreezerTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

............................

Time: 0 seconds

OK (28 tests, 60 assertions)</pre><p>
      Para um controle mais refinado sobre quais testes executar, podemos usar o comutador 
      <code class="literal">--filter</code>:
    </p><pre class="screen"><strong class="userinput"><code>phpunit --filter testFreezingAnObjectWorks Tests</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.

Time: 0 seconds

OK (1 test, 2 assertions)</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        Uma desvantagem dessa abordagem é que não temos controle sobre a ordem em que os testes são executados. Isso pode causar problemas com relação às dependências dos testes, veja <a class="xref" href="#writing-tests-for-phpunit.test-dependencies" title="Dependências de Testes">“Dependências de Testes”</a>.
        Na próxima seção você vai ver como pode tornar explícita a ordem de execução de testes usando o arquivo de configuração XML.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="organizing-tests.xml-configuration"></a>Compondo uma Suíte de Testes Usando uma Configuração XML</h2></div></div></div><a id="idp33323024" class="indexterm"></a><p>
      O arquivo de configuração XML do PHPUnit (<a class="xref" href="#appendixes.configuration" title="Apêndice C. O arquivo de configuração XML">Apêndice C</a>)
      também pode ser usado para compor uma suíte de testes.
      <a class="xref" href="#organizing-tests.xml-configuration.examples.phpunit.xml" title="Exemplo 7.1: Compondo uma Suíte de Testes Usando uma Configuração XML">Exemplo 7.1</a>
      mostra um exemplo mínimo que adicionará todas as classes <code class="literal">*Test</code> que forem encontradas em arquivos <code class="filename">*Test.php</code> quando os
      <code class="filename">Tests</code> forem atravessados recursivamente.
    </p><div class="example"><a id="organizing-tests.xml-configuration.examples.phpunit.xml"></a><p class="title"><strong>Exemplo 7.1: Compondo uma Suíte de Testes Usando uma Configuração XML</strong></p><div class="example-contents"><pre class="programlisting"><code>&lt;phpunit&gt;
&lt;testsuites&gt;
&lt;testsuite name="Object_Freezer"&gt;
&lt;directory&gt;Tests&lt;/directory&gt;
&lt;/testsuite&gt;
&lt;/testsuites&gt;
&lt;/phpunit&gt;</code></pre></div></div><br class="example-break" /><p>
      A ordem de execução dos testes pode ser explicitada:
    </p><div class="example"><a id="organizing-tests.xml-configuration.examples.phpunit.xml2"></a><p class="title"><strong>Exemplo 7.2: Compondo uma Suíte de Testes Usando uma Configuração XML</strong></p><div class="example-contents"><pre class="programlisting"><code>&lt;phpunit&gt;
&lt;testsuites&gt;
&lt;testsuite name="Object_Freezer"&gt;
&lt;file&gt;Tests/Freezer/HashGenerator/NonRecursiveSHA1Test.php&lt;/file&gt;
&lt;file&gt;Tests/Freezer/IdGenerator/UUIDTest.php&lt;/file&gt;
&lt;file&gt;Tests/Freezer/UtilTest.php&lt;/file&gt;
&lt;file&gt;Tests/FreezerTest.php&lt;/file&gt;
&lt;file&gt;Tests/Freezer/StorageTest.php&lt;/file&gt;
&lt;file&gt;Tests/Freezer/Storage/CouchDB/WithLazyLoadTest.php&lt;/file&gt;
&lt;file&gt;Tests/Freezer/Storage/CouchDB/WithoutLazyLoadTest.php&lt;/file&gt;
&lt;/testsuite&gt;
&lt;/testsuites&gt;
&lt;/phpunit&gt;</code></pre></div></div><br class="example-break" /></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="database"></a>Capítulo 8. Testando Bancos de Dados</h1></div></div></div><p>
    Muitos exemplos de testes unitários iniciantes e intermediários em qualquer linguagem de programação sugerem que é perfeitamente fácil testar a lógica de sua aplicação com testes simples. Para aplicações centradas em bancos de dados isso está longe da realidade. Comece a usar Wordpress, TYPO3 ou Symfony com Doctrine ou Propel, por exemplo, e você vai experimentar facilmente problemas consideráveis com o PHPUnit: apenas porque o banco de dados é fortemente acoplado com essas bibliotecas.
  </p><p>
    Você provavelmente conhece esse cenário dos seus trabalhos e projetos diários, onde você quer colocar em prática suas habilidades (novas ou não) com PHPUnit e acaba ficando preso por um dos seguintes problemas:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
        O método que você quer testar executa uma operação JOIN muito grande e usa os dados para calcular alguns resultados importantes.
      </p></li><li class="listitem"><p>
        Sua lógica de negócios faz uma mistura de declarações SELECT, INSERT, UPDATE e DELETE.
      </p></li><li class="listitem"><p>
        Você precisa definir os dados de teste em (provavelmente muito) mais de duas tabelas para conseguir dados iniciais razoáveis para os métodos que deseja testar.
      </p></li></ol></div><p>
    A extensão DbUnit simplifica consideravelmente a configuração de um banco de dados para fins de teste e permite a você verificar os conteúdos de um banco de dados após fazer uma série de operações. Pode ser instalada da seguinte forma:
  </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/DbUnit</code></strong></pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="supported-vendors-for-database-testing"></a>Fornecedores Suportados para Testes de Banco de Dados</h2></div></div></div><p>
      O DbUnit atualmente suporta MySQL, PostgreSQL, Oracle e SQLite. Através das integrações
      <a class="ulink" href="http://framework.zend.com" target="_top">Zend Framework</a> ou
      <a class="ulink" href="http://www.doctrine-project.org" target="_top">Doctrine 2</a>
      ele tem acesso a outros sistemas como IBMDB2 ou Microsoft SQL Server.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="difficulties-in-database-testing"></a>Dificuldades em Testes de Bancos de Dados</h2></div></div></div><p>
      Existe uma boa razão pela qual todos os exemplos de testes unitários não incluírem interações com bancos de dados: esse tipo de testes é complexo tanto em configuração quanto em manutenção. Enquanto testar contra seu banco de dados você precisará ter cuidado com as seguintes variáveis:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Esquema e tabelas do banco de dados
        </p></li><li class="listitem"><p>
          Inserção das linhas exigidas para o teste nessas tabelas
        </p></li><li class="listitem"><p>
          Verificação do estado do banco de dados depois de executar os testes
        </p></li><li class="listitem"><p>
          Limpeza do banco de dados para cada novo teste
        </p></li></ul></div><p>
      Por causa de muitas APIs de bancos de dados como PDO, MySQLi ou OCI8 serem incômodos de usar e verbosas para escrever, fazer esses passos manualmente é um completo pesadelo.
    </p><p>
      O código de teste deve ser o mais curto e preciso possível por várias razões:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Você não quer modificar uma considerável quantidade de código de teste por pequenas mudanças em seu código de produção.
        </p></li><li class="listitem"><p>
          Você quer ser capaz de ler e entender o código de teste facilmente, mesmo meses depois de tê-lo escrito.
        </p></li></ul></div><p>
      Adicionalmente você tem que perceber que o banco de dados é essencialmente uma variável global de entrada para seu código. Dois testes em sua suíte de testes podem executar contra o mesmo banco de dados, possivelmente reutilizando dados múltiplas vezes. Falhas em um teste podem facilmente afetar o resultado dos testes seguintes, fazendo sua experiência com os testes muito difícil. O passo de limpeza mencionado anteriormente é da maior importância para resolver o problema do <span class="quote">“<span class="quote">banco de dados ser uma entrada global</span>”</span>.
    </p><p>
      O DbUnit ajuda a simplificar todos esses problemas com testes de bancos de dados de forma elegante.
    </p><p>
      O PHPUnit só não pode ajudá-lo no fato de que testes de banco de dados são muito lentos comparados aos testes que não usam bancos de dados. Dependendo do tamanho das interações com seu banco de dados, seus testes podem levar um tempo considerável para executar. Porém se você mantiver pequena a quantidade de dados usados para cada teste e tentar testar o máximo possível sem usar testes com bancos de dados, você facilmente conseguirá tempos abaixo de um minuto, mesmo para grandes suítes de teste.
    </p><p>
      A suíte de testes do projeto <a class="ulink" href="http://www.doctrine-project.org" target="_top">Doctrine 2
      </a>por exemplo, atualmente tem uma suíte com cerca de 1000 testes onde aproximadamente a metade deles tem acesso ao banco de dados e ainda executa em 15 segundos contra um banco de dados MySQL em um computador desktop comum.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="the-four-stages-of-a-database-test"></a>Os quatro estágios dos testes com banco de dados</h2></div></div></div><p>
      Em seu livro sobre Padrões de Teste xUnit, Gerard Meszaros lista os quatro estágios de um teste unitário:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          Configurar o ambiente (fixture)
        </p></li><li class="listitem"><p>
          Exercitar o Sistema Sob Teste
        </p></li><li class="listitem"><p>
          Verificar a saída
        </p></li><li class="listitem"><p>
          Teardown
        </p></li></ol></div><div class="blockquote"><blockquote class="blockquote"><p>
        <span class="strong"><strong>O que é um ambiente (fixture)?</strong></span>
      </p><p>
        Descreve o estado inicial em que sua aplicação e seu banco de dados estão ao executar um teste.
      </p></blockquote></div><p>
      Testar um banco de dados exige que você utilize pelo menos o setup e teardown para limpar e escrever em suas tabelas os dados de ambiente exigidos. Porém a extensão do banco de dados tem uma boa razão para reverter esses quatro estágios em um teste de banco de dados para assemelhar o seguinte fluxo de trabalho que é executado para cada teste:
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="clean-up-database"></a>1. Limpar o Banco de Dados</h3></div></div></div><p>
        Já que sempre existe um primeiro teste que é executado contra o banco de dados, você não sabe exatamente se já existem dados nas tabelas. O PHPUnit vai executar um TRUNCATE contra todas as tabelas que você especificou para redefinir seus estados para vazio.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="set-up-fixture"></a>2. Configurar o ambiente</h3></div></div></div><p>
        O PHPUnit então vai iterar sobre todas as linhas do ambiente especificado e inseri-las em suas respectivas tabelas.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="run-test-verify-outcome-and-teardown"></a>3–5. Executar Teste, Verificar saída e Teardown</h3></div></div></div><p>
        Depois de redefinir o banco de dados e carregá-lo com seu estado inicial, o verdadeiro teste é executado pelo PHPUnit. Esta parte do código teste não exige conhecimento sobre a Extensão do Banco de Dados, então você pode prosseguir e testar o que quiser com seu código.
      </p><p>
        Em seu teste use uma asserção especial chamada
        <code class="literal">assertDataSetsEqual()</code> para fins de verificação, porém isso é totalmente opcional. Esta função será explicada na seção <span class="quote">“<span class="quote">Asserções em Bancos de Dados</span>”</span>.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="configuration-of-a-phpunit-database-testcase"></a>Configuração de Caso de Teste de Banco de Dados do PHPUnit</h2></div></div></div><p>
      Ao usar o PHPUnit seus casos de teste vão estender a classe
      <code class="literal">PHPUnit_Framework_TestCase</code> da seguinte forma:
    </p><pre class="screen">
require_once "PHPUnit/Framework/TestCase.php";

class MeuTest extends PHPUnit_Framework_TestCase
{
    public function testCalculo()
    {
        $this-&gt;assertEquals(2, 1 + 1);
    }
}
</pre><p>
      Se você quer um código de teste que trabalha com a Extensão para Banco de Dados a configuração é um pouco mais complexa e você terá que estender um TestCase abstrato diferente, exigindo que você implemente dois métodos abstratos
      <code class="literal">getConnection()</code> e
      <code class="literal">getDataSet()</code>:
    </p><pre class="screen">
require_once "PHPUnit/Extensions/Database/TestCase.php";

class MeuLivroDeVisitasTest extends PHPUnit_Extensions_Database_TestCase
{
    /**
     * @return PHPUnit_Extensions_Database_DB_IDatabaseConnection
     */
    public function getConnection()
    {
        $pdo = new PDO('sqlite::memory:');
        return $this-&gt;createDefaultDBConnection($pdo, ':memory:');
    }

    /**
     * @return PHPUnit_Extensions_Database_DataSet_IDataSet
     */
    public function getDataSet()
    {
        return $this-&gt;createFlatXMLDataSet(dirname(__FILE__).'/_files/guestbook-seed.xml');
    }
}
</pre><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="implementing-getconnection"></a>Implementando <code class="literal">getConnection()</code></h3></div></div></div><p>
        Para permitir que a limpeza e o carregamento de funcionalidades do ambiente funcionem, a Extensão do Banco de Dados do PHPUnit exige acesso a uma conexão abstrata do banco de dados através dos fornecedores da biblioteca PDO. É importante notar que sua aplicação não precisa ser baseada em PDO para usar a Extensão para Banco de Dados do PHPUnit, pois a conexão é usada apenas para limpeza e configuração do ambiente.
      </p><p>
        No exemplo anterior criamos uma conexão Sqlite na memória e a passamos ao método <code class="literal">createDefaultDBConnection</code>
        que embrulha a instância do PDO e o segundo parâmetro (o nome do banco de dados) em uma camada simples de abstração para conexões do banco de dados do tipo
        <code class="literal">PHPUnit_Extensions_Database_DB_IDatabaseConnection</code>.
      </p><p>
        A seção <span class="quote">“<span class="quote">Usando a Conexão do Banco de Dados</span>”</span> explica a API desta interface e como você pode usá-la da melhor forma possível.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="implementing-getdataset"></a>Implementando <code class="literal">getDataSet()</code></h3></div></div></div><p>
        O método <code class="literal">getDataSet()</code> define como deve ser o estado inicial do banco de dados antes de cada teste ser executado. O estado do banco de dados é abstraído através de conceitos Conjunto de Dados e Tabela de Dados, ambos sendo representados pelas interfaces
        <code class="literal">PHPUnit_Extensions_Database_DataSet_IDataSet</code> e
        <code class="literal">PHPUnit_Extensions_Database_DataSet_IDataTable</code>.
        A próxima seção vai descrever em detalhes como esses conceitos trabalham e quais os benefícios de usá-los nos testes com bancos de dados.
      </p><p>
        Para a implementação precisaremos apenas saber que o método
        <code class="literal">getDataSet()</code> é chamado uma vez durante o
        <code class="literal">setUp()</code> para recuperar o conjunto de dados do ambiente e inseri-lo no banco de dados. No exemplo estamos usando um método de fábrica <code class="literal">createFlatXMLDataSet($nomearquivo)</code> que representa um conjunto de dados através de uma representação XML.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="what-about-the-database-schema-ddl"></a>E quanto ao Esquema do Banco de Dados (DDL)?</h3></div></div></div><p>
        O PHPUnit assume que o esquema do banco de dados com todas as suas tabelas, gatilhos, sequências e visualizações é criado antes que um teste seja executado. Isso quer dizer que você como desenvolvedor deve se certificar que o banco de dados está corretamente configurado antes de executar a suíte.
      </p><p>
        Existem vários meios para atingir esta pré-condição para testar bancos de dados.
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            Se você está usando um banco de dados persistente (não Sqlite Memory) você pode facilmente configurar o banco de dados uma vez com ferramentas como phpMyAdmin para MySQL e reutilizar o banco de dados para cada execução de teste.
          </p></li><li class="listitem"><p>
            Se você estiver usando bibliotecas como
            <a class="ulink" href="http://www.doctrine-project.org" target="_top">Doctrine 2</a> ou
            <a class="ulink" href="http://www.propelorm.org/" target="_top">Propel</a>
            você pode usar suas APIs para criar o esquema de banco de dados que precisa antes de rodar os testes. Você pode utilizar as capacidades de Configuração e Bootstrap 
            <a class="ulink" href="http://www.phpunit.de/manual/current/en/textui.html" target="_top"> do PHPUnit</a>
            para executar esse código sempre que seus testes forem executados.
          </p></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="tip:-use-your-own-abstract-database-testcase"></a>Dica: Use seu próprio Caso Abstrato de Teste de Banco de Dados</h3></div></div></div><p>
        Do exemplo prévio de implementação você pode facilmente perceber que o método
        <code class="literal">getConnection()</code> é bastante estático e pode ser reutilizado em diferentes casos de teste de banco de dados. Adicionalmente para manter uma boa performance dos seus testes e pouca carga sobre seu banco de dados, você pode refatorar o código um pouco para obter um caso de teste abstrato genérico para sua aplicação, o que ainda permite a você especificar um ambiente de dados diferente para cada caso de teste:
      </p><pre class="screen">
require_once "PHPUnit/Extensions/Database/TestCase.php";

abstract class MinhaApp_Testes_CasosDeTesteDeBancoDeDadosTest extends PHPUnit_Extensions_Database_TestCase
{
    // instancie o pdo apenas uma vez por limpeza de teste/carregamento de ambiente
    static private $pdo = null;

    // instancie PHPUnit_Extensions_Database_DB_IDatabaseConnection apenas uma vez por teste
    private $conn = null;

    final public function getConnection()
    {
        if ($this-&gt;conn === null) {
            if (self::$pdo == null) {
                self::$pdo = new PDO('sqlite::memory:');
            }
            $this-&gt;conn = $this-&gt;createDefaultDBConnection(self::$pdo, ':memory:');
        }

        return $this-&gt;conn;
    }
}
</pre><p>
        Entretanto, isso tem a conexão ao banco de dados codificada na conexão do PDO. O PHPUnit tem outra incrível característica que pode fazer este caso de teste ainda mais genérico. Se você usar a
        <a class="ulink" href="http://www.phpunit.de/manual/current/en/appendixes.configuration.html#appendixes.configuration.php-ini-constants-variables" target="_top">Configuração XML</a>
        você pode tornar a conexão com o banco de dados configurável por execução de teste. Primeiro vamos criar um arquivo <span class="quote">“<span class="quote">phpunit.xml</span>”</span> em seu diretório testes da aplicação, de forma semelhante a isto:
      </p><pre class="screen">
&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;phpunit&gt;
    &lt;php&gt;
        &lt;var name="BD_DSN" value="mysql:dbname=meulivrodevisitas;host=localhost" /&gt;
        &lt;var name="BD_USUARIO" value="usuario" /&gt;
        &lt;var name="BD_SENHA" value="senha" /&gt;
        &lt;var name="BD_NOMEBD" value="meulivrodevisitas" /&gt;
    &lt;/php&gt;
&lt;/phpunit&gt;
</pre><p>
        Agora podemos modificar seu caso de teste para parecer com isso:
      </p><pre class="screen">
abstract class Generic_Tests_DatabaseTestCase extends PHPUnit_Extensions_Database_TestCase
{
    // instancie o pdo apenas uma vez por limpeza de teste/carregamento de ambiente
    static private $pdo = null;

    // instancie PHPUnit_Extensions_Database_DB_IDatabaseConnection apenas uma vez por teste
    private $conn = null;

    final public function getConnection()
    {
        if ($this-&gt;conn === null) {
            if (self::$pdo == null) {
                self::$pdo = new PDO( $GLOBALS['BD_DSN'], $GLOBALS['BD_USUARIO'], $GLOBALS['BD_SENHA'] );
            }
            $this-&gt;conn = $this-&gt;createDefaultDBConnection(self::$pdo, $GLOBALS['BD_NOMEBD']);
        }

        return $this-&gt;conn;
    }
}
</pre><p>
        Agora podemos executar a suíte de testes de banco de dados usando diferentes configurações através da interface de linha-de-comando:
      </p><pre class="screen">
user@desktop&gt; phpunit --configuration developer-a.xml MeusTestes/
user@desktop&gt; phpunit --configuration developer-b.xml MeusTestes/
</pre><p>
        A possibilidade de executar facilmente os testes de banco de dados contra diferentes alvos é muito importante se você está desenvolvendo na máquina de desenvolvimento. Se vários desenvolvedores executarem os testes de banco de dados contra a mesma conexão de banco de dados você experimentará facilmente falhas de testes devido à condição de execução.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="understanding-datasets-and-datatables"></a>Entendendo Conjunto de Dados e Tabelas de Dados</h2></div></div></div><p>
      Um conceito central da Extensão para Banco de Dados do PHPUnit são os Conjuntos de Dados e as Tabelas de Dados. Você deveria tentar entender este conceito simples para dominar os testes de banco de dados com PHPUnit. Conjunto de Dados e Tabela de Dados formam uma camada abstrata em torno das tabelas, linhas e colunas do seu banco de dados. Uma simples API esconde os conteúdos subjacentes do banco de dados em uma estrutura de objetos, que também podem ser implementada por outra fonte que não seja um banco de dados.
    </p><p>
      Essa abstração é necessária para comparar os conteúdos reais de um banco de dados contra os conteúdos esperados. Expectativas podem ser representadas como arquivos XML, YAML, CSV ou vetores PHP, por exemplo. As interfaces Conjunto de Dados e Tabela de Dados permitem a comparação dessas fontes conceitualmente diferentes, emulando a armazenagem relacional de banco de dados em uma abordagem semanticamente similar.
    </p><p>
      Um fluxo de trabalho para asserções em banco de dados nos seus testes então consiste de três passos simples:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Especificar uma ou mais tabelas em seu banco de dados por nome de tabela (conjunto de dados real);
        </p></li><li class="listitem"><p>
          Especificar o Conjunto de Dados esperado no seu formato preferido (YAML, XML, ...);
        </p></li><li class="listitem"><p>
          Assertar que ambas as representações de conjunto de dados se equivalem.
        </p></li></ul></div><p>
      Asserções não são o único caso de uso para o Conjunto de Dados e a Tabela de Dados na Extensão para Banco de Dados do PHPUnit. Como mostrado na seção anterior, eles também descrevem os conteúdos iniciais de um banco de dados. Você é forçado a definir um conjunto de dados de ambiente pelo Caso de Teste de Banco de Dados, que então é usado para:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
          Deletar todas as linhas das tabelas especificadas no conjunto de dados.
        </p></li><li class="listitem"><p>
          Escrever todas as linhas nas tabelas de dados do banco de dados.
        </p></li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="available-implementations"></a>Implementações disponíveis</h3></div></div></div><p>
        Existem três tipos diferentes de conjuntos de dados/tabelas de dados:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            Conjuntos de Dados e Tabelas de Dados baseados em arquivo
          </p></li><li class="listitem"><p>
            Conjuntos de Dados e Tabelas de Dados baseados em query
          </p></li><li class="listitem"><p>
            Filtro e Composição de Conjunto de Dados e Tabelas de Dados
          </p></li></ul></div><p>
        Os Conjuntos de Dados e Tabelas de Dados baseadas em arquivo são geralmente usadas para o ambiente inicial e para descrever os estados esperados do banco de dados.
      </p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="flat-xml-dataset"></a>Conjunto de Dados de XML Plano</h4></div></div></div><p>
          O Conjunto de Dados mais comum é chamada XML Plano. É um formato xml simples onde uma tag dentro do nó-raiz
          <code class="literal">&lt;dataset&gt;</code> representa exatamente uma linha no banco de dados. Os nomes das tags equivalem à tabela onde inserir a linha e um atributo representa a coluna. Um exemplo para uma simples aplicação de livro de visitas poderia se parecer com isto:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;livrodevisitas id="1" conteudo="Olá amigo!" usuario="joao" criado="2010-04-24 17:15:23" /&gt;
    &lt;livrodevisitas id="2" conteudo="Eu gostei!" usuario="nanda" criado="2010-04-26 12:14:20" /&gt;
&lt;/dataset&gt;
</pre><p>
          Isso é, obviamente, fácil de escrever. Aqui
          <code class="literal">&lt;livrodevisitas&gt;</code> é o nome da tabela onde duas linhas são inseridas dentro de cada com quatro colunas <span class="quote">“<span class="quote">id</span>”</span>,
          <span class="quote">“<span class="quote">conteudo</span>”</span>, <span class="quote">“<span class="quote">usuario</span>”</span> e
          <span class="quote">“<span class="quote">criado</span>”</span> com seus respectivos valores.
        </p><p>
          Porém essa simplicidade tem um preço.
        </p><p>
          O exemplo anterior não deixa tão óbvio como você pode fazer para especificar uma tabela vazia. Você pode inserir uma tag sem atributos com o nome da tabela vazia. Um arquivo xml plano para uma tabela vazia do livro de visitas ficaria parecido com isso:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;livrodevisitas /&gt;
&lt;/dataset&gt;
</pre><p>
          O manejamento de valores NULL com o xml plano é tedioso. Um valor NULL é diferente de uma string com valor vazio em quase todos os bancos de dados (Oracle é uma exceção), algo difícil de descrever no formato xml plano. Você pode representar um valor NULL omitindo o atributo da especificação da linha. Se seu livro de visitas vai permitir entradas anônimas representadas por um valor NULL na coluna usuario, um estado hipotético para a tabela do livrodevisitas seria parecido com:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;livrodevisitas id="1" conteudo="Olá amigo!" usuario="joao" criado="2010-04-24 17:15:23" /&gt;
    &lt;livrodevisitas id="2" conteudo="Eu gostei!" criado="2010-04-26 12:14:20" /&gt;
&lt;/dataset&gt;
</pre><p>
          Nesse caso a segunda entrada é postada anonimamente. Porém isso acarreta um problema sério no reconhecimento de colunas. Durante as asserções de igualdade do conjunto de dados, cada conjunto de dados tem que especificar quais colunas uma tabela possui. Se um atributo for NULL para todas as linhas de uma tabela de dados, como a Extensão para Banco de Dados vai saber que a coluna pode ser parte da tabela?
        </p><p>
          O conjunto de dados em xml plano faz uma presunção crucial agora, definindo que os atributos na primeira linha definida de uma tabela define as colunas dessa tabela. No exemplo anterior isso significaria que
          <span class="quote">“<span class="quote">id</span>”</span>, <span class="quote">“<span class="quote">conteudo</span>”</span>, <span class="quote">“<span class="quote">usuario</span>”</span> e
          <span class="quote">“<span class="quote">criado</span>”</span> são colunas da tabela livrodevisitas. Para a segunda linha, onde <span class="quote">“<span class="quote">usuario</span>”</span> não está definido, um NULL seria inserido no banco de dados.
        </p><p>
          Quando a primeira entrada do livrodevisitas for apagada do conjunto de dados, apenas
          <span class="quote">“<span class="quote">id</span>”</span>, <span class="quote">“<span class="quote">conteudo</span>”</span> e
          <span class="quote">“<span class="quote">criado</span>”</span> seriam colunas da tabela livrodevisitas, já que <span class="quote">“<span class="quote">usuario</span>”</span> não é especificado.
        </p><p>
          Para usar o Conjunto de Dados em XML Plano efetivamente, quando valores NULL forem relevantes, a primeira linha de cada tabela não deve conter qualquer valor NULL e apenas as linhas seguintes poderão omitir atributos. Isso pode parecer estranho, já que a ordem das linhas é um fator relevante para as asserções com bancos de dados.
        </p><p>
          Em troca, se você especificar apenas um subconjunto das colunas da tabela no Conjunto de Dados do XML Plano, todos os valores omitidos serão definidos para seus valores padrão. Isso vai induzir a erros se uma das colunas omitidas estiver definida como <span class="quote">“<span class="quote">NOT NULL DEFAULT NULL</span>”</span>.
        </p><p>
          Para concluir eu posso dizer que as conjuntos de dados XML Plano só devem ser usadas se você não precisar de valores NULL.
        </p><p>
          Você pode criar uma instância de conjunto de dados xml plano de dentro de seu Caso de Teste de Banco de Dados chamando o método
          <code class="literal">createFlatXmlDataSet($nomearquivo)</code>:
        </p><pre class="screen">
class MeuCasoDeTest extends PHPUnit_Extensions_Database_TestCase
{
    public function getDataSet()
    {
        return $this-&gt;createFlatXmlDataSet('meuAmbienteXmlPlano.xml');
    }
}
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="xml-dataset"></a>Conjunto de Dados XML</h4></div></div></div><p>
          Existe uma outro Conjunto de Dados em XML mais estruturado, que é um pouco mais verboso para escrever mas evita os problemas do NULL nos conjuntos de dados em XML Plano. Dentro do nó-raiz <code class="literal">&lt;dataset&gt;</code> você pode especificar as tags <code class="literal">&lt;table&gt;</code>,
          <code class="literal">&lt;column&gt;</code>, <code class="literal">&lt;row&gt;</code>,
          <code class="literal">&lt;value&gt;</code> e
          <code class="literal">&lt;null /&gt;</code>. Um Conjunto de Dados equivalente ao definida anteriormente no Livrodevisitas em XML Plano seria como:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;table name="livrodevisitas"&gt;
        &lt;column&gt;id&lt;/column&gt;
        &lt;column&gt;conteudo&lt;/column&gt;
        &lt;column&gt;usuario&lt;/column&gt;
        &lt;column&gt;criado&lt;/column&gt;
        &lt;row&gt;
            &lt;value&gt;1&lt;/value&gt;
            &lt;value&gt;Olá amigo!&lt;/value&gt;
            &lt;value&gt;joao&lt;/value&gt;
            &lt;value&gt;2010-04-24 17:15:23&lt;/value&gt;
        &lt;/row&gt;
        &lt;row&gt;
            &lt;value&gt;2&lt;/value&gt;
            &lt;value&gt;Eu gostei!&lt;/value&gt;
            &lt;null /&gt;
            &lt;value&gt;2010-04-26 12:14:20&lt;/value&gt;
        &lt;/row&gt;
    &lt;/table&gt;
&lt;/dataset&gt;
</pre><p>
          Qualquer <code class="literal">&lt;table&gt;</code> definida tem um nome e requer uma definição de todas as colunas com seus nomes. Pode conter zero ou qualquer número positivo de elementos aninhados <code class="literal">&lt;row&gt;</code>. Não definir nenhum elemento <code class="literal">&lt;row&gt;</code> significa que a tabela está vazia. As tags <code class="literal">&lt;value&gt;</code> e <code class="literal">&lt;null /&gt;</code> têm que ser especificadas na ordem especificada nos elementos fornecidos previamente em <code class="literal">&lt;column&gt;</code>. A tag <code class="literal">&lt;null /&gt;</code> obviamente significa que o valor é NULL.
        </p><p>
          Você pode criar uma instância de conjunto de dados xml de dentro de seu Caso de Teste de Banco de Dados chamando o método <code class="literal">createXmlDataSet($nomearquivo)</code>:
        </p><pre class="screen">
class MeuCasoDeTest extends PHPUnit_Extensions_Database_TestCase
{
    public function getDataSet()
    {
        return $this-&gt;createXMLDataSet('meuAmbienteXml.xml');
    }
}
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="mysql-xml-dataset"></a>Conjunto de Dados XML MySQL</h4></div></div></div><p>
          Este novo formato de arquivo XML é específico para o 
          <a class="ulink" href="http://www.mysql.com" target="_top">servidor de banco de dados MySQL</a>.
          O suporte para ele foi adicionado no PHPUnit 3.5. Arquivos nesse formato podem ser gerados usando o utilitário<a class="ulink" href="http://dev.mysql.com/doc/refman/5.0/en/mysqldump.html" target="_top"><code class="literal">mysqldump</code></a>. Diferente dos conjuntos de dados CSV, que o <code class="literal">mysqldump</code>
          também suporta, um único arquivo neste formato XML pode conter dados para múltiplas tabelas. Você pode criar um arquivo nesse formato invocando o <code class="literal">mysqldump</code> desta forma:
        </p><pre class="screen">
mysqldump --xml -t -u [nomeusuario] --password=[senha] [bancodedados] &gt; /caminho/para/arquivo.xml
        </pre><p>
          Esse arquivo pode ser usado em seu Caso de Teste de Banco de Dados chamando o método
          <code class="literal">createMySQLXMLDataSet($filename)</code>:
        </p><pre class="screen">
class MeuCasoDeTest extends PHPUnit_Extensions_Database_TestCase
{
    public function getDataSet()
    {
        return $this-&gt;createMySQLXMLDataSet('/caminho/para/arquivo.xml');
    }
}
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="yaml-dataset"></a>Conjunto de Dados YAML</h4></div></div></div><p>
          Novidade do PHPUnit 3.4, é a capacidade de especificar um Conjunto de Dados no popular formato YAML. Para funcionar, você deve instalar o PHPUnit 3.4 através do PEAR com a dependência opcional do Symfony YAML. Então você poderá escrever um Conjunto de Dados YAML para o exemplo do livrodevisitas:
        </p><pre class="screen">
livrodevisitas:
  -
    id: 1
    conteudo: "Olá amigo!"
    usuario: "joao"
    criado: 2010-04-24 17:15:23
  -
    id: 2
    conteudo: "Eu gostei!"
    usuario:
    criado: 2010-04-26 12:14:20
</pre><p>
          Isso é simples, conveniente E resolve o problema do NULL que o Conjunto de Dados similar do XML Plano tem. Um NULL em um YAML é apenas o nome da coluna sem nenhum valor especificado. Uma string vazia é especificada como
          <code class="literal">coluna1: ""</code>.
        </p><p>
          O Conjunto de Dados YAML atualmente não possui método de fábrica no Caso de Teste de Banco de Dados, então você tem que instanciar manualmente:
        </p><pre class="screen">
require_once "PHPUnit/Extensions/Database/DataSet/YamlDataSet.php";

class LivroDeVisitasYamlTest extends PHPUnit_Extensions_Database_TestCase
{
    protected function getDataSet()
    {
        return new PHPUnit_Extensions_Database_DataSet_YamlDataSet(
            dirname(__FILE__)."/_files/livrodevisitas.yml"
        );
    }
}
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="csv-dataset"></a>Conjunto de Dados CSV</h4></div></div></div><p>
          Outro Conjunto de Dados baseado em arquivo, com arquivos CSV. Cada tabela do conjunto de dados é representada como um único arquivo CSV. Para nosso exemplo do livrodevisitas, vamos definir um arquivo tabela-livrodevisitas.csv:
        </p><pre class="screen">
id;conteudo;usuario;criado
1;"Olá amigo!";"joao";"2010-04-24 17:15:23"
2;"Eu gostei!""nanda";"2010-04-26 12:14:20"
</pre><p>
          Apesar disso ser muito conveniente para edição no Excel ou OpenOffice, você não pode especificar valores NULL em um Conjunto de Dados CSV. Uma coluna vazia levaria a um valor vazio padrão ser inserido na coluna.
        </p><p>
          Você pode criar um Conjunto de Dados CSV chamando:
        </p><pre class="screen">
require_once 'PHPUnit/Extensions/Database/DataSet/CsvDataSet.php';

class LivroDeVisitasCsvTest extends PHPUnit_Extensions_Database_TestCase
{
    protected function getDataSet()
    {
        $conjuntoDados = new PHPUnit_Extensions_Database_DataSet_CsvDataSet();
        $conjuntoDados-&gt;addTable('livrodevisitas', dirname(__FILE__)."/_files/livrodevisitas.csv");
        return $conjuntoDados;
    }
}
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="array-dataset"></a>Vetor de Conjunto de Dados</h4></div></div></div><p>
          Não existe (ainda) Conjunto de Dados baseado em vetor na Extensão para Banco de Dados do PHPUnit, mas podemos implementar o nosso próprio facilmente. Nosso exemplo do livrodevisitas deveria ficar parecido com:
        </p><pre class="screen">
class VetorLivroDeVisitasTest extends PHPUnit_Extensions_Database_TestCase
{
    protected function getDataSet()
    {
        return new MinhaApp_DbUnit_VetorConjuntoDeDados(array(
            'livrodevisitas' =&gt; array(
                array('id' =&gt; 1, 'conteudo' =&gt; 'Olá amigo!', 'usuario' =&gt; 'joao', 'criado' =&gt; '2010-04-24 17:15:23'),
                array('id' =&gt; 2, 'conteudo' =&gt; 'Eu gostei!', 'usuario' =&gt; null, 'criado' =&gt; '2010-04-26 12:14:20'),
            ),
        ));
    }
}
</pre><p>
          Um Conjunto de Dados do PHP em algumas vantagens óbvias sobre todas as outras conjuntos de dados baseadas em arquivos:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
              Vetores PHP podem, obviamente, trabalhar com valores <code class="literal">NULL</code>.
            </p></li><li class="listitem"><p>
              Você não precisa de arquivos adicionais para asserções e pode especificá-las diretamente no Caso de Teste.
            </p></li></ul></div><p>
          Para este Conjunto de Dados, como nos Conjunto de Dados em XML Plano, CSV e YAML, as chaves da primeira linha especificada definem os nomes das colunas das tabelas, que no caso anterior seriam <span class="quote">“<span class="quote">id</span>”</span>,
          <span class="quote">“<span class="quote">conteudo</span>”</span>, <span class="quote">“<span class="quote">usuario</span>”</span> e
          <span class="quote">“<span class="quote">criado</span>”</span>.
        </p><p>
          A implementação para este vetor Conjunto de Dados é simples e direta:
        </p><pre class="screen">
require_once 'PHPUnit/Util/Filter.php';

require_once 'PHPUnit/Extensions/Database/DataSet/AbstractDataSet.php';
require_once 'PHPUnit/Extensions/Database/DataSet/DefaultTableIterator.php';
require_once 'PHPUnit/Extensions/Database/DataSet/DefaultTable.php';
require_once 'PHPUnit/Extensions/Database/DataSet/DefaultTableMetaData.php';

PHPUnit_Util_Filter::addFileToFilter(__FILE__, 'PHPUNIT');

class MinhaApp_DbUnit_VetorConjuntoDeDadosTest extends PHPUnit_Extensions_Database_DataSet_AbstractDataSet
{
    /**
     * @var array
     */
    protected $tabelas = array();

    /**
     * @param array $dados
     */
    public function __construct(array $dados)
    {
        foreach ($dados AS $nomeTabela =&gt; $linhas) {
            $colunas = array();
            if (isset($linhas[0])) {
                $colunas = array_keys($linhas[0]);
            }

            $metaDados = new PHPUnit_Extensions_Database_DataSet_DefaultTableMetaData($nomeTabela, $colunas);
            $tabela = new PHPUnit_Extensions_Database_DataSet_DefaultTable($metaDados);

            foreach ($linhas AS $linha) {
                $tabela-&gt;addRow($linha);
            }
            $this-&gt;tabelas[$nomeTabela] = $tabela;
        }
    }

    protected function createIterator($reverso = FALSE)
    {
        return new PHPUnit_Extensions_Database_DataSet_DefaultTableIterator($this-&gt;tabelas, $reverso);
    }

    public function getTable($nomeTabela)
    {
        if (!isset($this-&gt;tabelas[$nomeTabela])) {
            throw new InvalidArgumentException("$nomeTabela não é uma tabela do banco de dados atual.");
        }

        return $this-&gt;tabelas[$nomeTabela];
    }
}
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="query-sql-dataset"></a>Conjunto de Dados Query (SQL)</h4></div></div></div><p>
          Para asserções de banco de dados você não precisa somente de conjuntos de dados baseados em arquivos, mas também de conjuntos de dados baseados em Query/SQL que contenha os conteúdos reais do banco de dados. É aí que entra o Query DataSet:
        </p><pre class="screen">
$ds = new PHPUnit_Extensions_Database_DataSet_QueryDataSet($this-&gt;getConnection());
$ds-&gt;addTable('livrodevisitas');
</pre><p>
          Adicionar uma tabela apenas por nome é um modo implícito de definir a tabela de dados com a seguinte query:
        </p><pre class="screen">
$ds = new PHPUnit_Extensions_Database_DataSet_QueryDataSet($this-&gt;getConnection());
$ds-&gt;addTable('livrodevisitas', 'SELECT * FROM livrodevisitas');
</pre><p>
          Você pode fazer uso disso especificando querys arbitrárias para suas tabelas, por exemplo restringindo linhas, colunas, ou adicionando cláusulas
          <code class="literal">ORDER BY</code>:
        </p><pre class="screen">
$ds = new PHPUnit_Extensions_Database_DataSet_QueryDataSet($this-&gt;getConnection());
$ds-&gt;addTable('livrodevisitas', 'SELECT id, conteudo FROM livrodevisitas ORDER BY criado DESC');
</pre><p>
          A seção nas Asserções de Banco de Dados mostrará mais alguns detalhes sobre como fazer uso do Conjunto de Dados Query.
        </p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="database-db-dataset"></a>Conjunto de Dados de Banco de Dados (BD)</h4></div></div></div><p>
          Acessando a Conexão de Teste você pode criar automaticamente um Conjunto de Dados que consiste de todas as tabelas com seus conteúdos no banco de dados especificado como segundo parâmetro ao método Conexões de Fábrica.
        </p><p>
          Você pode tanto criar um Conjunto de Dados para todo o banco de dados como mostrado em  <code class="literal">testLivrodevisitas()</code>, ou restringi-lo a um conjunto de nomes específicos de tabelas com uma lista branca, como mostrado no método
          <code class="literal">testLivrodevisitasFiltrado()</code>.
        </p><pre class="screen">
class MeuTesteLivrodevisitasMySqlTest extends PHPUnit_Extensions_Database_TestCase
{
    /**
     * @return PHPUnit_Extensions_Database_DB_IDatabaseConnection
     */
    public function getConnection()
    {
        $bancodedados = 'meu_bancodedados';
        $pdo = new PDO('mysql:...', $usuario, $senha);
        return $this-&gt;createDefaultDBConnection($pdo, $bancodedados);
    }

    public function testLivrodevisitas()
    {
        $conjuntoDados = $this-&gt;getConnection()-&gt;criarDataSet();
        // ...
    }

    public function testLivrodevisitasFiltrado()
    {
        $nomesTabelas = array('livrodevisitas');
        $conjuntoDados = $this-&gt;getConnection()-&gt;criarConjuntoDeDados($nomesTabelas);
        // ...
    }
}
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="replacement-dataset"></a>Conjunto de Dados de Reposição</h4></div></div></div><p>
          Eu tenho falado sobre problemas com NULL nos Conjunto de Dados XML Plano e CSV, mas existe uma alternativa um pouco complicada para fazer ambos funcionarem com NULLs.
        </p><p>
          O Conjunto de Dados de Reposição é um decorador para um Conjunto de Dados existente e permite que você substitua valores em qualquer coluna do conjunto de dados por outro valor de reposição. Para fazer nosso exemplo do livro de visitas funcionar com valores NULL devemos especificar o arquivo como:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;livrodevisitas id="1" conteudo="Olá amigo!" usuario="joe" criado="2010-04-24 17:15:23" /&gt;
    &lt;livrodevisitas id="2" conteudo="Eu gostei!" usuario="##NULL##" criado="2010-04-26 12:14:20" /&gt;
&lt;/dataset&gt;
</pre><p>
          Então envolvemos o Conjunto de Dados em XML Plano dentro de um Conjunto de Dados de Reposição:
        </p><pre class="screen">
require_once 'PHPUnit/Extensions/Database/DataSet/ReplacementDataSet.php';

class ReposicaoTest extends PHPUnit_Extensions_Database_TestCase
{
    public function getDataSet()
    {
        $ds = $this-&gt;createFlatXmlDataSet('meuAmbienteXmlPlano.xml');
        $rds = new PHPUnit_Extensions_Database_DataSet_ReplacementDataSet($ds);
        $rds-&gt;addFullReplacement('##NULL##', null);
        return $rds;
    }
}
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="dataset-filter"></a>Filtro de Conjunto de Dados</h4></div></div></div><p>
          Se você tiver um arquivo grande de ambiente você pode usar o Filtro de Conjunto de Dados para as listas branca e negra das tabelas e colunas que deveriam estar contidas em um sub-conjunto de dados. Isso ajuda especialmente em combinação com o BD DataSet para filtrar as colunas dos conjuntos de dados.
        </p><pre class="screen">
class FiltroConjuntoDeDadosTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testIncluirLivrodevisitasFiltrado()
    {
        $nomesTabelas = array('livrodevisitas');
        $conjuntoDados = $this-&gt;getConnection()-&gt;createDataSet();

        $filtroConjuntoDeDados = new PHPUnit_Extensions_Database_DataSet_DataSetFilter($conjuntoDados);
        $filtroConjuntoDeDados-&gt;addIncludeTables(array('livrodevisitas'));
        $filtroConjuntoDeDados-&gt;setIncludeColumnsForTable('livrodevisitas', array('id', 'conteudo'));
        // ..
    }

    public function testExcluirLivrodevisitasFiltrado()
    {
        $nomesTabelas = array('livrodevisitas');
        $conjuntoDeDados = $this-&gt;getConnection()-&gt;createDataSet();

        $filtroConjuntoDeDados = new PHPUnit_Extensions_Database_DataSet_DataSetFilter($conjuntoDeDados);
        $filtroConjuntoDeDados-&gt;addExcludeTables(array('foo', 'bar', 'baz')); // mantém apenas a tabela livrodevisitas!
        $filtroConjuntoDeDados-&gt;setExcludeColumnsForTable('livrodevisitas', array('usuario', 'criado'));
        // ..
    }
}
</pre><div class="blockquote"><blockquote class="blockquote"><p>
            <span class="strong"><strong>NOTA</strong></span> Você não pode usar ambos os filtros de coluna excluir e incluir na mesma tabela, apenas em tabelas diferentes. E mais: só é possível para a lista branca ou negra, mas não para ambas.
          </p></blockquote></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="composite-dataset"></a>Conjunto de Dados Composto</h4></div></div></div><p>
          O Conjunto de Dados composto é muito útil para agregar vários conjuntos de dados já existentes em um único Conjunto de Dados. Quando vários conjuntos de dados contém as mesmas tabelas, as linhas são anexadas na ordem especificada. Por exemplo se tivermos dois conjuntos de dados 
          <span class="emphasis"><em>ambiente1.xml</em></span>:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;livrodevisitas id="1" conteudo="Olá amigo!" usuario="joao" criado="2010-04-24 17:15:23" /&gt;
&lt;/dataset&gt;
</pre><p>
          e <span class="emphasis"><em>ambiente2.xml</em></span>:
        </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;livrodevisitas id="2" conteudo="Eu gostei!" usuario="##NULL##" criado="2010-04-26 12:14:20" /&gt;
&lt;/dataset&gt;
</pre><p>
          Usando o Conjunto de Dados Composto podemos agregar os dois arquivos de ambiente:
        </p><pre class="screen">
class CompostoTest extends PHPUnit_Extensions_Database_TestCase
{
    public function getDataSet()
    {
        $ds1 = $this-&gt;criarConjuntoDeDadosXmlPlano('ambiente1.xml');
        $ds2 = $this-&gt;criarConjuntoDeDadosXmlPlano('ambiente2.xml');

        $dsComposta = new PHPUnit_Extensions_Database_DataSet_CompositeDataSet();
        $dsComposta-&gt;adicionarConjuntoDeDados($ds1);
        $dsComposta-&gt;adicionarConjuntoDeDados($ds2);

        return $dsComposta;
    }
}
</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="beware-of-foreign-keys"></a>Cuidado com Chaves Estrangeiras</h3></div></div></div><p>
        Durante a Configuração do Ambiente a Extensão para Banco de Dados do PHPUnit insere as linhas no banco de dados na ordem que são especificadas em seu ambiente. Se seu esquema de banco de dados usa chaves estrangeiras isso significa que você tem que especificar as tabelas em uma ordem que não faça as restrições das chaves estrangeiras falharem.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="implementing-your-own-datasetsdatatables"></a>Implementando seus próprios Conjuntos de Dados/ Tabelas de Dados</h3></div></div></div><p>
        Para entender os interiores dos Conjuntos de Dados e Tabelas de Dados, vamos dar uma olhada na interface de um Conjunto de Dados. Você pode pular esta parte se você não planeja implementar sua próprio Conjunto de Dados ou Tabela de Dados.
      </p><pre class="screen">
interface PHPUnit_Extensions_Database_DataSet_IDataSet extends IteratorAggregate
{
    public function getNomesTabelas();
    public function getTabelasMetaData($nomeTabela);
    public function getTabela($nomeTabela);
    public function assertEquals(PHPUnit_Extensions_Database_DataSet_IDataSet $outra);

    public function getIteradorReverso();
}
</pre><p>
        A interface pública é usada internamente pela asserção
        <code class="literal">assertDataSetsEqual()</code> no Caso de Teste de Banco de Dados para verificar a qualidade do conjunto de dados. Da interface
        <code class="literal">IteratorAggregate</code> o IDataSet herda o método <code class="literal">getIterator()</code> para iterar sobre todas as tabelas do conjunto de dados. O método adicional do iterador reverso é requerido para truncar corretamente as tabelas em ordem reversa à especificada.
      </p><div class="blockquote"><blockquote class="blockquote"><p>
          Para entender a necessidade de um iterador reverso pense em duas tabelas
          (<span class="emphasis"><em>TabelaA</em></span> e <span class="emphasis"><em>TabelaB</em></span>) onde
          <span class="emphasis"><em>TabelaB</em></span> possui uma chave estrangeira em uma coluna da
          <span class="emphasis"><em>TabelaA</em></span>. Se para a configuração do ambiente uma linha é inserida na
          <span class="emphasis"><em>TabelaA</em></span> e então um registro dependente na
          <span class="emphasis"><em>TabelaB</em></span>, então é óbvio que para deletar todos os conteúdos das tabelas a execução em ordem reversa vai causar problemas com as restrições de chaves estrangeiras.
        </p></blockquote></div><p>
        Dependendo da implementação, diferentes abordagens são usadas para adicionar instâncias de tabela a um Conjunto de Dados. Por exemplo, tabelas são adicionadas internamente durante a construção a partir de um arquivo fonte em todas as conjuntos de dados baseadas em arquivo como <code class="literal">YamlDataSet</code>,
        <code class="literal">XmlDataSet</code> ou <code class="literal">FlatXmlDataSet</code>.
      </p><p>
        Uma tabela também é representada pela seguinte interface:
      </p><pre class="screen">
interface PHPUnit_Extensions_Database_DataSet_ITable
{
    public function getTabelaMetaDados();
    public function getContagemLinhas();
    public function getValor($linha, $coluna);
    public function getLinha($linha);
    public function assertEquals(PHPUnit_Extensions_Database_DataSet_ITable $outro);
}
</pre><p>
        Com exceção do método <code class="literal">getTabelaMetaDados()</code> isso é bastante auto-explicativo. Os métodos usados são todos requeridos para as diferentes asserções da Extensão para Banco de Dados que são explicados no próximo capítulo. O método
        <code class="literal">getTabelaMetaDados()</code> deve retornar uma implementação da interface
        <code class="literal">PHPUnit_Extensions_Database_DataSet_ITableMetaData</code>
        que descreve a estrutura da tabela. Possui informações sobre:
      </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
            O nome da tabela
          </p></li><li class="listitem"><p>
            Um vetor de nomes de coluna da tabela, ordenado por suas aparições nos resultados
          </p></li><li class="listitem"><p>
            Um vetor de colunas de chaves-primárias.
          </p></li></ul></div><p>
        Essa interface também tem uma asserção que verifica se duas instâncias da Tabela Metadados se equivalem, o que é usado pela asserção de igualdade do conjunto de dados.
      </p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="the-connection-api"></a>A API de Conexão</h2></div></div></div><p>
      Existem três métodos interessantes na interface de conexão que devem ser retornados do método
      <code class="literal">getConnection()</code> no Caso de Teste de Banco de Dados:
    </p><pre class="screen">
interface PHPUnit_Extensions_Database_DB_IDatabaseConnection
{
    public function criarConjuntoDeDados(Array $nomesTabelas = NULL);
    public function criarTabelaQuery($nomeResultado, $sql);
    public function getContagemLinhas($nomeTabela, $clausulaWhere = NULL);

    // ...
}
</pre><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          O método <code class="literal">criarConjuntoDeDados()</code> cria um Conjunto de Dados de Banco de Dados (BD) como descrito na seção de implementações de Conjunto de Dados.
        </p><pre class="screen">
class ConexaoTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testCriarConjuntoDeDados()
    {
        $nomesTabelas = array('livrodevisitas');
        $conjuntoDados = $this-&gt;getConnection()-&gt;criarConjuntoDeDados();
    }
}
</pre></li><li class="listitem"><p>
          O método <code class="literal">criarTabelaQuery()</code> 2. pode ser usado para criar instâncias de uma TabelaQuery, dê a eles um nome de resultado e uma query SQL. Este é um método conveniente quando se fala sobre asserções de tabela/resultado como será mostrado na próxima seção de API de Asserções de Banco de Dados.
        </p><pre class="screen">
class ConexaoTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testCriarTabelaQuery()
    {
        $nomesTabela = array('livrodevisitas');
        $tabelaQuery = $this-&gt;getConnection()-&gt;criarTabelaQuery('livrodevisitas', 'SELECT * FROM livrodevisitas');
    }
}
</pre></li><li class="listitem"><p>
          O método <code class="literal">getContagemLinhas()</code> é uma forma conveniente de acessar o número de linhas em uma tabela, opcionalmente filtradas por uma cláusula where adicional. Isso pode ser usado com uma simples asserção de igualdade:
        </p><pre class="screen">
class ConexaoTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testGetContagemLinhas()
    {
        $this-&gt;assertEquals(2, $this-&gt;getConnection()-&gt;getContagemLinhas('livrodevisitas'));
    }
}
</pre></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="database-assertions-api"></a>API de Asserções de Banco de Dados</h2></div></div></div><p>
      Para uma ferramenta de testes, a Extensão para Banco de Dados certamente fornece algumas asserções que você pode usar para verificar o estado atual do banco de dados, tabelas e a contagem de linhas de tabelas. Esta seção descreve essa funcionalidade em detalhes:
    </p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="asserting-the-row-count-of-a-table"></a>Assertando a contagem de linhas de uma Tabela</h3></div></div></div><p>
        Às vezes ajuda verificar se uma tabela contém uma quantidade específica de linhas. Você pode conseguir isso facilmente sem colar códigos adicionais usando a API de Conexão. Suponha que queiramos verificar se após a inserção de uma linha em nosso livro de visitas não apenas temos as duas entradas iniciais que nos acompanharam em todos os exemplos anteriores, mas uma terceira:
      </p><pre class="screen">
class LivroDeVisitasTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testAdicionaEntrada()
    {
        $this-&gt;assertEquals(2, $this-&gt;getConnection()-&gt;getContagemLinhas('livrodevisitas'), "Pre-Condition");

        $guestbook = new Guestbook();
        $guestbook-&gt;addEntry("suzy", "Olá mundo!");

        $this-&gt;assertEquals(3, $this-&gt;getConnection()-&gt;getContagemLinhas('livrodevisitas'), "Inserção falhou");
    }
}
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="asserting-the-state-of-a-table"></a>Assertando o Estado de uma Tabela</h3></div></div></div><p>
       A asserção anterior ajuda, mas certamente queremos verificar os conteúdos reais da tabela para verificar se todos os valores foram escritos nas colunas corretas. Isso pode ser conseguido com uma asserção de tabela.
      </p><p>
        Para isso vamos definir uma instância de Tabela Query que deriva seu conteúdo de um nome de tabela e de uma query SQL e compara isso a um Conjunto de Dados baseado em vetor/Arquivo:
      </p><pre class="screen">
class LivroDeVisitasTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testAdicionaEntrada()
    {
        $livrodevisitas = new LivrodeVisitas();
        $livrodevisitas-&gt;addEntry("suzy", "Olá mundo!");

        $tabelaQuery = $this-&gt;getConnection()-&gt;criaTabelaQuery(
            'livrodevisitas', 'SELECT * FROM livrodevisitas'
        );
        $tabelaEsperada = $this-&gt;criaDatasetXmlPlano("livroEsperado.xml")
                              -&gt;getTabela("livrodevisitas");
        $this-&gt;assertTablesEqual($tabelaEsperada, $tabelaQuery);
    }
}
</pre><p>
        Agora temos que escrever o arquivo XML Plano <span class="emphasis"><em>livroEsperado.xml</em></span> para esta asserção:
      </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;livrodevisitas id="1" conteudo="Olá amigo!" usuario="joao" criado="2010-04-24 17:15:23" /&gt;
    &lt;livrodevisitas id="2" conteudo="Eu gostei!" usuario="nanda" criado="2010-04-26 12:14:20" /&gt;
    &lt;livrodevisitas id="3" conteudo="Olá mundo!" usuario="suzy" criado="2010-05-01 21:47:08" /&gt;
&lt;/dataset&gt;
</pre><p>
        Apesar disso, esta asserção só vai passar em exatamente um segundo do universo, em <span class="emphasis"><em>2010–05–01 21:47:08</em></span>. Datas possuem um problema especial nos testes de bancos de dados e podemos circundar a falha omitindo a coluna <span class="quote">“<span class="quote">criado</span>”</span> da asserção.
      </p><p>
        O arquivo ajustado <span class="emphasis"><em>livroEsperado.xml</em></span> em XML Plano provavelmente vai ficar parecido com o seguinte para fazer a asserção passar:
      </p><pre class="screen">
&lt;?xml version="1.0" ?&gt;
&lt;dataset&gt;
    &lt;livrodevisitas id="1" conteudo="Olá amigo!" usuario="joao" /&gt;
    &lt;livrodevisitas id="2" conteudo="Eu gostei!" usuario="nanda" /&gt;
    &lt;livrodevisitas id="3" conteudo="Olá mundo!" usuario="suzy" /&gt;
&lt;/dataset&gt;
</pre><p>
        Nós temos que consertar a chamada da Tabela Query:
      </p><pre class="screen">
$tabelaQuery = $this-&gt;getConnection()-&gt;criarTabelaQuery(
    'livrodevisitas', 'SELECT id, conteudo, usuario FROM livrodevisitas'
);
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="asserting-the-result-of-a-query"></a>Assertando o Resultado de uma Query</h3></div></div></div><p>
        Você também pode assertar o resultado de querys complexas com a abordagem da Tabela Query, apenas especificando um nome de resultado com uma query e comparando isso a um conjunto de dados.
      </p><pre class="screen">
class QueryComplexaTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testQueryComplexa()
    {
        $tabelaQuery = $this-&gt;getConnection()-&gt;criarTabelaQuery(
            'minhaQueryComplexa', 'SELECT queryComplexa...'
        );
        $tabelaEsperada = $this-&gt;criarConjuntoDeDadosXmlPlano("assercaoQueryComplexa.xml")
                              -&gt;getTabela("minhaQueryComplexa");
        $this-&gt;assertTablesEqual($tabelaEsperada, $tabelaQuery);
    }
}
</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="asserting-the-state-of-multiple-tables"></a>Assertando o Estado de Múltiplas Tabelas</h3></div></div></div><p>
        Certamente você pode assertar o estado de múltiplas tabelas de uma vez e comparar um conjunto de dados de query contra um conjunto de dados baseado em arquivo. Existem duas formas diferentes de asserções de Conjuntos de Dados.
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
            Você pode usar o Conjunto de Dados de Banco de Dados (BD) e compará-lo com um Conjunto de Dados Baseado em Arquivo.
          </p><pre class="screen">
class AssercaoConjuntoDeDadosTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testCriarAssercaoDeConjuntoDeDados()
    {
        $conjuntoDeDados = $this-&gt;getConnection()-&gt;criaConjuntoDeDados(array('livrodevisitas'));
        $conjuntoDeDadosEsperado = $this-&gt;createFlatXmlDataSet('livrodevisitas.xml');
        $this-&gt;assertDataSetsEqual($conjuntoDeDadosEsperado, $conjuntoDeDados);
    }
}
</pre></li><li class="listitem"><p>
            Você pode construir o Conjunto de Dados por si mesmo:
          </p><pre class="screen">
class AssercoesConjuntoDeDadosTest extends PHPUnit_Extensions_Database_TestCase
{
    public function testAssercaoManualDeConjuntoDeDados()
    {
        $conjuntoDeDados = new PHPUnit_Extensions_Database_DataSet_QueryDataSet();
        $conjuntoDeDados-&gt;addTable('livrodevisitas', 'SELECT id, conteudo, usuario FROM livrodevisitas'); // tabelas adicionais
        $conjuntoDeDadosEsperado = $this-&gt;createFlatXmlDataSet('livrodevisitas.xml');

        $this-&gt;assertDataSetsEqual($conjuntoDeDadosEsperado, $conjuntoDeDados);
    }
}
</pre></li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="frequently-asked-questions"></a>Perguntas Mais Frequentes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="will-phpunit-re-create-the-database-schema-for-each-test"></a>O PHPUnit vai (re)criar o esquema do banco de dados para cada teste?</h3></div></div></div><p>
        Não, o PHPUnit exige que todos os objetos do banco de dados estejam disponíveis quando a suíte começar os testes. O Banco de Dados, tabelas, sequências, gatilhos e visualizações devem ser criadas antes que você execute a suíte de testes.
      </p><p>
        <a class="ulink" href="http://www.doctrine-project.org" target="_top">Doctrine 2</a> ou
        <a class="ulink" href="http://www.ezcomponents.org" target="_top">eZ Components</a> possuem ferramentas poderosas que permitem a você criar o esquema de banco de dados através de estruturas de dados pré-definidas, porém devem ser ligados à extensão do PHPUnit para permitir a recriação automática de banco de dados antes que a suíte de testes completa seja executada.
      </p><p>
        Já que cada teste limpa completamente o banco de dados, você nem sequer é forçado a recriar o banco de dados para cada execução de teste. Um banco de dados permanentemente disponível funciona perfeitamente.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="am-i-required-to-use-pdo-in-my-application-for-the-database-extension-to-work"></a>Sou forçado a usar PDO em minha aplicação para que a Extensão para Banco de Dados funcione?</h3></div></div></div><p>
        Não, PDO só é exigido para limpeza e configuração do ambiente e para asserções. Você pode usar qualquer abstração de banco de dados que quiser dentro de seu próprio código.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="what-can-i-do-when-i-get-a-too-much-connections-error"></a>O que posso fazer quando recebo um Erro 
             <span class="quote">“<span class="quote">Too much Connections</span>”</span>?</h3></div></div></div><p>
        Se você não armazena em cache a instância de PDO que é criada a partir do método do Caso de Teste <code class="literal">getConnection()</code> o número de conexões ao banco de dados é aumentado em um ou mais com cada teste do banco de dados. Com a configuração padrão o MySQL só permite 100 conexões concorrentes e outros fornecedores também têm um limite máximo de conexões.
      </p><p>
        A Sub-seção
        <span class="quote">“<span class="quote">Use seu próprio Caso Abstrato de Teste de Banco de Dados</span>”</span> mostra como você pode prevenir o acontecimento desse erro usando uma instância única armazenada em cache do PDO em todos os seus testes.
      </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="how-to-handle-null-with-flat-xml-csv-datasets"></a>Como lidar com NULL usando Conjuntos de Dados XML Plano / CSV?</h3></div></div></div><p>
        Não faça isso. Em vez disso, você deveria usar Conjuntos de Dados ou XML ou YAML.
      </p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="incomplete-and-skipped-tests"></a>Capítulo 9. Testes Incompletos e Pulados</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="incomplete-and-skipped-tests.incomplete-tests"></a>Testes Incompletos</h2></div></div></div><p>
      Quando você está trabalhando em uma nova classe de caso de teste, você pode querer começar a escrever métodos de teste vazios, como:
</p><pre class="programlisting"><code>public function testAlgumaCoisa()
{
}</code></pre><p> 
para manter o controle sobre os testes que você já escreveu. O problema com os métodos de teste vazios é que eles são interpretados como bem-sucedidos pelo framework do PHPUnit. Esse erro de interpretação leva à inutilização dos relatórios de testes -- você não pode ver se um teste foi realmente bem-sucedido ou simplesmente ainda não foi implementado. Chamar <code class="literal">$this-&gt;fail()</code> no teste não implementado não ajuda em nada, já que o teste será interpretado como uma falha. Isso seria tão errado quando interpretar um teste não implementado como bem-sucedido.
    </p><p>
      <a id="idp33922560" class="indexterm"></a>
      <a id="idp33923376" class="indexterm"></a>
      <a id="idp33924208" class="indexterm"></a>

      Se imaginarmos que um teste bem-sucedido é uma luz verde e um teste mal-sucedido (falho) é uma luz vermelha, precisaremos de uma luz amarela adicional para marcar o teste como incompleto ou ainda não implementado. O 
      <code class="literal">PHPUnit_Framework_IncompleteTest</code> é uma interface marcadora para marcar uma exceção que surge de um método de teste como resultado do teste ser incompleto ou atualmente não implementado. O 
      <code class="literal">PHPUnit_Framework_IncompleteTestError</code> é a implementação padrão dessa interface.
    </p><p>
      <a class="xref" href="#incomplete-and-skipped-tests.incomplete-tests.examples.SampleTest.php" title="Exemplo 9.1: Marcando um teste como incompleto">Exemplo 9.1</a>
      mostra uma classe de caso de teste, <code class="literal">ExemploTest</code>, que contém um método de teste, <code class="literal">testAlgumaCoisa()</code>. Chamando o método de conveniência <code class="literal">markTestIncomplete()</code> (que automaticamente traz uma exceção <code class="literal">PHPUnit_Framework_IncompleteTestError</code>) no método de teste, marcamos o teste como sendo incompleto.
    </p><div class="example"><a id="incomplete-and-skipped-tests.incomplete-tests.examples.SampleTest.php"></a><p class="title"><strong>Exemplo 9.1: Marcando um teste como incompleto</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ExemploTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Opcional:&nbsp;Teste&nbsp;alguma&nbsp;coisa&nbsp;aqui,&nbsp;se&nbsp;quiser</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'Já&nbsp;deveria&nbsp;funcionar.'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Pare&nbsp;aqui&nbsp;e&nbsp;marque&nbsp;este&nbsp;teste&nbsp;como&nbsp;incompleto.</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">markTestIncomplete</span><span class="keyword">(</span><br /><span class="string">'Este&nbsp;teste&nbsp;ainda&nbsp;não&nbsp;foi&nbsp;implementado.'</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Um teste incompleto é denotado por um <code class="literal">I</code> na saída do executor de testes em linha-de-comando do PHPUnit, como mostrado no exemplo abaixo:
    </p><pre class="screen"><strong class="userinput"><code>phpunit --verbose ExemploTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

I

Time: 0 seconds, Memory: 3.75Mb

There was 1 incomplete test:

1) ExemploTest::testAlgumaCoisa
Este teste ainda não foi implementado.

/home/sb/SampleTest.php:12
OK, but incomplete or skipped tests!
Tests: 1, Assertions: 1, Incomplete: 1.</pre><p>
      <a class="xref" href="#incomplete-and-skipped-tests.incomplete-tests.tables.api" title="Tabela 9.1. API para Testes Incompletos">Tabela 9.1</a>
      mostra a API para marcar testes como incompletos.
    </p><div class="table"><a id="incomplete-and-skipped-tests.incomplete-tests.tables.api"></a><p class="title"><strong>Tabela 9.1. API para Testes Incompletos</strong></p><div class="table-contents"><table summary="API para Testes Incompletos" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Método</th><th align="left">Significado</th></tr></thead><tbody><tr><td align="left"><code class="literal">void markTestIncomplete()</code></td><td align="left">Marca o teste atual como incompleto.</td></tr><tr><td align="left"><code class="literal">void markTestIncomplete(string $mensagem)</code></td><td align="left">Marca o teste atual como incompleto usando <code class="literal">$menssagem</code> como uma mensagem explanatória.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="incomplete-and-skipped-tests.skipping-tests"></a>Pulando Testes</h2></div></div></div><p>
      Nem todos os testes podem ser executados em qualquer ambiente. Considere, por exemplo, uma camada de abstração de banco de dados contendo vários drivers para os vários sistemas de banco de dados que suporta. Os testes para o driver MySQL podem ser executados apenas, é claro, se um servidor MySQL estiver disponível.
    </p><p>
      <a class="xref" href="#incomplete-and-skipped-tests.skipping-tests.examples.DatabaseTest.php" title="Exemplo 9.2: Pulando um teste">Exemplo 9.2</a>
      mostra uma classe de caso de teste, <code class="literal">BancoDeDadosTest</code>, que contém um método de teste, <code class="literal">testConnection()</code>. No método modelo da classe do caso de teste
      <code class="literal">setUp()</code>, verificamos se uma extensão MySQLi está disponível e usamos o método <code class="literal">markTestSkipped()</code>para pular o teste caso contrário.
    </p><div class="example"><a id="incomplete-and-skipped-tests.skipping-tests.examples.DatabaseTest.php"></a><p class="title"><strong>Exemplo 9.2: Pulando um teste</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">BancoDeDadosTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="keyword">!</span><span class="default">extension_loaded</span><span class="keyword">(</span><span class="string">'mysqli'</span><span class="keyword">)</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">markTestSkipped</span><span class="keyword">(</span><br /><span class="string">'A&nbsp;extensão&nbsp;MySQLi&nbsp;não&nbsp;está&nbsp;disponível.'</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testConnection</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;...</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Um teste que tenha sido pulado é denotado por um <code class="literal">S</code> na saída do executor de testes em linha-de-comando do PHPUnit, como mostrado no seguinte exemplo:
    </p><pre class="screen"><strong class="userinput"><code>phpunit --verbose BancoDeDadosTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

S

Time: 0 seconds, Memory: 3.75Mb

There was 1 skipped test:

1) BancoDeDadosTest::testConnection
A extensão MySQLi não está disponível.

/home/sb/BancoDeDadosTest.php:9
OK, but incomplete or skipped tests!
Tests: 1, Assertions: 0, Skipped: 1.</pre><p>
      <a class="xref" href="#incomplete-and-skipped-tests.skipped-tests.tables.api" title="Tabela 9.2. API para Pular Testes">Tabela 9.2</a>
      mostra a API para pular testes.
    </p><div class="table"><a id="incomplete-and-skipped-tests.skipped-tests.tables.api"></a><p class="title"><strong>Tabela 9.2. API para Pular Testes</strong></p><div class="table-contents"><table summary="API para Pular Testes" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Método</th><th align="left">Significado</th></tr></thead><tbody><tr><td align="left"><code class="literal">void markTestSkipped()</code></td><td align="left">Marca o teste atual como pulado.</td></tr><tr><td align="left"><code class="literal">void markTestSkipped(string $menssagem)</code></td><td align="left">Marca o teste atual como pulado usando <code class="literal">$menssagem</code> como uma mensagem explanatória.</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="incomplete-and-skipped-tests.skipping-tests-using-requires"></a>Pulando Testes usando @requires</h2></div></div></div><p>
      Além do método acima também é possível usar a anotação
      <code class="literal">@requires</code> para expressar pré-condições comuns para um caso de teste.
    </p><div class="table"><a id="incomplete-and-skipped-tests.requires.tables.api"></a><p class="title"><strong>Tabela 9.3. Possíveis usos para @requires</strong></p><div class="table-contents"><table summary="Possíveis usos para @requires" border="1"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th align="left">Tipo</th><th align="left">Valores Possíveis</th><th align="left">Exemplos</th><th align="left">Outro exemplo</th></tr></thead><tbody><tr><td align="left"><code class="literal">PHP</code></td><td align="left">Qualquer identificador de versão do PHP</td><td align="left">@requires PHP 5.3.3</td><td align="left">@requires PHP 5.4-dev</td></tr><tr><td align="left"><code class="literal">PHPUnit</code></td><td align="left">Qualquer identificador de versão do PHPUnit</td><td align="left">@requires PHPUnit 3.6.3</td><td align="left">@requires PHPUnit 3.7</td></tr><tr><td align="left"><code class="literal">função</code></td><td align="left">Qualquer parâmetro válido para <a class="ulink" href="http://php.net/function_exists" target="_top">function_exists</a></td><td align="left">@requires function imap_open</td><td align="left">@requires function ReflectionMethod::setAccessible</td></tr><tr><td align="left"><code class="literal">extensão</code></td><td align="left">Qualquer nome de extensão</td><td align="left">@requires extension mysqli</td><td align="left">@requires extension curl</td></tr></tbody></table></div></div><br class="table-break" /><div class="example"><a id="incomplete-and-skipped-tests.skipping-tests.examples.DatabaseClassSkippingTest.php"></a><p class="title"><strong>Exemplo 9.3: Pulando casos de teste usando @requires</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@requires&nbsp;extension&nbsp;mysqli</span><br /><span class="comment">*/</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">BancoDeDadosTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@requires&nbsp;PHP&nbsp;5.3</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testConnection</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;O&nbsp;Teste&nbsp;requer&nbsp;as&nbsp;extensões&nbsp;mysqli&nbsp;e&nbsp;PHP&nbsp;&gt;=&nbsp;5.3</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">//&nbsp;...&nbsp;Todos&nbsp;os&nbsp;outros&nbsp;testes&nbsp;requerem&nbsp;a&nbsp;extensão&nbsp;mysqli</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Se você está usando uma sintaxe que não compila com uma certa versão do PHP, procure dentro da configuração xml por includes dependentes de versão na seção chamada <a class="xref" href="#appendixes.configuration.testsuites" title="Suítes de Teste">“Suítes de Teste”</a>
    </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="test-doubles"></a>Capítulo 10. Dublês de Testes</h1></div></div></div><p>
    Gerard Meszaros introduz o conceito de Dublês de Testes em
    <a class="xref" href="#Meszaros2007" title="xUnit Test Patterns: Refactoring Test Code">[<abbr class="abbrev">Meszaros2007</abbr>]</a> desta forma:
  </p><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
      <a id="idp34030224" class="indexterm"></a>

      Às vezes é muito difícil testar o sistema sob teste (SST) porque isso depende de outros ambientes que não podem ser usados no ambiente de testes. Isso pode ser porque não estão disponíveis, não retornarão os resultados necessários para o teste, ou porque executá-los causaria efeitos colaterais indesejáveis. Em outros casos, nossa estratégia de testes requer que tenhamos mais controle ou visibilidade do comportamento interno do SST.
    </p><p>
      <a id="idp34069424" class="indexterm"></a>
      <a id="idp34070208" class="indexterm"></a>

      Quando estamos escrevendo um teste no qual não podemos (ou decidimos não) usar um ambiente realmente dependente (DOC), podemos substitui-lo por um Dublê de Teste. O Dublê de Teste não precisa se comportar exatamente como o DOC real; apenas precisa fornecer a mesma API como o real, de forma que o SST pense que é o real!
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Gerard Meszaros</span></td></tr></table></div><p>
    O método <code class="literal">getMock($nomeClasse)</code> fornecido pelo PHPUnit pode ser usado em um teste para gerar automaticamente um objeto que possa atuar como um dublê de teste para a classe original especificada. Esse objeto de dublê de teste pode ser usado em cada contexto onde um objeto da classe original é esperado.
  </p><p>
    Por padrão, todos os métodos da classe original são substituídos com uma implementação simulada que apenas retorna <code class="literal">NULL</code> (sem chamar o método original). Usando o método <code class="literal">will($this-&gt;returnValue())</code>, por exemplo, você pode configurar essas implementações simuladas para retornar um valor quando chamadas.
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Limitações</h3><p>
      Por favor, note que os métodos <code class="literal">final</code>, <code class="literal">private</code>
      e <code class="literal">static</code> não podem ser esboçados (stubbed) ou falsificados (mocked). Eles são ignorados pela funcionalidade de dublê de teste do PHPUnit e mantêm seus comportamentos originais.
    </p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Aviso</h3><p>
        Por favor atente para o fato de que a gestão de parâmetros foi mudada. A implementação anterior clona todos os parâmetros de objetos. Isso não permite verificar se o mesmo objeto foi passado para um método ou não.
        <a class="xref" href="#test-doubles.mock-objects.examples.clone-object-parameters-usecase.php" title="Exemplo 10.14: Testando se um método é chamado uma vez e com o objeto idêntico ao que foi passado">Exemplo 10.14</a> mostra onde a nova implementação pode ser útil.
        <a class="xref" href="#test-doubles.mock-objects.examples.enable-clone-object-parameters.php" title="Exemplo 10.15: Criando um objeto falso com clonagem de parâmetros ativada">Exemplo 10.15</a> mostra como voltar para o comportamento anterior.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="test-doubles.stubs"></a>Esboços (stubs)</h2></div></div></div><p>
      <a id="idp34084608" class="indexterm"></a>

      A prática de substituir um objeto por um dublê de teste que (opcionalmente) retorna valores de retorno configurados é chamada de
      <span class="emphasis"><em>esboçamento</em></span>. Você pode usar um <span class="emphasis"><em>esboço</em></span> para "substituir um ambiente real do qual o SST depende de modo que o teste tenha um ponto de controle para as entradas indiretas do SST. Isso permite ao teste forçar o SST através de caminhos que não seriam executáveis de outra forma."
    </p><p>
      <a id="idp34087504" class="indexterm"></a>

      <a class="xref" href="#test-doubles.stubs.examples.StubTest.php" title="Exemplo 10.2: Esboçando uma chamada de método para retornar um valor fixo">Exemplo 10.2</a> mostra como esboçar chamadas de método e configurar valores de retorno. Primeiro usamos o método
      <code class="literal">getMock()</code> que é fornecido pela classe
      <code class="literal">PHPUnit_Framework_TestCase</code> para configurar um esboço de objeto que parece com um objeto de <code class="literal">SomeClass</code>
      (<a class="xref" href="#test-doubles.stubs.examples.SomeClass.php" title="Exemplo 10.1: A classe que queremos esboçar">Exemplo 10.1</a>). Então usamos a <a class="ulink" href="http://martinfowler.com/bliki/FluentInterface.html" target="_top">Interface Fluente</a>
      que o PHPUnit fornece para especificar o comportamento para o esboço. Essencialmente, isso significa que você não precisa criar vários objetos temporários e uni-los depois. Em vez disso, você encadeia chamadas de método como mostrado no exemplo. Isso leva a códigos mais legíveis e "fluentes".
    </p><div class="example"><a id="test-doubles.stubs.examples.SomeClass.php"></a><p class="title"><strong>Exemplo 10.1: A classe que queremos esboçar</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">AlgumaClasse</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Faça&nbsp;algo.</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><div class="example"><a id="test-doubles.stubs.examples.StubTest.php"></a><p class="title"><strong>Exemplo 10.2: Esboçando uma chamada de método para retornar um valor fixo</strong></p><div class="example-contents"><a id="idp34096544" class="indexterm"></a><a id="idp34097360" class="indexterm"></a><a id="idp34098176" class="indexterm"></a><a id="idp34098992" class="indexterm"></a><a id="idp34099808" class="indexterm"></a><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'AlgumaClasse.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">EsbocoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testEsboco</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Cria&nbsp;um&nbsp;esboço&nbsp;para&nbsp;a&nbsp;classe&nbsp;AlgumaClasse.</span><br /><span class="default">$esboco</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="string">'AlgumaClasse'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Configura&nbsp;o&nbsp;esboço.</span><br /><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">any</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'fazAlgumaCoisa'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">will</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">returnValue</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Chamando&nbsp;$esboco-&gt;fazAlgumaCoisa()&nbsp;agora&nbsp;vai&nbsp;retornar&nbsp;'foo'.</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      "Atrás dos bastidores" o PHPUnit automaticamente gera uma nova classe PHP que implementa o comportamento desejado quando um método <code class="literal">getMock()</code>
      é usado. A classe de dublê de teste gerada pode ser configurada através dos argumentos opcionais do método <code class="literal">getMock()</code>.
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Por padrão, todos os métodos das classes fornecidas são substituídos com um dublê de teste que apenas retorna <code class="literal">NULL</code> a menos que um valor de retorno seja configurado usando <code class="literal">will($this-&gt;returnValue())</code>, por exemplo.</p></li><li class="listitem"><p>Quando o segundo parâmetro (opcional) é fornecido, apenas os métodos cujos nomes estão no vetor são substituídos com um dublê de teste configurável. O comportamento dos outros métodos não é alterado.</p></li><li class="listitem"><p>O terceiro parâmetro (opcional) pode conter um vetor de parâmetros que é passado para o construtor da classe original (que por padrão não é substituído com a implementação falsa).</p></li><li class="listitem"><p>O quarto parâmetro (opcional) pode ser usado para especificar um nome de classe para a classe de dublê de teste gerada.</p></li><li class="listitem"><p>O quinto parâmetro (opcional) pode ser usado para desabilitar a chamada para o construtor da classe original.</p></li><li class="listitem"><p>O sexto parâmetro (opcional) pode ser usado para desabilitar a chamada para o construtor do clone da classe original.</p></li><li class="listitem"><p>O sétimo parâmetro (opcional) pode ser usado para desabilitar o <code class="literal">__autoload()</code> durante a geração da classe de dublê de teste.</p></li></ul></div><p>
      Alternativamente, a Mock Builder API pode ser usada para configurar a classe de dublê de teste gerada. <a class="xref" href="#test-doubles.stubs.examples.StubTest2.php" title="Exemplo 10.3: Usando a Mock Builder API para configurar a classe de dublê de teste gerada">Exemplo 10.3</a>
      mostra um exemplo. Aqui temos uma lista dos métodos que podem ser usados na interface fluente do Mock Builder:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">setMethods(vetor $metodos)</code> pode ser chamado no objeto Mock Builder para especificar os métodos que devem ser substituídos com um dublê de teste configurável. O comportamento dos outros métodos não muda.</p></li><li class="listitem"><p><code class="literal">setConstructorArgs(vetor $args)</code> pode ser chamado para fornecer um vetor de parâmetros que é passado ao construtor da classe original (que por padrão não é substituído com uma implementação falsa).</p></li><li class="listitem"><p><code class="literal">setMockClassName($nome)</code> pode ser usado para especificar um nome de classe para a classe de dublê de teste gerada.</p></li><li class="listitem"><p><code class="literal">disableOriginalConstructor()</code> pode ser usado para desabilitar a chamada ao construtor da classe original.</p></li><li class="listitem"><p><code class="literal">disableOriginalClone()</code> pode ser usado para desabilitar a chamada ao construtor do clone da classe original.</p></li><li class="listitem"><p><code class="literal">disableAutoload()</code> pode ser usado para desabilitar o <code class="literal">__autoload()</code> durante a geração da classe de dublê de teste.</p></li></ul></div><div class="example"><a id="test-doubles.stubs.examples.StubTest2.php"></a><p class="title"><strong>Exemplo 10.3: Usando a Mock Builder API para configurar a classe de dublê de teste gerada</strong></p><div class="example-contents"><a id="idp34123904" class="indexterm"></a><a id="idp34124720" class="indexterm"></a><a id="idp34125536" class="indexterm"></a><a id="idp34126352" class="indexterm"></a><a id="idp34127168" class="indexterm"></a><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'AlgumaClasse.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">EsbocoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testEsboco</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Cria&nbsp;um&nbsp;esboço&nbsp;para&nbsp;a&nbsp;classe&nbsp;AlgumaClasse.</span><br /><span class="default">$esboco</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMockBuilder</span><span class="keyword">(</span><span class="string">'AlgumaClasse'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">disableOriginalConstructor</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Configura&nbsp;o&nbsp;esboço.</span><br /><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">any</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'fazAlgumaCoisa'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">will</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">returnValue</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Chamar&nbsp;$esboco-&gt;fazAlgumaCoisa()&nbsp;agora&nbsp;vai&nbsp;retornar&nbsp;'foo'.</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Às vezes você quer retornar um dos argumentos de uma chamada de método (inalterada) como o resultado de uma chamada ao método esboçado.
      <a class="xref" href="#test-doubles.stubs.examples.StubTest3.php" title="Exemplo 10.4: Esboçando uma chamada de método para retornar um dos argumentos">Exemplo 10.4</a> mostra como você pode conseguir isso usando <code class="literal">returnArgument()</code> em vez de
      <code class="literal">returnValue()</code>.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest3.php"></a><p class="title"><strong>Exemplo 10.4: Esboçando uma chamada de método para retornar um dos argumentos</strong></p><div class="example-contents"><a id="idp34133360" class="indexterm"></a><a id="idp34134176" class="indexterm"></a><a id="idp34134992" class="indexterm"></a><a id="idp34135808" class="indexterm"></a><a id="idp34136624" class="indexterm"></a><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'AlgumaClasse.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">EsbocoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testRetornaArgumentoEsboco</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Cria&nbsp;um&nbsp;esboço&nbsp;para&nbsp;a&nbsp;classe&nbsp;AlgumaClasse.</span><br /><span class="default">$esboco</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="string">'AlgumaClasse'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Configura&nbsp;o&nbsp;esboço.</span><br /><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">any</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'fazAlgumaCoisa'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">will</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">returnArgument</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;$esboco-&gt;fazAlgumaCoisa('foo')&nbsp;retorna&nbsp;'foo'.</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;$esboco-&gt;fazAlgumaCoisa('bar')&nbsp;retorna&nbsp;'bar'.</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'bar'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="string">'bar'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Ao testar uma interface fluente, às vezes é útil fazer um método esboçado retornar uma referência ao objeto esboçado.
      <a class="xref" href="#test-doubles.stubs.examples.StubTest4.php" title="Exemplo 10.5: Esboçando uma chamada de método para retornar uma referência ao objeto esboçado">Exemplo 10.5</a> mostra como você pode usar <code class="literal">returnSelf()</code> para conseguir isso.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest4.php"></a><p class="title"><strong>Exemplo 10.5: Esboçando uma chamada de método para retornar uma referência ao objeto esboçado</strong></p><div class="example-contents"><a id="idp34142096" class="indexterm"></a><a id="idp34142912" class="indexterm"></a><a id="idp34143728" class="indexterm"></a><a id="idp34144544" class="indexterm"></a><a id="idp34145360" class="indexterm"></a><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'AlgumaClasse.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">EsbocoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testRetornaEleMesmo</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Cria&nbsp;um&nbsp;esboço&nbsp;para&nbsp;a&nbsp;classe&nbsp;AlgumaClasse.</span><br /><span class="default">$esboco</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="string">'AlgumaClasse'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Configura&nbsp;o&nbsp;esboço.</span><br /><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">any</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'fazAlgumaCoisa'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">will</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">returnSelf</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;$esboco-&gt;fazAlgumaCoisa()&nbsp;retorna&nbsp;$esboco.</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertSame</span><span class="keyword">(</span><span class="default">$esboco</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Algumas vezes um método esboçado deveria retornar valores diferentes dependendo de uma lista predefinida de argumentos. Você pode usar
      <code class="literal">returnValueMap()</code> para criar um mapa que associa argumentos com valores de retorno correspondentes. Veja
      <a class="xref" href="#test-doubles.stubs.examples.StubTest5.php" title="Exemplo 10.6: Esboçando uma chamada de método para retornar o valor de um mapa">Exemplo 10.6</a> para ter um exemplo.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest5.php"></a><p class="title"><strong>Exemplo 10.6: Esboçando uma chamada de método para retornar o valor de um mapa</strong></p><div class="example-contents"><a id="idp34150736" class="indexterm"></a><a id="idp34151552" class="indexterm"></a><a id="idp34152368" class="indexterm"></a><a id="idp34153184" class="indexterm"></a><a id="idp34154000" class="indexterm"></a><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'AlgumaClasse.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">EsbocoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testRetornaEsbocoMapaValores</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Cria&nbsp;um&nbsp;esboço&nbsp;para&nbsp;a&nbsp;classe&nbsp;AlgumaClasse.</span><br /><span class="default">$esboco</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="string">'AlgumaClasse'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Cria&nbsp;um&nbsp;mapa&nbsp;de&nbsp;argumentos&nbsp;para&nbsp;valores&nbsp;retornados.</span><br /><span class="default">$mapa</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="string">'a'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'b'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'c'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'d'</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="string">'e'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'f'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'g'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'h'</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Configura&nbsp;o&nbsp;esboço.</span><br /><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">any</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'fazAlgumaCoisa'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">will</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">returnValueMap</span><span class="keyword">(</span><span class="default">$mapa</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;$esboco-&gt;fazAlgumaCoisa()&nbsp;retorna&nbsp;valores&nbsp;diferentes&nbsp;dependendo</span><br /><span class="comment">//&nbsp;dos&nbsp;argumentos&nbsp;fornecidos.</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'d'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="string">'a'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'b'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'c'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'h'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="string">'e'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'f'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'g'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Quando a chamada ao método esboçado deve retornar um valor calculado em vez de um fixo (veja <code class="literal">returnValue()</code>) ou um argumento (inalterado) (veja <code class="literal">returnArgument()</code>), você pode usar
      <code class="literal">returnCallback()</code> para que o método esboçado retorne o resultado da função ou método callback. Veja
      <a class="xref" href="#test-doubles.stubs.examples.StubTest6.php" title="Exemplo 10.7: Esboçando uma chamada de método para retornar um valor de um callback">Exemplo 10.7</a> para ter um exemplo.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest6.php"></a><p class="title"><strong>Exemplo 10.7: Esboçando uma chamada de método para retornar um valor de um callback</strong></p><div class="example-contents"><a id="idp34161280" class="indexterm"></a><a id="idp34162096" class="indexterm"></a><a id="idp34162912" class="indexterm"></a><a id="idp34163728" class="indexterm"></a><a id="idp34164544" class="indexterm"></a><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'AlgumaClasse.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">EsbocoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testRetornaEsbocoCallback</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Cria&nbsp;um&nbsp;esboço&nbsp;para&nbsp;a&nbsp;classe&nbsp;AlgumaClasse.</span><br /><span class="default">$esboco</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="string">'AlgumaClasse'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Configura&nbsp;o&nbsp;esboço.</span><br /><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">any</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'fazAlgumaCoisa'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">will</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">returnCallback</span><span class="keyword">(</span><span class="string">'str_rot13'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;$esboco-&gt;fazAlgumaCoisa($argumento)&nbsp;retorna&nbsp;str_rot13($argumento).</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'fbzrguvat'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="string">'algo'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Uma alternativa mais simples para configurar um método callback pode ser especificar uma lista de valores de retorno desejados. Você pode fazer isso com o método <code class="literal">onConsecutiveCalls()</code>. Veja
      <a class="xref" href="#test-doubles.stubs.examples.StubTest7.php" title="Exemplo 10.8: Esboçando uma chamada de método para retornar uma lista de valores na ordem especificada">Exemplo 10.8</a> para ter um exemplo.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest7.php"></a><p class="title"><strong>Exemplo 10.8: Esboçando uma chamada de método para retornar uma lista de valores na ordem especificada</strong></p><div class="example-contents"><a id="idp34169968" class="indexterm"></a><a id="idp34170784" class="indexterm"></a><a id="idp34171600" class="indexterm"></a><a id="idp34172416" class="indexterm"></a><a id="idp34173232" class="indexterm"></a><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'AlgumaClasse.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">EsbocoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testEsbocoChamadasConsecutivas</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Cria&nbsp;um&nbsp;esboço&nbsp;para&nbsp;a&nbsp;classe&nbsp;AlgumaClasse.</span><br /><span class="default">$esboco</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="string">'AlgumaClasse'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Configura&nbsp;o&nbsp;esboço.</span><br /><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">any</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'fazAlgumaCoisa'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">will</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">onConsecutiveCalls</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">3</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">5</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">7</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;$esboco-&gt;fazAlgumaCoisa()&nbsp;retorna&nbsp;um&nbsp;valor&nbsp;diferente&nbsp;de&nbsp;cada&nbsp;vez</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">2</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">3</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">5</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Em vez de retornar um valor, um método esboçado também pode causar uma exceção. <a class="xref" href="#test-doubles.stubs.examples.StubTest8.php" title="Exemplo 10.9: Esboçando uma chamada de método para lançar uma exceção">Exemplo 10.9</a>
      mostra como usar <code class="literal">throwException()</code> para fazer isso.
    </p><div class="example"><a id="test-doubles.stubs.examples.StubTest8.php"></a><p class="title"><strong>Exemplo 10.9: Esboçando uma chamada de método para lançar uma exceção</strong></p><div class="example-contents"><a id="idp34178672" class="indexterm"></a><a id="idp34179488" class="indexterm"></a><a id="idp34180304" class="indexterm"></a><a id="idp34181120" class="indexterm"></a><a id="idp34181904" class="indexterm"></a><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'AlgumaClasse.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">EsbocoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testEsbocoLancaExcecao</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Cria&nbsp;um&nbsp;esboço&nbsp;para&nbsp;a&nbsp;classe&nbsp;AlgumaClasse.</span><br /><span class="default">$esboco</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="string">'AlgumaClasse'</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Configura&nbsp;o&nbsp;esboço.</span><br /><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">any</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'fazAlgumaCoisa'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">will</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">throwException</span><span class="keyword">(</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Exception</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;$esboco-&gt;fazAlgumaCoisa()&nbsp;lança&nbsp;uma&nbsp;exceção</span><br /><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Alternativamente, você mesmo pode escrever um esboço enquanto melhora o design. Recursos amplamente utilizados são acessados através de uma única fachada, então você pode substituir facilmente o recurso pelo esboço. Por exemplo, em vez de ter chamadas diretas ao banco de dados espalhadas pelo código, você tem um único objeto <code class="literal">BancoDeDados</code> que implementa a interface <code class="literal">IBancoDeDados</code> . Então, você pode criar um esboço de implementação da <code class="literal">IBancoDeDados</code> e usá-la em seus testes. Você pode até criar uma opção para executar os testes com o esboço do banco de dados ou com o banco de dados real, então você pode usar seus testes tanto para testes locais durante o desenvolvimento quanto para integração dos testes com o banco de dados real.
    </p><p>
      Funcionalidades que precisam ser esboçadas tendem a se agrupar no mesmo objeto, aumentando a coesão. Por apresentar a funcionalidade com uma interface única e coerente, você reduz o acoplamento com o resto do sistema.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="test-doubles.mock-objects"></a>Objetos Falsos</h2></div></div></div><p>
      A prática de substituir um objeto por um dublê de teste que verifica expectativas, por exemplo assertando um método chamado, é conhecido como <span class="emphasis"><em>falsificação (mocking)</em></span>.
    </p><p>
      <a id="idp34191632" class="indexterm"></a>

      Você pode usar um <span class="emphasis"><em>objeto falso</em></span> "como um ponto de observação que é usado para verificar as saídas indiretas do SST durante seu exercício. Tipicamente, o objeto falso também inclui a funcionalidade de um esboço de teste que deve retornar valores para o SST se ainda não tiver falhado nos testes, mas a ênfase está na verificação das saídas indiretas. Portanto, um objeto falso é muito mais que apenas um esboço de testes mais asserções; é utilizado de uma forma fundamentalmente diferente".
    </p><p>
      Aqui está um exemplo: suponha que queiramos testar se o método correto,
      <code class="literal">update()</code> em nosso exemplo, é chamado em um objeto que observa outro objeto. <a class="xref" href="#test-doubles.mock-objects.examples.SUT.php" title="Exemplo 10.10: As classes Sujeito e Observador que são parte do Sistema Sob Teste (SST)">Exemplo 10.10</a> mostra o código para as classes <code class="literal">Sujeito</code> e <code class="literal">Observador</code>
      que são parte do Sistema Sob Teste (SST).
    </p><div class="example"><a id="test-doubles.mock-objects.examples.SUT.php"></a><p class="title"><strong>Exemplo 10.10: As classes Sujeito e Observador que são parte do Sistema Sob Teste (SST)</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">Sujeito</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$observadores</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">anexar</span><span class="keyword">(</span><span class="default">Observador</span><span class="default">&nbsp;</span><span class="default">$observador</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">observadors</span><span class="keyword">[</span><span class="keyword">]</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$observador</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Faça&nbsp;algo.</span><br /><span class="comment">//&nbsp;...</span><br />&nbsp;<br /><span class="comment">//&nbsp;Notifica&nbsp;aos&nbsp;observadores&nbsp;que&nbsp;fizemos&nbsp;algo.</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">notify</span><span class="keyword">(</span><span class="string">'algo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">fazAlgumaCoisaRuim</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">foreach</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">observadores</span><span class="default">&nbsp;</span><span class="keyword">as</span><span class="default">&nbsp;</span><span class="default">$observador</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$observador</span><span class="keyword">-&gt;</span><span class="default">reportError</span><span class="keyword">(</span><span class="default">42</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'Alguma&nbsp;coisa&nbsp;ruim&nbsp;aconteceu.'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">notify</span><span class="keyword">(</span><span class="default">$argumento</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">foreach</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">observadores</span><span class="default">&nbsp;</span><span class="keyword">as</span><span class="default">&nbsp;</span><span class="default">$observador</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$observador</span><span class="keyword">-&gt;</span><span class="default">update</span><span class="keyword">(</span><span class="default">$argumento</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">//&nbsp;Outros&nbsp;métodos.</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">Observador</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">update</span><span class="keyword">(</span><span class="default">$argumento</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Faça&nbsp;algo.</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">realatarErro</span><span class="keyword">(</span><span class="default">$codigoErro</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$mensagemErro</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">Sujeito</span><span class="default">&nbsp;</span><span class="default">$sujeito</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Faça&nbsp;algo.</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">//&nbsp;Outros&nbsp;métodos.</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      <a id="idp34199440" class="indexterm"></a>

      <a class="xref" href="#test-doubles.mock-objects.examples.SubjectTest.php" title="Exemplo 10.11: Testando se um método é chamado uma vez e com o argumento especificado">Exemplo 10.11</a>
      mostra como usar um objeto falso para testar a interação entre os objetos
      <code class="literal">Sujeito</code> e <code class="literal">Observador</code>.
    </p><p>
      Primeiro usamos o método <code class="literal">getMock()</code> que é fornecido pela classe <code class="literal">PHPUnit_Framework_TestCase</code> para configurar um objeto falso para ser o <code class="literal">Observer</code>. Já que fornecemos um vetor como segundo parâmetro (opcional) para o método <code class="literal">getMock()</code> apenas o método <code class="literal">update()</code> da classe <code class="literal">Observador</code> é substituído por uma implementação falsificada.
    </p><div class="example"><a id="test-doubles.mock-objects.examples.SubjectTest.php"></a><p class="title"><strong>Exemplo 10.11: Testando se um método é chamado uma vez e com o argumento especificado</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">SujeitoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testObservadoresEstaoAtualizados</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Cria&nbsp;uma&nbsp;falsificação&nbsp;para&nbsp;a&nbsp;classe&nbsp;Observador,</span><br /><span class="comment">//&nbsp;apenas&nbsp;falsificando&nbsp;o&nbsp;método&nbsp;atualizar().</span><br /><span class="default">$observador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="string">'Observador'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'atualizar'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Configura&nbsp;a&nbsp;expectativa&nbsp;para&nbsp;o&nbsp;método&nbsp;atualizar()</span><br /><span class="comment">//&nbsp;para&nbsp;ser&nbsp;chamado&nbsp;apenas&nbsp;uma&nbsp;vez&nbsp;e&nbsp;com&nbsp;a&nbsp;string&nbsp;'algo'</span><br /><span class="comment">//&nbsp;como&nbsp;seu&nbsp;parâmetro.</span><br /><span class="default">$observador</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">once</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'atualizar'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">with</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">equalTo</span><span class="keyword">(</span><span class="string">'algo'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Cria&nbsp;um&nbsp;objeto&nbsp;Sujeito&nbsp;e&nbsp;anexa&nbsp;a&nbsp;ele&nbsp;o&nbsp;objeto</span><br /><span class="comment">//&nbsp;Observador&nbsp;falso.</span><br /><span class="default">$sujeito</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Subject</span><span class="keyword">;</span><br /><span class="default">$sujeito</span><span class="keyword">-&gt;</span><span class="default">attach</span><span class="keyword">(</span><span class="default">$observador</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Chama&nbsp;o&nbsp;método&nbsp;fazAlgumaCoisa()&nbsp;no&nbsp;objeto&nbsp;$sujeito</span><br /><span class="comment">//&nbsp;no&nbsp;qual&nbsp;esperamos&nbsp;chamar&nbsp;o&nbsp;método&nbsp;atualizar()</span><br /><span class="comment">//&nbsp;do&nbsp;objeto&nbsp;falso&nbsp;Observador,&nbsp;com&nbsp;a&nbsp;string&nbsp;'algo'.</span><br /><span class="default">$sujeito</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisa</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      O método <code class="literal">with()</code> pode receber qualquer número de argumentos, correspondendo ao número de parâmetros sendo falsos. Você pode especificar restrições mais avançadas do que uma simples igualdade no argumento do método.
    </p><div class="example"><a id="test-doubles.mock-objects.examples.MultiParameterTest.php"></a><p class="title"><strong>Exemplo 10.12: Testando se um método é chamado com um número de argumentos restringidos de formas diferentes</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">SujeitoTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testErroRelatado</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Cria&nbsp;uma&nbsp;falsificação&nbsp;para&nbsp;a&nbsp;classe&nbsp;Observador,</span><br /><span class="comment">//&nbsp;falsificando&nbsp;o&nbsp;método&nbsp;reportError()</span><br /><span class="default">$observador</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="string">'Observador'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'relatarErro'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$observador</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">once</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'relatarErro'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">with</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">greaterThan</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">stringContains</span><span class="keyword">(</span><span class="string">'Algo'</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">anything</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$sujeito</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Sujeito</span><span class="keyword">;</span><br /><span class="default">$sujeito</span><span class="keyword">-&gt;</span><span class="default">attach</span><span class="keyword">(</span><span class="default">$observador</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;O&nbsp;método&nbsp;fazAlgumaCoisaRuim()&nbsp;deveria&nbsp;relatar&nbsp;um&nbsp;erro</span><br /><span class="comment">//&nbsp;ao&nbsp;observador&nbsp;via&nbsp;método&nbsp;reportError()</span><br /><span class="default">$sujeito</span><span class="keyword">-&gt;</span><span class="default">fazAlgumaCoisaRuim</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      <a class="xref" href="#writing-tests-for-phpunit.assertions.assertThat.tables.constraints" title="Tabela 4.3. Restrições">Tabela 4.3</a>
      mostra as restrições que podem ser aplicadas aos argumentos do método e
      <a class="xref" href="#test-doubles.mock-objects.tables.matchers" title="Tabela 10.1. Equiparadores">Tabela 10.1</a>
      mostra os equiparadores que estão disponíveis para especificar o número de invocações.
    </p><div class="table"><a id="test-doubles.mock-objects.tables.matchers"></a><p class="title"><strong>Tabela 10.1. Equiparadores</strong></p><div class="table-contents"><table summary="Equiparadores" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Equiparador</th><th align="left">Significado</th></tr></thead><tbody><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_AnyInvokedCount any()</code></td><td align="left">Retorna um equiparador que corresponde quando o método que é avaliado for executado zero ou mais vezes.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_InvokedCount never()</code></td><td align="left">Retorna um equiparador que corresponde quando o método que é avaliado nunca for executado.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_InvokedAtLeastOnce atLeastOnce()</code></td><td align="left">Retorna um equiparador que corresponde quando o método que é avaliado for executado pelo menos uma vez.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_InvokedCount once()</code></td><td align="left">Retorna um equiparador que corresponde quando o método que é avaliado for executado exatamente uma vez.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_InvokedCount exactly(int $conta)</code></td><td align="left">Retorna um equiparador que corresponde quando o método que é avaliado for executado exatamente <code class="literal">$conta</code> vezes.</td></tr><tr><td align="left"><code class="literal">PHPUnit_Framework_MockObject_Matcher_InvokedAtIndex at(int $indice)</code></td><td align="left">Retorna um equiparador que corresponde quando o método que é avaliado for invocado no <code class="literal">$indice</code> fornecido.</td></tr></tbody></table></div></div><br class="table-break" /><p>
      <a id="idp34243344" class="indexterm"></a>

      O método <code class="literal">getMockForAbstractClass()</code> retorna um objeto falso para uma classe abstrata. Todos os métodos abstratos da classe abstrata fornecida são falsos. Isso permite testar os métodos concretos de uma classe abstrata.
    </p><div class="example"><a id="test-doubles.mock-objects.examples.AbstractClassTest.php"></a><p class="title"><strong>Exemplo 10.13: Testando os métodos concretos de uma classe abstrata</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">abstract</span><span class="default">&nbsp;</span><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ClasseAbstrata</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">metodoConcreto</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">metodoAbstrato</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">abstract</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">metodoAbstrato</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ClasseAbstrataTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testMetodoConcreto</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$esboco</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMockForAbstractClass</span><span class="keyword">(</span><span class="string">'ClasseAbstrata'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">any</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'metodoAbstrato'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">will</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">returnValue</span><span class="keyword">(</span><span class="default">TRUE</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">$esboco</span><span class="keyword">-&gt;</span><span class="default">metodoConcreto</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><div class="example"><a id="test-doubles.mock-objects.examples.clone-object-parameters-usecase.php"></a><p class="title"><strong>Exemplo 10.14: Testando se um método é chamado uma vez e com o objeto idêntico ao que foi passado</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">FooTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testObjetoIdenticoPassado</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$objetoEsperado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">stdClass</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$falso</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="string">'stdClass'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$falso</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">once</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'foo'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">with</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">identicalTo</span><span class="keyword">(</span><span class="default">$objetoEsperado</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$falso</span><span class="keyword">-&gt;</span><span class="default">foo</span><span class="keyword">(</span><span class="default">$objetoEsperado</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><div class="example"><a id="test-doubles.mock-objects.examples.enable-clone-object-parameters.php"></a><p class="title"><strong>Exemplo 10.15: Criando um objeto falso com clonagem de parâmetros ativada</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">FooTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testObjetoIdenticoPassado</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$argumentosClonados</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">true</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$falso</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><br /><span class="string">'stdClass'</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span><br /><span class="string">''</span><span class="keyword">,</span><br /><span class="default">FALSE</span><span class="keyword">,</span><br /><span class="default">TRUE</span><span class="keyword">,</span><br /><span class="default">TRUE</span><span class="keyword">,</span><br /><span class="default">$argumentosClonados</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;ou&nbsp;usando&nbsp;o&nbsp;mock&nbsp;builder</span><br /><span class="default">$falso</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMockBuilder</span><span class="keyword">(</span><span class="string">'stdClass'</span><span class="keyword">)</span><span class="keyword">-&gt;</span><span class="default">enableArgumentCloning</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">-&gt;</span><span class="default">getMock</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;agora&nbsp;você&nbsp;falsifica&nbsp;seus&nbsp;parâmetros&nbsp;de&nbsp;clones&nbsp;de&nbsp;modo&nbsp;que&nbsp;a&nbsp;restrição&nbsp;identicalTo&nbsp;vá&nbsp;falhar.</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="test-doubles.stubbing-and-mocking-web-services"></a>Esboçando e Falsificando Serviços Web</h2></div></div></div><p>
      <a id="idp34253920" class="indexterm"></a>

      Quando sua aplicação interage com um serviço web você quer testá-lo sem realmente interagir com o serviço web. Para tornar mais fáceis o esboço e falsificação dos serviços web, o <code class="literal">getMockFromWsdl()</code>
      pode ser usado da mesma forma que o <code class="literal">getMock()</code> (vide acima). A única diferença é que <code class="literal">getMockFromWsdl()</code> retorna um esboço ou falsificação baseado em uma descrição de um serviço web em WSDL e <code class="literal">getMock()</code>
      retorna um esboço ou falsificação baseado em uma classe ou interface PHP.
    </p><p>
      <a class="xref" href="#test-doubles.stubbing-and-mocking-web-services.examples.GoogleTest.php" title="Exemplo 10.16: Esboçando um serviço web">Exemplo 10.16</a>
      mostra como <code class="literal">getMockFromWsdl()</code> pode ser usado para esboçar, por exemplo, o erviço web descrito em <code class="filename">GoogleSearch.wsdl</code>.
    </p><div class="example"><a id="test-doubles.stubbing-and-mocking-web-services.examples.GoogleTest.php"></a><p class="title"><strong>Exemplo 10.16: Esboçando um serviço web</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">GoogleTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testSearch</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$googleSearch</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getMockFromWsdl</span><span class="keyword">(</span><br /><span class="string">'GoogleSearch.wsdl'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'GoogleSearch'</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$directoryCategory</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">StdClass</span><span class="keyword">;</span><br /><span class="default">$directoryCategory</span><span class="keyword">-&gt;</span><span class="default">fullViewableName</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">''</span><span class="keyword">;</span><br /><span class="default">$directoryCategory</span><span class="keyword">-&gt;</span><span class="default">specialEncoding</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">''</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$elemento</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">StdClass</span><span class="keyword">;</span><br /><span class="default">$elemento</span><span class="keyword">-&gt;</span><span class="default">summary</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">''</span><span class="keyword">;</span><br /><span class="default">$elemento</span><span class="keyword">-&gt;</span><span class="default">URL</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'http://www.phpunit.de/'</span><span class="keyword">;</span><br /><span class="default">$elemento</span><span class="keyword">-&gt;</span><span class="default">snippet</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'...'</span><span class="keyword">;</span><br /><span class="default">$elemento</span><span class="keyword">-&gt;</span><span class="default">title</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'&lt;b&gt;PHPUnit&lt;/b&gt;'</span><span class="keyword">;</span><br /><span class="default">$elemento</span><span class="keyword">-&gt;</span><span class="default">cachedSize</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'11k'</span><span class="keyword">;</span><br /><span class="default">$elemento</span><span class="keyword">-&gt;</span><span class="default">relatedInformationPresent</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">TRUE</span><span class="keyword">;</span><br /><span class="default">$elemento</span><span class="keyword">-&gt;</span><span class="default">hostName</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'www.phpunit.de'</span><span class="keyword">;</span><br /><span class="default">$elemento</span><span class="keyword">-&gt;</span><span class="default">directoryCategory</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$directoryCategory</span><span class="keyword">;</span><br /><span class="default">$elemento</span><span class="keyword">-&gt;</span><span class="default">directoryTitle</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">''</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$resultado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">StdClass</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">documentFiltering</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">FALSE</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">searchComments</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">''</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">estimatedTotalResultsCount</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">378000</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">estimateIsExact</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">FALSE</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">resultElements</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="default">$elemento</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">searchQuery</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'PHPUnit'</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">startIndex</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">endIndex</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">searchTips</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">''</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">directoryCategories</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">searchTime</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">0.248822</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$googleSearch</span><span class="keyword">-&gt;</span><span class="default">expects</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">any</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">method</span><span class="keyword">(</span><span class="string">'doGoogleSearch'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">will</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">returnValue</span><span class="keyword">(</span><span class="default">$resultado</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;$googleSearch-&gt;doGoogleSearch()&nbsp;agora&nbsp;retornará&nbsp;um&nbsp;resultado&nbsp;esboçado</span><br /><span class="comment">*&nbsp;e&nbsp;o&nbsp;método&nbsp;doGoogleSearch()&nbsp;do&nbsp;serviço&nbsp;web&nbsp;não&nbsp;será&nbsp;invocado.</span><br /><span class="comment">*/</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><br /><span class="default">$result</span><span class="keyword">,</span><br /><span class="default">$googleSearch</span><span class="keyword">-&gt;</span><span class="default">doGoogleSearch</span><span class="keyword">(</span><br /><span class="string">'00000000000000000000000000000000'</span><span class="keyword">,</span><br /><span class="string">'PHPUnit'</span><span class="keyword">,</span><br /><span class="default">0</span><span class="keyword">,</span><br /><span class="default">1</span><span class="keyword">,</span><br /><span class="default">FALSE</span><span class="keyword">,</span><br /><span class="string">''</span><span class="keyword">,</span><br /><span class="default">FALSE</span><span class="keyword">,</span><br /><span class="string">''</span><span class="keyword">,</span><br /><span class="string">''</span><span class="keyword">,</span><br /><span class="string">''</span><br /><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="test-doubles.mocking-the-filesystem"></a>Esboçando o Sistema de Arquivos</h2></div></div></div><p>
      <a class="ulink" href="https://github.com/mikey179/vfsStream" target="_top">vfsStream</a>
      é um <a class="ulink" href="http://www.php.net/streams" target="_top">stream wrapper</a> para um
      <a class="ulink" href="http://en.wikipedia.org/wiki/Virtual_file_system" target="_top">sistema de arquivos virtual
      </a> que pode ser útil em testes unitários para falsificar um sistema de arquivos real.
    </p><p>
      Para instalar o vfsStram, o canal PEAR
      (<code class="systemitem">pear.bovigo.org</code>) que é usado para esta distribuição precisa ser registrado com o ambiente PEAR local.
    </p><pre class="screen"><strong class="userinput"><code>pear channel-discover pear.bovigo.org</code></strong></pre><p>
      Isso só precisa ser feito uma vez. Agora o Instalador PEAR pode ser usado para instalar o vfsStream:
    </p><pre class="screen"><strong class="userinput"><code>pear install bovigo/vfsStream-beta</code></strong></pre><p>
      <a class="xref" href="#test-doubles.mocking-the-filesystem.examples.Example.php" title="Exemplo 10.17: Uma classe que interage com um sistema de arquivos">Exemplo 10.17</a>
      mostra a classe que interage com o sistema de arquivos.
    </p><div class="example"><a id="test-doubles.mocking-the-filesystem.examples.Example.php"></a><p class="title"><strong>Exemplo 10.17: Uma classe que interage com um sistema de arquivos</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">Exemplo</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$id</span><span class="keyword">;</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$diretorio</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$id</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">id</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$id</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setDiretorio</span><span class="keyword">(</span><span class="default">$diretorio</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">diretorio</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$diretorio</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="default">SEPARADOR_DE_DIRETORIO</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">id</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="keyword">!</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">diretorio</span><span class="keyword">)</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">mkdir</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">diretorio</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">0700</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">TRUE</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Sem um sistema de arquivos virtual como o vfsStream não poderíamos testar o método
      <code class="literal">setDirectory()</code> isolado de influências externas (veja <a class="xref" href="#test-doubles.mocking-the-filesystem.examples.ExampleTest.php" title="Exemplo 10.18: Testando uma classe que interage com o sistema de arquivos">Exemplo 10.18</a>).
    </p><div class="example"><a id="test-doubles.mocking-the-filesystem.examples.ExampleTest.php"></a><p class="title"><strong>Exemplo 10.18: Testando uma classe que interage com o sistema de arquivos</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'Exemplo.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ExemploTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">'/id'</span><span class="keyword">)</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">rmdir</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">'/id'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testDiretorioFoiCriado</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$exemplo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Exemplo</span><span class="keyword">(</span><span class="string">'id'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertFalse</span><span class="keyword">(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">'/id'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$exemplo</span><span class="keyword">-&gt;</span><span class="default">setDiretorio</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">'/id'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">tearDown</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">file_exists</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">'/id'</span><span class="keyword">)</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">rmdir</span><span class="keyword">(</span><span class="default">dirname</span><span class="keyword">(</span><span class="default">__FILE__</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">.</span><span class="default">&nbsp;</span><span class="string">'/id'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      A abordagem acima tem várias desvantagens:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Assim como um recurso externo, podem haver problemas intermitentes com o sistema de arquivos. Isso deixa os testes com os quais interage esquisitos.</p></li><li class="listitem"><p>Nos métodos <code class="literal">setUp()</code> e <code class="literal">tearDown()</code> temos que assegurar que o diretório não existe antes e depois do teste.</p></li><li class="listitem"><p>Quando a execução do teste termina antes do método <code class="literal">tearDown()</code> ser invocado, o diretório permanece no sistema de arquivos.</p></li></ul></div><p>
      <a class="xref" href="#test-doubles.mocking-the-filesystem.examples.ExampleTest2.php" title="Exemplo 10.19: Falsificando o sistema de arquivos em um teste para a classe que interage com o sistema de arquivos">Exemplo 10.19</a>
      mostra como o vfsStream pode ser usado para falsificar o sistema de arquivos em um teste para uma classe que interage com o sistema de arquivos.
    </p><div class="example"><a id="test-doubles.mocking-the-filesystem.examples.ExampleTest2.php"></a><p class="title"><strong>Exemplo 10.19: Falsificando o sistema de arquivos em um teste para a classe que interage com o sistema de arquivos</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'vfsStream/vfsStream.php'</span><span class="keyword">;</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'Exemplo.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ExemploTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">vfsStreamWrapper</span><span class="keyword">::</span><span class="default">register</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">vfsStreamWrapper</span><span class="keyword">::</span><span class="default">setRoot</span><span class="keyword">(</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">vfsStreamDirectory</span><span class="keyword">(</span><span class="string">'diretorioExemplo'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testDiretorioFoiCriado</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$exemplo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">Exemplo</span><span class="keyword">(</span><span class="string">'id'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertFalse</span><span class="keyword">(</span><span class="default">vfsStreamWrapper</span><span class="keyword">::</span><span class="default">getRoot</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">-&gt;</span><span class="default">hasChild</span><span class="keyword">(</span><span class="string">'id'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$exemplo</span><span class="keyword">-&gt;</span><span class="default">setDirectory</span><span class="keyword">(</span><span class="default">vfsStream</span><span class="keyword">::</span><span class="default">url</span><span class="keyword">(</span><span class="string">'diretorioExemplo'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">vfsStreamWrapper</span><span class="keyword">::</span><span class="default">getRoot</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">-&gt;</span><span class="default">hasChild</span><span class="keyword">(</span><span class="string">'id'</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Isso tem várias vantagens:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>O próprio teste fica mais conciso.</p></li><li class="listitem"><p>O vfsStream concede ao desenvolvedor de testes controle total sobre a aparência do ambiente do sistema de arquivos para o código testado.</p></li><li class="listitem"><p>Já que as operações do sistema de arquivos não operam mais no sistema de arquivos real, operações de limpeza em um método <code class="literal">tearDown()</code> não são mais exigidas.</p></li></ul></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="testing-practices"></a>Capítulo 11. Práticas de Teste</h1></div></div></div><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
      Você sempre pode escrever mais testes. Porém, você vai descobrir rapidamente que apenas uma fração dos testes que você pode imaginar são realmente úteis. O que você quer é escrever testes que falham mesmo quando você acha que eles deveriam funcionar, ou testes que passam mesmo quando você acha que eles deveria falhar. Outra forma de pensar sobre isso é com relação ao custo/benefício. Você pode querer escrever testes que te darão retorno com informação.
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Erich Gamma</span></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="testing-practices.during-development"></a>Durante o Desenvolvimento</h2></div></div></div><p>
      <a id="idp34461584" class="indexterm"></a>

      Quando você precisa fazer uma mudança na estrutura interna do programa em que está trabalhando para torná-lo mais fácil de entender e mais barato de modificar sem alterar seu comportamento visível, uma suíte de testes é inestimável na aplicação das assim chamadas <a class="ulink" href="http://martinfowler.com/bliki/DefinitionOfRefactoring.html" target="_top">refatorações</a>com segurança. De outra forma, você poderia não notar o sistema quebrando enquanto você está cuidando da reestruturação.
    </p><p>
      As seguintes condições vão ajudá-lo a melhorar o código e design do seu projeto, enquanto usa testes unitários para verificar que os passos de transformação da refatoração são, de fato, preservadores de comportamento e não introduzem erros:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Todos os testes unitários são executados corretamente.</p></li><li class="listitem"><p>O código comunica seus princípios de design.</p></li><li class="listitem"><p>O código não contém redundâncias.</p></li><li class="listitem"><p>O código contém o mínimo número de classes e métodos.</p></li></ol></div><p>
      Quando você precisar adicionar novas funcionalidades ao sistema, escreva os testes primeiro. Então, você terá terminado de desenvolver quando os testes executarem. Esta prática é discutida no próximo capítulo.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="testing-practices.during-debugging"></a>Durante a Depuração</h2></div></div></div><p>
      Quando você recebe um relatório de defeito, seu impulso pode ser consertar o defeito o mais rápido possível. A experiência mostra que esse impulso não vai lhe servir bem; parece que o conserto de um defeito acaba causando outro defeito.
    </p><p>
      Você pode conter esses seus impulsos fazendo o seguinte:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
          Verifique que você pode reproduzir o defeito.
        </p></li><li class="listitem"><p>
          Encontre a demonstração em menor escala do defeito no código. Por exemplo, se um número aparece incorretamente em uma saída, encontre o objeto que está computando esse número.
        </p></li><li class="listitem"><p>
          Escreva um teste automatizado que falha agora, mas vai passar quando o defeito for consertado.
        </p></li><li class="listitem"><p>
          Conserte o defeito.
        </p></li></ol></div><p>
      Encontrar a menor reprodução confiável do defeito vai te dar a oportunidade de examinar realmente a causa do defeito. O teste que você escreve vai melhorar as chances de que, quando você consertar o defeito, você realmente tê-lo consertado, porque o novo teste reduz a probabilidade de desfazer o conserto com futuras modificações no código. Todos os testes que você escreveu antes reduzem a probabilidade de causar diferentes problemas inadvertidamente.
    </p><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
        Testes unitários oferecem muitas vantagens:
        </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Testar dá aos autores e revisores dos códigos confiança de que remendos produzem os resultados corretos.</p></li><li class="listitem"><p>Criar casos de testes é um bom ímpeto para desenvolvedores descobrirem casos extremos.</p></li><li class="listitem"><p>Testar fornece uma boa maneira de capturar regressões rapidamente, e ter certeza de que nenhuma regressão será repetida duas vezes.</p></li><li class="listitem"><p>Testes unitários fornecem exemplos funcionais de como usar uma API e podem auxiliar significativamente os trabalhos de documentação.</p></li></ul></div><p>
        No geral, testes unitários integrados reduzem o custo e o risco de qualquer mudança individual. Isso vai permitir ao projeto realizar [...] maiores mudanças arquitetônicas [...] rápida e confiavelmente.
      </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Benjamin Smedberg</span></td></tr></table></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="test-driven-development"></a>Capítulo 12. Desenvolvimento Guiado por Testes</h1></div></div></div><p>
    <a id="idp34486592" class="indexterm"></a>
    <a id="idp34487376" class="indexterm"></a>
    <a id="idp34488224" class="indexterm"></a>
    <a id="idp34489056" class="indexterm"></a>
    <a id="idp34479552" class="indexterm"></a>

    Testes Unitários são uma parte vital de várias práticas de desenvolvimento e processos como Programar Testes Primeiro, <a class="ulink" href="http://en.wikipedia.org/wiki/Extreme_Programming" target="_top">Programação Extrema</a>,
    e <a class="ulink" href="http://en.wikipedia.org/wiki/Test-driven_development" target="_top">Desenvolvimento Guiado por Testes</a>.
    Eles também permitem um <a class="ulink" href="http://en.wikipedia.org/wiki/Design_by_Contract" target="_top">Projeto-por-Contrato</a>
    em linguagens de programação que não suportam essa metodologia com construções de linguagem.
  </p><p>
    Você pode usar o PHPUnit para escrever testes uma vez que você tiver terminado de programar. Porém quanto antes um teste é escrito depois de um erro ser introduzido, mais valioso o teste se torna. Então em vez de escrever os testes meses depois do código estar "completo", podemos escrever os testes dias ou horas ou minutos depois da possível introdução de um defeito. Por que parar aqui? Por que não escrever os testes um pouco antes da possível introdução de um defeito?
  </p><p>
    Programar Testes Primeiro, que é parte da Programação Extrema e Desenvolvimento Guiado por Testes, constrói essa ideia e leva isso ao extremo. Com o poder computacional de hoje, temos a oportunidade de executar milhares de testes, milhares de vezes por dia. Nós podemos usar o retorno de todos esses testes para programar em pequenos passos, cada qual levando consigo a segurança de um novo teste automatizado além de todos os testes que vieram antes dele. Os testes são como ancoradores, assegurando que você, não importa o que aconteça, uma vez que tiver feito progresso só poderá cair até aqui.
  </p><p>
    Quando você escreve o teste primeiro ele não poderá ser executado, pois você estará chamando objetos e métodos que ainda não foram programados. Isso pode parecer estranho no começo, mas depois de um tempo você vai se acostumar. Pense em Programar Testes Primeiro como uma abordagem pragmática para seguir o princípio da programação orientada a objetos de programar para uma interface em vez de programar para uma implementação: enquanto você está escrevendo o teste você está pensando sobre a interface do objeto que está testando -- como esse objeto se parece do lado de fora. Quando você vai fazer o teste realmente funcionar, você está pensando sobre pura implementação. A interface é consertada a partir da falha desse teste.
  </p><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
      O ponto do <a class="ulink" href="http://en.wikipedia.org/wiki/Test-driven_development" target="_top">Desenvolvimento Guiado por Testes</a> é dirigir a funcionalidade que o programa realmente precisa, em vez do que o programador imagina que provavelmente deverá ter. A forma que isso é feito pode parecer contra-intuitiva no começo, se não totalmente boba, mas não apenas faz sentido, como também rapidamente se torna uma forma natural e elegante de desenvolver programas.
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Dan North</span></td></tr></table></div><p>
    O que segue é necessariamente uma introdução abreviada ao Desenvolvimento Guiado por Testes. Você pode explorar o tópico posteriormente em outros livros, como
    <span class="emphasis"><em>Test-Driven Development</em></span> <a class="xref" href="#Beck2002" title="Test Driven Development by Example">[<abbr class="abbrev">Beck2002</abbr>]</a>
    de Kent Beck ou <span class="emphasis"><em>A Practical Guide to Test-Driven
    Development</em></span> de Dave Astels<a class="xref" href="#Astels2003" title="Test Driven Development">[<abbr class="abbrev">Astels2003</abbr>]</a>.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="test-driven-development.bankaccount-example"></a>Exemplo da Conta Bancária</h2></div></div></div><p>
      Nesta seção, vamos dar uma olhada no exemplo de uma classe que representa uma conta bancária. O contrato para a classe <code class="literal">ContaBancaria</code>não apenas exige métodos get e set para o saldo da conta, mas também métodos para depositar e sacar dinheiro. Também especifica as duas seguintes condições que devem ser garantidas:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>O saldo inicial da conta bancária deve ser zero.</p></li><li class="listitem"><p>O saldo da conta bancária não pode se tornar negativo.</p></li></ul></div><p>
      Nós escrevemos os testes para a classe <code class="literal">ContaBancaria</code> antes de escrevermos o código propriamente dito da classe. Nós usamos as condições do contrato como base para os testes e nomeamos os testes conforme o mesmo, como mostrado em <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccountTest.php" title="Exemplo 12.1: Testes para a classe ContaBancaria">Exemplo 12.1</a>.
    </p><div class="example"><a id="test-driven-development.bankaccount-example.examples.BankAccountTest.php"></a><p class="title"><strong>Exemplo 12.1: Testes para a classe ContaBancaria</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'ContaBancaria.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContaBancariaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$cb</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">ContaBancaria</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testSaldoInicialZero</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testSaldoNaoPodeFicarNegativo</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">try</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">sacarDinheiro</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">catch</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">ExcecaoContaBancaria</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">return</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fail</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testSaldoNaoPodeFicarNegativo2</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">try</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">depositarDinheiro</span><span class="keyword">(</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">catch</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">ExcecaoContaBancaria</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">return</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fail</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Agora escrevemos somente o mínimo de código necessário para o primeiro teste,
      <code class="literal">testSaldoInicialZero()</code>, passar. Em nosso exemplo essa quantidade equivale a implementar o método <code class="literal">getBalance()</code> da classe <code class="literal">ContaBancaria</code>, como mostrado em
      <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccount.php" title="Exemplo 12.2: Código necessário para que o testSaldoInicialZero() passe">Exemplo 12.2</a>.
    </p><div class="example"><a id="test-driven-development.bankaccount-example.examples.BankAccount.php"></a><p class="title"><strong>Exemplo 12.2: Código necessário para que o testSaldoInicialZero() passe</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContaBancaria</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$saldo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">saldo</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      O teste para a primeira condição do contrato agora passa, mas os testes para a segunda condição do contrato falham, porque ainda temos que implementar os métodos que esses testes chamam.
    </p><pre class="screen"><strong class="userinput"><code>phpunit ContaBancariaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

.
Fatal error: Call to undefined method ContaBancaria::sacarDinheiro()</pre><p>
      Para que os testes que asseguram a segunda condição do contrato passem, agora precisamos implementar os métodos <code class="literal">sacarDinheiro()</code>,
      <code class="literal">depositarDinheiro()</code>, e <code class="literal">setSaldo()</code>
      como mostrado em
      <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccount2.php" title="Exemplo 12.3: A classe ContaBancaria completa">Exemplo 12.3</a>.
      Esses métodos são escritos de forma a gerar uma
      <code class="literal">ExcecaoContaBancaria</code> quando forem chamados com valores ilegais que poderiam violar as condições do contrato.
    </p><div class="example"><a id="test-driven-development.bankaccount-example.examples.BankAccount2.php"></a><p class="title"><strong>Exemplo 12.3: A classe ContaBancaria completa</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContaBancaria</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$saldo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">saldo</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setSaldo</span><span class="keyword">(</span><span class="default">$saldo</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">$saldo</span><span class="default">&nbsp;</span><span class="default">&gt;=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">saldo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$saldo</span><span class="keyword">;</span><br /><span class="keyword">}</span><span class="default">&nbsp;</span><span class="keyword">else</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">throw</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">ExcecaoContaBancaria</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">depositarDinheiro</span><span class="keyword">(</span><span class="default">$saldo</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setSaldo</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">+</span><span class="default">&nbsp;</span><span class="default">$saldo</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">sacarDinheiro</span><span class="keyword">(</span><span class="default">$saldo</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setSaldo</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">-</span><span class="default">&nbsp;</span><span class="default">$saldo</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Agora os testes que asseguram a segunda condição do contrato também passam:
    </p><pre class="screen"><strong class="userinput"><code>phpunit ContaBancariaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

...

Time: 0 seconds


OK (3 tests, 3 assertions)</pre><p>
      <a id="idp34592576" class="indexterm"></a>

      Alternativamente, você pode usar os métodos estáticos de asserção fornecidos pela classe
      <code class="literal">PHPUnit_Framework_Assert</code> para escrever as condições do contrato como asserções do tipo Projeto-por-Contrato em seu código, como mostrado em <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccount3.php" title="Exemplo 12.4: A classe ContaBancaria com asserções projetadas-por-contrato">Exemplo 12.4</a>.
      Quando uma dessas asserções falha, surge uma exceção
      <code class="literal">PHPUnit_Framework_AssertionFailedError</code> Com essa abordagem, você escreve menos código para as verificações das condições do contrato e os testes se tornam mais legíveis. Porém, você adiciona uma dependência em tempo de execução ao PHPUnit no seu projeto.
    </p><div class="example"><a id="test-driven-development.bankaccount-example.examples.BankAccount3.php"></a><p class="title"><strong>Exemplo 12.4: A classe ContaBancaria com asserções projetadas-por-contrato</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContaBancaria</span><br /><span class="keyword">{</span><br /><span class="keyword">private</span><span class="default">&nbsp;</span><span class="default">$saldo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">saldo</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setSaldo</span><span class="keyword">(</span><span class="default">$saldo</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">PHPUnit_Framework_Assert</span><span class="keyword">::</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">$saldo</span><span class="default">&nbsp;</span><span class="default">&gt;=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">saldo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$saldo</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">depositarDinheiro</span><span class="keyword">(</span><span class="default">$quantia</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">PHPUnit_Framework_Assert</span><span class="keyword">::</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">$quantia</span><span class="default">&nbsp;</span><span class="default">&gt;=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setSaldo</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">+</span><span class="default">&nbsp;</span><span class="default">$quantia</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">sacarDinheiro</span><span class="keyword">(</span><span class="default">$quantia</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">PHPUnit_Framework_Assert</span><span class="keyword">::</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">$quantia</span><span class="default">&nbsp;</span><span class="default">&gt;=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">PHPUnit_Framework_Assert</span><span class="keyword">::</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">saldo</span><span class="default">&nbsp;</span><span class="default">&gt;=</span><span class="default">&nbsp;</span><span class="default">$quantia</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setSaldo</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">-</span><span class="default">&nbsp;</span><span class="default">$quantia</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Escrevendo as condições do contrato nos testes, temos usado o conceito Projeto-por-Contrato para programar a classe <code class="literal">ContaBancaria</code> Então escrevemos, seguindo a abordagem Programe Testes Primeiro, o código precisava fazer os testes passarem. Porém esquecemos de escrever testes que chamem <code class="literal">setSaldo()</code>,
      <code class="literal">depositarDinheiro()</code>, e <code class="literal">sacarDinheiro()</code>
      com valores legais que não violem as condições do contrato. Precisamos de um meio para testar nossos testes ou pelo menos medir sua qualidade. Tal meio é a análise da informação de cobertura-de-código que discutiremos a seguir.
    </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="behaviour-driven-development"></a>Capítulo 13. Desenvolvimento Guiado por Comportamento</h1></div></div></div><p>
    <a id="idp34619024" class="indexterm"></a>
    <a id="idp34619840" class="indexterm"></a>

    Em <a class="xref" href="#Astels2006" title="A New Look at Test-Driven Development">[<abbr class="abbrev">Astels2006</abbr>]</a>, Dave Astels aponta o seguinte:
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        <a class="ulink" href="http://en.wikipedia.org/wiki/Extreme_Programming" target="_top">Programação Extrema</a>
        tinha originalmente a regra de testar tudo que pudesse possivelmente quebrar.
      </p></li><li class="listitem"><p>
        Porém agora a prática dos testes na Programação Extrema evoluiu para o <a class="ulink" href="http://en.wikipedia.org/wiki/Test-driven_development" target="_top">Desenvolvimento Guiado por Testes</a>
        (veja <a class="xref" href="#test-driven-development" title="Capítulo 12. Desenvolvimento Guiado por Testes">Capítulo 12</a>).
      </p></li><li class="listitem"><p>
        Mas as ferramentas ainda forçam os desenvolvedores a pesar em termos de testes e asserções em vez de especificações.
      </p></li></ul></div><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><div class="blockquote-title"><p><strong>Então se não é sobre testes, é sobre o quê?</strong></p></div><p>
      É sobre descobrir o quê você está tentando fazer antes de sair desesperado tentando fazê-lo. Você escreve uma especificação que resolve um pequeno aspecto do comportamento de uma forma concisa, inequívoca e executável. É simples assim. Isso significa que você escreve testes? Não. Isso significa que você escreve especificações sobre o quê o seu código terá que fazer. Significa que você especifica o comportamento do seu código antes da hora. Mas não muito antes. De fato, logo antes de você escrever o código é melhor, porque é quando você tem o máximo de informações à mão até chegar a esse ponto. Como no DGT bem feito, você trabalha com pequenos incrementos... especificando um pequeno aspecto do comportamento de cada vez, então implementando-o.
    </p><p>
      Quando você perceber que é tudo uma questão de especificar os comportamentos e não de escrever testes, seu ponto de vista muda. Repentinamente a ideia de ter uma classe de teste para cada uma das suas classes de produção se torna ridiculamente limitadora. E a ideia de testar cada um de seus métodos com seu próprio método de testes (uma relação 1-1) se torna hilária.
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Dave Astels</span></td></tr></table></div><p>
    <a id="idp34669264" class="indexterm"></a>
    <a id="idp34670112" class="indexterm"></a>

    O foco do <a class="ulink" href="http://en.wikipedia.org/wiki/Behavior_driven_development" target="_top">Desenvolvimento Guiado por Comportamento</a>
    a linguagem e as interações usadas no processo de desenvolvimento de programas. Desenvolvedores Guiados por Comportamento usam suas linguagens nativas em combinação com a linguagem ubíqua de <a class="ulink" href="http://en.wikipedia.org/wiki/Domain_driven_design" target="_top">Design Guiado por Domínio</a>
    para descrever o propósito e o benefício de seus códigos. Isso permite aos desenvolvedores focarem-se no motivo do código ser criado, em vez dos detalhes técnicos, minimizando a tradução entre a linguagem técnica na qual o código é escrito e a linguagem de domínio falada pelos especialistas em domínios".
  </p><p>
    <a id="idp34673904" class="indexterm"></a>

    A Classe <code class="literal">PHPUnit_Extensions_Story_TestCase</code> adiciona um framework de história que facilita a definição de uma
    <a class="ulink" href="http://en.wikipedia.org/wiki/Domain-specific_programming_language" target="_top">Linguagem de Domínio Específico</a>
    para Desenvolvimento Guiado por Comportamento. Pode ser instalada assim:
  </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_Story</code></strong></pre><p>
    Dentro de um <span class="emphasis"><em>cenário</em></span>, <code class="literal">given()</code>,
    <code class="literal">when()</code>, e <code class="literal">then()</code> representam um
    <span class="emphasis"><em>passo</em></span> cada um. <code class="literal">and()</code> é do mesmo tipo do passo anterior. Os seguintes métodos são declarados <code class="literal">abstract</code>
    no <code class="literal">PHPUnit_Extensions_Story_TestCase</code> e precisam ser implementados:
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">runGiven(&amp;$mundo, $acao, $argumentos)</code></p><p>...</p></li><li class="listitem"><p><code class="literal">runWhen(&amp;$mundo, $acao, $argumentos)</code></p><p>...</p></li><li class="listitem"><p><code class="literal">runThen(&amp;$mundo, $acao, $argumentos)</code></p><p>...</p></li></ul></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="behaviour-driven-development.bowlinggame-example"></a>Exemplo do Jogo de Boliche</h2></div></div></div><p>
      Nesta seção vamos dar uma olhada no exemplo de uma classe que calcula a pontuação para um jogo de boliche. As regras são as seguintes:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>O jogo consiste de 10 quadros.</p></li><li class="listitem"><p>Em cada quadro o jogador tem duas oportunidades de derrubar 10 pinos.</p></li><li class="listitem"><p>A pontuação para um quadro é o número total de pinos derrubados, mais bônus para strikes e spares.</p></li><li class="listitem"><p>Um spare é quando um jogador derruba todos os 10 pinos em duas tentativas.</p><p>O bônus para esse quadro é o número de pinos derrubados na próxima rodada.</p></li><li class="listitem"><p>Um strike é quando um jogador derruba todos os pinos na primeira tentativa.</p><p>O bônus para esse quadro é o valor das duas próximas bolas jogadas.</p></li></ul></div><p>
      <a class="xref" href="#behaviour-driven-development.bowlinggame-example.examples.BowlingGameSpec.php" title="Exemplo 13.1: Especificação para a classe JogoDeBoliche">Exemplo 13.1</a>
      mostra como as regras acima podem ser escritas como cenários de especificação usando o <code class="literal">PHPUnit_Extensions_Story_TestCase</code>.
    </p><div class="example"><a id="behaviour-driven-development.bowlinggame-example.examples.BowlingGameSpec.php"></a><p class="title"><strong>Exemplo 13.1: Especificação para a classe JogoDeBoliche</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'PHPUnit/Extensions/Story/TestCase.php'</span><span class="keyword">;</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'JogoBoliche.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">JogoBolicheSpec</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Extensions_Story_TestCase</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@scenario</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">pontuacaoPorJogarNaCanaletaEh0</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">given</span><span class="keyword">(</span><span class="string">'Novo&nbsp;jogo'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">then</span><span class="keyword">(</span><span class="string">'Pontuação&nbsp;deve&nbsp;ser'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@scenario</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">pontuacaoParaTodosUmEh20</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">given</span><span class="keyword">(</span><span class="string">'Novo&nbsp;jogo'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">when</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">then</span><span class="keyword">(</span><span class="string">'Pontuação&nbsp;deve&nbsp;ser'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">20</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@scenario</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">pontuacaoParaUmSpareE3Eh16</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">given</span><span class="keyword">(</span><span class="string">'Novo&nbsp;jogo'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">when</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">5</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">5</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">3</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">then</span><span class="keyword">(</span><span class="string">'Pontuação&nbsp;deve&nbsp;ser'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">16</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@scenario</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">pontuacaoParaUmStrikeE3E4Eh24</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">given</span><span class="keyword">(</span><span class="string">'Novo&nbsp;jogo'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">when</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">3</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">4</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">then</span><span class="keyword">(</span><span class="string">'Pontuação&nbsp;deve&nbsp;ser'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">24</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@scenario</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">pontuacaoParaJogoPerfeitoEh300</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">given</span><span class="keyword">(</span><span class="string">'Novo&nbsp;jogo'</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">when</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">and</span><span class="keyword">(</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">10</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">then</span><span class="keyword">(</span><span class="string">'Pontuação&nbsp;deve&nbsp;ser'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">300</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">runGiven</span><span class="keyword">(</span><span class="keyword">&amp;</span><span class="default">$mundo</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$acao</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$argumentos</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">switch</span><span class="keyword">(</span><span class="default">$action</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">case</span><span class="default">&nbsp;</span><span class="string">'New&nbsp;game'</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$world</span><span class="keyword">[</span><span class="string">'game'</span><span class="keyword">]</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">BowlingGame</span><span class="keyword">;</span><br /><span class="default">$world</span><span class="keyword">[</span><span class="string">'rolls'</span><span class="keyword">]</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">break</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">default</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">notImplemented</span><span class="keyword">(</span><span class="default">$action</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">runWhen</span><span class="keyword">(</span><span class="keyword">&amp;</span><span class="default">$mundo</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$acao</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$argumentos</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">switch</span><span class="keyword">(</span><span class="default">$acao</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">case</span><span class="default">&nbsp;</span><span class="string">'Jogador&nbsp;arremessa'</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$mundo</span><span class="keyword">[</span><span class="string">'jogo'</span><span class="keyword">]</span><span class="keyword">-&gt;</span><span class="default">arremesso</span><span class="keyword">(</span><span class="default">$argumentos</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$mundo</span><span class="keyword">[</span><span class="string">'arremessos'</span><span class="keyword">]</span><span class="keyword">++</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">break</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">default</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">notImplemented</span><span class="keyword">(</span><span class="default">$acao</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">runThen</span><span class="keyword">(</span><span class="keyword">&amp;</span><span class="default">$mundo</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$acao</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$argumentos</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">switch</span><span class="keyword">(</span><span class="default">$acao</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">case</span><span class="default">&nbsp;</span><span class="string">'Pontuação&nbsp;deve&nbsp;ser'</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">for</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">$i</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$mundo</span><span class="keyword">[</span><span class="string">'rolls'</span><span class="keyword">]</span><span class="keyword">;</span><span class="default">&nbsp;</span><span class="default">$i</span><span class="default">&nbsp;</span><span class="keyword">&lt;</span><span class="default">&nbsp;</span><span class="default">20</span><span class="keyword">;</span><span class="default">&nbsp;</span><span class="default">$i</span><span class="keyword">++</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$mundo</span><span class="keyword">[</span><span class="string">'jogo'</span><span class="keyword">]</span><span class="keyword">-&gt;</span><span class="default">arremesso</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">$argumentos</span><span class="keyword">[</span><span class="default">0</span><span class="keyword">]</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$mundo</span><span class="keyword">[</span><span class="string">'jogo'</span><span class="keyword">]</span><span class="keyword">-&gt;</span><span class="default">pontuacao</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">break</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">default</span><span class="keyword">:</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">notImplemented</span><span class="keyword">(</span><span class="default">$acao</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit --printer PHPUnit_Extensions_Story_ResultPrinter_Text EspecJogoBoliche</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

EspecJogoBoliche
 [x] Pontuação por jogar na canaleta eh 0

   Given Novo jogo
    Then Pontuação deve ser 0

 [x] Pontuação para todos um eh 20

   Given Novo jogo
    When Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
     and Jogador arremessa 1
    Then Pontuação deve ser 20

 [x] Pontuação para um spare e 3 eh 16

   Given Novo jogo
    When Jogador arremessa 5
     and Jogador arremessa 5
     and Jogador arremessa 3
    Then Pontuação deve ser 16

 [x] Pontuação para um strike e 3 e 4 eh 24

   Given Novo jogo
    When Jogador arremessa 10
     and Jogador arremessa 3
     and Jogador arremessa 4
    Then Pontuação deve ser 24

 [x] Pontuação para jogo perfeito eh 300

   Given Novo jogo
    When Jogador arremessa 10
     and Jogador arremessa 10
     and Jogador arremessa 10
     and Jogador arremessa 10
     and Jogador arremessa 10
     and Jogador arremessa 10
     and Jogador arremessa 10
     and Jogador arremessa 10
     and Jogador arremessa 10
     and Jogador arremessa 10
     and Jogador arremessa 10
     and Jogador arremessa 10
    Then Pontuação deve ser 300

Scenarios: 5, Failed: 0, Skipped: 0, Incomplete: 0.</pre></div></div><br class="example-break" /></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="code-coverage-analysis"></a>Capítulo 14. Análise de Cobertura de Código</h1></div></div></div><div class="blockquote"><table border="0" class="blockquote" style="width: 100%; cellspacing: 0; cellpadding: 0;" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p>
      A beleza de testar não se encontra no esforço, mas na eficiência.
    </p><p>
      Saber o que deveria ser testado é lindo, e saber o que está sendo testado é lindo.
    </p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution">Murali Nandigama</span></td></tr></table></div><p>
    <a id="idp34722944" class="indexterm"></a>

    Neste capítulo você aprenderá tudo sobre a funcionalidade de cobertura de código do PHPUnit que lhe dará uma perspicácia sobre quais partes do código de produção são executadas quando os testes são executados. Isso ajuda a responder questões como:
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>
        Como você descobre o código que ainda não foi testado -- ou, em outras palavras, ainda não foi <span class="emphasis"><em>coberto</em></span> por um teste?
      </p></li><li class="listitem"><p>Como você mede o quanto os testes estão completos?</p></li></ul></div><p>
    Um exemplo sobre o quê podem significar as estatísticas de cobertura de código é que se existir um método com 100 linhas de código, e apenas 75 dessas linhas são realmente executadas quando os testes são executados, então considera-se que o método tem uma cobertura de código de 75 porcento.
  </p><p>
    <a id="idp34766144" class="indexterm"></a>

    A funcionalidade de cobertura de código do PHPUnit faz uso do componente
    <a class="ulink" href="http://github.com/sebastianbergmann/php-code-coverage" target="_top">PHP_CodeCoverage</a>
    que por sua vez aproveita a funcionalidade da cobertura de declarações fornecida pela extensão <a class="ulink" href="http://www.xdebug.org/" target="_top">Xdebug</a>
    para PHP.
  </p><p>
    Deixe-nos gerar um relatório de cobertura de código para a classe <code class="literal">ContaBancaria</code>
    de <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccount2.php" title="Exemplo 12.3: A classe ContaBancaria completa">Exemplo 12.3</a>.
  </p><pre class="screen"><strong class="userinput"><code>phpunit --coverage-html ./report ContaBancariaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

...

Time: 0 seconds

OK (3 tests, 3 assertions)

Generating report, this may take a moment.</pre><p>
    <a class="xref" href="#code-coverage-analysis.figures.Code_Coverage.png" title="Figura 14.1. Cobertura de Código para setSaldo()">Figura 14.1</a> mostra um resumo do relatório de Cobertura de Código. Linhas de código que foram executadas enquanto os testes executavam estão destacadas em verde, linhas de código que são executáveis mas não foram executadas estão destacadas em vermelho, e o "código morto" está destacado em cinza. O número à esquerda da linha de código atual indica quantos testes cobrem aquela linha.
  </p><div class="figure"><a id="code-coverage-analysis.figures.Code_Coverage.png"></a><p class="title"><strong>Figura 14.1. Cobertura de Código para <code class="literal">setSaldo()</code></strong></p><div class="figure-contents"><div><img src="figures/Code_Coverage.png" alt="Cobertura de Código para setSaldo()" /></div></div></div><br class="figure-break" /><p>
    Clicando no número da linha de uma linha coberta abrirá um painel (veja
    <a class="xref" href="#code-coverage-analysis.figures.Code_Coverage2.png" title="Figura 14.2. Painel com informações sobre cobertura de testes">Figura 14.2</a>) que mostra os casos de testes que cobrem esta linha.
  </p><div class="figure"><a id="code-coverage-analysis.figures.Code_Coverage2.png"></a><p class="title"><strong>Figura 14.2. Painel com informações sobre cobertura de testes</strong></p><div class="figure-contents"><div><img src="figures/Code_Coverage2.png" alt="Painel com informações sobre cobertura de testes" /></div></div></div><br class="figure-break" /><p>
    O relatório de cobertura de código para nosso exemplo <code class="literal">ContaBancaria</code> mostra que não temos quaisquer testes ainda que chamem os métodos
    <code class="literal">setBalance()</code>, <code class="literal">depositMoney()</code>, e
    <code class="literal">withdrawMoney()</code> com valores legais.
    <a class="xref" href="#code-coverage-analysis.examples.BankAccountTest.php" title="Exemplo 14.1: Teste perdido para conseguir completa cobertura de código">Exemplo 14.1</a>
    mostra um teste que pode ser adicionado à classe de caso de teste <code class="literal">ContaBancariaTest</code>
    para cobrir completamente a classe <code class="literal">ContaBancaria</code>.
  </p><div class="example"><a id="code-coverage-analysis.examples.BankAccountTest.php"></a><p class="title"><strong>Exemplo 14.1: Teste perdido para conseguir completa cobertura de código</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'ContaBancaria.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContaBancariaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;...</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testDepositarSacarDinheiro</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">depositarDinheiro</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">sacarDinheiro</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
    <a class="xref" href="#code-coverage-analysis.figures.Code_Coverage3.png" title="Figura 14.3. Cobertura de Código para setSaldo() com teste adicional">Figura 14.3</a> mostra a cobertura de código para o método <code class="literal">setSaldo()</code> com o teste adicional.
  </p><div class="figure"><a id="code-coverage-analysis.figures.Code_Coverage3.png"></a><p class="title"><strong>Figura 14.3. Cobertura de Código para <code class="literal">setSaldo()</code> com teste adicional</strong></p><div class="figure-contents"><div><img src="figures/Code_Coverage3.png" alt="Cobertura de Código para setSaldo() com teste adicional" /></div></div></div><br class="figure-break" /><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="code-coverage-analysis.specifying-covered-methods"></a>Especificando métodos cobertos</h2></div></div></div><p>
      <a id="idp34794752" class="indexterm"></a>
      <a id="idp34795568" class="indexterm"></a>

      A anotação <code class="literal">@covers</code> (veja
      <a class="xref" href="#appendixes.annotations.covers.tables.annotations" title="Tabela B.1. Anotações para especificar quais métodos são cobertos por um teste">Tabela B.1</a>) pode ser usada em um código de teste para especificar qual(is) método(s) um método de teste quer testar. Se fornecido, apenas a informação de cobertura de código para o(s) método(s) especificado(s) será considerada.
      <a class="xref" href="#code-coverage-analysis.specifying-covered-methods.examples.BankAccountTest.php" title="Exemplo 14.2: Testes que especificam quais métodos querem cobrir">Exemplo 14.2</a>
      mostra um exemplo.
    </p><div class="example"><a id="code-coverage-analysis.specifying-covered-methods.examples.BankAccountTest.php"></a><p class="title"><strong>Exemplo 14.2: Testes que especificam quais métodos querem cobrir</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'ContaBancaria.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">ContaBancariaTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$cb</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">ContaBancaria</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@covers&nbsp;ContaBancaria::getSaldo</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testSaldoInicialEhZero</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@covers&nbsp;ContaBancaria::sacarDinheiro</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testSaldoNaoPodeFicarNegativo</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">try</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">sacarDinheiro</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">catch</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">ExcecaoContaBancaria</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">return</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fail</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@covers&nbsp;ContaBancaria::depositarDinheiro</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testBalanceCannotBecomeNegative2</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">try</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">depositarDinheiro</span><span class="keyword">(</span><span class="keyword">-</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">catch</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">ExcecaoContaBancaria</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">return</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">fail</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@covers&nbsp;ContaBancaria::getSaldo</span><br /><span class="comment">*&nbsp;@covers&nbsp;ContaBancaria::depositarDinheiro</span><br /><span class="comment">*&nbsp;@covers&nbsp;ContaBancaria::sacarDinheiro</span><br /><span class="comment">*/</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testDepositarSacarDinheiro</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">depositarDinheiro</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">sacarDinheiro</span><span class="keyword">(</span><span class="default">1</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">cb</span><span class="keyword">-&gt;</span><span class="default">getSaldo</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      <a id="idp34801504" class="indexterm"></a>
      <a id="idp34802320" class="indexterm"></a>

      Também é possível especificar que um teste não deve cobrir
      <span class="emphasis"><em>qualquer</em></span> método usando a anotação
      <code class="literal">@coversNothing</code> (veja
      <a class="xref" href="#appendixes.annotations.coversNothing" title="@coversNothing">“<code class="literal">@coversNothing</code>”</a>). Isso pode ser útil quando escrever testes de integração para certificar-se de que você só gerará cobertura de código com testes unitários.
    </p><div class="example"><a id="code-coverage-analysis.specifying-covered-methods.examples.GuestbookIntegrationTest.php"></a><p class="title"><strong>Exemplo 14.3: Um teste que especifica que nenhum método deve ser coberto</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">IntegracaoLivroDeVisitasTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Extensions_Database_TestCase</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@coversNothing</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testAdicionaEntrada</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$livrodevisitas</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">LivroDeVisitas</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$livrodevisitas</span><span class="keyword">-&gt;</span><span class="default">adicionaEntrada</span><span class="keyword">(</span><span class="string">&quot;suzy&quot;</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">&quot;Olá&nbsp;mundo!&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">$tabelaQuery</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">getConnection</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">-&gt;</span><span class="default">criarTabelaQuery</span><span class="keyword">(</span><br /><span class="string">'livrodevisitas'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="string">'SELECT&nbsp;*&nbsp;FROM&nbsp;livrodevisitas'</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$expectedTable</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">criarConjuntoDadosXmlPlano</span><span class="keyword">(</span><span class="string">&quot;livroEsperado.xml&quot;</span><span class="keyword">)</span><br /><span class="keyword">-&gt;</span><span class="default">getTabela</span><span class="keyword">(</span><span class="string">&quot;livrodevisitas&quot;</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTablesEqual</span><span class="keyword">(</span><span class="default">$tabelaEsperada</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$tabelaQuery</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /><span class="html">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br /></code></pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="code-coverage-analysis.ignoring-code-blocks"></a>Ignorando Blocos de Código</h2></div></div></div><p>
      <a id="idp34811792" class="indexterm"></a>
      <a id="idp34812608" class="indexterm"></a>
      <a id="idp34813424" class="indexterm"></a>
      <a id="idp34814256" class="indexterm"></a>

      Às vezes você tem blocos de código que não pode testar e que pode querer ignorar durante a análise de cobertura de código. O PHPUnit permite que você o faça usando as anotações <code class="literal">@codeCoverageIgnore</code>,
      <code class="literal">@codeCoverageIgnoreStart</code> e
      <code class="literal">@codeCoverageIgnoreEnd</code> como mostrado em 
      <a class="xref" href="#code-coverage-analysis.ignoring-code-blocks.examples.Sample.php" title="Exemplo 14.4: Usando as anotações @codeCoverageIgnore, @codeCoverageIgnoreStart e @codeCoverageIgnoreEnd">Exemplo 14.4</a>.
    </p><div class="example"><a id="code-coverage-analysis.ignoring-code-blocks.examples.Sample.php"></a><p class="title"><strong>Exemplo 14.4: Usando as anotações <code class="literal">@codeCoverageIgnore</code>, <code class="literal">@codeCoverageIgnoreStart</code> e <code class="literal">@codeCoverageIgnoreEnd</code></strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@codeCoverageIgnore</span><br /><span class="comment">*/</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">Foo</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">bar</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">Bar</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@codeCoverageIgnore</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">foo</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">FALSE</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="comment">//&nbsp;@codeCoverageIgnoreStart</span><br /><span class="default">print</span><span class="default">&nbsp;</span><span class="string">'*'</span><span class="keyword">;</span><br /><span class="comment">//&nbsp;@codeCoverageIgnoreEnd</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      As linhas de código que estão marcadas para serem ignoradas usando as anotações são contadas como executadas (se forem executáveis) e não serão destacadas.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="code-coverage-analysis.including-excluding-files"></a>Incluindo e Excluindo Arquivos</h2></div></div></div><p>
      <a id="idp34825024" class="indexterm"></a>
      <a id="idp34825840" class="indexterm"></a>
      <a id="idp34826656" class="indexterm"></a>

      Por padrão, todos os arquivos de código-fonte que contêm pelo menos uma linha de código que tenha sido executada (e apenas esses arquivos) são incluídos no relatório. Os arquivos de código-fonte que são incluídos no relatório podem ser filtrados usando uma abordagem de lista-negra ou lista-branca.
    </p><p>
      A lista-negra é pré-preenchida com todos os arquivos de código-fonte do próprio PHPUnit assim como os testes. Quando a lista-branca está vazia (padrão), a lista-negra é usada. Quando a lista-branca não está vazia, a lista-branca é usada. Cada arquivo na lista-branca é adicionado ao relatório de cobertura de código independentemente de ter sido executado ou não. Todas as linhas em tal arquivo, incluindo aquelas que não são executáveis, são contadas como não executadas.
    </p><p>
      Quando você define <code class="literal">processUncoveredFilesFromWhitelist="true"</code>
      na sua configuração do PHPUnit (veja <a class="xref" href="#appendixes.configuration.blacklist-whitelist" title="Incluindo e Excluindo Arquivos para Cobertura de Código">“Incluindo e Excluindo Arquivos para Cobertura de Código”</a>) então esses arquivos serão incluídos pelo PHP_CodeCoverage para calcular adequadamente o número de linhas executáveis.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Nota</h3><p>
        Por favor, note que o carregamento de arquivos de código-fonte que é realizado quando
        <code class="literal">processUncoveredFilesFromWhitelist="true"</code> é definido pode causar problemas quando um arquivo de código-fonte contém código fora do escopo de uma classe ou função, por exemplo.
      </p></div><p>
      O arquivo de configuração XML do PHPUnit (veja <a class="xref" href="#appendixes.configuration.blacklist-whitelist" title="Incluindo e Excluindo Arquivos para Cobertura de Código">“Incluindo e Excluindo Arquivos para Cobertura de Código”</a>)
      pode ser usado para controlar as listas branca e negra. Usar uma lista-branca é a melhor prática recomendada para controlar a lista de arquivos incluídos no relatório de cobertura de código.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="code-coverage-analysis.edge-cases"></a>Casos Extremos</h2></div></div></div><p>
      De modo geral é seguro dizer que o PHPUnit oferece a você uma informação de cobertura de código "baseada em linha", mas devido ao modo que a informação é coletada, existem alguns casos extremos dignos de atenção.
    </p><div class="example"><a id="code-coverage-analysis.edge-cases.examples.Sample.php"></a><p class="title"><strong>Exemplo 14.5: </strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="comment">//&nbsp;Por&nbsp;ser&nbsp;&quot;baseado&nbsp;em&nbsp;linha&quot;&nbsp;e&nbsp;não&nbsp;em&nbsp;declaração,</span><br /><span class="comment">//&nbsp;uma&nbsp;linha&nbsp;sempre&nbsp;terá&nbsp;um&nbsp;estado&nbsp;de&nbsp;cobertura</span><br /><span class="keyword">if</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="default">esta_chamada_de_funcao_aparece_como_coberta</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Devido&nbsp;ao&nbsp;modo&nbsp;que&nbsp;a&nbsp;cobertura&nbsp;de&nbsp;código&nbsp;funciona&nbsp;internamente,</span><br /><span class="comment">//&nbsp;estas&nbsp;duas&nbsp;linhas&nbsp;são&nbsp;especiais.</span><br /><span class="comment">//&nbsp;Esta&nbsp;linha&nbsp;vai&nbsp;aparecer&nbsp;como&nbsp;não-executável</span><br /><span class="keyword">if</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">)</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;Esta&nbsp;linha&nbsp;vai&nbsp;aparecer&nbsp;como&nbsp;coberta,&nbsp;pois&nbsp;de&nbsp;fato&nbsp;é&nbsp;a&nbsp;cobertura</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment">//&nbsp;da&nbsp;declaração&nbsp;if&nbsp;da&nbsp;linha&nbsp;anterior&nbsp;que&nbsp;é&nbsp;mostrada&nbsp;aqui!</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="default">tambem_vai_aparecer_como_coberta</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="comment">//&nbsp;Para&nbsp;evitar&nbsp;isso&nbsp;é&nbsp;necessário&nbsp;usar&nbsp;chaves</span><br /><span class="keyword">if</span><span class="keyword">(</span><span class="default">false</span><span class="keyword">)</span><span class="keyword">{</span><br /><span class="default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="default">esta_chamada_nunca_aparecera_como_coberta</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="other-uses-for-tests"></a>Capítulo 15. Outros Usos para Testes</h1></div></div></div><p>
    Uma vez que você se acostumar a escrever testes automatizados, você vai querer descobrir mais usos para testes. Aqui temos alguns exemplos.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="other-uses-for-tests.agile-documentation"></a>Documentação Ágil</h2></div></div></div><p>
      <a id="idp34880864" class="indexterm"></a>
      <a id="idp34881712" class="indexterm"></a>
      <a id="idp34919872" class="indexterm"></a>
      <a id="idp34920720" class="indexterm"></a>

      Tipicamente, em um projeto desenvolvido usando um processo ágil, como a Programação Extrema, a documentação não pode se manter com as mudanças frequentes do design e código do projeto. Programação Extrema exige <span class="emphasis"><em>propriedade coletiva de código</em></span>, então todos os desenvolvedores precisam saber como o sistema todo funciona. Se você for disciplinado o suficiente para consequentemente usar "nomes falantes" para seus teste que descrevam o que cada classe deveria fazer, você pode usar a funcionalidade TestDox do PHPUnit para gerar documentação automatizada para seu projeto baseada nos testes. Essa documentação dá aos desenvolvedores uma visão geral sobre o que cada classe do projeto deveria fazer.
    </p><p>
      A funcionalidade TestDox do PHPUnit olha para uma classe de teste e todos os nomes dos métodos de teste e os converte de nomes camelCase do PHP para sentenças:
      <code class="literal">testBalanceIsInitiallyZero()</code> se torna "Saldo eh inicialmente zero". Se houverem vários métodos de teste cujos nomes apenas diferem em um sufixo de um ou mais dígitos, como em
      <code class="literal">testBalanceCannotBecomeNegative()</code> e
      <code class="literal">testBalanceCannotBecomeNegative2()</code>, a sentença "Saldo nao pode ficar negativo" aparecerá apenas uma vez, assumindo-se que todos os testes foram bem-sucedidos.
    </p><p>
      Vamos dar uma olhada na documentação ágil gerada para a classe
      <code class="literal">ContaBancaria</code> class (from
      <a class="xref" href="#test-driven-development.bankaccount-example.examples.BankAccountTest.php" title="Exemplo 12.1: Testes para a classe ContaBancaria">Exemplo 12.1</a>):
    </p><pre class="screen"><strong class="userinput"><code>phpunit --testdox ContaBancariaTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

ContaBancaria
 [x] Saldo eh inicialmente zero
 [x] Saldo nao pode ficar negativo</pre><p>
      Alternativamente, a documentação ágil pode ser gerada nos formatos HTML ou texto plano e escrita em um arquivo usando os argumentos <code class="literal">--testdox-html</code>
      e <code class="literal">--testdox-text</code>.
    </p><p>
      <a id="idp34932256" class="indexterm"></a>

      A Documentação Ágil pode ser usada para documentar as suposições que você faz sobre os pacotes externos que você usa em seu projeto. Quando você usa um pacote externo, você está exposto ao risco do pacote não se comportar como você espera, e de futuras versões do pacote mudarem de formas súbitas que quebrarão o seu código, sem que você saiba. Você pode dar um jeito nesses problemas escrevendo um teste toda vez que fizer uma suposição. Se seu teste for bem sucedido, sua suposição é válida. Se você documentar todas as suas suposições com testes, futuras versões do pacote externo não serão motivo de preocupação: se o teste for bem-sucedido, seu sistema deverá continuar funcionando.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="other-uses-for-tests.cross-team-tests"></a>Testes Inter-Equipes</h2></div></div></div><p>
      Quando você documenta suposições com testes, você possui os testes. O fornecedor do pacote -- sobre o qual você faz suposições -- não sabe nada sobre seus testes. Se você quer ter um relacionamento mais próximo com o fornecedor do pacote, você pode usar os testes para comunicar e coordenar suas atividades.
    </p><p>
      Quando você concorda em coordenar suas atividades com o fornecedor de um pacote, vocês podem escrever os testes juntos. Faça isso de modo que os testes revelem o máximo possível de suposições. Suposições escondidas são a morte da cooperação. Com os testes você documenta exatamente o que você espera de um pacote fornecido. O fornecedor vai saber que o pacote está completo quando todos os testes executarem.
    </p><p>
      <a id="idp34938400" class="indexterm"></a>

      Usando esboços (veja o capítulo em "Objetos Falsos", anteriormente neste livro), você pode chegar a se desassociar do fornecedor: O trabalho do fornecedor é fazer os testes executarem com a implementação real do pacote. O seu trabalho é fazer os testes executarem para seu próprio código. Até esse momento como você tem a implementação real do pacote fornecido, você usa objetos esboçados. Seguindo esta abordagem, os dois times podem desenvolver independentemente.
    </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="skeleton-generator"></a>Capítulo 16. Gerador de Esqueleto</h1></div></div></div><p>
    O Gerador de Esqueleto do PHPUnit é uma ferramenta que pode gerar esqueletos de classes de teste a partir de classes códigos de produção e vice-versa. Pode ser instalado usando-se o seguinte comando:
  </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_SkeletonGenerator</code></strong></pre><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="skeleton-generator.test"></a>Gerando um Esqueleto de Classe de Caso de Teste</h2></div></div></div><p>
    <a id="idp34899344" class="indexterm"></a>

    Quando você está escrevendo testes para um código existente, você tem que escrever os mesmos fragmentos de código como:
</p><pre class="programlisting"><code>public function testMetodo()
{
}</code></pre><p> 
de novo e de novo. O Gerador de Esqueleto do PHPUnit pode ajudá-lo analisando o código da classe existente e gerando um esqueleto de classe de caso de teste para ele.
  </p><div class="example"><a id="skeleton-generator.examples.Calculator.php"></a><p class="title"><strong>Exemplo 16.1: A classe Calculadora</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">Calculadora</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">soma</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$b</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$a</span><span class="default">&nbsp;</span><span class="keyword">+</span><span class="default">&nbsp;</span><span class="default">$b</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
    O seguinte exemplo mostra como gerar um esqueleto de classe de caso de teste para uma classe chamada <code class="literal">Calculadora</code>
    (veja <a class="xref" href="#skeleton-generator.examples.Calculator.php" title="Exemplo 16.1: A classe Calculadora">Exemplo 16.1</a>).
  </p><pre class="screen"><strong class="userinput"><code>phpunit-skelgen --test Calculadora</code></strong>
PHPUnit Skeleton Generator 1.0.0 by Sebastian Bergmann.

Wrote skeleton for "CalculadoraTest" to "/home/sb/CalculadoraTest.php".</pre><p>
    <a id="idp34974464" class="indexterm"></a>

    Para cada método na classe original, haverá um caso de teste incompleto (veja <a class="xref" href="#incomplete-and-skipped-tests" title="Capítulo 9. Testes Incompletos e Pulados">Capítulo 9</a>) na classe de caso de teste gerada.
  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Classes separadas por nome e o Gerador de Esqueleto</h3><p>
      Quando você está usando o gerador de esqueleto para gerar código baseado em uma classe que é declarada em um <a class="ulink" href="http://php.net/namespace" target="_top">namespace</a>
      você tem que fornecer o nome qualificado da classe assim como o caminho para o arquivo-fonte em que está declarado.
    </p><p>
      Por exemplo, para a classe <code class="literal">Calculadora</code> que está declarada no namespace <code class="literal">project</code> você precisa invocar o gerador de esqueleto desta forma:
      </p><pre class="screen"><strong class="userinput"><code>phpunit-skelgen --test -- "project\Calculadora" Calculadora.php</code></strong>
PHPUnit Skeleton Generator 1.0.0 by Sebastian Bergmann.

Wrote skeleton for "project\CalculadoraTest" to "/home/sb/CalculadoraTest.php".</pre><p>
    </p></div><p>
    Abaixo está a saída da execução da classe de caso de teste gerada.
  </p><pre class="screen"><strong class="userinput"><code>phpunit --bootstrap Calculadora.php --verbose CalculadoraTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

I

Time: 0 seconds, Memory: 3.50Mb

There was 1 incomplete test:

1) CalculadoraTest::testSoma
This test has not been implemented yet.

/home/sb/CalculadoraTest.php:38
OK, but incomplete or skipped tests!
Tests: 1, Assertions: 0, Incomplete: 1.</pre><p>
      <a id="idp34984000" class="indexterm"></a>
      <a id="idp34984816" class="indexterm"></a>

      Você pode usar a anotação <code class="literal">@assert</code> no bloco de documentação de um método para gerar automaticamente testes simples, porém significativos, em vez de casos de testes incompletos.
      <a class="xref" href="#skeleton-generator.test.examples.Calculator.php" title="Exemplo 16.2: A classe Calculadora com anotações @assert">Exemplo 16.2</a>
      mostra um exemplo.
    </p><div class="example"><a id="skeleton-generator.test.examples.Calculator.php"></a><p class="title"><strong>Exemplo 16.2: A classe Calculadora com anotações @assert</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">Calculadora</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@assert&nbsp;(0,&nbsp;0)&nbsp;==&nbsp;0</span><br /><span class="comment">*&nbsp;@assert&nbsp;(0,&nbsp;1)&nbsp;==&nbsp;1</span><br /><span class="comment">*&nbsp;@assert&nbsp;(1,&nbsp;0)&nbsp;==&nbsp;1</span><br /><span class="comment">*&nbsp;@assert&nbsp;(1,&nbsp;1)&nbsp;==&nbsp;2</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">soma</span><span class="keyword">(</span><span class="default">$a</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$b</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$a</span><span class="default">&nbsp;</span><span class="keyword">+</span><span class="default">&nbsp;</span><span class="default">$b</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Cada método na classe original é verificada por anotações <code class="literal">@assert</code>. Estas são transformadas em um código de teste como
      </p><pre class="programlisting"><code> /**
     * Generated from @assert (0, 0) == 0.
     */
    public function testSoma() {
        $o = new Calculadora;
        $this-&gt;assertEquals(0, $o-&gt;soma(0, 0));
    }</code></pre><p>
    </p><p>
      Abaixo está a saída da execução da classe de caso de teste gerada.
    </p><pre class="screen"><strong class="userinput"><code>phpunit --bootstrap Calculadora.php --verbose CalculadoraTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

....

Time: 0 seconds, Memory: 3.50Mb

OK (4 tests, 4 assertions)</pre><p>
      <a class="xref" href="#skeleton-generator.test.tables.assert-annotations" title="Tabela 16.1. Variantes suportadas da anotação @assert">Tabela 16.1</a>
      mostra variantes suportadas para a anotação <code class="literal">@assert</code>
      e como elas podem ser transformadas em código de teste.
    </p><div class="table"><a id="skeleton-generator.test.tables.assert-annotations"></a><p class="title"><strong>Tabela 16.1. Variantes suportadas da anotação @assert</strong></p><div class="table-contents"><table summary="Variantes suportadas da anotação @assert" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Anotação</th><th align="left">Transformada para</th></tr></thead><tbody><tr><td align="left"><code class="literal">@assert (...) == X</code></td><td align="left"><code class="literal">assertEquals(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) != X</code></td><td align="left"><code class="literal">assertNotEquals(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) === X</code></td><td align="left"><code class="literal">assertSame(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) !== X</code></td><td align="left"><code class="literal">assertNotSame(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) &gt; X</code></td><td align="left"><code class="literal">assertGreaterThan(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) &gt;= X</code></td><td align="left"><code class="literal">assertGreaterThanOrEqual(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) &lt; X</code></td><td align="left"><code class="literal">assertLessThan(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) &lt;= X</code></td><td align="left"><code class="literal">assertLessThanOrEqual(X, method(...))</code></td></tr><tr><td align="left"><code class="literal">@assert (...) throws X</code></td><td align="left"><code class="literal">@expectedException X</code></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="skeleton-generator.class"></a>Gerando uma Classe Esqueleto de uma Classe de Caso de Teste</h2></div></div></div><p>
      Quando você está fazendo Desenvolvimento Guiado por Teste (veja <a class="xref" href="#test-driven-development" title="Capítulo 12. Desenvolvimento Guiado por Testes">Capítulo 12</a>)
      e escreve seus testes antes do código que o teste exercita, o PHPUnit pode ajudá-lo a gerar esqueletos de classe das classes de casos de testes.
    </p><p>
      Seguindo a convenção de que os testes para uma classe  <code class="literal">Unidade</code>
      são escritos em uma classe chamada <code class="literal">UnidadeTest</code>, a fonte da classe de caso de teste é pesquisada para encontrar variáveis que referenciem objetos da classe
      <code class="literal">Unidade</code> e analisa que métodos são chamados nesses objetos. Por exemplo, dê uma olhada em <a class="xref" href="#skeleton-generator.class.examples.BowlingGame.php" title="Exemplo 16.4: O esqueleto gerado da classe JogoBoliche">Exemplo 16.4</a> que foi gerado baseado na análise de <a class="xref" href="#skeleton-generator.class.examples.BowlingGameTest.php" title="Exemplo 16.3: A classe JogoBolicheTest">Exemplo 16.3</a>.
    </p><div class="example"><a id="skeleton-generator.class.examples.BowlingGameTest.php"></a><p class="title"><strong>Exemplo 16.3: A classe JogoBolicheTest</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">JogoBolicheTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$jogo</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">jogo</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">JogoBoliche</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">arremessarVarias</span><span class="keyword">(</span><span class="default">$n</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$pinos</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">for</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">$i</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">;</span><span class="default">&nbsp;</span><span class="default">$i</span><span class="default">&nbsp;</span><span class="keyword">&lt;</span><span class="default">&nbsp;</span><span class="default">$n</span><span class="keyword">;</span><span class="default">&nbsp;</span><span class="default">$i</span><span class="keyword">++</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">jogo</span><span class="keyword">-&gt;</span><span class="default">arremessa</span><span class="keyword">(</span><span class="default">$pinos</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testPontuacaoPorJogarNaCanaletaEh0</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">arremessarVarias</span><span class="keyword">(</span><span class="default">20</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="default">0</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">jogo</span><span class="keyword">-&gt;</span><span class="default">pontuacao</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><pre class="screen"><strong class="userinput"><code>phpunit-skelgen --class JogoBolicheTest</code></strong>
PHPUnit Skeleton Generator 1.0.0 by Sebastian Bergmann.

Wrote skeleton for "JogoBoliche" to "./JogoBoliche.php".</pre><div class="example"><a id="skeleton-generator.class.examples.BowlingGame.php"></a><p class="title"><strong>Exemplo 16.4: O esqueleto gerado da classe JogoBoliche</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;Generated&nbsp;by&nbsp;PHPUnit_SkeletonGenerator&nbsp;on&nbsp;2012-01-09&nbsp;at&nbsp;16:55:58.</span><br /><span class="comment">*/</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">JogoBoliche</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@todo&nbsp;Implement&nbsp;arremessa().</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">arremessa</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Remove&nbsp;the&nbsp;following&nbsp;line&nbsp;when&nbsp;you&nbsp;implement&nbsp;this&nbsp;method.</span><br /><span class="keyword">throw</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">RuntimeException</span><span class="keyword">(</span><span class="string">'Not&nbsp;yet&nbsp;implemented.'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;@todo&nbsp;Implement&nbsp;pontuacao().</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">pontuacao</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;Remove&nbsp;the&nbsp;following&nbsp;line&nbsp;when&nbsp;you&nbsp;implement&nbsp;this&nbsp;method.</span><br /><span class="keyword">throw</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">RuntimeException</span><span class="keyword">(</span><span class="string">'Not&nbsp;yet&nbsp;implemented.'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Abaixo está a saída da execução dos testes contra a classe gerada.
    </p><pre class="screen"><strong class="userinput"><code>phpunit --bootstrap JogoBoliche.php JogoBolicheTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

E

Time: 0 seconds, Memory: 3.50Mb

There was 1 error:

1) JogoBolicheTest::testPontuacaoPorJogarNaCanaletaEh0
RuntimeException: Not yet implemented.

/home/sb/JogoBoliche.php:13
/home/sb/JogoBolicheTest.php:14
/home/sb/JogoBolicheTest.php:20

FAILURES!
Tests: 1, Assertions: 0, Errors: 1.</pre></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="selenium"></a>Capítulo 17. PHPUnit e Selenium</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.selenium-rc"></a>Servidor Selenium</h2></div></div></div><p>
      <a id="idp35068304" class="indexterm"></a>

      <a class="ulink" href="http://seleniumhq.org/" target="_top">Servidor Selenium</a> é uma ferramenta de testes que permite a você escrever testes automatizados de interface de usuário para aplicações web em qualquer linguagem de programação contra qualquer website HTTP usando um dos principais navegadores. Ele realiza tarefas automatizadas no navegador guiando seu processo através do sistema operacional. O Selenium executa os testes diretamente em um navegador, exatamente como os usuários reais fazem. Esses testes podem ser usados para ambos <span class="emphasis"><em>testes de aceitação</em></span>
      (realizando testes de alto-nível no sistema integrado em vez de apenas testar cada unidade do sistema independentemente) e <span class="emphasis"><em>testes de compatibilidade de navegador</em></span> (testando a aplicação web em diferentes sistemas operacionais e navegadores).
    </p><p>
      O único cenário suportado do PHPUnit_Selenium é o do servidor Selenium 2.x. O servidor pode ser acessado através da Api clássica Selenium RC, já presente no 1.x, ou com a API WebDriver (parcialmente implementada) do PHPUnit_Selenium 1.2.
    </p><p>
      A razão por trás dessa decisão é que o Selenium 2 é compatível e o Selenium RC não é mais mantido.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.installation"></a>Instalação</h2></div></div></div><p>
      Primeiro, instale o Servidor Selenium:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Baixe um arquivo de distribuição do <a class="ulink" href="http://seleniumhq.org/download/" target="_top">Servidor Selenium</a>.</li><li class="listitem">Descompacte o arquivo de distribuição e copie o <code class="filename">selenium-server-standalone-2.9.0.jar</code> (verifique o sufixo da versão) para <code class="filename">/usr/local/bin</code>, por exemplo.</li><li class="listitem">Inicie o Servidor Selenium executando <strong class="userinput"><code>java -jar /usr/local/bin/selenium-server-standalone-2.9.0.jar</code></strong>.</li></ol></div><p>
      Segundo, instale o pacote PHPUnit_Selenium, necessário para acessar nativamente o Servidor Selenium do PHPUnit:
      </p><pre class="screen"><strong class="userinput"><code>pear install phpunit/PHPUnit_Selenium</code></strong></pre><p>
    </p><p>
      Agora podemos enviar comandos para o Servidor Selenium usando seu protocolo cliente/servidor.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.selenium2testcase"></a>PHPUnit_Extensions_Selenium2TestCase</h2></div></div></div><p>
      <a id="idp35121424" class="indexterm"></a>

      O caso de teste <code class="literal">PHPUnit_Extensions_Selenium2TestCase</code> permite a você usar a API WebDriver (parcialmente implementada).
    </p><p>
      <a class="xref" href="#selenium.selenium2testcase.examples.WebTest.php" title="Exemplo 17.1: Exemplo de uso para PHPUnit_Extensions_Selenium2TestCase">Exemplo 17.1</a> mostra como testar os conteúdos do elemento <code class="literal">&lt;title&gt;</code>
      do site <code class="systemitem">http://www.example.com/</code>.
    </p><div class="example"><a id="selenium.selenium2testcase.examples.WebTest.php"></a><p class="title"><strong>Exemplo 17.1: Exemplo de uso para PHPUnit_Extensions_Selenium2TestCase</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">WebTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Extensions_Selenium2TestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setBrowser</span><span class="keyword">(</span><span class="string">'firefox'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setBrowserUrl</span><span class="keyword">(</span><span class="string">'http://www.exemplo.com/'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testTitle</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">url</span><span class="keyword">(</span><span class="string">'http://www.exemplo.com/'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertEquals</span><span class="keyword">(</span><span class="string">'Página&nbsp;WWW&nbsp;de&nbsp;Exemplo'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">title</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit WebTest</code></strong>
PHPUnit 3.6.10 by Sebastian Bergmann.

F

Time: 28 seconds, Memory: 3.00Mb

There was 1 failure:

1) WebTest::testTitle
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'Página WWW de Exemplo'
+'IANA — Domínio de Exemplo'

/home/giorgio/WebTest.php:13

FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
    Os comandos do Selenium2TestCase são implementados via __call(). Por favor, recorra ao <a class="ulink" href="https://github.com/sebastianbergmann/phpunit-selenium/blob/master/Tests/Selenium2TestCaseTest.php" target="_top">teste de ponta a ponta para o PHPUnit_Extensions_Selenium2TestCase</a> para uma lista de cada característica suportada.
  </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="selenium.seleniumtestcase"></a>PHPUnit_Extensions_SeleniumTestCase</h2></div></div></div><p>
      <a id="idp35132992" class="indexterm"></a>

      A extensão de caso de teste <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code> implementa o protocolo cliente/servidor para conversar com o Servidor Selenium assim como métodos de asserção especializados para testes web.
    </p><p>
      <a class="xref" href="#selenium.seleniumtestcase.examples.WebTest.php" title="Exemplo 17.2: Exemplo de uso para PHPUnit_Extensions_SeleniumTestCase">Exemplo 17.2</a> mostra como testar os conteúdos do elemento <code class="literal">&lt;title&gt;</code>
      para o site <code class="systemitem">http://www.exemplo.com/</code>.
    </p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest.php"></a><p class="title"><strong>Exemplo 17.2: Exemplo de uso para PHPUnit_Extensions_SeleniumTestCase</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'PHPUnit/Extensions/SeleniumTestCase.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">WebTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Extensions_SeleniumTestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setBrowser</span><span class="keyword">(</span><span class="string">'*firefox'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setBrowserUrl</span><span class="keyword">(</span><span class="string">'http://www.exemplo.com/'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testTitle</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="string">'http://www.exemplo.com/'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTitle</span><span class="keyword">(</span><span class="string">'Página&nbsp;WWW&nbsp;de&nbsp;Exemplo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit WebTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 9 seconds, Memory: 6.00Mb

There was 1 failure:

1) WebTest::testTitle
Current URL: http://www.iana.org/dominios/exemplo/

Failed asserting that 'IANA — Domínios de Exemplo' matches PCRE pattern "/Página WWW de Exemplo/".


FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
      Diferente da classe <code class="literal">PHPUnit_Framework_TestCase</code> classes de caso de teste que estendem o <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code> têm que prover um método <code class="literal">setUp()</code>. Esse método é usado para configurar a sessão do Servidor Selenium. Veja
      <a class="xref" href="#selenium.seleniumtestcase.tables.seleniumrc-api.setup" title="Tabela 17.1. API do Servidor Selenium: Setup">Tabela 17.1</a>
      para uma lista de métodos que estão disponíveis para isso.
    </p><div class="table"><a id="selenium.seleniumtestcase.tables.seleniumrc-api.setup"></a><p class="title"><strong>Tabela 17.1. API do Servidor Selenium: Setup</strong></p><div class="table-contents"><table summary="API do Servidor Selenium: Setup" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Método</th><th align="left">Significado</th></tr></thead><tbody><tr><td align="left"><code class="literal">void setBrowser(string $browser)</code></td><td align="left">Define o navegador a ser usado pelo Servidor Selenium.</td></tr><tr><td align="left"><code class="literal">void setBrowserUrl(string $browserUrl)</code></td><td align="left">Define a URL base para os testes.</td></tr><tr><td align="left"><code class="literal">void setHost(string $host)</code></td><td align="left">Define o nome do host para a conexão do Servidor Selenium.</td></tr><tr><td align="left"><code class="literal">void setPort(int $port)</code></td><td align="left">Define a porta de conexão para o Servidor Selenium</td></tr><tr><td align="left"><code class="literal">void setTimeout(int $timeout)</code></td><td align="left">Define o timeout para a conexão do Servidor Selenium.</td></tr><tr><td align="left"><code class="literal">void setSleep(int $seconds)</code></td><td align="left">Define o número de segundos que o cliente do Servidor Selenium deve esperar entre cada envio de comandos de ação para o Servidor Selenium.</td></tr></tbody></table></div></div><br class="table-break" /><p>
      O PHPUnit pode opcionalmente fazer uma captura de tela quando um teste do Selenium falha. Para habilitar isso, configure <code class="literal">$captureScreenshotOnFailure</code>,
      <code class="literal">$screenshotPath</code> e <code class="literal">$screenshotUrl</code>
      em sua classe de caso de teste como mostrado em
      <a class="xref" href="#selenium.seleniumtestcase.examples.WebTest2.php" title="Exemplo 17.3: Capturando a tela quando um teste falha">Exemplo 17.3</a>.
    </p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest2.php"></a><p class="title"><strong>Exemplo 17.3: Capturando a tela quando um teste falha</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'PHPUnit/Extensions/SeleniumTestCase.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">WebTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Extensions_SeleniumTestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$captureScreenshotOnFailure</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">TRUE</span><span class="keyword">;</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$screenshotPath</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'/var/www/localhost/htdocs/screenshots'</span><span class="keyword">;</span><br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="default">$screenshotUrl</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'http://localhost/screenshots'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setBrowser</span><span class="keyword">(</span><span class="string">'*firefox'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setBrowserUrl</span><span class="keyword">(</span><span class="string">'http://www.exemplo.com/'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testTitle</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="string">'http://www.exemplo.com/'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTitle</span><span class="keyword">(</span><span class="string">'Página&nbsp;WWW&nbsp;de&nbsp;Exemplo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen"><strong class="userinput"><code>phpunit WebTest</code></strong>
PHPUnit 3.7.0 by Sebastian Bergmann.

F

Time: 7 seconds, Memory: 6.00Mb

There was 1 failure:

1) WebTest::testTitle
Current URL: http://www.iana.org/dominios/exemplo/
Screenshot: http://localhost/screenshots/334b080f2364b5f11568ee1c7f6742c9.png

Failed asserting that 'IANA — Domínio de Exemplo' matches PCRE pattern "/Página WWW de Exemplo/".


FAILURES!
Tests: 1, Assertions: 1, Failures: 1.</pre></div></div><br class="example-break" /><p>
      Você pode executar cada teste usando um conjunto de navegadores: Em vez de usar
      <code class="literal">setBrowser()</code> para configurar um navegador, você pode declarar um vetor
      <code class="literal">public static</code> chamado <code class="literal">$browsers</code>
      em sua classe de caso de testes. Cada item nesse vetor descreve uma configuração de navegador. Cada um desses navegadores pode ser hospedado em diferentes Servidores Selenium.
      <a class="xref" href="#selenium.seleniumtestcase.examples.WebTest3.php" title="Exemplo 17.4: Definindo configurações de múltiplos navegadores">Exemplo 17.4</a> mostra um exemplo.
    </p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest3.php"></a><p class="title"><strong>Exemplo 17.4: Definindo configurações de múltiplos navegadores</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'PHPUnit/Extensions/SeleniumTestCase.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">WebTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Extensions_SeleniumTestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">static</span><span class="default">&nbsp;</span><span class="default">$browsers</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">array</span><span class="keyword">(</span><br /><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'name'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'Firefox&nbsp;no&nbsp;Linux'</span><span class="keyword">,</span><br /><span class="string">'browser'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'*firefox'</span><span class="keyword">,</span><br /><span class="string">'host'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'my.linux.box'</span><span class="keyword">,</span><br /><span class="string">'port'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="default">4444</span><span class="keyword">,</span><br /><span class="string">'timeout'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="default">30000</span><span class="keyword">,</span><br /><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'name'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'Safari&nbsp;no&nbsp;MacOS&nbsp;X'</span><span class="keyword">,</span><br /><span class="string">'browser'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'*safari'</span><span class="keyword">,</span><br /><span class="string">'host'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'my.macosx.box'</span><span class="keyword">,</span><br /><span class="string">'port'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="default">4444</span><span class="keyword">,</span><br /><span class="string">'timeout'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="default">30000</span><span class="keyword">,</span><br /><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'name'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'Safari&nbsp;no&nbsp;Windows&nbsp;XP'</span><span class="keyword">,</span><br /><span class="string">'browser'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'*custom&nbsp;C:\Program&nbsp;Files\Safari\Safari.exe&nbsp;-url'</span><span class="keyword">,</span><br /><span class="string">'host'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'my.windowsxp.box'</span><span class="keyword">,</span><br /><span class="string">'port'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="default">4444</span><span class="keyword">,</span><br /><span class="string">'timeout'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="default">30000</span><span class="keyword">,</span><br /><span class="keyword">)</span><span class="keyword">,</span><br /><span class="keyword">array</span><span class="keyword">(</span><br /><span class="string">'name'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'Internet&nbsp;Explorer&nbsp;no&nbsp;Windows&nbsp;XP'</span><span class="keyword">,</span><br /><span class="string">'browser'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'*iexplore'</span><span class="keyword">,</span><br /><span class="string">'host'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="string">'my.windowsxp.box'</span><span class="keyword">,</span><br /><span class="string">'port'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="default">4444</span><span class="keyword">,</span><br /><span class="string">'timeout'</span><span class="default">&nbsp;</span><span class="keyword">=&gt;</span><span class="default">&nbsp;</span><span class="default">30000</span><span class="keyword">,</span><br /><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">protected</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">setUp</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">setBrowserUrl</span><span class="keyword">(</span><span class="string">'http://www.exemplo.com/'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">testTitle</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">open</span><span class="keyword">(</span><span class="string">'http://www.exemplo.com/'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">assertTitle</span><span class="keyword">(</span><span class="string">'Página&nbsp;Web&nbsp;de&nbsp;Exemplo'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code> pode coletar a informação de cobertura de código para execução de testes através do Selenium:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Copie <code class="filename">PHPUnit/Extensions/SeleniumTestCase/phpunit_coverage.php</code> 1. para dentro do diretório raiz de documentos do seu servidor web.</li><li class="listitem">Em seu arquivo de configuração <code class="filename">php.ini</code> do servidor web, configure <code class="filename">PHPUnit/Extensions/SeleniumTestCase/prepend.php</code> e <code class="filename">PHPUnit/Extensions/SeleniumTestCase/append.php</code> como o <code class="literal">auto_prepend_file</code> e <code class="literal">auto_append_file</code>, respectivamente.</li><li class="listitem">Na sua classe de caso de teste que estende <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code>, use <pre class="programlisting"><code>protected $coverageScriptUrl = 'http://host/phpunit_coverage.php';</code></pre> para configurar a URL para o script <code class="filename">phpunit_coverage.php</code>.</li></ol></div><p>
      <a class="xref" href="#selenium.seleniumtestcase.tables.assertions" title="Tabela 17.2. Asserções">Tabela 17.2</a> lista os vários métodos de asserção que o <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code>
      fornece.
    </p><div class="table"><a id="selenium.seleniumtestcase.tables.assertions"></a><p class="title"><strong>Tabela 17.2. Asserções</strong></p><div class="table-contents"><table summary="Asserções" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Asserção</th><th align="left">Significado</th></tr></thead><tbody><tr><td align="left"><code class="literal">void assertElementValueEquals(string $locator, string $text)</code></td><td align="left">Relata um erro se o valor do elemento identificado por <code class="literal">$locator</code> não é igual ao <code class="literal">$text</code> informado.</td></tr><tr><td align="left"><code class="literal">void assertElementValueNotEquals(string $locator, string $text)</code></td><td align="left">Relata um erro se o valor do elemento identificado por <code class="literal">$locator</code> é igual ao <code class="literal">$text</code> informado.</td></tr><tr><td align="left"><code class="literal">void assertElementValueContains(string $locator, string $text)</code></td><td align="left">Relata um erro se o valor do elemento identificado por <code class="literal">$locator</code> não contém o <code class="literal">$text</code> informado.</td></tr><tr><td align="left"><code class="literal">void assertElementValueNotContains(string $locator, string $text)</code></td><td align="left">Relata um erro se o valor do elemento identificado por <code class="literal">$locator</code> contém o <code class="literal">$text</code> informado.</td></tr><tr><td align="left"><code class="literal">void assertElementContainsText(string $locator, string $text)</code></td><td align="left">Relata um erro se o elemento identificado por <code class="literal">$locator</code> não contém o <code class="literal">$text</code> informado.</td></tr><tr><td align="left"><code class="literal">void assertElementNotContainsText(string $locator, string $text)</code></td><td align="left">Relata um erro se o elemento identificado por <code class="literal">$locator</code> contém o <code class="literal">$text</code> informado.</td></tr><tr><td align="left"><code class="literal">void assertSelectHasOption(string $selectLocator, string $option)</code></td><td align="left">Relata um erro se a opção informada não estiver disponível.</td></tr><tr><td align="left"><code class="literal">void assertSelectNotHasOption(string $selectLocator, string $option)</code></td><td align="left">Relata um erro se a opção informada estiver disponível.</td></tr><tr><td align="left"><code class="literal">void assertSelected($selectLocator, $option)</code></td><td align="left">Relata um erro se o rótulo informado não estiver selecionado.</td></tr><tr><td align="left"><code class="literal">void assertNotSelected($selectLocator, $option)</code></td><td align="left">Relata um erro se o rótulo informado estiver selecionado.</td></tr><tr><td align="left"><code class="literal">void assertIsSelected(string $selectLocator, string $value)</code></td><td align="left">Relata um erro se o valor informado não estiver selecionado.</td></tr><tr><td align="left"><code class="literal">void assertIsNotSelected(string $selectLocator, string $value)</code></td><td align="left">Relata um erro se o valor informado estiver selecionado.</td></tr></tbody></table></div></div><br class="table-break" /><p>
      <a class="xref" href="#selenium.seleniumtestcase.tables.template-methods" title="Tabela 17.3. Métodos Modelo">Tabela 17.3</a> mostra o método modelo de <code class="literal">PHPUnit_Extensions_SeleniumTestCase</code>:
    </p><div class="table"><a id="selenium.seleniumtestcase.tables.template-methods"></a><p class="title"><strong>Tabela 17.3. Métodos Modelo</strong></p><div class="table-contents"><table summary="Métodos Modelo" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Método</th><th align="left">Significado</th></tr></thead><tbody><tr><td align="left"><code class="literal">void defaultAssertions()</code></td><td align="left">Sobreposição para realizar asserções que são compartilhadas por todos os testes de um caso de teste. Este método é chamado após cada comando ser enviado ao Servidor  Selenium.</td></tr></tbody></table></div></div><br class="table-break" /><p>
      Por favor, verifique a <a class="ulink" href="http://release.seleniumhq.org/selenium-core/1.0.1/reference.html" target="_top">documentação dos comandos do Selenium</a> para uma referência de todos os comandos disponíveis e como eles são utilizados.
    </p><p>
    Os comandos do Selenium 1 são implementados dinamicamente via __call. Verifique também <a class="ulink" href="https://github.com/sebastianbergmann/phpunit-selenium/blob/master/PHPUnit/Extensions/SeleniumTestCase/Driver.php#L410" target="_top">a documentação API para PHPUnit_Extensions_SeleniumTestCase_Driver::__call()</a> para uma lista de todos os métodos suportados do lado do PHP, juntamente com argumentos e tipos de retorno quando disponíveis.
    </p><p>
      Usando o método <code class="literal">runSelenese($nomearquivo)</code> você também pode executar um teste Selenium a partir de sua especificação Selenese/HTML. Além disso, usando o atributo estático <code class="literal">$seleneseDirectory</code>, você pode criar automaticamente objetos de teste a partir de um diretório que contenha arquivos Selenese/HTML. O diretório especificado é pesquisado recursivamente por arquivos
      <code class="literal">.htm</code> que possam conter Selenese/HTML.
      <a class="xref" href="#selenium.seleniumtestcase.examples.WebTest4.php" title="Exemplo 17.5: Usando um diretório de arquivos Selenese/HTML como testes">Exemplo 17.5</a> mostra um exemplo.
    </p><div class="example"><a id="selenium.seleniumtestcase.examples.WebTest4.php"></a><p class="title"><strong>Exemplo 17.5: Usando um diretório de arquivos Selenese/HTML como testes</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'PHPUnit/Extensions/SeleniumTestCase.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">SeleneseTests</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Extensions_SeleniumTestCase</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">static</span><span class="default">&nbsp;</span><span class="default">$seleneseDirectory</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">'/caminho/para/arquivos'</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
    Desde o Selenium 1.1.1, um recurso experimental foi incluído para permitir ao usuário compartilhar a sessão entre testes. O único caso suportado é compartilhar a sessão entre todos os testes quando um único navegador é usado. Chame <code class="literal">PHPUnit_Extensions_SeleniumTestCase::shareSession(true)</code> em seu arquivo bootstrap para permitir o compartilhamento de sessão. A sessão será reiniciada no caso de testes mal-sucedidos (falhos ou incompletos); cabe ao usuário evitar interações entre testes seja resetando cookies ou deslogando da aplicação sob teste (com um método tearDown()).
    </p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="logging"></a>Capítulo 18. Registrando</h1></div></div></div><p>
    <a id="idp35341168" class="indexterm"></a>

    O PHPUnit pode produzir vários tipos de arquivos de registro (logfiles).
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="logging.xml"></a>Resultados de Teste (XML)</h2></div></div></div><p>
      O arquivo de registro XML para resultados de testes produzidos pelo PHPUnit é baseado naquele usado pela <a class="ulink" href="http://ant.apache.org/manual/OptionalTasks/junit.html" target="_top">tarefa do JUnit para Apache Ant</a>. O seguinte exemplo mostra o arquivo de registro XML gerado para os testes em <code class="literal">ArrayTest</code>:
    </p><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;testsuites&gt;
&lt;testsuite name="ArrayTest"
file="/home/sb/ArrayTest.php"
tests="2"
assertions="2"
failures="0"
errors="0"
time="0.016030"&gt;
&lt;testcase name="testNewArrayIsEmpty"
class="ArrayTest"
file="/home/sb/ArrayTest.php"
line="6"
assertions="1"
time="0.008044"/&gt;
&lt;testcase name="testArrayContainsAnElement"
class="ArrayTest"
file="/home/sb/ArrayTest.php"
line="15"
assertions="1"
time="0.007986"/&gt;
&lt;/testsuite&gt;
&lt;/testsuites&gt;</pre><p>
      O arquivo de registro XML seguinte foi gerado por dois testes,
      <code class="literal">testFailure</code> e <code class="literal">testError</code>,
      de uma classe de caso de teste chamada <code class="literal">FailureErrorTest</code> e
      mostra como falhas e erros são denotadas.
    </p><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;testsuites&gt;
&lt;testsuite name="FailureErrorTest"
file="/home/sb/FailureErrorTest.php"
tests="2"
assertions="1"
failures="1"
errors="1"
time="0.019744"&gt;
&lt;testcase name="testFailure"
class="FailureErrorTest"
file="/home/sb/FailureErrorTest.php"
line="6"
assertions="1"
time="0.011456"&gt;
&lt;failure type="PHPUnit_Framework_ExpectationFailedException"&gt;
testFailure(FailureErrorTest)
Failed asserting that &amp;lt;integer:2&amp;gt; matches expected value &amp;lt;integer:1&amp;gt;.

/home/sb/FailureErrorTest.php:8
&lt;/failure&gt;
&lt;/testcase&gt;
&lt;testcase name="testError"
class="FailureErrorTest"
file="/home/sb/FailureErrorTest.php"
line="11"
assertions="0"
time="0.008288"&gt;
&lt;error type="Exception"&gt;testError(FailureErrorTest)
Exception:

/home/sb/FailureErrorTest.php:13
&lt;/error&gt;
&lt;/testcase&gt;
&lt;/testsuite&gt;
&lt;/testsuites&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="logging.tap"></a>Resultados de Teste (TAP)</h2></div></div></div><p>
      O <a class="ulink" href="http://testanything.org/" target="_top">Test Anything Protocol (TAP)</a>
      é uma interface simples baseada em texto do Perl entre módulos de teste. O seguinte exemplo mostra o arquivo de registro TAP gerado para os testes em
      <code class="literal">ArrayTest</code>:
    </p><pre class="screen">TAP version 13
ok 1 - testNewArrayIsEmpty(ArrayTest)
ok 2 - testArrayContainsAnElement(ArrayTest)
1..2</pre><p>
      O seguinte arquivo de registro TAP foi gerado para dois testes,
      <code class="literal">testFailure</code> e <code class="literal">testError</code>,
      de uma classe de caso de teste chamada <code class="literal">FailureErrorTest</code> e
      e mostra como falhas e erros são denotados.
    </p><pre class="screen">TAP version 13
not ok 1 - Failure: testFailure(FailureErrorTest)
---
message: 'Failed asserting that &lt;integer:2&gt; matches expected value &lt;integer:1&gt;.'
severity: fail
data:
got: 2
expected: 1
...
not ok 2 - Error: testError(FailureErrorTest)
1..2</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="logging.json"></a>Resultados de Teste (JSON)</h2></div></div></div><p>
      O <a class="ulink" href="http://www.json.org/" target="_top">JavaScript Object Notation (JSON)</a>
      é um formato leve de intercâmbio de dados. O seguinte exemplo mostra as mensagem JSON geradas para os testes em <code class="literal">ArrayTest</code>:
    </p><pre class="screen">{"event":"suiteStart","suite":"ArrayTest","tests":2}
{"event":"test","suite":"ArrayTest",
 "test":"testNewArrayIsEmpty(ArrayTest)","status":"pass",
 "time":0.000460147858,"trace":[],"message":""}
{"event":"test","suite":"ArrayTest",
 "test":"testArrayContainsAnElement(ArrayTest)","status":"pass",
 "time":0.000422954559,"trace":[],"message":""}</pre><p>
      As mensagens JSON seguintes foram geradas para dois testes,
      <code class="literal">testFailure</code> e <code class="literal">testError</code>,
      de uma classe de caso de teste chamada <code class="literal">FailureErrorTest</code> e
      mostra como falhas e erros são denotados.
    </p><pre class="screen">{"event":"suiteStart","suite":"FailureErrorTest","tests":2}
{"event":"test","suite":"FailureErrorTest",
"test":"testFailure(FailureErrorTest)","status":"fail",
"time":0.0082459449768066,"trace":[],
"message":"Failed asserting that &lt;integer:2&gt; is equal to &lt;integer:1&gt;."}
{"event":"test","suite":"FailureErrorTest",
"test":"testError(FailureErrorTest)","status":"error",
"time":0.0083680152893066,"trace":[],"message":""}</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="logging.codecoverage.xml"></a>Cobertura de Código (XML)</h2></div></div></div><p>
      O arquivo de registro no formato XML para informação de cobertura de código produzido pelo PHPUnit é amplamente baseado naquele usado pelo <a class="ulink" href="http://www.atlassian.com/software/clover/" target="_top">
      Clover</a>. O seguinte exemplo mostra o arquivo de registro XML gerado para os testes em <code class="literal">ContaBancariaTest</code>:
    </p><pre class="screen">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;coverage generated="1184835473" phpunit="3.6.0"&gt;
&lt;project name="ContaBancariaTest" timestamp="1184835473"&gt;
&lt;file name="/home/sb/ContaBancariaTest.php"&gt;
&lt;class name="ExcecaoContaBancaria"&gt;
&lt;metrics methods="0" coveredmethods="0" statements="0"
coveredstatements="0" elements="0" coveredelements="0"/&gt;
&lt;/class&gt;
&lt;class name="ContaBancaria"&gt;
&lt;metrics methods="4" coveredmethods="4" statements="13"
coveredstatements="5" elements="17" coveredelements="9"/&gt;
&lt;/class&gt;
&lt;line num="77" type="method" count="3"/&gt;
&lt;line num="79" type="stmt" count="3"/&gt;
&lt;line num="89" type="method" count="2"/&gt;
&lt;line num="91" type="stmt" count="2"/&gt;
&lt;line num="92" type="stmt" count="0"/&gt;
&lt;line num="93" type="stmt" count="0"/&gt;
&lt;line num="94" type="stmt" count="2"/&gt;
&lt;line num="96" type="stmt" count="0"/&gt;
&lt;line num="105" type="method" count="1"/&gt;
&lt;line num="107" type="stmt" count="1"/&gt;
&lt;line num="109" type="stmt" count="0"/&gt;
&lt;line num="119" type="method" count="1"/&gt;
&lt;line num="121" type="stmt" count="1"/&gt;
&lt;line num="123" type="stmt" count="0"/&gt;
&lt;metrics loc="126" ncloc="37" classes="2" methods="4" coveredmethods="4"
statements="13" coveredstatements="5" elements="17"
coveredelements="9"/&gt;
&lt;/file&gt;
&lt;metrics files="1" loc="126" ncloc="37" classes="2" methods="4"
coveredmethods="4" statements="13" coveredstatements="5"
elements="17" coveredelements="9"/&gt;
&lt;/project&gt;
&lt;/coverage&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="logging.codecoverage.text"></a>Cobertura de Código (TEXTO)</h2></div></div></div><p>
      Saída de cobertura de código humanamente legível para linha-de-comando ou arquivo de texto. O objetivo deste formato de saída é fornecer uma rápida visão geral de cobertura enquanto se trabalha em um pequeno grupo de classes. Para maiores projetos esta saída pode ser útil para conseguir uma rápida visão geral da cobertura do projeto ou quando usado com a funcionalidade <code class="literal">--filter</code>.

      Quando usada da linha-de-comando escrevendo <code class="literal">php://stdout</code>
      isso vai honrar a configuração <code class="literal">--colors</code>.

      Escrever em saída padrão é a opção padrão quando usado a partir da linha-de-comando. Por padrão isso só vai mostrar arquivos que tenham pelo menos uma linha coberta. Isso só pode ser alterado através da opção de configuração xml <code class="literal">showUncoveredFiles</code>. Veja <a class="xref" href="#appendixes.configuration.logging" title="Registrando">“Registrando”</a>.
    </p><div class="figure"><a id="code-coverage-analysis.figures.Code_Coverage4.png"></a><p class="title"><strong>Figura 18.1. Saída de Cobertura de Código na linha-de-comando com cores</strong></p><div class="figure-contents"><div><img src="figures/Code_Coverage4.png" alt="Saída de Cobertura de Código na linha-de-comando com cores" /></div></div></div><br class="figure-break" /></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="extending-phpunit"></a>Capítulo 19. Estendendo o PHPUnit</h1></div></div></div><p>
    O PHPUnit pode ser estendido de várias formas para facilitar a escrita de testes e personalizar as respostas que você recebe ao executar os testes. Aqui estão pontos de partida comuns para estender o PHPUnit.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending-phpunit.PHPUnit_Framework_TestCase"></a>Subclasse PHPUnit_Framework_TestCase</h2></div></div></div><p>
      <a id="idp35421872" class="indexterm"></a>

      Escreva asserções personalizadas e métodos utilitários em uma subclasse abstrata do
      <code class="literal">PHPUnit_Framework_TestCase</code> e derive suas classes de caso de teste dessa classe. Essa é uma das formas mais fáceis de estender o PHPUnit.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending-phpunit.custom-assertions"></a>Escreva asserções personalizadas</h2></div></div></div><p>
      Ao escrever asserções personalizadas a melhor prática é seguir a mesma forma que as asserções do próprio PHPUnit são implementadas. Como você pode ver em
      <a class="xref" href="#extending-phpunit.examples.Assert.php" title="Exemplo 19.1: Os métodos assertTrue() e isTrue() da classe PHPUnitFramework_Assert">Exemplo 19.1</a>, o método
      <code class="literal">assertTrue()</code> é apenas um empacotador em torno dos métodos
      <code class="literal">isTrue()</code> e <code class="literal">assertThat()</code>:
      <code class="literal">isTrue()</code> cria um objeto comparador que é passado para
      <code class="literal">assertThat()</code> para avaliação.
    </p><div class="example"><a id="extending-phpunit.examples.Assert.php"></a><p class="title"><strong>Exemplo 19.1: Os métodos assertTrue() e isTrue() da classe PHPUnitFramework_Assert</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">abstract</span><span class="default">&nbsp;</span><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_Assert</span><br /><span class="keyword">{</span><br /><span class="comment">//&nbsp;...</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;Asserta&nbsp;que&nbsp;uma&nbsp;condição&nbsp;é&nbsp;verdade.</span><br /><span class="comment">*</span><br /><span class="comment">*&nbsp;@param&nbsp;boolean&nbsp;$condicao</span><br /><span class="comment">*&nbsp;@param&nbsp;string&nbsp;$menssagem</span><br /><span class="comment">*&nbsp;@throws&nbsp;PHPUnit_Framework_AssertionFailedError</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">static</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">assertTrue</span><span class="keyword">(</span><span class="default">$condicao</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$mensagem</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="string">''</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">self</span><span class="keyword">::</span><span class="default">assertThat</span><span class="keyword">(</span><span class="default">$condicao</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">self</span><span class="keyword">::</span><span class="default">isTrue</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$mensagem</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">//&nbsp;...</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;Retorna&nbsp;um&nbsp;objeto&nbsp;equiparador&nbsp;PHPUnit_Framework_Constraint_IsTrue.</span><br /><span class="comment">*</span><br /><span class="comment">*&nbsp;@return&nbsp;PHPUnit_Framework_Constraint_IsTrue</span><br /><span class="comment">*&nbsp;@since&nbsp;Método&nbsp;disponível&nbsp;desde&nbsp;a&nbsp;versão&nbsp;3.3.0</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">static</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">isTrue</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_Constraint_IsTrue</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">//&nbsp;...</span><br /><span class="keyword">}</span><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      <a class="xref" href="#extending-phpunit.examples.IsTrue.php" title="Exemplo 19.2: A classe PHPUnit_Framework_Constraint_IsTrue">Exemplo 19.2</a> mostra como
      <code class="literal">PHPUnit_Framework_Constraint_IsTrue</code> estende a classe base abstrata para objetos comparadores (ou restritores),
      <code class="literal">PHPUnit_Framework_Constraint</code>.
    </p><div class="example"><a id="extending-phpunit.examples.IsTrue.php"></a><p class="title"><strong>Exemplo 19.2: A classe PHPUnit_Framework_Constraint_IsTrue</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_Constraint_IsTrue</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_Constraint</span><br /><span class="keyword">{</span><br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;Avalia&nbsp;a&nbsp;restrição&nbsp;para&nbsp;o&nbsp;parâmetro&nbsp;$outro.&nbsp;Retorna&nbsp;TRUE&nbsp;se&nbsp;a</span><br /><span class="comment">*&nbsp;restrição&nbsp;é&nbsp;confirmada,&nbsp;FALSE&nbsp;caso&nbsp;contrário.</span><br /><span class="comment">*</span><br /><span class="comment">*&nbsp;@param&nbsp;misto&nbsp;$outro&nbsp;Valor&nbsp;ou&nbsp;objeto&nbsp;a&nbsp;avaliar.</span><br /><span class="comment">*&nbsp;@return&nbsp;bool</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">matches</span><span class="keyword">(</span><span class="default">$outro</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$outro</span><span class="default">&nbsp;</span><span class="keyword">===</span><span class="default">&nbsp;</span><span class="default">TRUE</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="comment">/**</span><br /><span class="comment">*&nbsp;Retorna&nbsp;uma&nbsp;representação&nbsp;string&nbsp;da&nbsp;restrição.</span><br /><span class="comment">*</span><br /><span class="comment">*&nbsp;@return&nbsp;string</span><br /><span class="comment">*/</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">toString</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="string">'é&nbsp;verdade'</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      O esforço de implementar os métodos <code class="literal">assertTrue()</code> e
      <code class="literal">isTrue()</code> assim como a classe
      <code class="literal">PHPUnit_Framework_Constraint_IsTrue</code> rende o benefício de que <code class="literal">assertThat()</code> automaticamente cuida de avaliar a asserção e escriturar tarefas como contá-las para estatísticas. Além disso, o método <code class="literal">isTrue()</code> pode ser usado como um comparador ao configurar objetos falsos.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending-phpunit.PHPUnit_Framework_TestListener"></a>Implementando PHPUnit_Framework_TestListener</h2></div></div></div><p>
      <a id="idp35481136" class="indexterm"></a>

      <a class="xref" href="#extending-phpunit.examples.SimpleTestListener.php" title="Exemplo 19.3: Um simples ouvinte de teste">Exemplo 19.3</a>
      mostra uma implementação simples da interface <code class="literal">PHPUnit_Framework_TestListener</code>.
    </p><div class="example"><a id="extending-phpunit.examples.SimpleTestListener.php"></a><p class="title"><strong>Exemplo 19.3: Um simples ouvinte de teste</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">SimplesOuvinteDeTest</span><span class="default">&nbsp;</span><span class="default">implements</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestListener</span><br /><span class="keyword">{</span><br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">addError</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_Test</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">Exception</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$tempo</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;Erro&nbsp;ao&nbsp;executar&nbsp;o&nbsp;teste&nbsp;'%s'.\n&quot;</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">addFailure</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_Test</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_AssertionFailedError</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$tempo</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;O&nbsp;Teste&nbsp;'%s'&nbsp;falhou.\n&quot;</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">addIncompleteTest</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_Test</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">Exception</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$tempo</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;O&nbsp;Teste&nbsp;'%s'&nbsp;está&nbsp;incompleto.\n&quot;</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">addSkippedTest</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_Test</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">Exception</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$tempo</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;O&nbsp;Teste&nbsp;'%s'&nbsp;foi&nbsp;pulado.\n&quot;</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">startTest</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_Test</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;O&nbsp;Teste&nbsp;'%s'&nbsp;iniciou.\n&quot;</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">endTest</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_Test</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$tempo</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;O&nbsp;Teste&nbsp;'%s'&nbsp;terminou.\n&quot;</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">startTestSuite</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_TestSuite</span><span class="default">&nbsp;</span><span class="default">$suite</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;A&nbsp;Suíte&nbsp;de&nbsp;Testes&nbsp;'%s'&nbsp;iniciou.\n&quot;</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$suite</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">endTestSuite</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_TestSuite</span><span class="default">&nbsp;</span><span class="default">$suite</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">printf</span><span class="keyword">(</span><span class="string">&quot;A&nbsp;Suíte&nbsp;de&nbsp;Testes&nbsp;'%s'&nbsp;terminou.\n&quot;</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$suite</span><span class="keyword">-&gt;</span><span class="default">getName</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /><p>
      Em <a class="xref" href="#appendixes.configuration.test-listeners" title="Ouvintes de Teste">“Ouvintes de Teste”</a> você pode ver como configurar o PHPUnit para anexar seu ouvinte de teste para a execução do teste.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending-phpunit.PHPUnit_Extensions_TestDecorator"></a>Subclasse PHPUnit_Extensions_TestDecorator</h2></div></div></div><p>
      <a id="idp35489520" class="indexterm"></a>

      ocê pode envolver casos de teste ou suítes de teste em uma subclasse do
      <code class="literal">PHPUnit_Extensions_TestDecorator</code> e usar o padrão de design do Decorador para realizar algumas ações antes e depois da execução do teste.
    </p><p>
      <a id="idp35491872" class="indexterm"></a>
      <a id="idp35492704" class="indexterm"></a>

      O PHPUnit navega com dois decoradores de teste concretos:
      <code class="literal">PHPUnit_Extensions_RepeatedTest</code> e
      <code class="literal">PHPUnit_Extensions_TestSetup</code>. O formador é usado para executar um teste repetidamente e apenas o conta como bem-sucedido se todas as iterações forem bem-sucedidas. O último foi discutido em <a class="xref" href="#fixtures" title="Capítulo 6. Ambientes">Capítulo 6</a>.
    </p><p>
      <a class="xref" href="#extending-phpunit.examples.RepeatedTest.php" title="Exemplo 19.4: O Decorador RepeatedTest">Exemplo 19.4</a>
      mostra uma versão resumida do decorador de teste <code class="literal">PHPUnit_Extensions_RepeatedTest</code>
      que ilustra como escrever seus próprios decoradores de teste.
    </p><div class="example"><a id="extending-phpunit.examples.RepeatedTest.php"></a><p class="title"><strong>Exemplo 19.4: O Decorador RepeatedTest</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">require_once</span><span class="default">&nbsp;</span><span class="string">'PHPUnit/Extensions/TestDecorator.php'</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Extensions_RepeatedTest</span><span class="default">&nbsp;</span><span class="keyword">extends</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Extensions_TestDecorator</span><br /><span class="keyword">{</span><br /><span class="keyword">private</span><span class="default">&nbsp;</span><span class="default">$repetirVezes</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_Test</span><span class="default">&nbsp;</span><span class="default">$teste</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$repetirVezes</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">parent</span><span class="keyword">::</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$teste</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">is_integer</span><span class="keyword">(</span><span class="default">$repetirVezes</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">&amp;&amp;</span><br /><span class="default">$repetirVezes</span><span class="default">&nbsp;</span><span class="default">&gt;=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">repetirVezes</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$repetirVezes</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">count</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">repetirVezes</span><span class="default">&nbsp;</span><span class="keyword">*</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">teste</span><span class="keyword">-&gt;</span><span class="default">count</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">run</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_TestResult</span><span class="default">&nbsp;</span><span class="default">$resultado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">NULL</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">$resultado</span><span class="default">&nbsp;</span><span class="keyword">===</span><span class="default">&nbsp;</span><span class="default">NULL</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$resultado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">createResult</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="default">for</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">$i</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">0</span><span class="keyword">;</span><span class="default">&nbsp;</span><span class="default">$i</span><span class="default">&nbsp;</span><span class="keyword">&lt;</span><span class="default">&nbsp;</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">repetirVezes</span><span class="default">&nbsp;</span><span class="keyword">&amp;&amp;</span><span class="default">&nbsp;</span><span class="keyword">!</span><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">shouldStop</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><span class="default">&nbsp;</span><span class="default">$i</span><span class="keyword">++</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">teste</span><span class="keyword">-&gt;</span><span class="default">run</span><span class="keyword">(</span><span class="default">$resultado</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$resultado</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br /><span class="default">?&gt;</span><br /></code></pre></div></div><br class="example-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="extending-phpunit.PHPUnit_Framework_Test"></a>Implementando PHPUnit_Framework_Test</h2></div></div></div><p>
      <a id="idp35452384" class="indexterm"></a>
      <a id="idp35453200" class="indexterm"></a>

      A interface <code class="literal">PHPUnit_Framework_Test</code> é limitada e fácil de implementar. Você pode escrever uma implementação do
      <code class="literal">PHPUnit_Framework_Test</code> que é mais simples que
      <code class="literal">PHPUnit_Framework_TestCase</code> e que executa
      <span class="emphasis"><em>data-driven tests</em></span>, por exemplo.
    </p><p>
      <a class="xref" href="#extending-phpunit.examples.DataDrivenTest.php" title="Exemplo 19.5: Um teste guiado por dados">Exemplo 19.5</a>
      mostra uma classe de caso de teste guiado por dados que compara valores de um arquivo com Valores Separados por Vírgulas (CSV). Cada linha de tal arquivo parece com
      <code class="literal">foo;bar</code>, onde o primeiro valor é o qual esperamos e o segundo é o real.
    </p><div class="example"><a id="extending-phpunit.examples.DataDrivenTest.php"></a><p class="title"><strong>Exemplo 19.5: Um teste guiado por dados</strong></p><div class="example-contents"><pre class="programlisting"><code><span class="default">&lt;?php</span><br /><span class="keyword">class</span><span class="default">&nbsp;</span><span class="default">GuiadoPorDadosTest</span><span class="default">&nbsp;</span><span class="default">implements</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_Test</span><br /><span class="keyword">{</span><br /><span class="keyword">private</span><span class="default">&nbsp;</span><span class="default">$linhas</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">__construct</span><span class="keyword">(</span><span class="default">$arquivoDados</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">linhas</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">file</span><span class="keyword">(</span><span class="default">$arquivoDados</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">count</span><span class="keyword">(</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">1</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">public</span><span class="default">&nbsp;</span><span class="keyword">function</span><span class="default">&nbsp;</span><span class="default">run</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_TestResult</span><span class="default">&nbsp;</span><span class="default">$resultado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">NULL</span><span class="keyword">)</span><br /><span class="keyword">{</span><br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">$resultado</span><span class="default">&nbsp;</span><span class="keyword">===</span><span class="default">&nbsp;</span><span class="default">NULL</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$resultado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">PHPUnit_Framework_TestResult</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">foreach</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">-&gt;</span><span class="default">linhas</span><span class="default">&nbsp;</span><span class="keyword">as</span><span class="default">&nbsp;</span><span class="default">$linha</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">startTest</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">PHP_Timer</span><span class="keyword">::</span><span class="default">start</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$stopTime</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">NULL</span><span class="keyword">;</span><br />&nbsp;<br /><span class="default">list</span><span class="keyword">(</span><span class="default">$esperado</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$real</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">explode</span><span class="keyword">(</span><span class="string">';'</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$linha</span><span class="keyword">)</span><span class="keyword">;</span><br />&nbsp;<br /><span class="keyword">try</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">PHPUnit_Framework_Assert</span><span class="keyword">::</span><span class="default">assertEquals</span><span class="keyword">(</span><br /><span class="default">trim</span><span class="keyword">(</span><span class="default">$esperado</span><span class="keyword">)</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">trim</span><span class="keyword">(</span><span class="default">$real</span><span class="keyword">)</span><br /><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">catch</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">PHPUnit_Framework_AssertionFailedError</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$stopTime</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">PHP_Timer</span><span class="keyword">::</span><span class="default">stop</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">addFailure</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$stopTime</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">catch</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">Exception</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$stopTime</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">PHP_Timer</span><span class="keyword">::</span><span class="default">stop</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">addError</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$e</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$stopTime</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">if</span><span class="default">&nbsp;</span><span class="keyword">(</span><span class="default">$stopTime</span><span class="default">&nbsp;</span><span class="keyword">===</span><span class="default">&nbsp;</span><span class="default">NULL</span><span class="keyword">)</span><span class="default">&nbsp;</span><span class="keyword">{</span><br /><span class="default">$stopTime</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">PHP_Timer</span><span class="keyword">::</span><span class="default">stop</span><span class="keyword">(</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="default">$resultado</span><span class="keyword">-&gt;</span><span class="default">endTest</span><span class="keyword">(</span><span class="default">$this</span><span class="keyword">,</span><span class="default">&nbsp;</span><span class="default">$stopTime</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="keyword">return</span><span class="default">&nbsp;</span><span class="default">$resultado</span><span class="keyword">;</span><br /><span class="keyword">}</span><br /><span class="keyword">}</span><br />&nbsp;<br /><span class="default">$teste</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="keyword">new</span><span class="default">&nbsp;</span><span class="default">GuiadoPorDadosTest</span><span class="keyword">(</span><span class="string">'arquivo_dados.csv'</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">$resultado</span><span class="default">&nbsp;</span><span class="keyword">=</span><span class="default">&nbsp;</span><span class="default">PHPUnit_TextUI_TestRunner</span><span class="keyword">::</span><span class="default">run</span><span class="keyword">(</span><span class="default">$teste</span><span class="keyword">)</span><span class="keyword">;</span><br /><span class="default">?&gt;</span><br /></code></pre><pre class="screen">PHPUnit 3.7.0 by Sebastian Bergmann.

.F

Time: 0 seconds

There was 1 failure:

1) GuiadoPorDadosTest
Failed asserting that two strings are equal.
expected string &lt;bar&gt;
difference &lt; x&gt;
got string &lt;baz&gt;
/home/sb/GuiadoPorDadosTest.php:32
/home/sb/GuiadoPorDadosTest.php:53

FAILURES!
Tests: 2, Failures: 1.</pre></div></div><br class="example-break" /></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.assertions"></a>Apêndice A. Assertions</h1></div></div></div><p>
    <a class="xref" href="#appendixes.assertions.tables.assertions" title="Tabela A.1. Assertions">Tabela A.1</a> mostra todas as variedades de asserções.
  </p><div class="table"><a id="appendixes.assertions.tables.assertions"></a><p class="title"><strong>Tabela A.1. Assertions</strong></p><div class="table-contents"><table summary="Assertions" border="1"><colgroup><col /></colgroup><thead><tr><th align="left">Assertion</th></tr></thead><tbody><tr><td align="left"><code class="literal">assertArrayHasKey($chave, $vetor, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertArrayNotHasKey($chave, $vetor, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeContains($agulha, $nomeAtributoBateria, $classeOuObjetoBateria, $mensagem = '', $ignorarCaixa = FALSE, $verificarIdentidadeDoObjeto = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertAttributeContainsOnly($tipo, $nomeAtributoBateria, $classeOuObjetoBateria, $ehTipoNativo = NULL, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeCount($contagemEsperada, $nomeAtributoBateria, $classeOuObjetoBateria, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeEmpty($nomeAtributoBateria, $classeOuObjetoBateria, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeEquals($esperado, $nomeRealAtributo, $classeOuObjetoReal, $mensagem = '', $delta = 0, $profMax = 10, $canonicalizar = FALSE, $ignorarCaixa = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertAttributeGreaterThan($esperado, $nomeRealAtributo, $classeOuObjetoReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeGreaterThanOrEqual($esperado, $nomeRealAtributo, $classeOuObjetoReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeInstanceOf($esperado, $nomeAtributo, $classeOuObjeto, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeInternalType($esperado, $nomeAtributo, $classeOuObjeto, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeLessThan($esperado, $nomeRealAtributo, $classeOuObjetoReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeLessThanOrEqual($esperado, $nomeRealAtributo, $classeOuObjetoReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotContains($agulha, $nomeAtributoBateria, $classeOuObjetoBateria, $mensagem = '', $ignorarCaixa = FALSE, $verificarIdentidadeDoObjeto = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotContainsOnly($tipo, $nomeAtributoBateria, $classeOuObjetoBateria, $ehTipoNativo = NULL, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotCount($contagemEsperada, $nomeAtributoBateria, $classeOuObjetoBateria, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotEmpty($nomeAtributoBateria, $classeOuObjetoBateria, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotEquals($esperado, $nomeRealAtributo, $classeOuObjetoReal, $mensagem = '', $delta = 0, $profMax = 10, $canonicalizar = FALSE, $ignorarCaixa = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotInstanceOf($esperado, $nomeAtributo, $classeOuObjeto, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotInternalType($esperado, $nomeAtributo, $classeOuObjeto, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeNotSame($esperado, $nomeRealAtributo, $classeOuObjetoReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertAttributeSame($esperado, $nomeRealAtributo, $classeOuObjetoReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertClassHasAttribute($nomeAtributo, $nomeClasse, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertClassHasStaticAttribute($nomeAtributo, $nomeClasse, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertClassNotHasAttribute($nomeAtributo, $nomeClasse, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertClassNotHasStaticAttribute($nomeAtributo, $nomeClasse, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertContains($agulha, $bateria, $mensagem = '', $ignorarCaixa = FALSE, $verificarIdentidadeDoObjeto = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertContainsOnly($tipo, $bateria, $ehTipoNativo = NULL, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertContainsOnlyInstancesOf($nomeclasse, $bateria, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertCount($contagemEsperada, $bateria, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertEmpty($real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertEqualXMLStructure(DOMElement $elementoEsperado, DOMElement $elementoReal, $verificarAtributos = FALSE, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertEquals($esperado, $real, $mensagem = '', $delta = 0, $profMax = 10, $canonicalizar = FALSE, $ignorarCaixa = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertFalse($condicao, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertFileEquals($esperado, $real, $mensagem = '', $canonicalizar = FALSE, $ignorarCaixa = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertFileExists($nomearquivo, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertFileNotEquals($esperado, $real, $mensagem = '', $canonicalizar = FALSE, $ignorarCaixa = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertFileNotExists($nomearquivo, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertGreaterThan($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertGreaterThanOrEqual($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertInstanceOf($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertInternalType($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonFileEqualsJsonFile($arquivoEsperado, $arquivoReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonFileNotEqualsJsonFile($arquivoEsperado, $arquivoReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonStringEqualsJsonFile($arquivoEsperado, $jsonReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonStringEqualsJsonString($jsonEsperado, $jsonReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonStringNotEqualsJsonFile($arquivoEsperado, $jsonReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertJsonStringNotEqualsJsonString($jsonEsperado, $jsonReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertLessThan($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertLessThanOrEqual($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotContains($agulha, $bateria, $mensagem = '', $ignorarCaixa = FALSE, $verificarIdentidadeDoObjeto = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertNotContainsOnly($tipo, $bateria, $ehTipoNativo = NULL, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotCount($contagemEsperada, $bateria, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotEmpty($real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotEquals($esperado, $real, $mensagem = '', $delta = 0, $profMax = 10, $canonicalizar = FALSE, $ignorarCaixa = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertNotInstanceOf($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotInternalType($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotNull($real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotRegExp($padrao, $string, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotSame($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotSameSize($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertNotTag($equiparador, $real, $mensagem = '', $ehHtml = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertNull($real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertObjectHasAttribute($nomeAtributo, $objeto, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertObjectNotHasAttribute($nomeAtributo, $objeto, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertRegExp($padrao, $string, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertSame($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertSameSize($esperado, $real, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertSelectCount($seletor, $conta, $real, $mensagem = '', $ehHtml = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertSelectEquals($seletor, $conteudo, $conta, $real, $mensagem = '', $ehHtml = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertSelectRegExp($seletor, $padrao, $conta, $real, $mensagem = '', $ehHtml = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertStringEndsNotWith($sufixo, $string, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringEndsWith($sufixo, $string, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringEqualsFile($arquivoEsperado, $stringReal, $mensagem = '', $canonicalizar = FALSE, $ignorarCaixa = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertStringMatchesFormat($formato, $string, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringMatchesFormatFile($formatoArquivo, $string, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringNotEqualsFile($arquivoEsperado, $stringReal, $mensagem = '', $canonicalizar = FALSE, $ignorarCaixa = FALSE)</code></td></tr><tr><td align="left"><code class="literal">assertStringNotMatchesFormat($formato, $string, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringNotMatchesFormatFile($formatoArquivo, $string, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringStartsNotWith($prefixo, $string, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertStringStartsWith($prefixo, $string, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertTag($equiparador, $real, $mensagem = '', $ehHtml = TRUE)</code></td></tr><tr><td align="left"><code class="literal">assertThat($valor, PHPUnit_Framework_Constraint $restricao, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertTrue($condicao, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlFileEqualsXmlFile($arquivoEsperado, $arquivoReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlFileNotEqualsXmlFile($arquivoEsperado, $arquivoReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlStringEqualsXmlFile($arquivoEsperado, $xmlReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlStringEqualsXmlString($xmlEsperado, $xmlReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlStringNotEqualsXmlFile($arquivoEsperado, $xmlReal, $mensagem = '')</code></td></tr><tr><td align="left"><code class="literal">assertXmlStringNotEqualsXmlString($xmlEsperado, $xmlReal, $mensagem = '')</code></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.annotations"></a>Apêndice B. Anotações</h1></div></div></div><p>
    <a id="idp35932112" class="indexterm"></a>

    Uma anotação é uma forma especial de metadados sintáticos que podem ser adicionados ao código-fonte de algumas linguagens de programação. Enquanto o PHP não tem um recurso de linguagem dedicado a anotação de código-fonte, o uso de tags como <code class="literal">@annotation arguments</code> em bloco de documentação tem sido estabelecido na comunidade do PHP para anotar o código-fonte. Os blocos de documentação PHP são reflexivos: eles podem ser acessados através do método da API de Reflexão <code class="literal">getDocComment()</code> a nível de função, classe, método e atributo. Aplicações como o PHPUnit usam essa informação em tempo de execução para configurar seu comportamento.
  </p><p>
    Este apêndice mostra todas as variedades de anotações suportadas pelo PHPUnit.
  </p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.author"></a><code class="literal">@author</code></h2></div></div></div><p>
      <a id="idp35975728" class="indexterm"></a>

      A anotação <code class="literal">@author</code> é um apelido para a anotação
      <code class="literal">@group</code> (veja a seção chamada <a class="xref" href="#appendixes.annotations.group" title="@group">“<code class="literal">@group</code>”</a>) e permite filtrar os testes baseado em seus autores.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.backupGlobals"></a><code class="literal">@backupGlobals</code></h2></div></div></div><p>
      <a id="idp35980912" class="indexterm"></a>

      As operações de backup e restauração para variáveis globais podem ser completamente desabilitadas para todos os testes de uma classe de caso de teste como esta:

</p><pre class="programlisting"><code>
/**
 * @backupGlobals disabled
 */
class MeuTest extends PHPUnit_Framework_TestCase
{
    // ...
}</code></pre><p>
    </p><p>
      <a id="idp35983376" class="indexterm"></a>

      A anotação <code class="literal">@backupGlobals</code> também pode ser usada a nível de método de teste. Isso permite uma configuração refinada das operações de backup e restauração: 
</p><pre class="programlisting"><code>
/**
 * @backupGlobals disabled
 */
class MeuTest extends PHPUnit_Framework_TestCase
{
    /**
     * @backupGlobals enabled
     */
    public function testQueInterageComVariaveisGlobais()
    {
        // ...
    }
}</code></pre><p>
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.backupStaticAttributes"></a><code class="literal">@backupStaticAttributes</code></h2></div></div></div><p>
      <a id="idp35988336" class="indexterm"></a>

      As operações de backup e restauração para atributos estáticos de classes podem ser completamente desabilitadas para todos os testes de uma classe de caso de teste como esta:
      </p><pre class="programlisting"><code>
/**
 * @backupStaticAttributes disabled
 */
class MeuTest extends PHPUnit_Framework_TestCase
{
    // ...
}</code></pre><p>
    </p><p>
      <a id="idp35990848" class="indexterm"></a>

      A anotação <code class="literal">@backupStaticAttributes</code> também pode ser usada a nível de método de teste. Isso permite uma configuração refinada das operações de backup e restauração:
</p><pre class="programlisting"><code>
/**
 * @backupStaticAttributes disabled
 */
class MeuTest extends PHPUnit_Framework_TestCase
{
    /**
     * @backupStaticAttributes enabled
     */
    public function testQueInterageComAtributosEstaticos()
    {
        // ...
    }
}</code></pre><p>
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.codeCoverageIgnore"></a><code class="literal">@codeCoverageIgnore*</code></h2></div></div></div><p>
      <a id="idp35995824" class="indexterm"></a>
      <a id="idp35996640" class="indexterm"></a>
      <a id="idp35997472" class="indexterm"></a>

      As anotações <code class="literal">@codeCoverageIgnore</code>,
      <code class="literal">@codeCoverageIgnoreStart</code> e
      <code class="literal">@codeCoverageIgnoreEnd</code> podem ser usadas para excluir linhas de código da análise de cobertura.
    </p><p>
      Para uso, veja a seção chamada <a class="xref" href="#code-coverage-analysis.ignoring-code-blocks" title="Ignorando Blocos de Código">“Ignorando Blocos de Código”</a>.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.covers"></a><code class="literal">@covers</code></h2></div></div></div><p>
      <a id="idp36003968" class="indexterm"></a>
      <a id="idp36004784" class="indexterm"></a>

      A anotação <code class="literal">@covers</code> pode ser usada no código de teste para especificar quais métodos um método de teste quer testar: </p><pre class="programlisting"><code>/**
 * @covers ContaBancaria::getSaldo
 */
public function testSaldoEhInicialmenteZero()
{
    $this-&gt;assertEquals(0, $this-&gt;cb-&gt;getSaldo());
}</code></pre><p>
    </p><p>
      Se fornecida, apenas a informação de cobertura de código para o(s) método(s) especificado(s) será considerada.
    </p><p>
      <a class="xref" href="#appendixes.annotations.covers.tables.annotations" title="Tabela B.1. Anotações para especificar quais métodos são cobertos por um teste">Tabela B.1</a> mostra a sintaxe da anotação <code class="literal">@covers</code>.
    </p><div class="table"><a id="appendixes.annotations.covers.tables.annotations"></a><p class="title"><strong>Tabela B.1. Anotações para especificar quais métodos são cobertos por um teste</strong></p><div class="table-contents"><table summary="Anotações para especificar quais métodos são cobertos por um teste" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="left">Anotação</th><th align="left">Descrição</th></tr></thead><tbody><tr><td align="left"><code class="literal">@covers ClassName::methodName</code></td><td align="left"><code class="literal">Especifica que o método de teste anotado cobre o método especificado.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName</code></td><td align="left"><code class="literal">Especifica que o método de teste anotado cobre todos os métodos de uma dada classe.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName&lt;extended&gt;</code></td><td align="left"><code class="literal">Especifica que o método de teste anotado cobre todos os métodos de uma dada classe e sua(s) classe(s) pai(s) e interface(s).</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;public&gt;</code></td><td align="left"><code class="literal">Especifica que o método de teste anotado cobre todos os métodos públicos de uma dada classe.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;protected&gt;</code></td><td align="left"><code class="literal">Especifica que o método de teste anotado cobre todos os métodos protegidos de uma dada classe.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;private&gt;</code></td><td align="left"><code class="literal">Especifica que o método de teste anotado cobre todos os métodos privados de uma dada classe.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;!public&gt;</code></td><td align="left"><code class="literal">Especifica que o método de teste anotado cobre todos os métodos que não sejam públicos de uma dada classe.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;!protected&gt;</code></td><td align="left"><code class="literal">Especifica que o método de teste anotado cobre todos os métodos que não sejam protegidos de uma dada classe.</code></td></tr><tr><td align="left"><code class="literal">@covers ClassName::&lt;!private&gt;</code></td><td align="left"><code class="literal">Especifica que o método de teste anotado cobre todos os métodos que não sejam privados de uma dada classe.</code></td></tr><tr><td align="left"><code class="literal">@covers ::functionName</code></td><td align="left"><code class="literal">Especifica que o método de teste anotado cobre todos os métodos que não sejam privados de uma dada classe.</code></td></tr></tbody></table></div></div><br class="table-break" /></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.coversNothing"></a><code class="literal">@coversNothing</code></h2></div></div></div><p>
      <a id="idp36038608" class="indexterm"></a>

      A anotação <code class="literal">@coversNothing</code> pode ser usada no código de teste para especificar que nenhuma informação de cobertura de código será gravada para o caso de teste anotado.
    </p><p>
        Isso pode ser usado para testes de integração. Veja
        <a class="xref" href="#code-coverage-analysis.specifying-covered-methods.examples.GuestbookIntegrationTest.php" title="Exemplo 14.3: Um teste que especifica que nenhum método deve ser coberto">Exemplo 14.3</a>
        para um exemplo.
    </p><p>
        A anotação pode ser usada nos níveis de classe e de método e vão sobrepujar quaisquer tags <code class="literal">@covers</code>.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.dataProvider"></a><code class="literal">@dataProvider</code></h2></div></div></div><p>
      <a id="idp36045392" class="indexterm"></a>

      Um método de teste pode aceitar argumentos arbitrários. Esses argumentos devem ser fornecidos por um método provedor  (<code class="literal">provider()</code> em
      <a class="xref" href="#">???</a>).
      O método provedor de dados a ser usado é especificado usando a anotação
      <code class="literal">@dataProvider</code>.
    </p><p>
      Veja a seção chamada <a class="xref" href="#writing-tests-for-phpunit.data-providers" title="Provedores de Dados">“Provedores de Dados”</a> para mais detalhes.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.depends"></a><code class="literal">@depends</code></h2></div></div></div><p>
      <a id="idp36052480" class="indexterm"></a>

      O PHPUnit suporta a declaração de dependências explícitas entre métodos de teste. Tais dependências não definem a ordem em que os métodos de teste devem ser executados, mas permitem o retorno de uma instância do componente de teste por um produtor e passá-la aos consumidores dependentes.
      <a class="xref" href="#writing-tests-for-phpunit.examples.StackTest2.php" title="Exemplo 4.2: Usando a anotação @depends para expressar dependências">Exemplo 4.2</a> mostra como usar a anotação <code class="literal">@depends</code> para expressar dependências entre métodos de teste.
    </p><p>
      Veja a seção chamada <a class="xref" href="#writing-tests-for-phpunit.test-dependencies" title="Dependências de Testes">“Dependências de Testes”</a> para mais detalhes.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.expectedException"></a><code class="literal">@expectedException</code></h2></div></div></div><p>
      <a id="idp36058896" class="indexterm"></a>

      <a class="xref" href="#">???</a>
      mostra como usar a anotação <code class="literal">@expectedException</code> para testar se uma exceção é lançada dentro do código testado.
    </p><p>
      Veja a seção chamada <a class="xref" href="#writing-tests-for-phpunit.exceptions" title="Testando Exceções">“Testando Exceções”</a> para mais detalhes.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.expectedExceptionCode"></a><code class="literal">@expectedExceptionCode</code></h2></div></div></div><p>
      <a id="idp36064832" class="indexterm"></a>

      A anotação <code class="literal">@expectedExceptionCode</code> em conjunção com a <code class="literal">@expectedException</code> permite fazer asserções no código de erro de uma exceção lançada, permitindo diminuir uma exceção específica.

      </p><pre class="programlisting"><code>class MeuTest extends PHPUnit_Framework_TestCase
{
    /**
     * @expectedException MinhaExcecao
     * @expectedExceptionCode 20
     */
    public function testExcecaoTemCodigoErro20()
    {
        throw new MinhaExcecao('Alguma Mensagem', 20);
    }
}</code></pre><p>

      Para facilitar o teste e reduzir a duplicação, um atalho pode ser usado para especificar uma constante de classe como uma
      <code class="literal">@expectedExceptionCode</code> usando a sintaxe
      "<code class="literal">@expectedExceptionCode ClassName::CONST</code>".

      </p><pre class="programlisting"><code>class MeuTest extends PHPUnit_Framework_TestCase
{
    /**
      * @expectedException MinhaExcecao
      * @expectedExceptionCode MyClass::ERRORCODE
      */
    public function testExcecaoTemCodigoErro20()
    {
      throw new MyException('Alguma Mensagem', 20);
    }
}
class MinhaClasse
{
    const ERRORCODE = 20;
}</code></pre><p>

    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.expectedExceptionMessage"></a><code class="literal">@expectedExceptionMessage</code></h2></div></div></div><p>
      <a id="idp36072656" class="indexterm"></a>

      A anotação <code class="literal">@expectedExceptionMessage</code> trabalha de modo similar a <code class="literal">@expectedExceptionCode</code> já que lhe permite fazer uma asserção na mensagem de erro de uma exceção.

      </p><pre class="programlisting"><code>class MeuTest extends PHPUnit_Framework_TestCase
{
    /**
     * @expectedException MinhaExcecao
     * @expectedExceptionMessage Alguma Mensagem
     */
    public function testExcecaoTemMensagemCerta()
    {
        throw new MinhaExcecao('Alguma Mensagem', 20);
    }
}</code></pre><p>

      A mensagem esperada pode ser uma substring de uma Mensagem de exceção. Isso pode ser útil para assertar apenas que um certo nome ou parâmetro que foi passado é mostrado na exceção e não fixar toda a mensagem de exceção no teste.

      </p><pre class="programlisting"><code>class MeuTest extends PHPUnit_Framework_TestCase
{
     /**
      * @expectedException MinhaExcecao
      * @expectedExceptionMessage quebrado
      */
     public function testExcecaoTemMensagemCerta()
     {
         $param = "quebrado";
         throw new MinhaExcecao('Parâmetro Inválido "'.$param.'".', 20);
     }
}</code></pre><p>

      Para facilitar o teste e reduzir duplicação um atalho pode ser usado para especificar uma constante de classe como uma
      <code class="literal">@expectedExceptionMessage</code> usando a sintaxe
      "<code class="literal">@expectedExceptionMessage ClassName::CONST</code>".

      Um exemplo pode ser encontrado na seção chamada <a class="xref" href="#appendixes.annotations.expectedExceptionCode" title="@expectedExceptionCode">“<code class="literal">@expectedExceptionCode</code>”</a>.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.group"></a><code class="literal">@group</code></h2></div></div></div><p>
      <a id="idp36082032" class="indexterm"></a>

      Um teste pode ser marcado como pertencente a um ou mais grupos usando a anotação
      <code class="literal">@group</code> desta forma: 
</p><pre class="programlisting"><code>
class MeuTest extends PHPUnit_Framework_TestCase
{
    /**
     * @group especificacao
     */
    public function testAlgumaCoisa()
    {
    }

    /**
     * @group regressao
     * @group bug2204
     */
    public function testOutraCoisa()
    {
    }
}</code></pre><p>
    </p><p>
      Testes podem ser selecionados para execução baseada em grupos usando os comutadores
      <code class="literal">--group</code> e <code class="literal">--exclude-group</code> do executor de teste em linha-de-comando ou usando as respectivas diretivas do arquivo de configuração XML.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.outputBuffering"></a><code class="literal">@outputBuffering</code></h2></div></div></div><p>
      <a id="idp36088560" class="indexterm"></a>

      A anotação <code class="literal">@outputBuffering</code> pode ser usada para controlar a memória temporária (buffering) de saída <a class="ulink" href="http://www.php.net/manual/en/intro.outcontrol.php" target="_top">http://www.php.net/manual/en/intro.outcontrol.php</a>
      desta forma: 
</p><pre class="programlisting"><code>
/**
 * @outputBuffering enabled
 */
class MeuTest extends PHPUnit_Framework_TestCase
{
    // ...
}</code></pre><p>
    </p><p>
      <a id="idp36092176" class="indexterm"></a>

      A anotação <code class="literal">@outputBuffering</code> também pode ser usada a nível de método de teste. Isso permite um controle refinado da memória temporária de saída: 
</p><pre class="programlisting"><code>
/**
 * @outputBuffering disabled
 */
class MeuTest extends PHPUnit_Framework_TestCase
{
    /**
     * @outputBuffering enabled
     */
    public function testQueImprimeAlgumaCoisa()
    {
        // ...
    }
}</code></pre><p>
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.requires"></a><code class="literal">@requires</code></h2></div></div></div><p>
      <a id="idp36097168" class="indexterm"></a>

      A anotação <code class="literal">@requires</code> pode ser usada para pular testes quando pré-condição, como a Versão do PHP ou extensões instaladas, não batem.
    </p><p>
      <a id="idp36099776" class="indexterm"></a>
      Uma lista completa de possibilidades e exemplos pode ser encontrada em
      <a class="xref" href="#incomplete-and-skipped-tests.requires.tables.api" title="Tabela 9.3. Possíveis usos para @requires">Tabela 9.3</a>
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.runTestsInSeparateProcesses"></a><code class="literal">@runTestsInSeparateProcesses</code></h2></div></div></div><p>
      <a id="idp36103904" class="indexterm"></a>
    </p><pre class="programlisting"><code></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.runInSeparateProcess"></a><code class="literal">@runInSeparateProcess</code></h2></div></div></div><p>
      <a id="idp36107120" class="indexterm"></a>
    </p><pre class="programlisting"></code></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.test"></a><code class="literal">@test</code></h2></div></div></div><p>
      <a id="idp36110272" class="indexterm"></a>

      Como uma alternativa para prefixar seus nomes de métodos de teste com
      <code class="literal">test</code>, você pode usar a anotação <code class="literal">@test</code>
      no Bloco de Documentação de um método para marcá-lo como um método de teste.
      </p><pre class="programlisting"><code>
/**
 * @test
 */
public function saldoInicialDeveSer0()
{
    $this-&gt;assertEquals(0, $this-&gt;cb-&gt;getSaldo());
}</code></pre><p>
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.testdox"></a><code class="literal">@testdox</code></h2></div></div></div><p>
      <a id="idp36115440" class="indexterm"></a>
      <a id="idp36116256" class="indexterm"></a>
    </p><pre class="programlisting"><code></pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.annotations.ticket"></a><code class="literal">@ticket</code></h2></div></div></div><p>
      <a id="idp36119376" class="indexterm"></a>
    </p><pre class="programlisting"></code></pre></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.configuration"></a>Apêndice C. O arquivo de configuração XML</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.phpunit"></a>PHPUnit</h2></div></div></div><p>
      Os atributos do elemento <code class="literal">&lt;phpunit&gt;</code> podem ser usados para configurar a funcionalidade do núcleo do PHPUnit.
    </p><pre class="screen">&lt;phpunit backupGlobals="true"
backupStaticAttributes="false"
&lt;!--bootstrap="/caminho/para/bootstrap.php"--&gt;
cacheTokens="false"
colors="false"
convertErrorsToExceptions="true"
convertNoticesToExceptions="true"
convertWarningsToExceptions="true"
forceCoversAnnotation="false"
mapTestClassNameToCoveredClassName="false"
printerClass="PHPUnit_TextUI_ResultPrinter"
&lt;!--printerFile="/caminho/para/ResultPrinter.php"--&gt;
processIsolation="false"
stopOnError="false"
stopOnFailure="false"
stopOnIncomplete="false"
stopOnSkipped="false"
testSuiteLoaderClass="PHPUnit_Runner_StandardTestSuiteLoader"
&lt;!--testSuiteLoaderFile="/caminho/para/StandardTestSuiteLoader.php"--&gt;
strict="false"
verbose="false"&gt;
&lt;!-- ... --&gt;
&lt;/phpunit&gt;</pre><p>
      A configuração XML acima corresponde ao comportamento padrão do executor de teste TextUI documentado na seção chamada <a class="xref" href="#textui.clioptions" title="Comutadores de linha-de-comando">“Comutadores de linha-de-comando”</a>.
    </p><p>
      Opções adicionais que não estão disponíveis como comutadores em linha-de-comando são:
    </p><div class="variablelist"><dl class="variablelist"><dt><span class="term"><code class="literal">convertNoticesToExceptions</code>, </span><span class="term"><code class="literal">convertWarningsToExceptions</code>, </span><span class="term"><code class="literal">convertErrorsToExceptions</code></span></dt><dd><p>
            Pode ser usado para desligar a conversão automática de cada notificação/aviso/erro do PHP em uma exceção.
         </p></dd><dt><span class="term"><code class="literal">forceCoversAnnotation</code></span></dt><dd><p>
          A Cobertura de Código só será gravada para testes que usem a anotação
          <code class="literal">@covers</code> documentada na seção chamada
          <a class="xref" href="#appendixes.annotations.covers" title="@covers">“<code class="literal">@covers</code>”</a>.
        </p></dd></dl></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.testsuites"></a>Suítes de Teste</h2></div></div></div><p>
      <a id="idp36283616" class="indexterm"></a>

      O elemento <code class="literal">&lt;testsuites&gt;</code> e seu(s) um ou mais filhos <code class="literal">&lt;testsuite&gt;</code> podem ser usados para compor uma suíte de teste fora das suítes e casos de teste.
    </p><pre class="screen">&lt;testsuites&gt;
&lt;testsuite name="Minha Suíte de Testes"&gt;
&lt;directory&gt;/caminho/para/arquivos/*Test.php&lt;/directory&gt;
&lt;file&gt;/caminho/para/MeuTest.php&lt;/file&gt;
&lt;exclude&gt;/caminho/para/excluidos&lt;/exclude&gt;
&lt;/testsuite&gt;
&lt;/testsuites&gt;</pre><p>
      Usando os atributos <code class="literal">phpVersion</code> e
      <code class="literal">phpVersionOperator</code> uma versão exigida do PHP pode ser especificada. O exemplo abaixo só vai adicionar os arquivos
      <code class="filename">/caminho/para/*Test.php</code> e
      <code class="filename">/caminho/para/MeuTest.php</code> se a versão do PHP for no mínio 5.3.0.
    </p><pre class="screen"> &lt;testsuites&gt;
&lt;testsuite name="Minha Suíte de Testes"&gt;
&lt;directory suffix="Test.php" phpVersion="5.3.0" phpVersionOperator="&gt;="&gt;/caminho/para/arquivos&lt;/directory&gt;
&lt;file phpVersion="5.3.0" phpVersionOperator="&gt;="&gt;/caminho/para/MeuTest.php&lt;/file&gt;
&lt;/testsuite&gt;
&lt;/testsuites&gt;</pre><p>
      O atributo <code class="literal">phpVersionOperator</code> é opcional e padronizado para <code class="literal">&gt;=</code>.
    </p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.groups"></a>Grupos</h2></div></div></div><p>
      <a id="idp36294528" class="indexterm"></a>

      O elemento <code class="literal">&lt;groups&gt;</code> e seus filhos
      <code class="literal">&lt;include&gt;</code>,
      <code class="literal">&lt;exclude&gt;</code>, e
      <code class="literal">&lt;group&gt;</code> podem ser usados para selecionar grupos de testes de uma suíte de testes que (não) deveriam ser executadas.
    </p><pre class="screen">&lt;groups&gt;
&lt;include&gt;
&lt;group&gt;nome&lt;/group&gt;
&lt;/include&gt;
&lt;exclude&gt;
&lt;group&gt;nome&lt;/group&gt;
&lt;/exclude&gt;
&lt;/groups&gt;</pre><p>
      A configuração XML acima corresponde a invocar o executor de testes TextUI com os seguintes comutadores:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">--group nome</code></p></li><li class="listitem"><p><code class="literal">--exclude-group nome</code></p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.blacklist-whitelist"></a>Incluindo e Excluindo Arquivos para Cobertura de Código</h2></div></div></div><p>
      <a id="idp36303728" class="indexterm"></a>
      <a id="idp36304576" class="indexterm"></a>
      <a id="idp36305392" class="indexterm"></a>

      O elemento <code class="literal">&lt;filter&gt;</code> e seus filhos podem ser usados para configurar a lista-negra e lista-branca para o relatório de cobertura de código.
    </p><pre class="screen">&lt;filter&gt;
&lt;blacklist&gt;
&lt;directory suffix=".php"&gt;/caminho/para/arquivos&lt;/directory&gt;
&lt;file&gt;/path/to/file&lt;/file&gt;
&lt;exclude&gt;
&lt;directory suffix=".php"&gt;/caminho/para/arquivos&lt;/directory&gt;
&lt;file&gt;/caminho/para/arquivo&lt;/file&gt;
&lt;/exclude&gt;
&lt;/blacklist&gt;
&lt;whitelist processUncoveredFilesFromWhitelist="true"&gt;
&lt;directory suffix=".php"&gt;/caminho/para/arquivos&lt;/directory&gt;
&lt;file&gt;/caminho/para/arquivo&lt;/file&gt;
&lt;exclude&gt;
&lt;directory suffix=".php"&gt;/caminho/para/arquivos&lt;/directory&gt;
&lt;file&gt;/caminho/para/arquivo&lt;/file&gt;
&lt;/exclude&gt;
&lt;/whitelist&gt;
&lt;/filter&gt;</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.logging"></a>Registrando</h2></div></div></div><p>
      <a id="idp36309728" class="indexterm"></a>

      O elemento <code class="literal">&lt;logging&gt;</code> e seus filhos
      <code class="literal">&lt;log&gt;</code> podem ser usados para configurar o registro da execução de teste.
    </p><pre class="screen">&lt;logging&gt;
&lt;log type="coverage-html" target="/tmp/report" charset="UTF-8"
highlight="false" lowUpperBound="35" highLowerBound="70"/&gt;
&lt;log type="coverage-clover" target="/tmp/coverage.xml"/&gt;
&lt;log type="coverage-php" target="/tmp/coverage.serialized"/&gt;
&lt;log type="coverage-text" target="php://stdout" showUncoveredFiles="false"/&gt;
&lt;log type="json" target="/tmp/logfile.json"/&gt;
&lt;log type="tap" target="/tmp/logfile.tap"/&gt;
&lt;log type="junit" target="/tmp/logfile.xml" logIncompleteSkipped="false"/&gt;
&lt;log type="testdox-html" target="/tmp/testdox.html"/&gt;
&lt;log type="testdox-text" target="/tmp/testdox.txt"/&gt;
&lt;/logging&gt;</pre><p>
      A configuração XML acima corresponde a invocar o executor de teste TextUI com os seguintes comutadores:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">--coverage-html /tmp/report</code></p></li><li class="listitem"><p><code class="literal">--coverage-clover /tmp/coverage.xml</code></p></li><li class="listitem"><p><code class="literal">--coverage-php /tmp/coverage.serialized</code></p></li><li class="listitem"><p><code class="literal">--coverage-text</code></p></li><li class="listitem"><p><code class="literal">--log-json /tmp/logfile.json</code></p></li><li class="listitem"><p><code class="literal">&gt; /tmp/logfile.txt</code></p></li><li class="listitem"><p><code class="literal">--log-tap /tmp/logfile.tap</code></p></li><li class="listitem"><p><code class="literal">--log-junit /tmp/logfile.xml</code></p></li><li class="listitem"><p><code class="literal">--testdox-html /tmp/testdox.html</code></p></li><li class="listitem"><p><code class="literal">--testdox-text /tmp/testdox.txt</code></p></li></ul></div><p>
      Os atributos <code class="literal">charset</code>, <code class="literal">highlight</code>,
      <code class="literal">lowUpperBound</code>, <code class="literal">highLowerBound</code>,
      <code class="literal">logIncompleteSkipped</code> e
      <code class="literal">showUncoveredFiles</code> não possuem comutador TextUI equivalente.
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">charset</code>: Conjunto de caracteres a ser usado para as páginas HTML geradas.</p></li><li class="listitem"><p><code class="literal">highlight</code>: Quando definidos como <code class="literal">true</code>, o código em seus relatórios de cobertura terá a sintaxe destacada.</p></li><li class="listitem"><p><code class="literal">lowUpperBound</code>: Máxima porcentagem de cobertura para ser considerado de "baixamente" coberto.</p></li><li class="listitem"><p><code class="literal">highLowerBound</code>: Mínima porcentagem de cobertura para ser considerado "altamente" coberto.</p></li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.test-listeners"></a>Ouvintes de Teste</h2></div></div></div><p>
      <a id="idp36336240" class="indexterm"></a>
      <a id="idp36337024" class="indexterm"></a>

      O elemento <code class="literal">&lt;listeners&gt;</code> e seus filhos
      <code class="literal">&lt;listener&gt;</code> podem ser usados para anexar ouvintes adicionais de teste para a execução dos testes.
    </p><pre class="screen">&lt;listeners&gt;
&lt;listener class="MeuOuvinte" file="/caminho/opcional/para/MeuOuvinte.php"&gt;
&lt;arguments&gt;
&lt;array&gt;
&lt;element key="0"&gt;
&lt;string&gt;Sebastian&lt;/string&gt;
&lt;/element&gt;
&lt;/array&gt;
&lt;integer&gt;22&lt;/integer&gt;
&lt;string&gt;Abril&lt;/string&gt;
&lt;double&gt;19.78&lt;/double&gt;
&lt;null/&gt;
&lt;object class="stdClass"/&gt;
&lt;/arguments&gt;
&lt;/listener&gt;
&lt;/listeners&gt;</pre><p>
      A configuração XML acima corresponde a anexar o objeto
      <code class="literal">$ouvinte</code> (veja abaixo) à execução de teste:
    </p><pre class="screen">$ouvinte = new MeuOuvinte(
array('Sebastian'),
22,
'Abril',
19.78,
NULL,
new stdClass
);</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.php-ini-constants-variables"></a>Setting PHP INI settings, Constants and Global Variables</h2></div></div></div><p>
      <a id="idp36343744" class="indexterm"></a>
      <a id="idp36344560" class="indexterm"></a>
      <a id="idp36345392" class="indexterm"></a>

      O elemento <code class="literal">&lt;php&gt;</code> e seus filhos podem ser usados para definir configurações, constantes e variáveis globais do PHP. Também pode ser usado para preceder o <code class="literal">include_path</code>.
    </p><pre class="screen">&lt;php&gt;
&lt;includePath&gt;.&lt;/includePath&gt;
&lt;ini name="foo" value="bar"/&gt;
&lt;const name="foo" value="bar"/&gt;
&lt;var name="foo" value="bar"/&gt;
&lt;env name="foo" value="bar"/&gt;
&lt;post name="foo" value="bar"/&gt;
&lt;get name="foo" value="bar"/&gt;
&lt;cookie name="foo" value="bar"/&gt;
&lt;server name="foo" value="bar"/&gt;
&lt;files name="foo" value="bar"/&gt;
&lt;request name="foo" value="bar"/&gt;
&lt;/php&gt;</pre><p>
      A configuração XML acima corresponde ao seguinte código PHP:
    </p><pre class="screen">ini_set('foo', 'bar');
define('foo', 'bar');
$GLOBALS['foo'] = 'bar';
$_ENV['foo'] = 'bar';
$_POST['foo'] = 'bar';
$_GET['foo'] = 'bar';
$_COOKIE['foo'] = 'bar';
$_SERVER['foo'] = 'bar';
$_FILES['foo'] = 'bar';
$_REQUEST['foo'] = 'bar';</pre></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="appendixes.configuration.selenium-rc"></a>Configurando Navegadores para Selenium RC</h2></div></div></div><p>
      <a id="idp36352000" class="indexterm"></a>

      O elemento <code class="literal">&lt;selenium&gt;</code> e seus filhos
      <code class="literal">&lt;browser&gt;</code> podem ser usados para configurar uma lista de servidores Selenium RC.
    </p><pre class="screen">&lt;selenium&gt;
&lt;browser name="Firefox no Linux"
browser="*firefox /usr/lib/firefox/firefox-bin"
host="my.linux.box"
port="4444"
timeout="30000"/&gt;
&lt;/selenium&gt;</pre><p>
      O arquivo de configuração XML acima corresponde ao seguinte código PHP:
    </p><pre class="screen">class WebTest extends PHPUnit_Extensions_SeleniumTestCase
{
public static $navegadores = array(
array(
'name' =&gt; 'Firefox no Linux',
'browser' =&gt; '*firefox /usr/lib/firefox/firefox-bin',
'host' =&gt; 'my.linux.box',
'port' =&gt; 4444,
'timeout' =&gt; 30000
)
);

// ...
}</pre></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.index"></a>Apêndice D. Índice</h1></div></div></div><div class="index"><div class="titlepage"><div><div><h2 class="title"><a id="appendixes.index.index"></a></h2></div></div></div><div class="index"><div class="indexdiv"><h3>Símbolos</h3><dl><dt>$backupGlobalsBlacklist, <a class="indexterm" href="#fixtures.global-state">Estado Global</a></dt><dt>$backupStaticAttributesBlacklist, <a class="indexterm" href="#fixtures.global-state">Estado Global</a></dt><dt>@assert, <a class="indexterm" href="#skeleton-generator.test">Gerando um Esqueleto de Classe de Caso de Teste</a></dt><dt>@author, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a>, <a class="indexterm" href="#appendixes.annotations.author">@author</a></dt><dt>@backupGlobals, <a class="indexterm" href="#fixtures.global-state">Estado Global</a>, <a class="indexterm" href="#appendixes.annotations.backupGlobals">@backupGlobals</a></dt><dt>@backupStaticAttributes, <a class="indexterm" href="#fixtures.global-state">Estado Global</a>, <a class="indexterm" href="#appendixes.annotations.backupStaticAttributes">@backupStaticAttributes</a></dt><dt>@codeCoverageIgnore, <a class="indexterm" href="#code-coverage-analysis.ignoring-code-blocks">Ignorando Blocos de Código</a>, <a class="indexterm" href="#appendixes.annotations.codeCoverageIgnore">@codeCoverageIgnore*</a></dt><dt>@codeCoverageIgnoreEnd, <a class="indexterm" href="#code-coverage-analysis.ignoring-code-blocks">Ignorando Blocos de Código</a>, <a class="indexterm" href="#appendixes.annotations.codeCoverageIgnore">@codeCoverageIgnore*</a></dt><dt>@codeCoverageIgnoreStart, <a class="indexterm" href="#code-coverage-analysis.ignoring-code-blocks">Ignorando Blocos de Código</a>, <a class="indexterm" href="#appendixes.annotations.codeCoverageIgnore">@codeCoverageIgnore*</a></dt><dt>@covers, <a class="indexterm" href="#code-coverage-analysis.specifying-covered-methods">Especificando métodos cobertos</a>, <a class="indexterm" href="#appendixes.annotations.covers">@covers</a></dt><dt>@coversNothing, <a class="indexterm" href="#code-coverage-analysis.specifying-covered-methods">Especificando métodos cobertos</a>, <a class="indexterm" href="#appendixes.annotations.coversNothing">@coversNothing</a></dt><dt>@dataProvider, <a class="indexterm" href="#writing-tests-for-phpunit.data-providers">Provedores de Dados</a>, <a class="indexterm" href="#appendixes.annotations.dataProvider">@dataProvider</a></dt><dt>@depends, <a class="indexterm" href="#writing-tests-for-phpunit.test-dependencies">Dependências de Testes</a>, <a class="indexterm" href="#writing-tests-for-phpunit.data-providers">Provedores de Dados</a>, <a class="indexterm" href="#appendixes.annotations.depends">@depends</a></dt><dt>@expectedException, <a class="indexterm" href="#writing-tests-for-phpunit.exceptions">Testando Exceções</a>, <a class="indexterm" href="#appendixes.annotations.expectedException">@expectedException</a></dt><dt>@expectedExceptionCode, <a class="indexterm" href="#writing-tests-for-phpunit.exceptions">Testando Exceções</a>, <a class="indexterm" href="#appendixes.annotations.expectedExceptionCode">@expectedExceptionCode</a></dt><dt>@expectedExceptionMessage, <a class="indexterm" href="#writing-tests-for-phpunit.exceptions">Testando Exceções</a>, <a class="indexterm" href="#appendixes.annotations.expectedExceptionMessage">@expectedExceptionMessage</a></dt><dt>@group, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a>, <a class="indexterm" href="#appendixes.annotations.group">@group</a></dt><dt>@outputBuffering, <a class="indexterm" href="#appendixes.annotations.outputBuffering">@outputBuffering</a></dt><dt>@requires, <a class="indexterm" href="#appendixes.annotations.requires">@requires</a></dt><dt>@runInSeparateProcess, <a class="indexterm" href="#appendixes.annotations.runInSeparateProcess">@runInSeparateProcess</a></dt><dt>@runTestsInSeparateProcesses, <a class="indexterm" href="#appendixes.annotations.runTestsInSeparateProcesses">@runTestsInSeparateProcesses</a></dt><dt>@test, <a class="indexterm" href="#writing-tests-for-phpunit">Escrevendo Testes para o PHPUnit</a>, <a class="indexterm" href="#appendixes.annotations.test">@test</a></dt><dt>@testdox, <a class="indexterm" href="#appendixes.annotations.testdox">@testdox</a></dt><dt>@ticket, <a class="indexterm" href="#appendixes.annotations.ticket">@ticket</a></dt></dl></div><div class="indexdiv"><h3>A</h3><dl><dt>Ambientes, <a class="indexterm" href="#fixtures">Ambientes</a></dt><dt>Anotação, <a class="indexterm" href="#writing-tests-for-phpunit">Escrevendo Testes para o PHPUnit</a>, <a class="indexterm" href="#writing-tests-for-phpunit.test-dependencies">Dependências de Testes</a>, <a class="indexterm" href="#writing-tests-for-phpunit.data-providers">Provedores de Dados</a>, <a class="indexterm" href="#writing-tests-for-phpunit.exceptions">Testando Exceções</a>, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a>, <a class="indexterm" href="#code-coverage-analysis.specifying-covered-methods">Especificando métodos cobertos</a>, <a class="indexterm" href="#code-coverage-analysis.ignoring-code-blocks">Ignorando Blocos de Código</a>, <a class="indexterm" href="#skeleton-generator.test">Gerando um Esqueleto de Classe de Caso de Teste</a></dt><dt>Anotações, <a class="indexterm" href="#appendixes.annotations">Anotações</a></dt><dt>anything(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>arrayHasKey(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>Asserções, <a class="indexterm" href="#automating-tests">Automatizando Testes</a></dt><dt>assertArrayHasKey(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertArrayHasKey">assertArrayHasKey()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertArrayNotHasKey(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertArrayHasKey">assertArrayHasKey()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeContains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContains">assertContains()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeContainsOnly(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContainsOnly">assertContainsOnly()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeCount(), <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeEmpty(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEmpty">assertEmpty()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEquals">assertEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeGreaterThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertGreaterThan">assertGreaterThan()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeGreaterThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertGreaterThanOrEqual">assertGreaterThanOrEqual()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeInstanceOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInstanceOf">assertInstanceOf()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeInternalType(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInternalType">assertInternalType()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeLessThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertLessThan">assertLessThan()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeLessThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertLessThanOrEqual">assertLessThanOrEqual()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeNotContains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContains">assertContains()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeNotContainsOnly(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContainsOnly">assertContainsOnly()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeNotCount(), <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeNotEmpty(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEmpty">assertEmpty()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeNotEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEquals">assertEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeNotInstanceOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInstanceOf">assertInstanceOf()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeNotInternalType(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInternalType">assertInternalType()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeNotSame(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSame">assertSame()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertAttributeSame(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSame">assertSame()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertClassHasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertClassHasAttribute">assertClassHasAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertClassHasStaticAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertClassHasStaticAttribute">assertClassHasStaticAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertClassNotHasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertClassHasAttribute">assertClassHasAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertClassNotHasStaticAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertClassHasStaticAttribute">assertClassHasStaticAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertContains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContains">assertContains()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertContainsOnly(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContainsOnly">assertContainsOnly()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertContainsOnlyInstancesOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContainsOnlyInstancesOf">assertContainsOnlyInstancesOf()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertCount(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertCount">assertCount()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertEmpty(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEmpty">assertEmpty()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEquals">assertEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertEqualXMLStructure(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEqualXMLStructure">assertEqualXMLStructure()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertFalse(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertFalse">assertFalse()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertFileEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertFileEquals">assertFileEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertFileExists(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertFileExists">assertFileExists()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertFileNotEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertFileEquals">assertFileEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertFileNotExists(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertFileExists">assertFileExists()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertGreaterThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertGreaterThan">assertGreaterThan()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertGreaterThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertGreaterThanOrEqual">assertGreaterThanOrEqual()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertInstanceOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInstanceOf">assertInstanceOf()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertInternalType(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInternalType">assertInternalType()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertJsonFileEqualsJsonFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonFileEqualsJsonFile">assertJsonFileEqualsJsonFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertJsonFileNotEqualsJsonFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonFileEqualsJsonFile">assertJsonFileEqualsJsonFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertJsonStringEqualsJsonFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonFile">assertJsonStringEqualsJsonFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertJsonStringEqualsJsonString(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonString">assertJsonStringEqualsJsonString()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertJsonStringNotEqualsJsonFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonFile">assertJsonStringEqualsJsonFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertJsonStringNotEqualsJsonString(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertJsonStringEqualsJsonString">assertJsonStringEqualsJsonString()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertLessThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertLessThan">assertLessThan()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertLessThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertLessThanOrEqual">assertLessThanOrEqual()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotContains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContains">assertContains()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotContainsOnly(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertContainsOnly">assertContainsOnly()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotCount(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertCount">assertCount()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotEmpty(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEmpty">assertEmpty()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertEquals">assertEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotInstanceOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInstanceOf">assertInstanceOf()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotInternalType(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertInternalType">assertInternalType()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotNull(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertNull">assertNull()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotRegExp(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertRegExp">assertRegExp()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotSame(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSame">assertSame()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotSameSize(), <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNotTag(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertTag">assertTag()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertNull(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertNull">assertNull()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertObjectHasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertObjectHasAttribute">assertObjectHasAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertObjectNotHasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertObjectHasAttribute">assertObjectHasAttribute()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertPostConditions(), <a class="indexterm" href="#fixtures">Ambientes</a></dt><dt>assertPreConditions(), <a class="indexterm" href="#fixtures">Ambientes</a></dt><dt>assertRegExp(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertRegExp">assertRegExp()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertSame(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSame">assertSame()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertSameSize(), <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertSelectCount(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSelectCount">assertSelectCount()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertSelectEquals(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSelectEquals">assertSelectEquals()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertSelectRegExp(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertSelectRegExp">assertSelectRegExp()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertStringEndsNotWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringEndsWith">assertStringEndsWith()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertStringEndsWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringEndsWith">assertStringEndsWith()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertStringEqualsFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringEqualsFile">assertStringEqualsFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertStringMatchesFormat(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormat">assertStringMatchesFormat()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertStringMatchesFormatFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormatFile">assertStringMatchesFormatFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertStringNotEqualsFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringEqualsFile">assertStringEqualsFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertStringNotMatchesFormat(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormat">assertStringMatchesFormat()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertStringNotMatchesFormatFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringMatchesFormatFile">assertStringMatchesFormatFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertStringStartsNotWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringStartsWith">assertStringStartsWith()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertStringStartsWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertStringStartsWith">assertStringStartsWith()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertTag(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertTag">assertTag()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertThat(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertTrue(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertTrue">assertTrue()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertXmlFileEqualsXmlFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlFileEqualsXmlFile">assertXmlFileEqualsXmlFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertXmlFileNotEqualsXmlFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlFileEqualsXmlFile">assertXmlFileEqualsXmlFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertXmlStringEqualsXmlFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlFile">assertXmlStringEqualsXmlFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertXmlStringEqualsXmlString(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlString">assertXmlStringEqualsXmlString()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertXmlStringNotEqualsXmlFile(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlFile">assertXmlStringEqualsXmlFile()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>assertXmlStringNotEqualsXmlString(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertXmlStringEqualsXmlString">assertXmlStringEqualsXmlString()</a>, <a class="indexterm" href="#appendixes.assertions">Assertions</a></dt><dt>attribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>attributeEqualTo(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>C</h3><dl><dt>classHasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>classHasStaticAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>Cobertura de Código, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a>, <a class="indexterm" href="#code-coverage-analysis">Análise de Cobertura de Código</a>, <a class="indexterm" href="#code-coverage-analysis.including-excluding-files">Incluindo e Excluindo Arquivos</a>, <a class="indexterm" href="#appendixes.configuration.blacklist-whitelist">Incluindo e Excluindo Arquivos para Cobertura de Código</a></dt><dt>Code Coverage, <a class="indexterm" href="#appendixes.annotations.covers">@covers</a></dt><dt>Código de Cobertura, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt><dt>Componente Dependente, <a class="indexterm" href="#test-doubles">Dublês de Testes</a></dt><dt>Configuração, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt><dt>Constante, <a class="indexterm" href="#appendixes.configuration.php-ini-constants-variables">Setting PHP INI settings, Constants and Global Variables</a></dt><dt>contains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>containsOnly(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>containsOnlyInstancesOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>D</h3><dl><dt>Dependências de Testes, <a class="indexterm" href="#writing-tests-for-phpunit.test-dependencies">Dependências de Testes</a></dt><dt>Desenvolvimento Guiado por Comportamento, <a class="indexterm" href="#behaviour-driven-development">Desenvolvimento Guiado por Comportamento</a></dt><dt>Desenvolvimento Guiado por Testes, <a class="indexterm" href="#test-driven-development">Desenvolvimento Guiado por Testes</a>, <a class="indexterm" href="#behaviour-driven-development">Desenvolvimento Guiado por Comportamento</a></dt><dt>Design Guiado por Domínio, <a class="indexterm" href="#behaviour-driven-development">Desenvolvimento Guiado por Comportamento</a></dt><dt>Documentação Ágil, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a>, <a class="indexterm" href="#other-uses-for-tests.agile-documentation">Documentação Ágil</a></dt><dt>Documentação Automatizada, <a class="indexterm" href="#other-uses-for-tests.agile-documentation">Documentação Ágil</a></dt><dt>Documentando Suposições, <a class="indexterm" href="#other-uses-for-tests.agile-documentation">Documentação Ágil</a></dt><dt>Dublê de Teste, <a class="indexterm" href="#test-doubles">Dublês de Testes</a></dt></dl></div><div class="indexdiv"><h3>E</h3><dl><dt>equalTo(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>Erro, <a class="indexterm" href="#textui">O executor de testes em linha-de-comando</a></dt><dt>Esboço, <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt><dt>Esboços, <a class="indexterm" href="#other-uses-for-tests.cross-team-tests">Testes Inter-Equipes</a></dt><dt>expects(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt></dl></div><div class="indexdiv"><h3>F</h3><dl><dt>Falha, <a class="indexterm" href="#textui">O executor de testes em linha-de-comando</a></dt><dt>fileExists(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>G</h3><dl><dt>Gerador de Esqueleto, <a class="indexterm" href="#skeleton-generator.test">Gerando um Esqueleto de Classe de Caso de Teste</a></dt><dt>getMock(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt><dt>getMockBuilder(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt><dt>getMockForAbstractClass(), <a class="indexterm" href="#test-doubles.mock-objects">Objetos Falsos</a></dt><dt>getMockFromWsdl(), <a class="indexterm" href="#test-doubles.stubbing-and-mocking-web-services">Esboçando e Falsificando Serviços Web</a></dt><dt>greaterThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>greaterThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>Grupos de Teste, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a>, <a class="indexterm" href="#appendixes.configuration.groups">Grupos</a></dt><dt>Grupos de Testes, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt></dl></div><div class="indexdiv"><h3>H</h3><dl><dt>hasAttribute(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>I</h3><dl><dt>identicalTo(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>include_path, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt><dt>Interface Fluente, <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt><dt>isFalse(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>isInstanceOf(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>isNull(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>Isoalmento de Teste, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt><dt>Isolamento de Processo, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt><dt>Isolamento de Teste, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt><dt>Isolamento de Testes, <a class="indexterm" href="#fixtures.global-state">Estado Global</a></dt><dt>isTrue(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>isType(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>J</h3><dl><dt>JSON, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt></dl></div><div class="indexdiv"><h3>L</h3><dl><dt>lessThan(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>lessThanOrEqual(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>Lista-branca, <a class="indexterm" href="#code-coverage-analysis.including-excluding-files">Incluindo e Excluindo Arquivos</a>, <a class="indexterm" href="#appendixes.configuration.blacklist-whitelist">Incluindo e Excluindo Arquivos para Cobertura de Código</a></dt><dt>Lista-negra, <a class="indexterm" href="#code-coverage-analysis.including-excluding-files">Incluindo e Excluindo Arquivos</a>, <a class="indexterm" href="#appendixes.configuration.blacklist-whitelist">Incluindo e Excluindo Arquivos para Cobertura de Código</a></dt><dt>Localização de Defeitos, <a class="indexterm" href="#writing-tests-for-phpunit.test-dependencies">Dependências de Testes</a></dt><dt>Logfile, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt><dt>logicalAnd(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>logicalNot(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>logicalOr(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>logicalXor(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt></dl></div><div class="indexdiv"><h3>M</h3><dl><dt>Manipulador de Erros, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testando Erros PHP</a></dt><dt>matchesRegularExpression(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>method(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt><dt>Método Modelo, <a class="indexterm" href="#fixtures">Ambientes</a></dt></dl></div><div class="indexdiv"><h3>O</h3><dl><dt>Objeto Falso, <a class="indexterm" href="#test-doubles.mock-objects">Objetos Falsos</a></dt><dt>onConsecutiveCalls(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt><dt>onNotSuccessfulTest(), <a class="indexterm" href="#fixtures">Ambientes</a></dt><dt>Ouvintes de Teste, <a class="indexterm" href="#appendixes.configuration.test-listeners">Ouvintes de Teste</a></dt></dl></div><div class="indexdiv"><h3>P</h3><dl><dt>PHP Error, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testando Erros PHP</a></dt><dt>PHP Notice, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testando Erros PHP</a></dt><dt>PHP Warning, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testando Erros PHP</a></dt><dt>php.ini, <a class="indexterm" href="#appendixes.configuration.php-ini-constants-variables">Setting PHP INI settings, Constants and Global Variables</a></dt><dt>PHPUnit_Extensions_RepeatedTest, <a class="indexterm" href="#extending-phpunit.PHPUnit_Extensions_TestDecorator">Subclasse PHPUnit_Extensions_TestDecorator</a></dt><dt>PHPUnit_Extensions_Selenium2TestCase, <a class="indexterm" href="#selenium.selenium2testcase">PHPUnit_Extensions_Selenium2TestCase</a></dt><dt>PHPUnit_Extensions_SeleniumTestCase, <a class="indexterm" href="#selenium.seleniumtestcase">PHPUnit_Extensions_SeleniumTestCase</a></dt><dt>PHPUnit_Extensions_Story_TestCase, <a class="indexterm" href="#behaviour-driven-development">Desenvolvimento Guiado por Comportamento</a></dt><dt>PHPUnit_Extensions_TestDecorator, <a class="indexterm" href="#extending-phpunit.PHPUnit_Extensions_TestDecorator">Subclasse PHPUnit_Extensions_TestDecorator</a></dt><dt>PHPUnit_Extensions_TestSetup, <a class="indexterm" href="#extending-phpunit.PHPUnit_Extensions_TestDecorator">Subclasse PHPUnit_Extensions_TestDecorator</a></dt><dt>PHPUnit_Framework_Assert, <a class="indexterm" href="#test-driven-development.bankaccount-example">Exemplo da Conta Bancária</a></dt><dt>PHPUnit_Framework_Error, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testando Erros PHP</a></dt><dt>PHPUnit_Framework_Error_Notice, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testando Erros PHP</a></dt><dt>PHPUnit_Framework_Error_Warning, <a class="indexterm" href="#writing-tests-for-phpunit.errors">Testando Erros PHP</a></dt><dt>PHPUnit_Framework_IncompleteTest, <a class="indexterm" href="#incomplete-and-skipped-tests.incomplete-tests">Testes Incompletos</a></dt><dt>PHPUnit_Framework_IncompleteTestError, <a class="indexterm" href="#incomplete-and-skipped-tests.incomplete-tests">Testes Incompletos</a></dt><dt>PHPUnit_Framework_Test, <a class="indexterm" href="#extending-phpunit.PHPUnit_Framework_Test">Implementando PHPUnit_Framework_Test</a></dt><dt>PHPUnit_Framework_TestCase, <a class="indexterm" href="#writing-tests-for-phpunit">Escrevendo Testes para o PHPUnit</a>, <a class="indexterm" href="#extending-phpunit.PHPUnit_Framework_TestCase">Subclasse PHPUnit_Framework_TestCase</a></dt><dt>PHPUnit_Framework_TestListener, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a>, <a class="indexterm" href="#extending-phpunit.PHPUnit_Framework_TestListener">Implementando PHPUnit_Framework_TestListener</a>, <a class="indexterm" href="#appendixes.configuration.test-listeners">Ouvintes de Teste</a></dt><dt>PHPUnit_Runner_TestSuiteLoader, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt><dt>PHPUnit_Util_Printer, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt><dt>Programação Extrema, <a class="indexterm" href="#test-driven-development">Desenvolvimento Guiado por Testes</a>, <a class="indexterm" href="#behaviour-driven-development">Desenvolvimento Guiado por Comportamento</a>, <a class="indexterm" href="#other-uses-for-tests.agile-documentation">Documentação Ágil</a></dt><dt>Programar Testes Primeiro, <a class="indexterm" href="#test-driven-development">Desenvolvimento Guiado por Testes</a></dt><dt>Projeto-por-Contrato, <a class="indexterm" href="#test-driven-development">Desenvolvimento Guiado por Testes</a></dt></dl></div><div class="indexdiv"><h3>R</h3><dl><dt>Refatorando, <a class="indexterm" href="#testing-practices.during-development">Durante o Desenvolvimento</a></dt><dt>Registrando, <a class="indexterm" href="#logging">Registrando</a>, <a class="indexterm" href="#appendixes.configuration.logging">Registrando</a></dt><dt>Relatório, <a class="indexterm" href="#textui.clioptions">Comutadores de linha-de-comando</a></dt><dt>returnArgument(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt><dt>returnCallback(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt><dt>returnSelf(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt><dt>returnValue(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt><dt>returnValueMap(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt></dl></div><div class="indexdiv"><h3>S</h3><dl><dt>Selenium RC, <a class="indexterm" href="#appendixes.configuration.selenium-rc">Configurando Navegadores para Selenium RC</a></dt><dt>Servidor Selenium, <a class="indexterm" href="#selenium.selenium-rc">Servidor Selenium</a></dt><dt>setUp(), <a class="indexterm" href="#fixtures">Ambientes</a></dt><dt>setUpBeforeClass, <a class="indexterm" href="#fixtures.sharing-fixture">Compartilhando Ambientes</a></dt><dt>setUpBeforeClass(), <a class="indexterm" href="#fixtures">Ambientes</a></dt><dt>Sistema Sob Teste, <a class="indexterm" href="#test-doubles">Dublês de Testes</a></dt><dt>stringContains(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>stringEndsWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>stringStartsWith(), <a class="indexterm" href="#writing-tests-for-phpunit.assertions.assertThat">assertThat()</a></dt><dt>Suíte de Testes, <a class="indexterm" href="#organizing-tests">Organizando Testes</a></dt><dt>Suítes de Teste, <a class="indexterm" href="#appendixes.configuration.testsuites">Suítes de Teste</a></dt></dl></div><div class="indexdiv"><h3>T</h3><dl><dt>tearDown(), <a class="indexterm" href="#fixtures">Ambientes</a></dt><dt>tearDownAfterClass, <a class="indexterm" href="#fixtures.sharing-fixture">Compartilhando Ambientes</a></dt><dt>tearDownAfterClass(), <a class="indexterm" href="#fixtures">Ambientes</a></dt><dt>TestDox, <a class="indexterm" href="#other-uses-for-tests.agile-documentation">Documentação Ágil</a>, <a class="indexterm" href="#appendixes.annotations.testdox">@testdox</a></dt><dt>Teste Automatizado, <a class="indexterm" href="#automating-tests">Automatizando Testes</a></dt><dt>Teste Incompleto, <a class="indexterm" href="#skeleton-generator.test">Gerando um Esqueleto de Classe de Caso de Teste</a></dt><dt>Teste Unitário, <a class="indexterm" href="#automating-tests">Automatizando Testes</a>, <a class="indexterm" href="#test-driven-development">Desenvolvimento Guiado por Testes</a></dt><dt>Testes Guiados por Dados, <a class="indexterm" href="#extending-phpunit.PHPUnit_Framework_Test">Implementando PHPUnit_Framework_Test</a></dt><dt>Testes Incompletos, <a class="indexterm" href="#incomplete-and-skipped-tests.incomplete-tests">Testes Incompletos</a></dt><dt>throwException(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt></dl></div><div class="indexdiv"><h3>V</h3><dl><dt>Variável Global, <a class="indexterm" href="#fixtures.global-state">Estado Global</a>, <a class="indexterm" href="#appendixes.configuration.php-ini-constants-variables">Setting PHP INI settings, Constants and Global Variables</a></dt></dl></div><div class="indexdiv"><h3>W</h3><dl><dt>will(), <a class="indexterm" href="#test-doubles.stubs">Esboços (stubs)</a></dt></dl></div><div class="indexdiv"><h3>X</h3><dl><dt>Xdebug, <a class="indexterm" href="#code-coverage-analysis">Análise de Cobertura de Código</a></dt><dt>XML Configuration, <a class="indexterm" href="#organizing-tests.xml-configuration">Compondo uma Suíte de Testes Usando uma Configuração XML</a></dt></dl></div></div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.bibliography"></a>Apêndice E. Bibliografia</h1></div></div></div><div class="biblioentry"><a id="Astels2003"></a><p>[<abbr class="abbrev">Astels2003</abbr>] <span class="title"><em>Test Driven Development</em>. </span><span class="authorgroup"><span class="firstname">David</span> <span class="surname">Astels</span>. </span><span class="copyright">Copyright © 2003. </span><span class="publisher"><span class="publishername">Prentice Hall. </span></span><span class="isbn">ISBN 0131016490. </span></p></div><div class="biblioentry"><a id="Astels2006"></a><p>[<abbr class="abbrev">Astels2006</abbr>] <span class="title"><em>A New Look at Test-Driven Development</em>. </span><span class="authorgroup"><span class="firstname">David</span> <span class="surname">Astels</span>. </span><span class="copyright">Copyright © 2006. </span><span class="publisher"><span class="publishername">http://blog.daveastels.com/files/BDD_Intro.pdf. </span></span></p></div><div class="biblioentry"><a id="Beck2002"></a><p>[<abbr class="abbrev">Beck2002</abbr>] <span class="title"><em>Test Driven Development by Example</em>. </span><span class="authorgroup"><span class="firstname">Kent</span> <span class="surname">Beck</span>. </span><span class="copyright">Copyright © 2002. </span><span class="publisher"><span class="publishername">Addison-Wesley. </span></span><span class="isbn">ISBN 0-321-14653-0. </span></p></div><div class="biblioentry"><a id="Meszaros2007"></a><p>[<abbr class="abbrev">Meszaros2007</abbr>] <span class="title"><em>xUnit Test Patterns: Refactoring Test Code</em>. </span><span class="authorgroup"><span class="firstname">Gerard</span> <span class="surname">Meszaros</span>. </span><span class="copyright">Copyright © 2007. </span><span class="publisher"><span class="publishername">Addison-Wesley. </span></span><span class="isbn">ISBN 978-0131495050. </span></p></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a id="appendixes.copyright"></a>Apêndice F. Copyright</h1></div></div></div><pre class="programlisting"><code>Copyright (c) 2005-2012 Sebastian Bergmann.

This work is licensed under the Creative Commons Attribution 3.0
Unported License.

A summary of the license is given below, followed by the full legal
text.

--------------------------------------------------------------------

You are free:

    * to Share - to copy, distribute and transmit the work
    * to Remix - to adapt the work

Under the following conditions:

Attribution. You must attribute the work in the manner specified by
the author or licensor (but not in any way that suggests that they
endorse you or your use of the work).

    * For any reuse or distribution, you must make clear to others
      the license terms of this work. The best way to do this is with
      a link to this web page.

    * Any of the above conditions can be waived if you get
      permission from the copyright holder.

    * Nothing in this license impairs or restricts the author's moral
      rights.

Your fair dealing and other rights are in no way affected by the
above.

This is a human-readable summary of the Legal Code (the full
license) below.

====================================================================

Creative Commons Legal Code
Attribution 3.0 Unported

CREATIVE COMMONS CORPORATION IS NOT A LAW FIRM AND DOES NOT PROVIDE
LEGAL SERVICES. DISTRIBUTION OF THIS LICENSE DOES NOT CREATE AN
ATTORNEY-CLIENT RELATIONSHIP. CREATIVE COMMONS PROVIDES THIS
INFORMATION ON AN "AS-IS" BASIS. CREATIVE COMMONS MAKES NO
WARRANTIES REGARDING THE INFORMATION PROVIDED, AND DISCLAIMS
LIABILITY FOR DAMAGES RESULTING FROM ITS USE.

License

THE WORK (AS DEFINED BELOW) IS PROVIDED UNDER THE TERMS OF THIS
CREATIVE COMMONS PUBLIC LICENSE ("CCPL" OR "LICENSE"). THE WORK IS
PROTECTED BY COPYRIGHT AND/OR OTHER APPLICABLE LAW. ANY USE OF THE
WORK OTHER THAN AS AUTHORIZED UNDER THIS LICENSE OR COPYRIGHT LAW
IS PROHIBITED.

BY EXERCISING ANY RIGHTS TO THE WORK PROVIDED HERE, YOU ACCEPT AND
AGREE TO BE BOUND BY THE TERMS OF THIS LICENSE. TO THE EXTENT THIS
LICENSE MAY BE CONSIDERED TO BE A CONTRACT, THE LICENSOR GRANTS YOU
THE RIGHTS CONTAINED HERE IN CONSIDERATION OF YOUR ACCEPTANCE OF
SUCH TERMS AND CONDITIONS.

1. Definitions

   a. "Adaptation" means a work based upon the Work, or upon the
      Work and other pre-existing works, such as a translation,
      adaptation, derivative work, arrangement of music or other
      alterations of a literary or artistic work, or phonogram or
      performance and includes cinematographic adaptations or any
      other form in which the Work may be recast, transformed, or
      adapted including in any form recognizably derived from the
      original, except that a work that constitutes a Collection
      will not be considered an Adaptation for the purpose of this
      License. For the avoidance of doubt, where the Work is a
      musical work, performance or phonogram, the synchronization of
      the Work in timed-relation with a moving image ("synching")
      will be considered an Adaptation for the purpose of this
      License.

   b. "Collection" means a collection of literary or artistic works,
      such as encyclopedias and anthologies, or performances,
      phonograms or broadcasts, or other works or subject matter
      other than works listed in Section 1(f) below, which, by
      reason of the selection and arrangement of their contents,
      constitute intellectual creations, in which the Work is
      included in its entirety in unmodified form along with one or
      more other contributions, each constituting separate and
      independent works in themselves, which together are assembled
      into a collective whole. A work that constitutes a Collection
      will not be considered an Adaptation (as defined above) for
      the purposes of this License.

   c. "Distribute" means to make available to the public the
      original and copies of the Work or Adaptation, as appropriate,
      through sale or other transfer of ownership.

   d. "Licensor" means the individual, individuals, entity or
      entities that offer(s) the Work under the terms of this License.

   e. "Original Author" means, in the case of a literary or artistic
      work, the individual, individuals, entity or entities who
      created the Work or if no individual or entity can be
      identified, the publisher; and in addition (i) in the case of
      a performance the actors, singers, musicians, dancers, and
      other persons who act, sing, deliver, declaim, play in,
      interpret or otherwise perform literary or artistic works or
      expressions of folklore; (ii) in the case of a phonogram the
      producer being the person or legal entity who first fixes the
      sounds of a performance or other sounds; and, (iii) in the
      case of broadcasts, the organization that transmits the
      broadcast.

   f. "Work" means the literary and/or artistic work offered under
      the terms of this License including without limitation any
      production in the literary, scientific and artistic domain,
      whatever may be the mode or form of its expression including
      digital form, such as a book, pamphlet and other writing; a
      lecture, address, sermon or other work of the same nature; a
      dramatic or dramatico-musical work; a choreographic work or
      entertainment in dumb show; a musical composition with or
      without words; a cinematographic work to which are assimilated
      works expressed by a process analogous to cinematography; a
      work of drawing, painting, architecture, sculpture, engraving
      or lithography; a photographic work to which are assimilated
      works expressed by a process analogous to photography; a work
      of applied art; an illustration, map, plan, sketch or three-
      dimensional work relative to geography, topography,
      architecture or science; a performance; a broadcast; a
      phonogram; a compilation of data to the extent it is protected
      as a copyrightable work; or a work performed by a variety or
      circus performer to the extent it is not otherwise considered
      a literary or artistic work.

   g. "You" means an individual or entity exercising rights under
      this License who has not previously violated the terms of
      this License with respect to the Work, or who has received
      express permission from the Licensor to exercise rights under
      this License despite a previous violation.

   h. "Publicly Perform" means to perform public recitations of the
      Work and to communicate to the public those public
      recitations, by any means or process, including by wire or
      wireless means or public digital performances; to make
      available to the public Works in such a way that members of
      the public may access these Works from a place and at a place
      individually chosen by them; to perform the Work to the public
      by any means or process and the communication to the public of
      the performances of the Work, including by public digital
      performance; to broadcast and rebroadcast the Work by any
      means including signs, sounds or images.

   i. "Reproduce" means to make copies of the Work by any means
      including without limitation by sound or visual recordings and
      the right of fixation and reproducing fixations of the Work,
      including storage of a protected performance or phonogram in
      digital form or other electronic medium.

2. Fair Dealing Rights. Nothing in this License is intended to
   reduce, limit, or restrict any uses free from copyright or rights
   arising from limitations or exceptions that are provided for in
   connection with the copyright protection under copyright law or
   other applicable laws.

3. License Grant. Subject to the terms and conditions of this
   License, Licensor hereby grants You a worldwide, royalty-free,
   non-exclusive, perpetual (for the duration of the applicable
   copyright) license to exercise the rights in the Work as stated
   below:

   a. to Reproduce the Work, to incorporate the Work into one or
      more Collections, and to Reproduce the Work as incorporated
      in the Collections;

   b. to create and Reproduce Adaptations provided that any such
      Adaptation, including any translation in any medium, takes
      reasonable steps to clearly label, demarcate or otherwise
      identify that changes were made to the original Work. For
      example, a translation could be marked "The original work was
      translated from English to Spanish," or a modification could
      indicate "The original work has been modified.";

   c. to Distribute and Publicly Perform the Work including as
      incorporated in Collections; and,

   d. to Distribute and Publicly Perform Adaptations.

   e. For the avoidance of doubt:

      i. Non-waivable Compulsory License Schemes. In those
         jurisdictions in which the right to collect royalties
         through any statutory or compulsory licensing scheme cannot
         be waived, the Licensor reserves the exclusive right to
         collect such royalties for any exercise by You of the
         rights granted under this License;

      ii. Waivable Compulsory License Schemes. In those
          jurisdictions in which the right to collect royalties
          through any statutory or compulsory licensing scheme can
          be waived, the Licensor waives the exclusive right to
          collect such royalties for any exercise by You of the
          rights granted under this License; and,

      iii. Voluntary License Schemes. The Licensor waives the right
           to collect royalties, whether individually or, in the
           event that the Licensor is a member of a collecting
           society that administers voluntary licensing schemes, via
           that society, from any exercise by You of the rights
           granted under this License.

The above rights may be exercised in all media and formats whether
now known or hereafter devised. The above rights include the right
to make such modifications as are technically necessary to exercise
the rights in other media and formats. Subject to Section 8(f), all
rights not expressly granted by Licensor are hereby reserved.

4. Restrictions. The license granted in Section 3 above is expressly
   made subject to and limited by the following restrictions:

   a. You may Distribute or Publicly Perform the Work only under the
      terms of this License. You must include a copy of, or the
      Uniform Resource Identifier (URI) for, this License with every
      copy of the Work You Distribute or Publicly Perform. You may
      not offer or impose any terms on the Work that restrict the
      terms of this License or the ability of the recipient of the
      Work to exercise the rights granted to that recipient under
      the terms of the License. You may not sublicense the Work. You
      must keep intact all notices that refer to this License and to
      the disclaimer of warranties with every copy of the Work You
      Distribute or Publicly Perform. When You Distribute or
      Publicly Perform the Work, You may not impose any effective
      technological measures on the Work that restrict the ability
      of a recipient of the Work from You to exercise the rights
      granted to that recipient under the terms of the License. This
      Section 4(a) applies to the Work as incorporated in a
      Collection, but this does not require the Collection apart
      from the Work itself to be made subject to the terms of this
      License. If You create a Collection, upon notice from any
      Licensor You must, to the extent practicable, remove from the
      Collection any credit as required by Section 4(b), as
      requested. If You create an Adaptation, upon notice from any
      Licensor You must, to the extent practicable, remove from the
      Adaptation any credit as required by Section 4(b), as requested.

   b. If You Distribute, or Publicly Perform the Work or any
      Adaptations or Collections, You must, unless a request has
      been made pursuant to Section 4(a), keep intact all copyright
      notices for the Work and provide, reasonable to the medium or
      means You are utilizing: (i) the name of the Original Author
      (or pseudonym, if applicable) if supplied, and/or if the
      Original Author and/or Licensor designate another party or
      parties (e.g., a sponsor institute, publishing entity,
      journal) for attribution ("Attribution Parties") in Licensor's
      copyright notice, terms of service or by other reasonable
      means, the name of such party or parties; (ii) the title of
      the Work if supplied; (iii) to the extent reasonably
      practicable, the URI, if any, that Licensor specifies to be
      associated with the Work, unless such URI does not refer to
      the copyright notice or licensing information for the Work;
      and (iv), consistent with Section 3(b), in the case of an
      Adaptation, a credit identifying the use of the Work in the
      Adaptation (e.g., "French translation of the Work by Original
      Author," or "Screenplay based on original Work by Original
      Author"). The credit required by this Section 4 (b) may be
      implemented in any reasonable manner; provided, however, that
      in the case of a Adaptation or Collection, at a minimum such
      credit will appear, if a credit for all contributing authors
      of the Adaptation or Collection appears, then as part of these
      credits and in a manner at least as prominent as the credits
      for the other contributing authors. For the avoidance of
      doubt, You may only use the credit required by this Section
      for the purpose of attribution in the manner set out above
      and, by exercising Your rights under this License, You may not
      implicitly or explicitly assert or imply any connection with,
      sponsorship or endorsement by the Original Author, Licensor
      and/or Attribution Parties, as appropriate, of You or Your use
      of the Work, without the separate, express prior written
      permission of the Original Author, Licensor and/or
      Attribution Parties.

   c. Except as otherwise agreed in writing by the Licensor or as
      may be otherwise permitted by applicable law, if You
      Reproduce, Distribute or Publicly Perform the Work either by
      itself or as part of any Adaptations or Collections, You must
      not distort, mutilate, modify or take other derogatory action
      in relation to the Work which would be prejudicial to the
      Original Author's honor or reputation. Licensor agrees that in
      those jurisdictions (e.g. Japan), in which any exercise of the
      right granted in Section 3(b) of this License (the right to
      make Adaptations) would be deemed to be a distortion,
      mutilation, modification or other derogatory action
      prejudicial to the Original Author's honor and reputation, the
      Licensor will waive or not assert, as appropriate, this
      Section, to the fullest extent permitted by the applicable
      national law, to enable You to reasonably exercise Your right
      under Section 3(b) of this License (right to make Adaptations)
      but not otherwise.

5. Representations, Warranties and Disclaimer

UNLESS OTHERWISE MUTUALLY AGREED TO BY THE PARTIES IN WRITING,
LICENSOR OFFERS THE WORK AS-IS AND MAKES NO REPRESENTATIONS OR
WARRANTIES OF ANY KIND CONCERNING THE WORK, EXPRESS, IMPLIED,
STATUTORY OR OTHERWISE, INCLUDING, WITHOUT LIMITATION, WARRANTIES OF
TITLE, MERCHANTIBILITY, FITNESS FOR A PARTICULAR PURPOSE,
NONINFRINGEMENT, OR THE ABSENCE OF LATENT OR OTHER DEFECTS,
ACCURACY, OR THE PRESENCE OF ABSENCE OF ERRORS, WHETHER OR NOT
DISCOVERABLE. SOME JURISDICTIONS DO NOT ALLOW THE EXCLUSION OF
IMPLIED WARRANTIES, SO SUCH EXCLUSION MAY NOT APPLY TO YOU.

6. Limitation on Liability. EXCEPT TO THE EXTENT REQUIRED BY
   APPLICABLE LAW, IN NO EVENT WILL LICENSOR BE LIABLE TO YOU ON ANY
   LEGAL THEORY FOR ANY SPECIAL, INCIDENTAL, CONSEQUENTIAL, PUNITIVE
   OR EXEMPLARY DAMAGES ARISING OUT OF THIS LICENSE OR THE USE OF
   THE WORK, EVEN IF LICENSOR HAS BEEN ADVISED OF THE POSSIBILITY
   OF SUCH DAMAGES.

7. Termination

   a. This License and the rights granted hereunder will terminate
      automatically upon any breach by You of the terms of this
      License. Individuals or entities who have received Adaptations
      or Collections from You under this License, however, will not
      have their licenses terminated provided such individuals or
      entities remain in full compliance with those licenses.
      Sections 1, 2, 5, 6, 7, and 8 will survive any termination of
      this License.

   b. Subject to the above terms and conditions, the license granted
      here is perpetual (for the duration of the applicable
      copyright in the Work). Notwithstanding the above, Licensor
      reserves the right to release the Work under different license
      terms or to stop distributing the Work at any time; provided,
      however that any such election will not serve to withdraw this
      License (or any other license that has been, or is required to
      be, granted under the terms of this License), and this License
      will continue in full force and effect unless terminated as
      stated above.

8. Miscellaneous

   a. Each time You Distribute or Publicly Perform the Work or a
      Collection, the Licensor offers to the recipient a license to
      the Work on the same terms and conditions as the license
      granted to You under this License.

   b. Each time You Distribute or Publicly Perform an Adaptation,
      Licensor offers to the recipient a license to the original
      Work on the same terms and conditions as the license granted
      to You under this License.

   c. If any provision of this License is invalid or unenforceable
      under applicable law, it shall not affect the validity or
      enforceability of the remainder of the terms of this License,
      and without further action by the parties to this agreement,
      such provision shall be reformed to the minimum extent
      necessary to make such provision valid and enforceable.

   d. No term or provision of this License shall be deemed waived
      and no breach consented to unless such waiver or consent shall
      be in writing and signed by the party to be charged with such
      waiver or consent.

   e. This License constitutes the entire agreement between the
      parties with respect to the Work licensed here. There are no
      understandings, agreements or representations with respect to
      the Work not specified here. Licensor shall not be bound by
      any additional provisions that may appear in any communication
      from You. This License may not be modified without the mutual
      written agreement of the Licensor and You.

   f. The rights granted under, and the subject matter referenced,
      in this License were drafted utilizing the terminology of the
      Berne Convention for the Protection of Literary and Artistic
      Works (as amended on September 28, 1979), the Rome Convention
      of 1961, the WIPO Copyright Treaty of 1996, the WIPO
      Performances and Phonograms Treaty of 1996 and the Universal
      Copyright Convention (as revised on July 24, 1971). These
      rights and subject matter take effect in the relevant
      jurisdiction in which the License terms are sought to be
      enforced according to the corresponding provisions of the
      implementation of those treaty provisions in the applicable
      national law. If the standard suite of rights granted under
      applicable copyright law includes additional rights not
      granted under this License, such additional rights are deemed
      to be included in the License; this License is not intended to
      restrict the license of any rights under applicable law.

Creative Commons is not a party to this License, and makes no
warranty whatsoever in connection with the Work. Creative Commons
will not be liable to You or any party on any legal theory for any
damages whatsoever, including without limitation any general,
special, incidental or consequential damages arising in connection
to this license. Notwithstanding the foregoing two (2) sentences,
if Creative Commons has expressly identified itself as the Licensor
hereunder, it shall have all rights and obligations of Licensor.

Except for the limited purpose of indicating to the public that the
Work is licensed under the CCPL, Creative Commons does not authorize
the use by either party of the trademark "Creative Commons" or any
related trademark or logo of Creative Commons without the prior
written consent of Creative Commons. Any permitted use will be in
compliance with Creative Commons' then-current trademark usage
guidelines, as may be published on its website or otherwise made
available upon request from time to time. For the avoidance of
doubt, this trademark restriction does not form part of this
License.

Creative Commons may be contacted at http://creativecommons.org/.

====================================================================</code></pre></div></div>

    </div>
</div>
</div>

</body></html>
