

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configuration &mdash; Doctrine 1.2.4 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.2.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Doctrine 1.2.4 documentation" href="../../index.html" />
    <link rel="up" title="Doctrine 1.2 ORM Manual" href="index.html" />
    <link rel="next" title="Connections" href="connections.html" />
    <link rel="prev" title="Introduction to Connections" href="introduction-to-connections.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="connections.html" title="Connections"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction-to-connections.html" title="Introduction to Connections"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Doctrine 1.2.4 documentation</a> &raquo;</li>
          <li><a href="../index.html" >English Documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Doctrine 1.2 ORM Manual</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<p>Doctrine controls configuration of features and functionality using
attributes. In this section we will discuss how to set and get
attributes as well as an overview of what attributes exist for you to
use to control Doctrine functionality.</p>
<div class="section" id="levels-of-configuration">
<h2>Levels of Configuration<a class="headerlink" href="#levels-of-configuration" title="Permalink to this headline">¶</a></h2>
<p>Doctrine has a three-level configuration structure. You can set
configuration attributes at a global, connection and table level. If the
same attribute is set on both lower level and upper level, the uppermost
attribute will always be used. So for example if a user first sets
default fetchmode in global level to <a href="#id1"><span class="problematic" id="id2">:php:const:`Doctrine_Core::FETCH_BATCH`</span></a>
and then sets a table fetchmode to <a href="#id3"><span class="problematic" id="id4">:php:const:`Doctrine_Core::FETCH_LAZY`</span></a>, the
lazy fetching strategy will be used whenever the records of that table
are being fetched.</p>
<ul>
<li><dl class="first docutils">
<dt><strong>Global level</strong></dt>
<dd><p class="first last">The attributes set in global level will affect every connection and every
table in each connection.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>Connection level</strong></dt>
<dd><p class="first last">The attributes set in connection level will take effect on each table in
that connection.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><strong>Table level</strong></dt>
<dd><p class="first last">The attributes set in table level will take effect only on that table.</p>
</dd>
</dl>
</li>
</ul>
<p>In the following example we set an attribute at the global level:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_VALIDATE</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">VALIDATE_ALL</span><span class="p">);</span>
</pre></div>
</div>
<p>In the next example above we override the global attribute on given
connection:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_VALIDATE</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">VALIDATE_NONE</span><span class="p">);</span>
</pre></div>
</div>
<p>In the last example we override once again the connection level
attribute in the table level:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$table</span> <span class="o">=</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">getTable</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">);</span>
<span class="nv">$table</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_VALIDATE</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">VALIDATE_ALL</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We haven&#8217;t introduced the above used <a href="#id5"><span class="problematic" id="id6">:php:meth:`Doctrine_Core::getTable`</span></a>
method. You will learn more about the table objects used in Doctrine in the
<a class="reference internal" href="component-overview.html"><em>Component Overview</em></a> section of the next chapter.</p>
</div>
</div>
<div class="section" id="default-attributes">
<h2>Default Attributes<a class="headerlink" href="#default-attributes" title="Permalink to this headline">¶</a></h2>
<p>Doctrine has a few specific attributes available that allow you to
specify the default values of things that in the past were hardcoded
values. Such as default column length, default column type, etc.</p>
<div class="section" id="default-column-options">
<h3>Default Column Options<a class="headerlink" href="#default-column-options" title="Permalink to this headline">¶</a></h3>
<p>It is possible to specify an array of default options to be used on
every column in your model.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span>
    <span class="nx">Doctrine</span><span class="o">::</span><span class="na">ATTR_DEFAULT_COLUMN_OPTIONS</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span> <span class="o">=&gt;</span> <span class="mi">255</span><span class="p">,</span> <span class="s1">&#39;notnull&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="default-added-auto-id">
<h3>Default Added Auto Id<a class="headerlink" href="#default-added-auto-id" title="Permalink to this headline">¶</a></h3>
<p>You can customize the properties of the automatically added primary key
in Doctrine models.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span>
    <span class="nx">Doctrine</span><span class="o">::</span><span class="na">ATTR_DEFAULT_IDENTIFIER_OPTIONS</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span><span class="s1">&#39;name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;%s_id&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span> <span class="o">=&gt;</span> <span class="mi">16</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">%s</span></tt> string in the name is replaced with the table name.</p>
</div>
</div>
</div>
<div class="section" id="portability">
<h2>Portability<a class="headerlink" href="#portability" title="Permalink to this headline">¶</a></h2>
<p>Each database management system (DBMS) has it&#8217;s own behaviors. For example,
some databases capitalize field names in their output, some lowercase them,
while others leave them alone. These quirks make it difficult to port your
applications over to another database type.  Doctrine strives to overcome these
differences so your applications can switch between DBMS&#8217;s without any changes.
For example switching from sqlite to mysql.</p>
<p>The portability modes are bitwised, so they can be combined using <tt class="docutils literal"><span class="pre">|</span></tt> and
removed using <tt class="docutils literal"><span class="pre">^</span></tt>. See the examples section below on how to do this.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">You can read more about the bitwise operators on the
<a class="reference external" href="http://www.php.net/language.operators.bitwise">PHP website</a>.</p>
</div>
<div class="section" id="portability-mode-attributes">
<h3>Portability Mode Attributes<a class="headerlink" href="#portability-mode-attributes" title="Permalink to this headline">¶</a></h3>
<p>Below is a list of all the available portability attributes and the
description of what each one does:</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">PORTABILITY_ALL</span></tt></td>
<td>Turn on all portability features. This is the default setting.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PORTABILITY_DELETE_COUNT</span></tt></td>
<td>Force reporting the number of rows deleted. Some DBMS&#8217;s don&#8217;t count the number of rows deleted when performingsimple <tt class="docutils literal"><span class="pre">DELETE</span> <span class="pre">FROM</span></tt> tablename queries. This mode tricks such DBMS&#8217;s into telling the count by adding <tt class="docutils literal"><span class="pre">WHERE</span> <span class="pre">1=1</span></tt> to the end of <tt class="docutils literal"><span class="pre">DELETE</span></tt> queries.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">PORTABILITY_EMPTY_TO_NULL</span></tt></td>
<td>Convert empty strings values to null in data in and output. Needed because Oracle considers empty strings to be null, while most other DBMS&#8217;s know the difference between empty and null.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PORTABILITY_ERRORS</span></tt></td>
<td>Makes certain error messages in certain drivers compatible with those from other DBMS&#8217;s</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">PORTABILITY_FIX_ASSOC_FIELD_NAMES</span></tt></td>
<td>This removes any qualifiers from keys in associative fetches. Some RDBMS, like for example SQLite, will by default use the fully qualified name for a column in assoc fetches if it is qualified in a query.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PORTABILITY_FIX_CASE</span></tt></td>
<td>Convert names of tables and fields to lower or upper case in all methods. The case depends on the field_case option that may be set to either <tt class="docutils literal"><span class="pre">CASE_LOWER</span></tt> (default) or <tt class="docutils literal"><span class="pre">CASE_UPPER</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">PORTABILITY_NONE</span></tt></td>
<td>Turn off all portability features.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PORTABILITY_NUMROWS</span></tt></td>
<td>Enable hack that makes <tt class="docutils literal"><span class="pre">numRows</span></tt> work in Oracle.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">PORTABILITY_EXPR</span></tt></td>
<td>Makes DQL API throw exceptions when non-portable expressions are being used.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">PORTABILITY_RTRIM</span></tt></td>
<td>Right trim the data output for all data fetches. This does not applied in drivers for RDBMS that automatically right trim values of fixed length character values, even if they do not right trim value of variable length character values.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>Now we can use the <tt class="docutils literal"><span class="pre">setAttribute</span></tt> method to enable portability for
lowercasing and trimming with the following code:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span>
    <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_PORTABILITY</span><span class="p">,</span>
    <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">PORTABILITY_FIX_CASE</span> <span class="o">|</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">PORTABILITY_RTRIM</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Enable all portability options except trimming:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span>
    <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_PORTABILITY</span><span class="p">,</span>
    <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">PORTABILITY_ALL</span> <span class="o">^</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">PORTABILITY_RTRIM</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="identifier-quoting">
<h2>Identifier quoting<a class="headerlink" href="#identifier-quoting" title="Permalink to this headline">¶</a></h2>
<p>You can quote the db identifiers (table and field names) with
<a href="#id7"><span class="problematic" id="id8">:php:meth:`quoteIdentifier`</span></a>. The delimiting style depends on which database
driver is being used.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Just because you CAN use delimited identifiers, it doesn&#8217;t
mean you SHOULD use them. In general, they end up causing way more
problems than they solve. Anyway, it may be necessary when you have
a reserved word as a field name (in this case, we suggest you to
change it, if you can).</p>
</div>
<p>Some of the internal Doctrine methods generate queries. Enabling the
<tt class="docutils literal"><span class="pre">quote_identifier</span></tt> attribute of Doctrine you can tell Doctrine to
quote the identifiers in these generated queries. For all user supplied
queries this option is irrelevant.</p>
<p>Portability is broken by using the following characters inside delimited
identifiers:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="44%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Character</th>
<th class="head">Driver</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>backtick</td>
<td><tt class="docutils literal"><span class="pre">`</span></tt></td>
<td>MySQL</td>
</tr>
<tr class="row-odd"><td>double quote</td>
<td><tt class="docutils literal"><span class="pre">&quot;</span></tt></td>
<td>Oracle</td>
</tr>
<tr class="row-even"><td>brackets</td>
<td><tt class="docutils literal"><span class="pre">[</span></tt> or <tt class="docutils literal"><span class="pre">]</span></tt></td>
<td>Access</td>
</tr>
</tbody>
</table>
<p>Delimited identifiers are known to generally work correctly under the
following drivers: Mssql, Mysql, Oracle, Pgsql, Sqlite and Firebird.</p>
<p>When using the <a href="#id9"><span class="problematic" id="id10">:php:const:`Doctrine_Core::ATTR_QUOTE_IDENTIFIER`</span></a> option, all
of the field identifiers will be automatically quoted in the resulting
SQL statements:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_QUOTE_IDENTIFIER</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
</pre></div>
</div>
<p>Will result in a SQL statement that all the field names are quoted with
the backtick <tt class="docutils literal"><span class="pre">`</span></tt> operator (in MySQL):</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">sometable</span> <span class="k">WHERE</span> <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="o">=</span> <span class="s1">&#39;123&#39;</span>
</pre></div>
</div>
<p>As opposed to:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">sometable</span> <span class="k">WHERE</span> <span class="n">id</span> <span class="o">=</span> <span class="s1">&#39;123&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="hydration-overwriting">
<h2>Hydration Overwriting<a class="headerlink" href="#hydration-overwriting" title="Permalink to this headline">¶</a></h2>
<p>By default Doctrine is configured to overwrite any local changes you
have on your objects if you were to query for some objects which have
already been queried for and modified:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$user</span> <span class="o">=</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">getTable</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">&#39;newusername&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Now I have modified the above object and if I were to query for the same
data again, my local changes would be overwritten:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$user</span> <span class="o">=</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">getTable</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span><span class="p">;</span>
</pre></div>
</div>
<p>You can disable this behavior by using the <a href="#id11"><span class="problematic" id="id12">:php:const:`Doctrine_Core::ATTR_HYDRATE_OVERWRITE`</span></a>
attribute:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_HYDRATE_OVERWRITE</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</pre></div>
</div>
<p>Now if were to run the same test we ran above, the modified username
would not be overwritten.</p>
</div>
<div class="section" id="configure-table-class">
<h2>Configure Table Class<a class="headerlink" href="#configure-table-class" title="Permalink to this headline">¶</a></h2>
<p>If you want to configure the class to be returned when using the
<a href="#id13"><span class="problematic" id="id14">:php:meth:`Doctrine_Core::getTable`</span></a> method you can set the
<a href="#id15"><span class="problematic" id="id16">:php:const:`Doctrine_Core::ATTR_TABLE_CLASS`</span></a> attribute. The only requirement is that the class
extends <a href="#id17"><span class="problematic" id="id18">:php:class:`Doctrine_Table`</span></a>.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_TABLE_CLASS</span><span class="p">,</span> <span class="s1">&#39;MyTableClass&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Now the <tt class="docutils literal"><span class="pre">MyTableClass</span></tt> would look like the following:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyTableClass</span> <span class="k">extends</span> <span class="nx">Doctrine_Table</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">myMethod</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// run some query and return the results</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now when you do the following it will return an instance of
<tt class="docutils literal"><span class="pre">MyTableClass</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$user</span> <span class="o">=</span> <span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">getTable</span><span class="p">(</span><span class="s1">&#39;MyModel&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">myMethod</span><span class="p">();</span>
</pre></div>
</div>
<p>If you want to customize the table class even further you can customize
it for each model. Just create a class named <tt class="docutils literal"><span class="pre">MyModelTable</span></tt> and make
sure it is able to be autoloaded.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyModelTable</span> <span class="k">extends</span> <span class="nx">MyTableClass</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">anotherMethod</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="c1">// run some query and return the results</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now when I execute the following code it will return an instance of
<tt class="docutils literal"><span class="pre">MyModelTable</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">echo</span> <span class="nb">get_class</span><span class="p">(</span><span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">getTable</span><span class="p">(</span><span class="s1">&#39;MyModel&#39;</span><span class="p">));</span> <span class="c1">// MyModelTable</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-query-class">
<h2>Configure Query Class<a class="headerlink" href="#configure-query-class" title="Permalink to this headline">¶</a></h2>
<p>If you would like to configure the base query class returned when you
create new query instances, you can use the <a href="#id19"><span class="problematic" id="id20">:php:const:`Doctrine_Core::ATTR_QUERY_CLASS`</span></a>
attribute. The only requirement is that it extends the
<tt class="docutils literal"><span class="pre">Doctrine_Query</span></tt> class.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_QUERY_CLASS</span><span class="p">,</span> <span class="s1">&#39;MyQueryClass&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">MyQueryClass</span></tt> would look like the following:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyQueryClass</span> <span class="k">extends</span> <span class="nx">Doctrine_Query</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now when you create a new query it will return an instance of
<tt class="docutils literal"><span class="pre">MyQueryClass</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$q</span> <span class="o">=</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">getTable</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">)</span> <span class="o">-&gt;</span><span class="na">createQuery</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nb">get_class</span><span class="p">(</span><span class="nv">$q</span><span class="p">);</span> <span class="c1">// MyQueryClass</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-collection-class">
<h2>Configure Collection Class<a class="headerlink" href="#configure-collection-class" title="Permalink to this headline">¶</a></h2>
<p>Since you can configure the base query and table class, it would only make
sense that you can also customize the collection class Doctrine should use. We
just need to set the <a href="#id21"><span class="problematic" id="id22">:php:const:`Doctrine_Core::ATTR_COLLECTION_CLASS`</span></a>
attribute.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_COLLECTION_CLASS</span><span class="p">,</span> <span class="s1">&#39;MyCollectionClass&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>The only requirement of the <tt class="docutils literal"><span class="pre">MyCollectionClass</span></tt> is that it must extend
<tt class="docutils literal"><span class="pre">Doctrine_Collection</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$phonenumbers</span> <span class="o">=</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">Phonenumber</span><span class="p">;</span>
<span class="k">echo</span> <span class="nb">get_class</span><span class="p">(</span><span class="nv">$phonenumbers</span><span class="p">);</span> <span class="c1">// MyCollectionClass</span>
</pre></div>
</div>
</div>
<div class="section" id="disabling-cascading-saves">
<h2>Disabling Cascading Saves<a class="headerlink" href="#disabling-cascading-saves" title="Permalink to this headline">¶</a></h2>
<p>You can optionally disable the cascading save operations which are enabled by
default for convenience with the <a href="#id23"><span class="problematic" id="id24">:php:const:`Doctrine_Core::ATTR_CASCADE_SAVES`</span></a>
attribute. If you set this attribute to <tt class="docutils literal"><span class="pre">false</span></tt> it will only cascade and save
if the record is dirty. This means that you can&#8217;t cascade and save records who
are dirty that are more than one level deep in the hierarchy, but you benefit
with a significant performance improvement.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$conn</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_CASCADE_SAVES</span><span class="p">,</span> <span class="k">false</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="exporting">
<h2>Exporting<a class="headerlink" href="#exporting" title="Permalink to this headline">¶</a></h2>
<p>The export attribute is used for telling Doctrine what it should export
when exporting classes to your database for creating your tables.</p>
<p>If you don&#8217;t want to export anything when exporting you can use:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_EXPORT</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">EXPORT_NONE</span><span class="p">);</span>
</pre></div>
</div>
<p>For exporting tables only (but not constraints) you can use on of the
following:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_EXPORT</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">EXPORT_TABLES</span><span class="p">);</span>
</pre></div>
</div>
<p>You can also use the following syntax as it is the same as the above:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span>
    <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_EXPORT</span><span class="p">,</span>
    <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">EXPORT_ALL</span> <span class="o">^</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">EXPORT_CONSTRAINTS</span>
<span class="p">);</span>
</pre></div>
</div>
<p>For exporting everything (tables and constraints) you can use:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_EXPORT</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">EXPORT_ALL</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="naming-convention-attributes">
<h2>Naming convention attributes<a class="headerlink" href="#naming-convention-attributes" title="Permalink to this headline">¶</a></h2>
<p>Naming convention attributes affect the naming of different database
related elements such as tables, indexes and sequences. Basically every
naming convention attribute has affect in both ways. When importing
schemas from the database to classes and when exporting classes into
database tables.</p>
<p>So for example by default Doctrine naming convention for indexes is
<tt class="docutils literal"><span class="pre">%s_idx</span></tt>. Not only do the indexes you set get a special suffix, also
the imported classes get their indexes mapped to their non-suffixed
equivalents. This applies to all naming convention attributes.</p>
<div class="section" id="index-name-format">
<h3>Index name format<a class="headerlink" href="#index-name-format" title="Permalink to this headline">¶</a></h3>
<p><a href="#id25"><span class="problematic" id="id26">:php:const:`Doctrine_Core::ATTR_IDXNAME_FORMAT`</span></a> can be used for changing the
naming convention of indexes. By default Doctrine uses the format
<tt class="docutils literal"><span class="pre">[name]_idx</span></tt>. So defining an index called &#8216;ageindex&#8217; will actually be
converted into &#8216;ageindex_idx&#8217;.</p>
<p>You can change the index naming convention with the following code:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_IDXNAME_FORMAT</span><span class="p">,</span> <span class="s1">&#39;%s_index&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="sequence-name-format">
<h3>Sequence name format<a class="headerlink" href="#sequence-name-format" title="Permalink to this headline">¶</a></h3>
<p>Similar to <a href="#id27"><span class="problematic" id="id28">:php:const:`Doctrine_Core::ATTR_IDXNAME_FORMAT`</span></a>,
<a href="#id29"><span class="problematic" id="id30">:php:const:`Doctrine_Core::ATTR_SEQNAME_FORMAT`</span></a> can be used for changing the
naming convention of sequences. By default Doctrine uses the format
<tt class="docutils literal"><span class="pre">[name]_seq</span></tt>, hence creating a new sequence with the name of
<tt class="docutils literal"><span class="pre">mysequence</span></tt> will lead into creation of sequence called
<tt class="docutils literal"><span class="pre">mysequence_seq</span></tt>.</p>
<p>You can change the sequence naming convention with the following code:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_SEQNAME_FORMAT</span><span class="p">,</span> <span class="s1">&#39;%s_sequence&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="table-name-format">
<h3>Table name format<a class="headerlink" href="#table-name-format" title="Permalink to this headline">¶</a></h3>
<p>The table name format can be changed the same as the index and sequence
name format with the following code:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_TBLNAME_FORMAT</span><span class="p">,</span> <span class="s1">&#39;%s_table&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="database-name-format">
<h3>Database name format<a class="headerlink" href="#database-name-format" title="Permalink to this headline">¶</a></h3>
<p>The database name format can be changed the same as the index, sequence
and table name format with the following code:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_DBNAME_FORMAT</span><span class="p">,</span> <span class="s1">&#39;myframework_%s&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="validation-attributes">
<h3>Validation attributes<a class="headerlink" href="#validation-attributes" title="Permalink to this headline">¶</a></h3>
<p>Doctrine provides complete control over what it validates. The validation
procedure can be controlled with <a href="#id31"><span class="problematic" id="id32">:php:const:`Doctrine_Core::ATTR_VALIDATE`</span></a>.</p>
<p>The validation modes are bitwised, so they can be combined using <tt class="docutils literal"><span class="pre">|</span></tt> and
removed using <tt class="docutils literal"><span class="pre">^</span></tt>. See the examples section below on how to do this.</p>
</div>
<div class="section" id="validation-mode-constants">
<h3>Validation mode constants<a class="headerlink" href="#validation-mode-constants" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">VALIDATE_NONE</span></tt></td>
<td>Turns off the whole validation procedure.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">VALIDATE_LENGTHS</span></tt></td>
<td>Makes Doctrine validate all field lengths.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">VALIDATE_TYPES</span></tt></td>
<td>Makes Doctrine validate all field types. Doctrine
does loose typevalidation. This means that for
example string with value &#8216;13.3&#8217; willnot pass as an
integer but &#8216;13&#8217; will.</td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">VALIDATE_CONSTRAINTS</span></tt></td>
<td>Makes Doctrine validate all fieldconstraints such
as <tt class="docutils literal"><span class="pre">notnull</span></tt>, <tt class="docutils literal"><span class="pre">email</span></tt> etc.</td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">VALIDATE_ALL</span></tt></td>
<td>Turns on all validations.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Validation by default is turned off so if you wish for your
data to be validated you will need to enable it. Some examples of
how to change this configuration are provided below.</p>
</div>
</div>
<div class="section" id="id33">
<h3>Examples<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h3>
<p>You can turn on all validations by using the
<a href="#id34"><span class="problematic" id="id35">:php:const:`Doctrine_Core::VALIDATE_ALL`</span></a> attribute with the following code:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_VALIDATE</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">VALIDATE_ALL</span><span class="p">);</span>
</pre></div>
</div>
<p>You can also configure Doctrine to validate lengths and types, but not
constraints with the following code:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// bootstrap.php</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span>
    <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_VALIDATE</span><span class="p">,</span>
    <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">VALIDATE_LENGTHS</span> <span class="o">|</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">VALIDATE_TYPES</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Now we have gone over some of the most common attributes used to
configure Doctrine. Some of these attributes may not apply to you ever
or you may not understand what you could use them for now. As you read
the next chapters you will see which attributes you do and don&#8217;t need to
use and things will begin to make more sense.</p>
<p>If you saw some attributes you wanted to change the value above, then
you should have added it to your <tt class="docutils literal"><span class="pre">bootstrap.php</span></tt> file and it should
look something like the following now:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="cm">/* Bootstrap Doctrine.php, register autoloader and specify</span>
<span class="cm">   configuration attributes */</span>

<span class="k">require_once</span><span class="p">(</span><span class="s1">&#39;../doctrine/branches/1.2/lib/Doctrine.php&#39;</span><span class="p">);</span>
<span class="nb">spl_autoload_register</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;Doctrine&#39;</span><span class="p">,</span> <span class="s1">&#39;autoload&#39;</span><span class="p">));</span>
<span class="nv">$manager</span> <span class="o">=</span> <span class="nx">Doctrine_Manager</span><span class="o">::</span><span class="na">getInstance</span><span class="p">();</span>

<span class="nv">$conn</span> <span class="o">=</span> <span class="nx">Doctrine_Manager</span><span class="o">::</span><span class="na">connection</span><span class="p">(</span><span class="s1">&#39;sqlite::memory:&#39;</span><span class="p">,</span> <span class="s1">&#39;doctrine&#39;</span><span class="p">);</span>

<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_VALIDATE</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">VALIDATE_ALL</span><span class="p">);</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_EXPORT</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">EXPORT_ALL</span><span class="p">);</span>
<span class="nv">$manager</span><span class="o">-&gt;</span><span class="na">setAttribute</span><span class="p">(</span><span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">ATTR_MODEL_LOADING</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">MODEL_LOADING_CONSERVATIVE</span><span class="p">);</span>
</pre></div>
</div>
<p>Now we are ready to move on to the next chapter where we will learn
everything there is to know about Doctrine <a class="reference internal" href="connections.html"><em>Connections</em></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Configuration</a><ul>
<li><a class="reference internal" href="#levels-of-configuration">Levels of Configuration</a></li>
<li><a class="reference internal" href="#default-attributes">Default Attributes</a><ul>
<li><a class="reference internal" href="#default-column-options">Default Column Options</a></li>
<li><a class="reference internal" href="#default-added-auto-id">Default Added Auto Id</a></li>
</ul>
</li>
<li><a class="reference internal" href="#portability">Portability</a><ul>
<li><a class="reference internal" href="#portability-mode-attributes">Portability Mode Attributes</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#identifier-quoting">Identifier quoting</a></li>
<li><a class="reference internal" href="#hydration-overwriting">Hydration Overwriting</a></li>
<li><a class="reference internal" href="#configure-table-class">Configure Table Class</a></li>
<li><a class="reference internal" href="#configure-query-class">Configure Query Class</a></li>
<li><a class="reference internal" href="#configure-collection-class">Configure Collection Class</a></li>
<li><a class="reference internal" href="#disabling-cascading-saves">Disabling Cascading Saves</a></li>
<li><a class="reference internal" href="#exporting">Exporting</a></li>
<li><a class="reference internal" href="#naming-convention-attributes">Naming convention attributes</a><ul>
<li><a class="reference internal" href="#index-name-format">Index name format</a></li>
<li><a class="reference internal" href="#sequence-name-format">Sequence name format</a></li>
<li><a class="reference internal" href="#table-name-format">Table name format</a></li>
<li><a class="reference internal" href="#database-name-format">Database name format</a></li>
<li><a class="reference internal" href="#validation-attributes">Validation attributes</a></li>
<li><a class="reference internal" href="#validation-mode-constants">Validation mode constants</a></li>
<li><a class="reference internal" href="#id33">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="introduction-to-connections.html"
                        title="previous chapter">Introduction to Connections</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="connections.html"
                        title="next chapter">Connections</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/en/manual/configuration.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="connections.html" title="Connections"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction-to-connections.html" title="Introduction to Connections"
             >previous</a> |</li>
        <li><a href="../../index.html">Doctrine 1.2.4 documentation</a> &raquo;</li>
          <li><a href="../index.html" >English Documentation</a> &raquo;</li>
          <li><a href="index.html" >Doctrine 1.2 ORM Manual</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Jonathan Wage and Contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>