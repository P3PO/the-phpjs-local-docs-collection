

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Utilities &mdash; Doctrine 1.2.4 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.2.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Doctrine 1.2.4 documentation" href="../../index.html" />
    <link rel="up" title="Doctrine 1.2 ORM Manual" href="index.html" />
    <link rel="next" title="Unit Testing" href="unit-testing.html" />
    <link rel="prev" title="Extensions" href="extensions.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="unit-testing.html" title="Unit Testing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="extensions.html" title="Extensions"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Doctrine 1.2.4 documentation</a> &raquo;</li>
          <li><a href="../index.html" >English Documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Doctrine 1.2 ORM Manual</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="utilities">
<h1>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pagination">
<h2>Pagination<a class="headerlink" href="#pagination" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h3>
<p>In real world applications, display content from database tables is a
commom task. Also, imagine that this content is a search result
containing thousands of items. Undoubtely, it will be a huge listing,
memory expensive and hard for users to find the right item. That is
where some organization of this content display is needed and pagination
comes in rescue.</p>
<p>Doctrine implements a highly flexible pager package, allowing you to not
only split listing in pages, but also enabling you to control the layout
of page links. In this chapter, we&#8217;ll learn how to create pager objects,
control pager styles and at the end, overview the pager layout object -
a powerful page links displayer of Doctrine.</p>
</div>
<div class="section" id="working-with-pager">
<h3>Working with Pager<a class="headerlink" href="#working-with-pager" title="Permalink to this headline">¶</a></h3>
<p>Paginating queries is as simple as effectively do the queries itself.
<a href="#id1"><span class="problematic" id="id2">:php:class:`Doctrine_Pager`</span></a> is the responsible to process queries and paginate
them. Check out this small piece of code:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// Defining initial variables</span>
<span class="nv">$currentPage</span>    <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="nv">$resultsPerPage</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span>

<span class="c1">// Creating pager object</span>
<span class="nv">$pager</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Doctrine_Pager</span><span class="p">(</span>
    <span class="nx">Doctrine_Query</span><span class="o">::</span><span class="na">create</span><span class="p">()</span>
        <span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span> <span class="s1">&#39;User u&#39;</span> <span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">leftJoin</span><span class="p">(</span> <span class="s1">&#39;u.Group g&#39;</span> <span class="p">)</span>
        <span class="o">-&gt;</span><span class="na">orderby</span><span class="p">(</span> <span class="s1">&#39;u.username ASC&#39;</span> <span class="p">),</span>
    <span class="nv">$currentPage</span><span class="p">,</span> <span class="c1">// Current page of request</span>
    <span class="nv">$resultsPerPage</span><span class="p">,</span> <span class="c1">// (Optional) Number of results per page. Default is 25</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Until this place, the source you have is the same as the old
<a href="#id3"><span class="problematic" id="id4">:php:class:`Doctrine_Query`</span></a> object. The only difference is that now you have 2
new arguments. Your old query object plus these 2 arguments are now
encapsulated by the <a href="#id5"><span class="problematic" id="id6">:php:class:`Doctrine_Pager`</span></a> object. At this stage,
<a href="#id7"><span class="problematic" id="id8">:php:class:`Doctrine_Pager`</span></a> defines the basic data needed to control pagination.
If you want to know that actual status of the pager, all you have to do
is to check if it&#8217;s already executed:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getExecuted</span><span class="p">();</span>
</pre></div>
</div>
<p>If you try to access any of the methods provided by <a href="#id9"><span class="problematic" id="id10">:php:class:`Doctrine_Pager`</span></a>
now, you&#8217;ll experience <a href="#id11"><span class="problematic" id="id12">:php:class:`Doctrine_Pager_Exception`</span></a> thrown, reporting
you that Pager was not yet executed. When executed, <a href="#id13"><span class="problematic" id="id14">:php:class:`Doctrine_Pager`</span></a>
offer you powerful methods to retrieve information. The API usage is
listed at the end of this topic.</p>
<p>To run the query, the process is similar to the current existent
<a href="#id15"><span class="problematic" id="id16">:php:class:`Doctrine_Query`</span></a> execute call. It even allow arguments the way you
usually do it. Here is the PHP complete syntax, including the syntax of
optional parameters:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$items</span> <span class="o">=</span> <span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">(</span> <span class="p">[</span><span class="nv">$args</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">[,</span> <span class="nv">$fetchType</span> <span class="o">=</span> <span class="k">null</span><span class="p">]]</span> <span class="p">);</span>

<span class="k">foreach</span> <span class="p">(</span> <span class="nv">$items</span> <span class="k">as</span> <span class="nv">$item</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are some special cases where the return records query differ of
the counter query. To allow this situation, <a href="#id17"><span class="problematic" id="id18">:php:class:`Doctrine_Pager`</span></a> has some
methods that enable you to count and then to execute. The first thing
you have to do is to define the count query:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">setCountQuery</span><span class="p">(</span> <span class="nv">$query</span> <span class="p">[,</span> <span class="nv">$params</span> <span class="o">=</span> <span class="k">null</span><span class="p">]</span> <span class="p">);</span>

<span class="c1">// ...</span>
<span class="nv">$rs</span> <span class="o">=</span> <span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
</pre></div>
</div>
<p>The first param of <tt class="docutils literal"><span class="pre">setCountQuery</span></tt> can be either a valid
<a href="#id19"><span class="problematic" id="id20">:php:class:`Doctrine_Query`</span></a> object or a DQL string. The second argument you can
define the optional parameters that may be sent in the counter query. If
you do not define the params now, you&#8217;re still able to define it later
by calling the <tt class="docutils literal"><span class="pre">setCountQueryParams</span></tt>:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">setCountQueryParams</span><span class="p">(</span> <span class="p">[</span><span class="nv">$params</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">[,</span> <span class="nv">$append</span> <span class="o">=</span> <span class="k">false</span><span class="p">]]</span> <span class="p">);</span>
</pre></div>
</div>
<p>This method accepts 2 parameters. The first one is the params to be sent
in count query and the second parameter is if the
<tt class="docutils literal"><span class="pre">$params</span></tt> should be appended to the list or if it should override the list of count query parameters.
The default behavior is to override the list. One last thing to mention about count query is, if you do not define any parameter for count query,
it will still send the parameters you define in <tt class="docutils literal"><span class="pre">$pager-&gt;execute()</span></tt>
call.</p>
<p>Count query is always enabled to be accessed. If you do not define it
and call <tt class="docutils literal"><span class="pre">$pager-&gt;getCountQuery()</span></tt>, it will return the &#8220;fetcher&#8221; query
to you.</p>
<p>If you need access the other functionalities that <a href="#id21"><span class="problematic" id="id22">:php:class:`Doctrine_Pager`</span></a>
provides, you can access them through the API:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// Returns the check if Pager was already executed</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getExecuted</span><span class="p">();</span>

<span class="c1">// Return the total number of itens found on query search</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getNumResults</span><span class="p">();</span>

<span class="c1">// Return the first page (always 1)</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getFirstPage</span><span class="p">();</span>

<span class="c1">// Return the total number of pages</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getLastPage</span><span class="p">();</span>

<span class="c1">// Return the current page</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getPage</span><span class="p">();</span>

<span class="c1">// Defines a new current page (need to call execute again to adjust offsets and values)</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">setPage</span><span class="p">(</span> <span class="nv">$page</span> <span class="p">);</span>

<span class="c1">// Return the next page</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getNextPage</span><span class="p">();</span>

<span class="c1">// Return the previous page</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getPreviousPage</span><span class="p">();</span>

<span class="c1">// Return the first indice of current page</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getFirstIndice</span><span class="p">();</span>

<span class="c1">// Return the last indice of current page</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getLastIndice</span><span class="p">();</span>

<span class="c1">// Return true if it&#39;s necessary to paginate or false if not</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">haveToPaginate</span><span class="p">();</span>

<span class="c1">// Return the maximum number of records per page</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getMaxPerPage</span><span class="p">();</span>

<span class="c1">// Defined a new maximum number of records per page (need to call execute again to adjust offset and values)</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">setMaxPerPage</span><span class="p">(</span> <span class="nv">$maxPerPage</span> <span class="p">);</span>

<span class="c1">// Returns the number of itens in current page</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getResultsInPage</span><span class="p">();</span>

<span class="c1">// Returns the Doctrine_Query object that is used to make the count results to pager</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getCountQuery</span><span class="p">();</span>

<span class="c1">// Defines the counter query to be used by pager</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">setCountQuery</span><span class="p">(</span> <span class="nv">$query</span><span class="p">,</span> <span class="nv">$params</span> <span class="o">=</span> <span class="k">null</span> <span class="p">);</span>

<span class="c1">// Returns the params to be used by counter Doctrine_Query (return $defaultParams if no param is defined)</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getCountQueryParams</span><span class="p">(</span> <span class="nv">$defaultParams</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span>

<span class="c1">// Defines the params to be used by counter Doctrine_Query</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">setCountQueryParams</span><span class="p">(</span> <span class="nv">$params</span> <span class="o">=</span> <span class="k">array</span><span class="p">(),</span> <span class="nv">$append</span> <span class="o">=</span> <span class="k">false</span> <span class="p">);</span>

<span class="c1">// Return the Doctrine_Query object</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getQuery</span><span class="p">();</span>

<span class="c1">// Return an associated Doctrine_Pager_Range_* instance</span>
<span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getRange</span><span class="p">(</span> <span class="nv">$rangeStyle</span><span class="p">,</span> <span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="controlling-range-styles">
<h3>Controlling Range Styles<a class="headerlink" href="#controlling-range-styles" title="Permalink to this headline">¶</a></h3>
<p>There are some cases where simple paginations are not enough. One
example situation is when you want to write page links listings. To
enable a more powerful control over pager, there is a small subset of
pager package that allows you to create ranges.</p>
<p>Currently, Doctrine implements two types (or styles) of ranges: Sliding
(<a href="#id23"><span class="problematic" id="id24">:php:class:`Doctrine_Pager_Range_Sliding`</span></a>) and Jumping
(<a href="#id25"><span class="problematic" id="id26">:php:class:`Doctrine_Pager_Range_Jumping`</span></a>).</p>
<div class="section" id="sliding">
<h4>Sliding<a class="headerlink" href="#sliding" title="Permalink to this headline">¶</a></h4>
<p>Sliding page range style, the page range moves smoothly with the current
page. The current page is always in the middle, except in the first and
last pages of the range. Check out how does it work with a chunk length
of 5 items:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nx">Listing</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">14</span>
<span class="nx">Page</span> <span class="mi">1</span><span class="o">:</span> <span class="nx">o</span><span class="o">-------|</span>
<span class="nx">Page</span> <span class="mi">2</span><span class="o">:</span> <span class="o">|-</span><span class="nx">o</span><span class="o">-----|</span>
<span class="nx">Page</span> <span class="mi">3</span><span class="o">:</span> <span class="o">|---</span><span class="nx">o</span><span class="o">---|</span>
<span class="nx">Page</span> <span class="mi">4</span><span class="o">:</span>   <span class="o">|---</span><span class="nx">o</span><span class="o">---|</span>
<span class="nx">Page</span> <span class="mi">5</span><span class="o">:</span>     <span class="o">|---</span><span class="nx">o</span><span class="o">---|</span>
<span class="nx">Page</span> <span class="mi">6</span><span class="o">:</span>       <span class="o">|---</span><span class="nx">o</span><span class="o">---|</span>
<span class="nx">Page</span> <span class="mi">7</span><span class="o">:</span>         <span class="o">|---</span><span class="nx">o</span><span class="o">---|</span>
<span class="nx">Page</span> <span class="mi">8</span><span class="o">:</span>           <span class="o">|---</span><span class="nx">o</span><span class="o">---|</span>
</pre></div>
</div>
</div>
<div class="section" id="jumping">
<h4>Jumping<a class="headerlink" href="#jumping" title="Permalink to this headline">¶</a></h4>
<p>In Jumping page range style, the range of page links is always one of a
fixed set of &#8220;frames&#8221;: 1-5, 6-10, 11-15, and so on.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nx">Listing</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span> <span class="mi">10</span> <span class="mi">11</span> <span class="mi">12</span> <span class="mi">13</span> <span class="mi">14</span>
<span class="nx">Page</span> <span class="mi">1</span><span class="o">:</span> <span class="nx">o</span><span class="o">-------|</span>
<span class="nx">Page</span> <span class="mi">2</span><span class="o">:</span> <span class="o">|-</span><span class="nx">o</span><span class="o">-----|</span>
<span class="nx">Page</span> <span class="mi">3</span><span class="o">:</span> <span class="o">|---</span><span class="nx">o</span><span class="o">---|</span>
<span class="nx">Page</span> <span class="mi">4</span><span class="o">:</span> <span class="o">|-----</span><span class="nx">o</span><span class="o">-|</span>
<span class="nx">Page</span> <span class="mi">5</span><span class="o">:</span> <span class="o">|-------</span><span class="nx">o</span>
<span class="nx">Page</span> <span class="mi">6</span><span class="o">:</span>           <span class="nx">o</span><span class="o">---------|</span>
<span class="nx">Page</span> <span class="mi">7</span><span class="o">:</span>           <span class="o">|-</span><span class="nx">o</span><span class="o">-------|</span>
<span class="nx">Page</span> <span class="mi">8</span><span class="o">:</span>           <span class="o">|---</span><span class="nx">o</span><span class="o">-----|</span>
</pre></div>
</div>
<p>Now that we know how the different of styles of pager range works, it&#8217;s
time to learn how to use them:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$pagerRange</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Doctrine_Pager_Range_Sliding</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;chunk&#39;</span> <span class="o">=&gt;</span> <span class="mi">5</span> <span class="c1">// Chunk length</span>
    <span class="p">),</span>
    <span class="nv">$pager</span> <span class="c1">// Doctrine_Pager object we learned how to create in previous topic</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Alternatively, you can use:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$pagerRange</span> <span class="o">=</span> <span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getRange</span><span class="p">(</span>
    <span class="s1">&#39;Sliding&#39;</span><span class="p">,</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;chunk&#39;</span> <span class="o">=&gt;</span> <span class="mi">5</span>
    <span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>What is the advantage to use this object, instead of the
<a href="#id27"><span class="problematic" id="id28">:php:class:`Doctrine_Pager`</span></a>? Just one; it allows you to retrieve ranges around
the current page.</p>
<p>Look at the example:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// Retrieves the range around the current page</span>
<span class="c1">// In our example, we are using sliding style and we are at page 1</span>
<span class="nv">$pages</span> <span class="o">=</span> <span class="nv">$pager_range</span><span class="o">-&gt;</span><span class="na">rangeAroundPage</span><span class="p">();</span>

<span class="c1">// Outputs: [1][2][3][4][5]</span>
<span class="k">echo</span> <span class="s1">&#39;[&#39;</span><span class="o">.</span> <span class="nb">implode</span><span class="p">(</span> <span class="s1">&#39;][&#39;</span><span class="p">,</span> <span class="nv">$pages</span> <span class="p">)</span> <span class="o">.</span><span class="s1">&#39;]&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>If you build your <a href="#id29"><span class="problematic" id="id30">:php:class:`Doctrine_Pager`</span></a> inside the range object, the API
gives you enough power to retrieve information related to
<a href="#id31"><span class="problematic" id="id32">:php:class:`Doctrine_Pager_Range`</span></a> subclass instance:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// Return the Pager associated to this Pager_Range</span>
<span class="nv">$pager_range</span><span class="o">-&gt;</span><span class="na">getPager</span><span class="p">();</span>

<span class="c1">// Defines a new Doctrine_Pager (automatically call _initialize protected method)</span>
<span class="nv">$pager_range</span><span class="o">-&gt;</span><span class="na">setPager</span><span class="p">(</span> <span class="nv">$pager</span> <span class="p">);</span>

<span class="c1">// Return the options assigned to the current Pager_Range</span>
<span class="nv">$pager_range</span><span class="o">-&gt;</span><span class="na">getOptions</span><span class="p">();</span>

<span class="c1">// Returns the custom Doctrine_Pager_Range implementation offset option</span>
<span class="nv">$pager_range</span><span class="o">-&gt;</span><span class="na">getOption</span><span class="p">(</span> <span class="nv">$option</span> <span class="p">);</span>

<span class="c1">// Check if a given page is in the range</span>
<span class="nv">$pager_range</span><span class="o">-&gt;</span><span class="na">isInRange</span><span class="p">(</span> <span class="nv">$page</span> <span class="p">);</span>

<span class="c1">// Return the range around the current page (obtained from Doctrine_Pager</span>
<span class="c1">// associated to the $pager_range instance)</span>
<span class="nv">$pager_range</span><span class="o">-&gt;</span><span class="na">rangeAroundPage</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="advanced-layouts-with-pager">
<h3>Advanced layouts with pager<a class="headerlink" href="#advanced-layouts-with-pager" title="Permalink to this headline">¶</a></h3>
<p>Until now, we learned how to create paginations and how to retrieve
ranges around the current page. To abstract the business logic involving
the page links generation, there is a powerful component called
<a href="#id33"><span class="problematic" id="id34">:php:class:`Doctrine_Pager_Layout`</span></a>. The main idea of this component is to
abstract php logic and only leave HTML to be defined by Doctrine
developer.</p>
<p><a href="#id35"><span class="problematic" id="id36">:php:class:`Doctrine_Pager_Layout`</span></a> accepts 3 obrigatory arguments: a
<a href="#id37"><span class="problematic" id="id38">:php:class:`Doctrine_Pager`</span></a> instance, a <a href="#id39"><span class="problematic" id="id40">:php:class:`Doctrine_Pager_Range`</span></a> subclass
instance and a string which is the URL to be assigned as <strong>{%url}</strong> mask in
templates. As you may see, there are two types of &#8220;variables&#8221; in
<a href="#id41"><span class="problematic" id="id42">:php:class:`Doctrine_Pager_Layout`</span></a>:</p>
<div class="section" id="mask">
<h4>Mask<a class="headerlink" href="#mask" title="Permalink to this headline">¶</a></h4>
<p>A piece of string that is defined inside template as replacements. They
are defined as <strong>{%mask_name}</strong> and are replaced by what you define in
options or what is defined internally by <a href="#id43"><span class="problematic" id="id44">:php:class:`Doctrine_Pager_Layout`</span></a>
component. Currently, these are the internal masks available:</p>
<ul class="simple">
<li><strong>{%page}</strong> Holds the page number, exactly as page_number, but can
be overwritable by <tt class="docutils literal"><span class="pre">addMaskReplacement()</span></tt> to behavior like another
mask or value</li>
<li><strong>{%page_number}</strong> Stores the current page number, but cannot be
overwritable</li>
<li><strong>{%url}</strong> Available only in <tt class="docutils literal"><span class="pre">setTemplate()</span></tt> and
<tt class="docutils literal"><span class="pre">setSelectedTemplate()</span></tt> methods. Holds the processed URL, which was
defined in constructor</li>
</ul>
</div>
<div class="section" id="template">
<h4>Template<a class="headerlink" href="#template" title="Permalink to this headline">¶</a></h4>
<p>As the name explains itself, it is the skeleton of HTML or any other
resource that is applied to each page returned by
<tt class="docutils literal"><span class="pre">Doctrine_Pager_Range::rangeAroundPage()</span></tt> subclasses. There are 3
distinct templates that can be defined:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">setTemplate()</span></tt> Defines the template that can be used in all pages
returned by <tt class="docutils literal"><span class="pre">Doctrine_Pager_Range::rangeAroundPage()</span></tt> subclass
call</li>
<li><tt class="docutils literal"><span class="pre">setSelectedTemplate()</span></tt> Template that is applied when it is the
page to be processed is the current page you are. If nothing is
defined (a blank string or no definition), the template you defined
in <tt class="docutils literal"><span class="pre">setTemplate()</span></tt> is used</li>
<li><tt class="docutils literal"><span class="pre">setSeparatorTemplate()</span></tt> Separator template is the string that is
applied between each processed page. It is not included before the
first call and after the last one. The defined template of this
method is not affected by options and also it cannot process masks</li>
</ul>
<p>Now we know how to create the <a href="#id45"><span class="problematic" id="id46">:php:class:`Doctrine_Pager_Layout`</span></a> and the types
that are around this component, it is time to view the basic usage:</p>
<p>Creating the pager layout is simple:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$pagerLayout</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Doctrine_Pager_Layout</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">Doctrine_Pager</span><span class="p">(</span>
        <span class="nx">Doctrine_Query</span><span class="o">::</span><span class="na">create</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span> <span class="s1">&#39;User u&#39;</span> <span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">leftJoin</span><span class="p">(</span> <span class="s1">&#39;u.Group g&#39;</span> <span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">orderby</span><span class="p">(</span> <span class="s1">&#39;u.username ASC&#39;</span> <span class="p">),</span>
        <span class="nv">$currentPage</span><span class="p">,</span>
        <span class="nv">$resultsPerPage</span>
    <span class="p">),</span>
    <span class="k">new</span> <span class="nx">Doctrine_Pager_Range_Sliding</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;chunk&#39;</span> <span class="o">=&gt;</span> <span class="mi">5</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="s1">&#39;http://wwww.domain.com/app/User/list/page,{%page_number}&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Assigning templates for page links creation:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">setTemplate</span><span class="p">(</span> <span class="s1">&#39;[{%page}]&#39;</span> <span class="p">);</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">setSelectedTemplate</span><span class="p">(</span> <span class="s1">&#39;[{%page}]&#39;</span> <span class="p">);</span>

<span class="c1">// Retrieving Doctrine_Pager instance</span>
<span class="nv">$pager</span> <span class="o">=</span> <span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">getPager</span><span class="p">();</span>

<span class="c1">// Fetching users</span>
<span class="nv">$users</span> <span class="o">=</span> <span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span> <span class="c1">// This is possible too!</span>

<span class="c1">// Displaying page links</span>
<span class="c1">// Displays: [1][2][3][4][5]</span>
<span class="c1">// With links in all pages, except the $currentPage (our example, page 1)</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">display</span><span class="p">();</span>
</pre></div>
</div>
<p>Explaining this source, the first part creates the pager layout
instance. Second, it defines the templates for all pages and for the
current page. The last part, it retrieves the <a href="#id47"><span class="problematic" id="id48">:php:class:`Doctrine_Pager`</span></a> object
and executes the query, returning in variable <tt class="docutils literal"><span class="pre">$users</span></tt>. The last part
calls the displar without any optional mask, which applies the template
in all pages found by <tt class="docutils literal"><span class="pre">Doctrine_Pager_Range::rangeAroundPage()</span></tt>
subclass call.</p>
<p>As you may see, there is no need to use other masks except the internals
ones. Lets suppose we implement a new functionality to search for Users
in our existent application, and we need to support this feature in
pager layout too. To simplify our case, the search parameter is named
&#8220;search&#8221; and is received through <tt class="docutils literal"><span class="pre">$_GET</span></tt> superglobal array. The first
change we need to do is tho adjust the <a href="#id49"><span class="problematic" id="id50">:php:class:`Doctrine_Query`</span></a> object and
also the URL, to allow it to be sent to other pages.</p>
<p>Creating the pager layout:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$pagerLayout</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Doctrine_Pager_Layout</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">Doctrine_Pager</span><span class="p">(</span>
        <span class="nx">Doctrine_Query</span><span class="o">::</span><span class="na">create</span><span class="p">()</span>
            <span class="o">-&gt;</span><span class="na">from</span><span class="p">(</span> <span class="s1">&#39;User u&#39;</span> <span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">leftJoin</span><span class="p">(</span> <span class="s1">&#39;u.Group g&#39;</span> <span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">where</span><span class="p">(</span> <span class="s1">&#39;LOWER(u.username) LIKE LOWER(?)&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;%&#39;</span> <span class="o">.</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;search&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;%&#39;</span> <span class="p">)</span> <span class="p">)</span>
            <span class="o">-&gt;</span><span class="na">orderby</span><span class="p">(</span> <span class="s1">&#39;u.username ASC&#39;</span> <span class="p">),</span>
        <span class="nv">$currentPage</span><span class="p">,</span>
        <span class="nv">$resultsPerPage</span>
    <span class="p">),</span>
    <span class="k">new</span> <span class="nx">Doctrine_Pager_Range_Sliding</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;chunk&#39;</span> <span class="o">=&gt;</span> <span class="mi">5</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="s1">&#39;http://wwww.domain.com/app/User/list/page,{%page_number}?search={%search}&#39;</span>
<span class="p">);</span>
</pre></div>
</div>
<p>Check out the code and notice we added a new mask, called <tt class="docutils literal"><span class="pre">{%search}</span></tt>.
We&#8217;ll need to send it to the template processing at a later stage. We
then assign the templates, just as defined before, without any change.
And also, we do not need to change execution of query.</p>
<p>Assigning templates for page links creation:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">setTemplate</span><span class="p">(</span> <span class="s1">&#39;[{%page}]&#39;</span> <span class="p">);</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">setSelectedTemplate</span><span class="p">(</span> <span class="s1">&#39;[{%page}]&#39;</span> <span class="p">);</span>

<span class="c1">// Fetching users</span>
<span class="nv">$users</span> <span class="o">=</span> <span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>

<span class="k">foreach</span> <span class="p">(</span> <span class="nv">$users</span> <span class="k">as</span> <span class="nv">$user</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The method <tt class="docutils literal"><span class="pre">display()</span></tt> is the place where we define the custom mask we
created. This method accepts 2 optional arguments: one array of optional
masks and if the output should be returned instead of printed on screen.
In our case, we need to define a new mask, the <tt class="docutils literal"><span class="pre">{%search}</span></tt>, which is
the search offset of <tt class="docutils literal"><span class="pre">$_GET</span></tt> superglobal array. Also, remember that
since it&#8217;ll be sent as URL, it needs to be encoded. Custom masks are
defined in key =&gt; value pairs. So all needed code is to define an array
with the offset we desire and the value to be replaced:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// Displaying page links</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">display</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;search&#39;</span> <span class="o">=&gt;</span> <span class="nb">urlencode</span><span class="p">(</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;search&#39;</span><span class="p">]</span> <span class="p">)</span>
    <span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p><a href="#id51"><span class="problematic" id="id52">:php:class:`Doctrine_Pager_Layout`</span></a> component offers accessors to defined
resources. There is not need to define pager and pager range as
variables and send to the pager layout. These instances can be retrieved
by these accessors:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// Return the Pager associated to the Pager_Layout</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">getPager</span><span class="p">();</span>

<span class="c1">// Return the Pager_Range associated to the Pager_Layout</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">getPagerRange</span><span class="p">();</span>

<span class="c1">// Return the URL mask associated to the Pager_Layout</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">getUrlMask</span><span class="p">();</span>

<span class="c1">// Return the template associated to the Pager_Layout</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">getTemplate</span><span class="p">();</span>

<span class="c1">// Return the current page template associated to the Pager_Layout</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">getSelectedTemplate</span><span class="p">();</span>

<span class="c1">// Defines the Separator template, applied between each page</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">setSeparatorTemplate</span><span class="p">(</span> <span class="nv">$separatorTemplate</span> <span class="p">);</span>

<span class="c1">// Return the current page template associated to the Pager_Layout</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">getSeparatorTemplate</span><span class="p">();</span>

<span class="c1">// Handy method to execute the query without need to retrieve the Pager instance</span>
<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">(</span> <span class="nv">$params</span> <span class="o">=</span> <span class="k">array</span><span class="p">(),</span> <span class="nv">$hydrationMode</span> <span class="o">=</span> <span class="k">null</span> <span class="p">);</span>
</pre></div>
</div>
<p>There are a couple of other methods that are available if you want to
extend the <a href="#id53"><span class="problematic" id="id54">:php:class:`Doctrine_Pager_Layout`</span></a> to create you custom layouter. We
will see these methods in the next section.</p>
</div>
</div>
<div class="section" id="customizing-pager-layout">
<h3>Customizing pager layout<a class="headerlink" href="#customizing-pager-layout" title="Permalink to this headline">¶</a></h3>
<p><a href="#id55"><span class="problematic" id="id56">:php:class:`Doctrine_Pager_Layout`</span></a> does a really good job, but sometimes it is
not enough. Let&#8217;s suppose a situation where you have to create a layout
of pagination like this one:</p>
<p>&lt;&lt; &lt; 1 2 3 4 5 &gt; &gt;&gt;</p>
<p>Currently, it is impossible with raw <a href="#id57"><span class="problematic" id="id58">:php:class:`Doctrine_Pager_Layout`</span></a>. But if
you extend it and use the available methods, you can achieve it. The
base Layout class provides you some methods that can be used to create
your own implementation. They are:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// $this refers to an instance of Doctrine_Pager_Layout</span>

<span class="c1">// Defines a mask replacement. When parsing template, it converts replacement</span>
<span class="c1">// masks into new ones (or values), allowing to change masks behavior on the fly</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">addMaskReplacement</span><span class="p">(</span> <span class="nv">$oldMask</span><span class="p">,</span> <span class="nv">$newMask</span><span class="p">,</span> <span class="nv">$asValue</span> <span class="o">=</span> <span class="k">false</span> <span class="p">);</span>

<span class="c1">// Remove a mask replacement</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">removeMaskReplacement</span><span class="p">(</span> <span class="nv">$oldMask</span> <span class="p">);</span>

<span class="c1">// Remove all mask replacements</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">cleanMaskReplacements</span><span class="p">();</span>

<span class="c1">// Parses the template and returns the string of a processed page</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">processPage</span><span class="p">(</span> <span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span> <span class="c1">// Needs at least page_number offset in $options array</span>

<span class="c1">// Protected methods, although very useful</span>

<span class="c1">// Parse the template of a given page and return the processed template</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_parseTemplate</span><span class="p">(</span> <span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span>

<span class="c1">// Parse the url mask to return the correct template depending of the options sent</span>
<span class="c1">// Already process the mask replacements assigned</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_parseUrlTemplate</span><span class="p">(</span> <span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span>

<span class="c1">// Parse the mask replacements of a given page</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_parseReplacementsTemplate</span><span class="p">(</span> <span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span>

<span class="c1">// Parse the url mask of a given page and return the processed url</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_parseUrl</span><span class="p">(</span> <span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">);</span>

<span class="c1">// Parse the mask replacements, changing from to-be replaced mask with new masks/values</span>
<span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_parseMaskReplacements</span><span class="p">(</span> <span class="nv">$str</span> <span class="p">);</span>
</pre></div>
</div>
<p>Now that you have a small tip of useful methods to be used when
extending <a href="#id59"><span class="problematic" id="id60">:php:class:`Doctrine_Pager_Layout`</span></a>, it&#8217;s time to see our implemented
class:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">class</span> <span class="nc">PagerLayoutWithArrows</span> <span class="k">extends</span> <span class="nx">Doctrine_Pager_Layout</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">display</span><span class="p">(</span> <span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">(),</span> <span class="nv">$return</span> <span class="o">=</span> <span class="k">false</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$pager</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">getPager</span><span class="p">();</span>
        <span class="nv">$str</span>   <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>

        <span class="c1">// First page</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">addMaskReplacement</span><span class="p">(</span> <span class="s1">&#39;page&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;laquo;&#39;</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>
        <span class="nv">$options</span><span class="p">[</span><span class="s1">&#39;page_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getFirstPage</span><span class="p">();</span>
        <span class="nv">$str</span>                   <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">processPage</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">);</span>

        <span class="c1">// Previous page</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">addMaskReplacement</span><span class="p">(</span> <span class="s1">&#39;page&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;lsaquo;&#39;</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>
        <span class="nv">$options</span><span class="p">[</span><span class="s1">&#39;page_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getPreviousPage</span><span class="p">();</span>
        <span class="nv">$str</span>                   <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">processPage</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">);</span>

        <span class="c1">// Pages listing</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">removeMaskReplacement</span><span class="p">(</span> <span class="s1">&#39;page&#39;</span> <span class="p">);</span>
        <span class="nv">$str</span> <span class="o">.=</span> <span class="k">parent</span><span class="o">::</span><span class="na">display</span><span class="p">(</span> <span class="nv">$options</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>

        <span class="c1">// Next page</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">addMaskReplacement</span><span class="p">(</span> <span class="s1">&#39;page&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;rsaquo;&#39;</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>
        <span class="nv">$options</span><span class="p">[</span><span class="s1">&#39;page_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getNextPage</span><span class="p">();</span>
        <span class="nv">$str</span>                   <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">processPage</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">);</span>

        <span class="c1">// Last page</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">addMaskReplacement</span><span class="p">(</span> <span class="s1">&#39;page&#39;</span><span class="p">,</span> <span class="s1">&#39;&amp;raquo;&#39;</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>
        <span class="nv">$options</span><span class="p">[</span><span class="s1">&#39;page_number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$pager</span><span class="o">-&gt;</span><span class="na">getLastPage</span><span class="p">();</span>
        <span class="nv">$str</span>                   <span class="o">.=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">processPage</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">);</span>

        <span class="c1">// Possible wish to return value instead of print it on screen</span>
        <span class="k">if</span> <span class="p">(</span> <span class="nv">$return</span> <span class="p">)</span>
        <span class="p">{</span>
            <span class="k">return</span> <span class="nv">$str</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">echo</span> <span class="nv">$str</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As you may see, I have to manual process the items &lt;&lt;, &lt;, &gt; and &gt;&gt;. I
override the <strong>{%page}</strong> mask by setting a raw value to it (raw value is
achieved by setting the third parameter as true). Then I define the only
MUST HAVE information to process the page and call it. The return is the
template processed as a string. I do it to any of my custom buttons.</p>
<p>Now supposing a totally different situation. Doctrine is framework
agnostic, but many of our users use it together with Symfony.
<a href="#id61"><span class="problematic" id="id62">:php:class:`Doctrine_Pager`</span></a> and subclasses are 100% compatible with Symfony, but
<a href="#id63"><span class="problematic" id="id64">:php:class:`Doctrine_Pager_Layout`</span></a> needs some tweaks to get it working with
Symfony&#8217;s <tt class="docutils literal"><span class="pre">link_to</span></tt> helper function. To allow this usage with
<a href="#id65"><span class="problematic" id="id66">:php:class:`Doctrine_Pager_Layout`</span></a>, you have to extend it and add your custom
processor over it. For example purpose (it works in Symfony), I used
<strong>{link_to}...{/link_to}</strong> as a template processor to do this job.
Here is the extended class and usage in Symfony:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="k">class</span> <span class="nc">sfDoctrinePagerLayout</span> <span class="k">extends</span> <span class="nx">Doctrine_Pager_Layout</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span> <span class="nv">$pager</span><span class="p">,</span> <span class="nv">$pagerRange</span><span class="p">,</span> <span class="nv">$urlMask</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">sfLoader</span><span class="o">::</span><span class="na">loadHelpers</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;Url&#39;</span><span class="p">,</span> <span class="s1">&#39;Tag&#39;</span> <span class="p">)</span> <span class="p">);</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">__construct</span><span class="p">(</span> <span class="nv">$pager</span><span class="p">,</span> <span class="nv">$pagerRange</span><span class="p">,</span> <span class="nv">$urlMask</span> <span class="p">);</span>
    <span class="p">}</span>

    <span class="k">protected</span> <span class="k">function</span> <span class="nf">_parseTemplate</span><span class="p">(</span> <span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$str</span> <span class="o">=</span> <span class="k">parent</span><span class="o">::</span><span class="na">_parseTemplate</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">);</span>

        <span class="k">return</span> <span class="nb">preg_replace</span><span class="p">(</span>
            <span class="s1">&#39;/\{link_to\}(.*?)\{\/link_to\}/&#39;</span><span class="p">,</span> <span class="nx">link_to</span><span class="p">(</span> <span class="s1">&#39;$1&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_parseUrl</span><span class="p">(</span> <span class="nv">$options</span> <span class="p">)</span> <span class="p">),</span> <span class="nv">$str</span>
        <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>}</p>
<p>Usage:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$pagerLayout</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">sfDoctrinePagerLayout</span><span class="p">(</span>
    <span class="nv">$pager</span><span class="p">,</span>
    <span class="k">new</span> <span class="nx">Doctrine_Pager_Range_Sliding</span><span class="p">(</span>
        <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;chunk&#39;</span> <span class="o">=&gt;</span> <span class="mi">5</span>
        <span class="p">)</span>
    <span class="p">),</span>
    <span class="s1">&#39;@hostHistoryList?page={%page_number}&#39;</span>
<span class="p">);</span>

<span class="nv">$pagerLayout</span><span class="o">-&gt;</span><span class="na">setTemplate</span><span class="p">(</span> <span class="s1">&#39;[{link_to}{%page}{/link_to}]&#39;</span> <span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="facade">
<h2>Facade<a class="headerlink" href="#facade" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-dropping-databases">
<h3>Creating &amp; Dropping Databases<a class="headerlink" href="#creating-dropping-databases" title="Permalink to this headline">¶</a></h3>
<p>Doctrine offers the ability to create and drop your databases from your
defined Doctrine connections. The only trick to using it is that the
name of your Doctrine connection must be the name of your database. This
is required due to the fact that PDO does not offer a method for
retrieving the name of the database you are connected to. So in order to
create and drop the database Doctrine itself must be aware of the name
of the database.</p>
</div>
<div class="section" id="convenience-methods">
<h3>Convenience Methods<a class="headerlink" href="#convenience-methods" title="Permalink to this headline">¶</a></h3>
<p>Doctrine offers static convenience methods available in the main
Doctrine class. These methods perform some of the most used
functionality of Doctrine with one method. Most of these methods are
using in the <a href="#id67"><span class="problematic" id="id68">:php:class:`Doctrine_Task`</span></a> system. These tasks are also what are
executed from the <a href="#id69"><span class="problematic" id="id70">:php:class:`Doctrine_Cli`</span></a>.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// Turn debug on/off and check for whether it is on/off</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">debug</span><span class="p">(</span> <span class="k">true</span> <span class="p">);</span>

<span class="k">if</span> <span class="p">(</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">debug</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;debugging is on&#39;</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;debugging is off&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Get the path to your Doctrine libraries</span>
<span class="nv">$path</span> <span class="o">=</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">getPath</span><span class="p">();</span>

<span class="c1">// Set the path to your Doctrine libraries if it is some non-default location</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">setPath</span><span class="p">(</span> <span class="s1">&#39;/path/to/doctrine/libs&#39;</span> <span class="p">);</span>

<span class="c1">// Load your models so that they are present and loaded for Doctrine to work with</span>
<span class="c1">// Returns an array of the Doctrine_Records that were found and loaded</span>
<span class="nv">$models</span> <span class="o">=</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">loadModels</span><span class="p">(</span> <span class="s1">&#39;/path/to/models&#39;</span><span class="p">,</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">MODEL_LOADING_CONSERVATIVE</span> <span class="p">);</span>
<span class="c1">// or Doctrine_Core::MODEL_LOADING_AGGRESSIVE</span>
<span class="nb">print_r</span><span class="p">(</span> <span class="nv">$models</span> <span class="p">);</span>

<span class="c1">// Get array of all the models loaded and present to Doctrine</span>
<span class="nv">$models</span> <span class="o">=</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">getLoadedModels</span><span class="p">();</span>

<span class="c1">// Pass an array of classes to the above method and it will filter out the ones that are not Doctrine_Records</span>
<span class="nv">$models</span> <span class="o">=</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">filterInvalidModels</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="s1">&#39;Formatter&#39;</span><span class="p">,</span> <span class="s1">&#39;Doctrine_Record&#39;</span> <span class="p">)</span> <span class="p">);</span>
<span class="nb">print_r</span><span class="p">(</span> <span class="nv">$models</span> <span class="p">);</span> <span class="c1">// would return array( &#39;User&#39; ) because Formatter and Doctrine_Record are not valid</span>

<span class="c1">// Get Doctrine_Connection object for an actual table name</span>
<span class="nv">$conn</span> <span class="o">=</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">getConnectionByTableName</span><span class="p">(</span> <span class="s1">&#39;user&#39;</span> <span class="p">);</span> <span class="c1">// returns the connection object that the table name is associated with.</span>

<span class="c1">// Generate YAML schema from an existing database</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">generateYamlFromDb</span><span class="p">(</span> <span class="s1">&#39;/path/to/dump/schema.yml&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;connection_name&#39;</span> <span class="p">),</span> <span class="nv">$options</span> <span class="p">);</span>

<span class="c1">// Generate your models from an existing database</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">generateModelsFromDb</span><span class="p">(</span> <span class="s1">&#39;/path/to/generate/models&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;connection_name&#39;</span> <span class="p">),</span> <span class="nv">$options</span> <span class="p">);</span>

<span class="c1">// Array of options and the default values</span>
<span class="nv">$options</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;packagesPrefix&#39;</span>       <span class="o">=&gt;</span> <span class="s1">&#39;Package&#39;</span><span class="p">,</span>
    <span class="s1">&#39;packagesPath&#39;</span>         <span class="o">=&gt;</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="s1">&#39;packagesFolderName&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;packages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;suffix&#39;</span>               <span class="o">=&gt;</span> <span class="s1">&#39;.php&#39;</span><span class="p">,</span>
    <span class="s1">&#39;generateBaseClasses&#39;</span>  <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
    <span class="s1">&#39;baseClassesPrefix&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;Base&#39;</span><span class="p">,</span>
    <span class="s1">&#39;baseClassesDirectory&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;generated&#39;</span><span class="p">,</span>
    <span class="s1">&#39;baseClassName&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;Doctrine_Record&#39;</span>
<span class="p">);</span>

<span class="c1">// Generate your models from YAML schema</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">generateModelsFromYaml</span><span class="p">(</span> <span class="s1">&#39;/path/to/schema.yml&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/generate/models&#39;</span><span class="p">,</span> <span class="nv">$options</span> <span class="p">);</span>

<span class="c1">// Create the tables supplied in the array</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">createTablesFromArray</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="s1">&#39;Phoneumber&#39;</span> <span class="p">)</span> <span class="p">);</span>

<span class="c1">// Create all your tables from an existing set of models</span>
<span class="c1">// Will generate sql for all loaded models if no directory is given</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">createTablesFromModels</span><span class="p">(</span> <span class="s1">&#39;/path/to/models&#39;</span> <span class="p">);</span>

<span class="c1">// Generate string of sql commands from an existing set of models</span>
<span class="c1">// Will generate sql for all loaded models if no directory is given</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">generateSqlFromModels</span><span class="p">(</span> <span class="s1">&#39;/path/to/models&#39;</span> <span class="p">);</span>

<span class="c1">// Generate array of sql statements to create the array of passed models</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">generateSqlFromArray</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="s1">&#39;Phonenumber&#39;</span> <span class="p">)</span> <span class="p">);</span>

<span class="c1">// Generate YAML schema from an existing set of models</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">generateYamlFromModels</span><span class="p">(</span> <span class="s1">&#39;/path/to/schema.yml&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/models&#39;</span> <span class="p">);</span>

<span class="c1">// Create all databases for connections.</span>
<span class="c1">// Array of connection names is optional</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">createDatabases</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;connection_name&#39;</span> <span class="p">)</span> <span class="p">);</span>

<span class="c1">// Drop all databases for connections</span>
<span class="c1">// Array of connection names is optional</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">dropDatabases</span><span class="p">(</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;connection_name&#39;</span> <span class="p">)</span> <span class="p">);</span>

<span class="c1">// Dump all data for your models to a yaml fixtures file</span>
<span class="c1">// 2nd argument is a bool value for whether or not to generate individual fixture files for each model. If true you need</span>
<span class="c1">// to specify a folder instead of a file.</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">dumpData</span><span class="p">(</span> <span class="s1">&#39;/path/to/dump/data.yml&#39;</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>

<span class="c1">// Load data from yaml fixtures files</span>
<span class="c1">// 2nd argument is a bool value for whether or not to append the data when loading or delete all data first before loading</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">loadData</span><span class="p">(</span> <span class="s1">&#39;/path/to/fixture/files&#39;</span><span class="p">,</span> <span class="k">true</span> <span class="p">);</span>

<span class="c1">// Run a migration process for a set of migration classes</span>
<span class="nv">$num</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="c1">// migrate to version #5</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">migration</span><span class="p">(</span> <span class="s1">&#39;/path/to/migrations&#39;</span><span class="p">,</span> <span class="nv">$num</span> <span class="p">);</span>

<span class="c1">// Generate a blank migration class template</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">generateMigrationClass</span><span class="p">(</span> <span class="s1">&#39;ClassName&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/migrations&#39;</span> <span class="p">);</span>

<span class="c1">// Generate all migration classes for an existing database</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">generateMigrationsFromDb</span><span class="p">(</span> <span class="s1">&#39;/path/to/migrations&#39;</span> <span class="p">);</span>

<span class="c1">// Generate all migration classes for an existing set of models</span>
<span class="c1">// 2nd argument is optional if you have already loaded your models using loadModels()</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">generateMigrationsFromModels</span><span class="p">(</span> <span class="s1">&#39;/path/to/migrations&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/models&#39;</span> <span class="p">);</span>

<span class="c1">// Get Doctrine_Table instance for a model</span>
<span class="nv">$userTable</span> <span class="o">=</span> <span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">getTable</span><span class="p">(</span> <span class="s1">&#39;User&#39;</span> <span class="p">);</span>

<span class="c1">// Compile doctrine in to a single php file</span>
<span class="nv">$drivers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span> <span class="s1">&#39;mysql&#39;</span> <span class="p">);</span> <span class="c1">// specify the array of drivers you want to include in this compiled version</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">compile</span><span class="p">(</span> <span class="s1">&#39;/path/to/write/compiled/doctrine&#39;</span><span class="p">,</span> <span class="nv">$drivers</span> <span class="p">);</span>

<span class="c1">// Dump doctrine objects for debugging</span>
<span class="nv">$conn</span> <span class="o">=</span> <span class="nx">Doctrine_Manager</span><span class="o">::</span><span class="na">connection</span><span class="p">();</span>
<span class="nx">Doctrine_Core</span><span class="o">::</span><span class="na">dump</span><span class="p">(</span> <span class="nv">$conn</span> <span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="tasks">
<h3>Tasks<a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h3>
<p>Tasks are classes which bundle some of the core convenience methods in
to tasks that can be easily executed by setting the required arguments.
These tasks are directly used in the Doctrine command line interface.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nx">BuildAll</span>
<span class="nx">BuildAllLoad</span>
<span class="nx">BuildAllReload</span>
<span class="nx">Compile</span>
<span class="nx">CreateDb</span>
<span class="nx">CreateTables</span>
<span class="nx">Dql</span>
<span class="nx">DropDb</span>
<span class="nx">DumpData</span>
<span class="nx">Exception</span>
<span class="nx">GenerateMigration</span>
<span class="nx">GenerateMigrationsDb</span>
<span class="nx">GenerateMigrationsModels</span>
<span class="nx">GenerateModelsDb</span>
<span class="nx">GenerateModelsYaml</span>
<span class="nx">GenerateSql</span>
<span class="nx">GenerateYamlDb</span>
<span class="nx">GenerateYamlModels</span>
<span class="nx">LoadData</span>
<span class="nx">Migrate</span>
<span class="nx">RebuildDb</span>
</pre></div>
</div>
<p>You can read below about how to execute Doctrine Tasks standalone in
your own scripts.</p>
</div>
</div>
<div class="section" id="command-line-interface">
<h2>Command Line Interface<a class="headerlink" href="#command-line-interface" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introduction-the-doctrine-cli-is-a-collection-of-tasks-that-help-you">
<h3>Introduction The Doctrine Cli is a collection of tasks that help you<a class="headerlink" href="#introduction-the-doctrine-cli-is-a-collection-of-tasks-that-help-you" title="Permalink to this headline">¶</a></h3>
<p>with your day to do development and testing with your Doctrine
implementation. Typically with the examples in this manual, you setup
php scripts to perform whatever tasks you may need. This Cli tool is
aimed at providing an out of the box solution for those tasks.</p>
</div>
<div class="section" id="id71">
<h3>Tasks<a class="headerlink" href="#id71" title="Permalink to this headline">¶</a></h3>
<p>Below is a list of available tasks for managing your Doctrine
implementation.</p>
<div class="highlight-sh"><div class="highlight"><pre><span class="nv">$ </span>./doctrine
Doctrine Command Line Interface
./doctrine build-all
./doctrine build-all-load
./doctrine build-all-reload
./doctrine compile
./doctrine create-db
./doctrine create-tables
./doctrine dql
./doctrine drop-db
./doctrine dump-data
./doctrine generate-migration
./doctrine generate-migrations-db
./doctrine generate-migrations-models
./doctrine generate-models-db
./doctrine generate-models-yaml
./doctrine generate-sql
./doctrine generate-yaml-db
./doctrine generate-yaml-models
./doctrine load-data
./doctrine migrate
./doctrine rebuild-db
</pre></div>
</div>
<p>The tasks for the CLI are separate from the CLI and can be used
standalone. Below is an example.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$task</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Doctrine_Task_GenerateModelsFromYaml</span><span class="p">();</span>
<span class="nv">$args</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;yaml_schema_path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/path/to/schema&#39;</span><span class="p">,</span>
    <span class="s1">&#39;models_path&#39;</span>      <span class="o">=&gt;</span> <span class="s1">&#39;/path/to/models&#39;</span>
<span class="p">);</span>

<span class="nv">$task</span><span class="o">-&gt;</span><span class="na">setArguments</span><span class="p">(</span> <span class="nv">$args</span> <span class="p">);</span>

<span class="k">try</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span> <span class="nv">$task</span><span class="o">-&gt;</span><span class="na">validate</span><span class="p">()</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$task</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">catch</span> <span class="p">(</span> <span class="nx">Exception</span> <span class="nv">$e</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nx">Doctrine_Exception</span><span class="p">(</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h3>
<p>File named &#8220;doctrine&#8221; that is set to executable</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">#!/usr/bin/env php</span>
<span class="p">[</span><span class="nx">php</span><span class="p">]</span>

<span class="nb">chdir</span><span class="p">(</span> <span class="nb">dirname</span><span class="p">(</span> <span class="k">__FILE__</span> <span class="p">)</span> <span class="p">);</span>
<span class="k">include</span><span class="p">(</span> <span class="s1">&#39;doctrine.php&#39;</span> <span class="p">);</span>
</pre></div>
</div>
<p>Actual php file named &#8220;doctrine.php&#8221; that implements the <a href="#id72"><span class="problematic" id="id73">:php:class:`Doctrine_Cli`</span></a>.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// Include your Doctrine configuration/setup here, your connections, models, etc.</span>

<span class="c1">// Configure Doctrine Cli</span>
<span class="c1">// Normally these are arguments to the cli tasks but if they are set here the arguments will be auto-filled and are not required for you to enter them.</span>

<span class="nv">$config</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;data_fixtures_path&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/path/to/data/fixtures&#39;</span><span class="p">,</span>
    <span class="s1">&#39;models_path&#39;</span>        <span class="o">=&gt;</span> <span class="s1">&#39;/path/to/models&#39;</span><span class="p">,</span>
    <span class="s1">&#39;migrations_path&#39;</span>    <span class="o">=&gt;</span> <span class="s1">&#39;/path/to/migrations&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sql_path&#39;</span>           <span class="o">=&gt;</span> <span class="s1">&#39;/path/to/data/sql&#39;</span><span class="p">,</span>
    <span class="s1">&#39;yaml_schema_path&#39;</span>   <span class="o">=&gt;</span> <span class="s1">&#39;/path/to/schema&#39;</span>
<span class="p">);</span>

<span class="nv">$cli</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Doctrine_Cli</span><span class="p">(</span> <span class="nv">$config</span> <span class="p">);</span>
<span class="nv">$cli</span><span class="o">-&gt;</span><span class="na">run</span><span class="p">(</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;argv&#39;</span><span class="p">]</span> <span class="p">);</span>
</pre></div>
</div>
<p>Now you can begin executing commands.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="o">./</span><span class="nx">doctrine</span> <span class="nx">generate</span><span class="o">-</span><span class="nx">models</span><span class="o">-</span><span class="nx">yaml</span>
<span class="o">./</span><span class="nx">doctrine</span> <span class="nx">create</span><span class="o">-</span><span class="nx">tables</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sandbox">
<h2>Sandbox<a class="headerlink" href="#sandbox" title="Permalink to this headline">¶</a></h2>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>You can install the sandbox by downloading the special sandbox package
from <a class="reference external" href="http://www.doctrine-project.org/download">http://www.doctrine-project.org/download</a> or you can install it via
svn below.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nx">svn</span> <span class="nx">co</span> <span class="nx">http</span><span class="o">://</span><span class="nx">www</span><span class="o">.</span><span class="nx">doctrine</span><span class="o">-</span><span class="nx">project</span><span class="o">.</span><span class="nx">org</span><span class="o">/</span><span class="nx">svn</span><span class="o">/</span><span class="nx">branches</span><span class="o">/</span><span class="mf">0.11</span> <span class="nx">doctrine</span>
<span class="nx">cd</span> <span class="nx">doctrine</span><span class="o">/</span><span class="nx">tools</span><span class="o">/</span><span class="nx">sandbox</span>
<span class="nb">chmod</span> <span class="mo">0777</span> <span class="nx">doctrine</span>

<span class="o">./</span><span class="nx">doctrine</span>
</pre></div>
</div>
<p>The above steps should give you a functioning sandbox. Execute the
./doctrine command without specifying a task will show you an index of
all the available cli tasks in Doctrine.</p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>I hope some of these utilities discussed in this chapter are of use to
you. Now lets discuss how Doctrine maintains stability and avoids
regressions by using <a class="reference internal" href="unit-testing.html"><em>Unit Testing</em></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Utilities</a><ul>
<li><a class="reference internal" href="#pagination">Pagination</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#working-with-pager">Working with Pager</a></li>
<li><a class="reference internal" href="#controlling-range-styles">Controlling Range Styles</a><ul>
<li><a class="reference internal" href="#sliding">Sliding</a></li>
<li><a class="reference internal" href="#jumping">Jumping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-layouts-with-pager">Advanced layouts with pager</a><ul>
<li><a class="reference internal" href="#mask">Mask</a></li>
<li><a class="reference internal" href="#template">Template</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizing-pager-layout">Customizing pager layout</a></li>
</ul>
</li>
<li><a class="reference internal" href="#facade">Facade</a><ul>
<li><a class="reference internal" href="#creating-dropping-databases">Creating &amp; Dropping Databases</a></li>
<li><a class="reference internal" href="#convenience-methods">Convenience Methods</a></li>
<li><a class="reference internal" href="#tasks">Tasks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#command-line-interface">Command Line Interface</a><ul>
<li><a class="reference internal" href="#introduction-the-doctrine-cli-is-a-collection-of-tasks-that-help-you">Introduction The Doctrine Cli is a collection of tasks that help you</a></li>
<li><a class="reference internal" href="#id71">Tasks</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sandbox">Sandbox</a><ul>
<li><a class="reference internal" href="#installation">Installation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="extensions.html"
                        title="previous chapter">Extensions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="unit-testing.html"
                        title="next chapter">Unit Testing</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/en/manual/utilities.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="unit-testing.html" title="Unit Testing"
             >next</a> |</li>
        <li class="right" >
          <a href="extensions.html" title="Extensions"
             >previous</a> |</li>
        <li><a href="../../index.html">Doctrine 1.2.4 documentation</a> &raquo;</li>
          <li><a href="../index.html" >English Documentation</a> &raquo;</li>
          <li><a href="index.html" >Doctrine 1.2 ORM Manual</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Jonathan Wage and Contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>