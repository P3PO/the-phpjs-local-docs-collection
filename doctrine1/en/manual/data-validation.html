

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Data Validation &mdash; Doctrine 1.2.4 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.2.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Doctrine 1.2.4 documentation" href="../../index.html" />
    <link rel="up" title="Doctrine 1.2 ORM Manual" href="index.html" />
    <link rel="next" title="Data Hydrators" href="data-hydrators.html" />
    <link rel="prev" title="YAML Schema Files" href="yaml-schema-files.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="data-hydrators.html" title="Data Hydrators"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="yaml-schema-files.html" title="YAML Schema Files"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Doctrine 1.2.4 documentation</a> &raquo;</li>
          <li><a href="../index.html" >English Documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Doctrine 1.2 ORM Manual</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="data-validation">
<h1>Data Validation<a class="headerlink" href="#data-validation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p><a class="reference external" href="http://www.postgresql.org/docs/8.2/static/ddl-constraints.html">PostgreSQL Documentation</a>: Data</p>
<blockquote>
<div>types are a way to limit the kind</div></blockquote>
<p class="last">of data that can be stored in a table. For many applications,
however, the constraint they provide is too coarse. For example, a
column containing a product price should probably only accept
positive values. But there is no standard data type that accepts
only positive numbers. Another issue is that you might want to
constrain column data with respect to other columns or rows. For
example, in a table containing product information, there should be
only one row for each product number.</p>
</div>
<p>Doctrine allows you to define <em>portable</em> constraints on columns and
tables. Constraints give you as much control over the data in your
tables as you wish. If a user attempts to store data in a column that
would violate a constraint, an error is raised. This applies even if the
value came from the default value definition.</p>
<p>Doctrine constraints act as database level constraints as well as
application level validators. This means double security: the database
doesn&#8217;t allow wrong kind of values and neither does the application.</p>
<p>Here is a full list of available validators within Doctrine:</p>
<p>Below is an example of how you use the validator and how to specify the
arguments for the validators on a column.</p>
<p>In our example we will use the <tt class="docutils literal"><span class="pre">minlength</span></tt> validator.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;minlength&#39;</span> <span class="o">=&gt;</span> <span class="mi">12</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(255)</span>
      <span class="l-Scalar-Plain">minlength</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">12</span>
<span class="c1"># ...</span>
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="not-null">
<h3>Not Null<a class="headerlink" href="#not-null" title="Permalink to this headline">¶</a></h3>
<p>A not-null constraint simply specifies that a column must not assume the
null value. A not-null constraint is always written as a column
constraint.</p>
<p>The following definition uses a <tt class="docutils literal"><span class="pre">notnull</span></tt> constraint for column name.
This means that the specified column doesn&#8217;t accept null values.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;notnull&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
                <span class="s1">&#39;primary&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(255)</span>
      <span class="l-Scalar-Plain">notnull</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
      <span class="l-Scalar-Plain">primary</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>When this class gets exported to database the following SQL statement
would get executed (in MySQL):</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nx">CREATE</span> <span class="nx">TABLE</span> <span class="nx">user</span> <span class="p">(</span><span class="nx">username</span> <span class="nx">VARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
<span class="nx">PRIMARY</span> <span class="nx">KEY</span><span class="p">(</span><span class="nx">username</span><span class="p">))</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">notnull</span></tt> constraint also acts as an application level validator.
This means that if Doctrine validators are turned on, Doctrine will
automatically check that specified columns do not contain null values
when saved.</p>
<p>If those columns happen to contain null values
<a href="#id1"><span class="problematic" id="id2">:php:class:`Doctrine_Validator_Exception`</span></a> is raised.</p>
</div>
<div class="section" id="email">
<h3>Email<a class="headerlink" href="#email" title="Permalink to this headline">¶</a></h3>
<p>The e-mail validator simply validates that the inputted value is indeed
a valid e-mail address and that the MX records for the address domain
resolve as a valid e-mail address.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;email&#39;</span>   <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">email</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(255)</span>
      <span class="l-Scalar-Plain">email</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now when we try and create a user with an invalid email address it will
not validate:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// test.php</span>
<span class="c1">// ...</span>
<span class="nv">$user</span>           <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">&#39;jwage&#39;</span><span class="p">;</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">email</span>    <span class="o">=</span> <span class="s1">&#39;jonwage&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid!&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above code will throw an exception because <tt class="docutils literal"><span class="pre">jonwage</span></tt> is not a
valid e-mail address. Now we can take this even further and give a valid
e-mail address format but an invalid domain name:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// test.php</span>
<span class="c1">// ...</span>
<span class="nv">$user</span>           <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">&#39;jwage&#39;</span><span class="p">;</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">email</span>    <span class="o">=</span> <span class="s1">&#39;jonwage@somefakedomainiknowdoesntexist.com&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid!&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now the above code will still fail because the domain
<tt class="docutils literal"><span class="pre">somefakedomainiknowdoesntexist.com</span></tt> does not exist and the php
function <a class="reference external" href="http://www.php.net/checkdnsrr">checkdnsrr()</a> returned
<tt class="docutils literal"><span class="pre">false</span></tt>.</p>
</div>
<div class="section" id="not-blank">
<h3>Not Blank<a class="headerlink" href="#not-blank" title="Permalink to this headline">¶</a></h3>
<p>The not blank validator is similar to the not null validator except that
it will fail on empty strings or strings with white space.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;notblank&#39;</span>   <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(255)</span>
      <span class="l-Scalar-Plain">notblank</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if we try and save a <tt class="docutils literal"><span class="pre">User</span></tt> record with a username that is a
single blank white space, validation will fail:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// test.php</span>

<span class="c1">// ...</span>
<span class="nv">$user</span>           <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid!&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="no-space">
<h3>No Space<a class="headerlink" href="#no-space" title="Permalink to this headline">¶</a></h3>
<p>The no space validator is simple. It checks that the value doesn&#8217;t
contain any spaces.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;nospace&#39;</span>   <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(255)</span>
      <span class="l-Scalar-Plain">nospace</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if we try and save a <tt class="docutils literal"><span class="pre">User</span></tt> with a <tt class="docutils literal"><span class="pre">username</span></tt> that has a space
in it, the validation will fail:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$user</span>           <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">&#39;jon wage&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid!&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="past">
<h3>Past<a class="headerlink" href="#past" title="Permalink to this headline">¶</a></h3>
<p>The past validator checks if the given value is a valid date in the
past. In this example we&#8217;ll have a <tt class="docutils literal"><span class="pre">User</span></tt> model with a <tt class="docutils literal"><span class="pre">birthday</span></tt>
column and we want to validate that the date is in the past.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;birthday&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;past&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">birthday</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">timestamp</span>
      <span class="l-Scalar-Plain">past</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if we try and set a birthday that is not in the past we will get a
validation error.</p>
</div>
<div class="section" id="future">
<h3>Future<a class="headerlink" href="#future" title="Permalink to this headline">¶</a></h3>
<p>The future validator is the opposite of the past validator and checks if
the given value is a valid date in the future. In this example we&#8217;ll
have a <tt class="docutils literal"><span class="pre">User</span></tt> model with a <tt class="docutils literal"><span class="pre">next_appointment_date</span></tt> column and we
want to validate that the date is in the future.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;next_appointment_date&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;future&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">next_appointment_date</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">timestamp</span>
      <span class="l-Scalar-Plain">future</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if we try and set an appointment date that is not in the future we
will get a validation error.</p>
</div>
<div class="section" id="min-length">
<h3>Min Length<a class="headerlink" href="#min-length" title="Permalink to this headline">¶</a></h3>
<p>The min length does exactly what it says. It checks that the value
string length is greater than the specified minimum length. In this
example we will have a <tt class="docutils literal"><span class="pre">User</span></tt> model with a <tt class="docutils literal"><span class="pre">password</span></tt> column where
we want to make sure the length of the <tt class="docutils literal"><span class="pre">password</span></tt> is at least 5
characters long.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">,</span> <span class="k">null</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;minlength&#39;</span> <span class="o">=&gt;</span> <span class="mi">5</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">password</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">timestamp</span>
      <span class="l-Scalar-Plain">minlength</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">5</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if we try and save a <tt class="docutils literal"><span class="pre">User</span></tt> with a <tt class="docutils literal"><span class="pre">password</span></tt> that is shorter
than 5 characters, the validation will fail.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// test.php</span>

<span class="c1">// ...</span>
<span class="nv">$user</span>           <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">&#39;jwage&#39;</span><span class="p">;</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">password</span> <span class="o">=</span> <span class="s1">&#39;test&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid because &quot;test&quot; is only 4 characters long!&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="country">
<h3>Country<a class="headerlink" href="#country" title="Permalink to this headline">¶</a></h3>
<p>The country validator checks if the given value is a valid country code.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;country&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">country</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(2)</span>
      <span class="l-Scalar-Plain">country</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if you try and save a <tt class="docutils literal"><span class="pre">User</span></tt> with an invalid country code the
validation will fail.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// test.php</span>

<span class="c1">// ...</span>
<span class="nv">$user</span>               <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span>     <span class="o">=</span> <span class="s1">&#39;jwage&#39;</span><span class="p">;</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">country_code</span> <span class="o">=</span> <span class="s1">&#39;zz&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid because &quot;zz&quot; is not a valid country code!&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ip-address">
<h3>IP Address<a class="headerlink" href="#ip-address" title="Permalink to this headline">¶</a></h3>
<p>The ip address validator checks if the given value is a valid ip
address.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;ip_address&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;ip&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">ip_address</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(15)</span>
      <span class="l-Scalar-Plain">ip</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if you try and save a <tt class="docutils literal"><span class="pre">User</span></tt> with an invalid ip address the
validation will fail.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$user</span>             <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span>   <span class="o">=</span> <span class="s1">&#39;jwage&#39;</span><span class="p">;</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">ip_address</span> <span class="o">=</span> <span class="s1">&#39;123.123&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid because &quot;123.123&quot; is not a valid ip address&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="html-color">
<h3>HTML Color<a class="headerlink" href="#html-color" title="Permalink to this headline">¶</a></h3>
<p>The html color validator checks that the given value is a valid html hex
color.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;favorite_color&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;htmlcolor&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<p>Now if you try and save a <tt class="docutils literal"><span class="pre">User</span></tt> with an invalid html color value for
the <tt class="docutils literal"><span class="pre">favorite_color</span></tt> column the validation will fail.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// test.php</span>

<span class="c1">// ...</span>
<span class="nv">$user</span>                 <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span>       <span class="o">=</span> <span class="s1">&#39;jwage&#39;</span><span class="p">;</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">favorite_color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid because &quot;red&quot; is not a valid hex color&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="range">
<h3>Range<a class="headerlink" href="#range" title="Permalink to this headline">¶</a></h3>
<p>The range validator checks if value is within given range of numbers.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;range&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">age</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">integer(3)</span>
      <span class="l-Scalar-Plain">range</span><span class="p-Indicator">:</span> <span class="p-Indicator">[</span><span class="nv">10</span><span class="p-Indicator">,</span> <span class="nv">100</span><span class="p-Indicator">]</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if you try and save a <tt class="docutils literal"><span class="pre">User</span></tt> with an age that is less than 10 or
greater than 100, the validation will fail.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// test.php</span>

<span class="c1">// ...</span>
<span class="nv">$user</span>           <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">&#39;jwage&#39;</span><span class="p">;</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">age</span>      <span class="o">=</span> <span class="s1">&#39;3&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid because &quot;3&quot; is less than the minimum of &quot;10&quot;&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can use the <tt class="docutils literal"><span class="pre">range</span></tt> validator to validate max and min values by
omitting either one of the <tt class="docutils literal"><span class="pre">0</span></tt> or <tt class="docutils literal"><span class="pre">1</span></tt> keys of the range array. Below
is an example:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;range&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span><span class="mi">1</span> <span class="o">=&gt;</span> <span class="mi">100</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above would make it so that age has a max of 100. To have a minimum
value simple specify <tt class="docutils literal"><span class="pre">0</span></tt> instead of <tt class="docutils literal"><span class="pre">1</span></tt> in the range array.</p>
<p>The YAML syntax for this would look like the following:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">age</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">integer(3)</span>
      <span class="l-Scalar-Plain">range</span><span class="p-Indicator">:</span>
        <span class="l-Scalar-Plain">1</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">100</span>
<span class="c1"># ...</span>
</pre></div>
</div>
</div>
<div class="section" id="unique">
<h3>Unique<a class="headerlink" href="#unique" title="Permalink to this headline">¶</a></h3>
<p>Unique constraints ensure that the data contained in a column or a group
of columns is unique with respect to all the rows in the table.</p>
<p>In general, a unique constraint is violated when there are two or more
rows in the table where the values of all of the columns included in the
constraint are equal. However, two null values are not considered equal
in this comparison. That means even in the presence of a unique
constraint it is possible to store duplicate rows that contain a null
value in at least one of the constrained columns. This behavior conforms
to the SQL standard, but some databases do not follow this rule. So be
careful when developing applications that are intended to be portable.</p>
<p>The following definition uses a <tt class="docutils literal"><span class="pre">unique</span></tt> constraint for column
username.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;unique&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(255)</span>
      <span class="l-Scalar-Plain">unique</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You should only use unique constraints for columns other
than the primary key because they are always unique already.</p>
</div>
</div>
<div class="section" id="regular-expression">
<h3>Regular Expression<a class="headerlink" href="#regular-expression" title="Permalink to this headline">¶</a></h3>
<p>The regular expression validator is a simple way to validate column
values against your own provided regular expression. In this example we
will make sure the username contains only valid letters or numbers.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;regexp&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;/[a-zA-Z0-9]/&#39;</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">username</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(255)</span>
      <span class="l-Scalar-Plain">regexp</span><span class="p-Indicator">:</span> <span class="s">&#39;/^[a-zA-Z0-9]+$/&#39;</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if we were to try and save a <tt class="docutils literal"><span class="pre">User</span></tt> with a <tt class="docutils literal"><span class="pre">username</span></tt> that has
any other character than a letter or number in it, the validation will
fail:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// test.php</span>

<span class="c1">// ...</span>
<span class="nv">$user</span>           <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">&#39;[jwage&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid because the username contains a [ character&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="credit-card">
<h3>Credit Card<a class="headerlink" href="#credit-card" title="Permalink to this headline">¶</a></h3>
<p>The credit card validator simply checks that the given value is indeed a
valid credit card number.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;cc_number&#39;</span><span class="p">,</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;creditcard&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">cc_number</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">integer(16)</span>
      <span class="l-Scalar-Plain">creditcard</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
</div>
<div class="section" id="read-only">
<h3>Read Only<a class="headerlink" href="#read-only" title="Permalink to this headline">¶</a></h3>
<p>The read only validator will fail validation if you modify a column that
has the <tt class="docutils literal"><span class="pre">readonly</span></tt> validator enabled on it.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;readonly_value&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;readonly&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">readonly_value</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">integer(16)</span>
      <span class="l-Scalar-Plain">readonly</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if I ever try and modify the column named <tt class="docutils literal"><span class="pre">readonly_value</span></tt> from a
<tt class="docutils literal"><span class="pre">User</span></tt> object instance, validation will fail.</p>
</div>
<div class="section" id="unsigned">
<h3>Unsigned<a class="headerlink" href="#unsigned" title="Permalink to this headline">¶</a></h3>
<p>The unsigned validator checks that the given integer value is unsigned.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/User.php</span>
<span class="k">class</span> <span class="nc">User</span> <span class="k">extends</span> <span class="nx">BaseUser</span>
<span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="k">parent</span><span class="o">::</span><span class="na">setTableDefinition</span><span class="p">();</span>

        <span class="c1">// ...</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;unsigned&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="c1"># ...</span>
<span class="l-Scalar-Plain">User</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
<span class="c1"># ...</span>
    <span class="l-Scalar-Plain">age</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">integer(3)</span>
      <span class="l-Scalar-Plain">unsigned</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="c1"># ...</span>
</pre></div>
</div>
<p>Now if I try and save a <tt class="docutils literal"><span class="pre">User</span></tt> with a negative age the validation will
fail:</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// test.php</span>

<span class="c1">// ...</span>
<span class="nv">$user</span>           <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">();</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">username</span> <span class="o">=</span> <span class="s1">&#39;jwage&#39;</span><span class="p">;</span>
<span class="nv">$user</span><span class="o">-&gt;</span><span class="na">age</span>      <span class="o">=</span> <span class="s1">&#39;-100&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$user</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;User is invalid because -100 is signed&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="us-state">
<h3>US State<a class="headerlink" href="#us-state" title="Permalink to this headline">¶</a></h3>
<p>The us state validator checks that the given string is a valid US state
code.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="c1">// models/State.php</span>
<span class="k">class</span> <span class="nc">State</span> <span class="k">extends</span> <span class="nx">Doctrine_Record</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">setTableDefinition</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">255</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">hasColumn</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span>
                <span class="s1">&#39;usstate&#39;</span> <span class="o">=&gt;</span> <span class="k">true</span>
            <span class="p">)</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here is the same example in YAML format. You can read more about YAML in
the <a class="reference internal" href="yaml-schema-files.html"><em>YAML Schema Files</em></a> chapter:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="nn">---</span>
<span class="c1"># schema.yml</span>

<span class="l-Scalar-Plain">State</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">columns</span><span class="p-Indicator">:</span>
    <span class="l-Scalar-Plain">name</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(255)</span>
    <span class="l-Scalar-Plain">code</span><span class="p-Indicator">:</span>
      <span class="l-Scalar-Plain">type</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">string(2)</span>
      <span class="l-Scalar-Plain">usstate</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
</pre></div>
</div>
<p>Now if I try and save a <tt class="docutils literal"><span class="pre">State</span></tt> with an invalid state code then the
validation will fail.</p>
<div class="highlight-php"><div class="highlight"><pre><span class="nv">$state</span>       <span class="o">=</span> <span class="k">new</span> <span class="nx">State</span><span class="p">();</span>
<span class="nv">$state</span><span class="o">-&gt;</span><span class="na">name</span> <span class="o">=</span> <span class="s1">&#39;Tennessee&#39;</span><span class="p">;</span>
<span class="nv">$state</span><span class="o">-&gt;</span><span class="na">code</span> <span class="o">=</span> <span class="s1">&#39;ZZ&#39;</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span> <span class="o">!</span> <span class="nv">$state</span><span class="o">-&gt;</span><span class="na">isValid</span><span class="p">()</span> <span class="p">)</span>
<span class="p">{</span>
    <span class="k">echo</span> <span class="s1">&#39;State is invalid because &quot;ZZ&quot; is not a valid state code&#39;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>If we want Doctrine to validate our data before being persisted to the
database, now we have the knowledge on how to do it. We can use the
validators that are provided with the Doctrine core to perform common
validations of our data.</p>
<p>The <a class="reference internal" href="inheritance.html"><em>Inheritance</em></a> is an important one as we will
discuss a great feature of Doctrine, <a class="reference internal" href="inheritance.html"><em>Inheritance</em></a>!
Inheritance is a great way accomplish complex functionality with minimal
code. After we discuss inheritance we will move on to a custom strategy
that provides even better functionality than inheritance, called <a class="reference internal" href="behaviors.html"><em>Behaviors</em></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Data Validation</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#not-null">Not Null</a></li>
<li><a class="reference internal" href="#email">Email</a></li>
<li><a class="reference internal" href="#not-blank">Not Blank</a></li>
<li><a class="reference internal" href="#no-space">No Space</a></li>
<li><a class="reference internal" href="#past">Past</a></li>
<li><a class="reference internal" href="#future">Future</a></li>
<li><a class="reference internal" href="#min-length">Min Length</a></li>
<li><a class="reference internal" href="#country">Country</a></li>
<li><a class="reference internal" href="#ip-address">IP Address</a></li>
<li><a class="reference internal" href="#html-color">HTML Color</a></li>
<li><a class="reference internal" href="#range">Range</a></li>
<li><a class="reference internal" href="#unique">Unique</a></li>
<li><a class="reference internal" href="#regular-expression">Regular Expression</a></li>
<li><a class="reference internal" href="#credit-card">Credit Card</a></li>
<li><a class="reference internal" href="#read-only">Read Only</a></li>
<li><a class="reference internal" href="#unsigned">Unsigned</a></li>
<li><a class="reference internal" href="#us-state">US State</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="yaml-schema-files.html"
                        title="previous chapter">YAML Schema Files</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="data-hydrators.html"
                        title="next chapter">Data Hydrators</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/en/manual/data-validation.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="data-hydrators.html" title="Data Hydrators"
             >next</a> |</li>
        <li class="right" >
          <a href="yaml-schema-files.html" title="YAML Schema Files"
             >previous</a> |</li>
        <li><a href="../../index.html">Doctrine 1.2.4 documentation</a> &raquo;</li>
          <li><a href="../index.html" >English Documentation</a> &raquo;</li>
          <li><a href="index.html" >Doctrine 1.2 ORM Manual</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Jonathan Wage and Contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>