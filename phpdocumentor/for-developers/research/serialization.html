
<!DOCTYPE html>

<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <title>Serialization &mdash; phpDocumentor</title>

    <link rel="stylesheet" href="../../_static/default.css" type="text/css"/>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css"/>
    <!--<link rel="stylesheet" href="../../_static/configurationblock.css" type="text/css"/>-->

    <link href="../../_static/css/template.css" rel="stylesheet" media="all">
    <style>
        h1 {
            font-family: serif;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            color: #333;
        }
        h2:first-of-type {
            margin-top: 25px;
        }
        h2 {
            font-family: serif;
            color: #333;
            border: none;
            font-style: italic;
            margin-top: 15px;
        }
        .well table.docutils {
            width: 100%;
        }
    </style>

    <script src="../../_static/js/jquery-1.7.1.min.js" type="text/javascript"></script>
    <script src="../../_static/js/jquery-ui-1.8.2.custom.min.js" type="text/javascript"></script>
    <script src="../../_static/js/bootstrap.js" type="text/javascript"></script>
    <script src="../../_static/js/prettify/prettify.min.js" type="text/javascript"></script>
    <script type="text/javascript">

        function equalHeight(group) {
            var tallest = 0;

            group.each(function() {
                var thisHeight = $(this).height();
                if(thisHeight > tallest) {
                    tallest = thisHeight;
                }
            });

            group.height(tallest);
        }

        $(document).ready(function() {
            $('.contents .row').each(function() {
                equalHeight(jQuery(this).find('.well'));
            });

            // remove the classes added by Sphinx; the container class is
            // used in Twitter bootstrap and this collides
            $('.container .container').removeClass('container');
        });
    </script>

    <link rel="shortcut icon" href="http://demo.phpdoc.org/Responsive/img/favicon.ico">
    <link rel="apple-touch-icon" href="http://demo.phpdoc.org/Responsive/img/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://demo.phpdoc.org/Responsive/img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://demo.phpdoc.org/Responsive/img/apple-touch-icon-114x114.png">
        <link rel="top" title="phpDocumentor" href="../../index.html"/>
        <link rel="up" title="Research" href="../research.html"/>
        <link rel="prev" title="Research" href="../research.html"/> 
</head>
<body>

<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </a>
            <a class="brand" href="/">phpDocumentor</a>

            <div class="nav-collapse">
                <ul class="nav">
                    <li class="dropdown">
                        <a href="#documentation" class="dropdown-toggle" data-toggle="dropdown"> Documentation<b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="/docs/"><i class="icon-th"></i> phpDocumentor 2</a></li>
                            <li><a href="http://manual.phpdoc.org"><i class="icon-th"></i> phpDocumentor 1</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#demo" class="dropdown-toggle" data-toggle="dropdown"> Demo<b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="http://demo.phpdoc.org/Responsive/"><i class="icon-list-alt"></i> Responsive</a></li>
                        </ul>
                    </li>
                    <li><a href="/templates"><i class="icon-list-alt"></i> Templates</a></li>
                    <li><a href="/contact"><i class="icon-list-alt"></i> Contact</a></li>
                    <li><a href="/about"><i class="icon-list-alt"></i> About</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="go_to_top"><a href="#___" style="color: inherit">Back to top <i class="icon-upload icon-white"></i></a></div>
</div>
<div id="___" class="container">
    <noscript>
        <div class="alert alert-warning">
            Javascript is disabled; several features are only available if Javascript is enabled.
        </div>
    </noscript>

    <div class="row">
        <div class="span3">
        <h3><a href="../../index.html">Table Of Contents</a>
        </h3>
        <ul>
<li><a class="reference internal" href="#">Serialization</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#benchmark-subjects">Benchmark subjects</a></li>
<li><a class="reference internal" href="#methodology">Methodology</a></li>
<li><a class="reference internal" href="#results">Results</a><ul>
<li><a class="reference internal" href="#id1">Zend Framework 2</a></li>
<li><a class="reference internal" href="#id2">Magento 2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>

        <h4>Previous topic</h4>

        <p class="topless"><a href="../research.html"
                              title="previous chapter">Research</a></p>
        <div id="searchbox" style="display: none">
            <h3>Search</h3>

            <form class="search" action="../../search.html" method="get">
                <input type="text" name="q" size="18"/>
                <input type="submit" value="Go"/>
                <input type="hidden" name="check_keywords" value="yes"/>
                <input type="hidden" name="area" value="default"/>
            </form>
        </div>
        <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
        <div class="span9 contents">
            <div class="breadcrumb">
<div class="related">
    <h3>Navigation</h3>
    <ul>
        <li class="right" style="margin-right: 10px; margin-top: 6px;">
            <a href="../../genindex.html" title="General Index" accesskey="I">
                index
            </a>
        </li>
        <li class="right" style="margin-right: 10px; margin-top: 6px;">
            <a href="../research.html" title="Research" accesskey="P">
                previous
            </a> |
        </li>
        <li>
            <a href="http://www.phpdoc.org">Homepage</a>  &raquo;
        </li>
        <li>
            <a href="../../index.html">Documentation</a>  &raquo;
        </li>
        <li>
            <a href="../../for-developers.html" >
                For developers
            </a>  &raquo;
        </li>
        <li>
            <a href="../research.html" accesskey="U">
                Research
            </a>  &raquo;
        </li> 
    </ul>
</div>
            </div>

            
            <div class="well">
            

            
  <div class="section" id="serialization">
<h1>Serialization<a class="headerlink" href="#serialization" title="Permalink to this headline">¶</a></h1>
<div class="section" id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>The goal of this research is to determine whether it is feasable to have the full Syntax Tree in memory using objects
and to be able to serialize and deserialize those objects within a given set of <a href="#id3"><span class="problematic" id="id4">`parameters`_</span></a>.</p>
<p>The outcome of this research should be whether the object model can be stored in memory and which serialization methods
perform best.</p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>phpDocumentor currently parses aggregated data from PHP source files and exports that directly to XML; where the
transformer reads the XML, alters the state and feeds this directly to the XSL Processor. This approach had been
chosen for it&#8217;s speed, straight-forward implementation and to reduce memory usage but increase speed.</p>
<p>During development it is noticed that this approach has several disadvantages:</p>
<ol class="arabic simple">
<li>XSL is complicated to write and thus not suited for all audiences</li>
<li>XSL relies on a PHP extension that is not always available</li>
<li>Inheritance is implemented by copying data from parent elements to child elements, which is slow
and memory intensive.</li>
<li>Processing the XML document has memory usage in the libXML library that is not detected by PHP and thus takes more
than originally intended.</li>
<li>Impossible to use a different file type or back end for the AST because the transformation process relies on XML.</li>
<li>Transformation writers that rely on an object model (such as Twig) can have trouble navigating using
SimpleXMLElement objects.</li>
</ol>
<p>It is expected that by using a normal object model instead of relying on the SimpleXMLElement classes and direct
modification of the XML will result in a faster, more flexible system.</p>
</div>
<div class="section" id="benchmark-subjects">
<h2>Benchmark subjects<a class="headerlink" href="#benchmark-subjects" title="Permalink to this headline">¶</a></h2>
<p>This research will use other Open Source projects as subjects in order to determine effectiveness of this approach.</p>
<p>The following projects have been selected:</p>
<ul>
<li><dl class="first docutils">
<dt><a class="reference external" href="https://github.com/zendframework/zf2">Zend Framework 2</a>, with 249,505 lines of code and 1472 classes is this</dt>
<dd><p class="first last">library a perfect fit to represent a <strong>large</strong> project.</p>
</dd>
</dl>
</li>
<li><p class="first"><a class="reference external" href="https://github.com/magento/magento2">Magento 2</a>, with 1,348,396 lines of code and 7573 classes is this application
a good example of a <strong>huge</strong> project.</p>
</li>
</ul>
<p>Important to note is that this research does not describe or compare the qualities of aforementioned projects, they
serve merely to benchmark the creation of an object model and to measure the effectiveness of several serialization
methods.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Originally there were several more benchmark subjects planned, due to similar results between Zend Framework 2 and
Magento 2 these have been cancelled; given the nature of the results of this research the conclusion was clear.</p>
</div>
</div>
<div class="section" id="methodology">
<h2>Methodology<a class="headerlink" href="#methodology" title="Permalink to this headline">¶</a></h2>
<p>The approach to finding an answer to this problem consists of the following actions:</p>
<ol class="arabic simple">
<li>Find different methods of serialization to compare.</li>
<li>Populate a representative data set.</li>
<li>Attempt to serialize the data set and register the following characteristics:<ol class="arabic">
<li>Amount of time in seconds until serialization is completed.</li>
<li>Amount of time in seconds until deserialization is completed.</li>
<li>Number of megabytes memory usage at the peak of execution.</li>
<li>Size of the resulting artifact in kilobytes.</li>
</ol>
</li>
<li>Populate a data set known to be exceptionally large.</li>
<li>For each method of serialization; attempt to serialize the second data set and register the characteristics
mentioned in step 3.</li>
<li>Aggregate the results and determine the conclusion.</li>
</ol>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Zend Framework 2<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p><strong>Serialization</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="11%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Pass 1</th>
<th class="head">Pass 2</th>
<th class="head">Pass 3</th>
<th class="head">Pass 4</th>
<th class="head">Pass 5</th>
<th class="head">Mean</th>
<th class="head">File size</th>
<th class="head">Peak memory used</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>serialize</td>
<td>1.0004</td>
<td>0.9158</td>
<td>0.8801</td>
<td>0.9901</td>
<td>0.9609</td>
<td>0.9494</td>
<td>14.0mb</td>
<td>+60mb</td>
</tr>
<tr class="row-odd"><td>json_encode</td>
<td>0.2663</td>
<td>0.4634</td>
<td>0.2790</td>
<td>0.2588</td>
<td>0.3098</td>
<td>0.3155</td>
<td>8.8mb</td>
<td>+16mb</td>
</tr>
<tr class="row-even"><td>igbinary_serialize</td>
<td>0.2253</td>
<td>0.2107</td>
<td>0.2038</td>
<td>0.2875</td>
<td>0.1979</td>
<td>0.2250</td>
<td>3.3mb</td>
<td><ul class="first last simple">
<li>7mb</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><strong>Deserialization</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Pass 1</th>
<th class="head">Pass 2</th>
<th class="head">Pass 3</th>
<th class="head">Pass 4</th>
<th class="head">Pass 5</th>
<th class="head">Mean</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>deserialize</td>
<td>2.6614</td>
<td>1.5656</td>
<td>1.7147</td>
<td>2.5170</td>
<td>1.5732</td>
<td>2.006</td>
</tr>
<tr class="row-odd"><td>json_decode</td>
<td>0.6404</td>
<td>0.5388</td>
<td>0.7459</td>
<td>0.5162</td>
<td>0.4181</td>
<td>0.5719</td>
</tr>
<tr class="row-even"><td>igbinary_deserialize</td>
<td>0.3245</td>
<td>0.2466</td>
<td>0.3035</td>
<td>0.1993</td>
<td>0.1924</td>
<td>0.2533</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">json_decode does not know how to transform classes back to their original types
because json by nature does not store such information. This will decrease the value
of json_decode as type-retention is desirable in the context of this application.</p>
</div>
</div>
<div class="section" id="id2">
<h3>Magento 2<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p><strong>Serialization</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="11%" />
<col width="20%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Pass 1</th>
<th class="head">Pass 2</th>
<th class="head">Pass 3</th>
<th class="head">Pass 4</th>
<th class="head">Pass 5</th>
<th class="head">Mean</th>
<th class="head">File size</th>
<th class="head">Peak memory used</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>serialize</td>
<td>4.0912</td>
<td>3.1885</td>
<td>3.8392</td>
<td>3.3655</td>
<td>3.1090</td>
<td>3.5187</td>
<td>55mb</td>
<td>+269mb</td>
</tr>
<tr class="row-odd"><td>json_encode</td>
<td>1.0389</td>
<td>1.6685</td>
<td>2.3115</td>
<td>1.0769</td>
<td>3.1391</td>
<td>1.8470</td>
<td>45mb</td>
<td>+78mb</td>
</tr>
<tr class="row-even"><td>igbinary_serialize</td>
<td>2.0011</td>
<td>0.8306</td>
<td>1.2812</td>
<td>2.1513</td>
<td>1.6902</td>
<td>1.5909</td>
<td>14mb</td>
<td>+31mb</td>
</tr>
</tbody>
</table>
<p><strong>Deserialization</strong></p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Pass 1</th>
<th class="head">Pass 2</th>
<th class="head">Pass 3</th>
<th class="head">Pass 4</th>
<th class="head">Pass 5</th>
<th class="head">Mean</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>deserialize</td>
<td>27.9888</td>
<td>27.0000</td>
<td>29.0000</td>
<td>29.0000</td>
<td>27.1046</td>
<td>28.0187</td>
</tr>
<tr class="row-odd"><td>json_decode</td>
<td>1.9304</td>
<td>4.6521</td>
<td>2.6136</td>
<td>1.4787</td>
<td>1.4096</td>
<td>2.4168</td>
</tr>
<tr class="row-even"><td>igbinary_deserialize</td>
<td>2.3876</td>
<td>2.5162</td>
<td>1.3756</td>
<td>1.5820</td>
<td>0.9632</td>
<td>1.7649</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">json_decode does not know how to transform classes back to their original types
because json by nature does not store such information. This will decrease the value
of json_decode as type-retention is desirable in the context of this application.</p>
</div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Based on this research the following conclusions could be made based on the previous results and the following
corollary,</p>
<blockquote>
<div><p>ZF2 is 18.5% LOC of Magento 2 (thus Magento 2 is 5.5 times the size of ZF2)</p>
<p>Serialize&#8217;s speed on ZF2 was 27.0% of Magento 2  (less than 4-fold increase)
JsonEncode&#8217;s speed on ZF2 was 17.1% of Magento 2 (almost 6-fold increase)
IGB&#8217;s speed on ZF2 was 14.1% of Magento 2 (seven-fold increase)</p>
<p>Memory size for all methods on ZF2 was approx. 20% of Magento 2 (5 fold increase)</p>
</div></blockquote>
<p>Igbinary outperforms serialize by far both in terms of memory and speed, where JSON Encode follows closely as second.
It can be seen that igbinary becomes less efficient if the dataset is larger but given igbinary&#8217;s inherent efficiency
does this scale sufficiently for the purposes of phpDocumentor.</p>
<p>A large downside for json_encode and json_decode is that it does not remember which class was associated with a
serialized object. For phpDocumentor this is important because this takes additional effort when rebuilding the object
model.</p>
<p>Another conclusion is that it is feasable for phpDocumentor to hold the object model of a large and even huge scale
application, Zend Framework&#8217;s object model using this POC was 111mb and Magento&#8217;s was 498mb. This also shows that it is
with reasonable certainty that we can determine that the used memory for a model rises just as fast percentually as the
amount of LOC in large to huge projects.</p>
</div>
</div>



            
            </div>
            
        </div>
    </div>

  <div class="row">
    <footer class="span12">
        <p>
            Created using <a
                href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
        </p>
    </footer>
  </div>
</div>

</body>
</html>