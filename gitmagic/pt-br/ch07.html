
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta name="generator" content=
  "HTML Tidy for Linux (vers 25 March 2009), see www.w3.org">
  <meta http-equiv="Content-Type" content=
  "text/html; charset=utf-8">

  <title>Git Magic - Capítulo 7. Grão-Mestre Git</title>
  <link rel="stylesheet" type="text/css" href="default.css">
  <meta name="generator" content="DocBook XSL Stylesheets V1.76.1">
  <link rel="home" href="index.html" title="Magia Git">
  <link rel="up" href="index.html" title="Magia Git">
  <link rel="prev" href="ch06.html" title=
  "Capítulo 6. Git Multiplayer">
  <link rel="next" href="ch08.html" title=
  "Capítulo 8. Segredos Revelados">
</head>

<body bgcolor="white" text="black" link="#0000FF" vlink="#840084"
alink="#0000FF">
    <div class="toc">
      <ul>
<li><b>Git Magic</b></li>
        <li>
          <span class="preface"><a href=
          "index.html">Prefácio</a></span>

          <ul>
            <li><span class="section"><a href=
            "index.html#_agradecimentos">Agradecimentos!</a></span></li>

            <li><span class="section"><a href=
            "index.html#_licen%C3%A7a">Licença</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch01.html">1.
          Introdução</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch01.html#_trabalhar_%C3%A9_divertido">Trabalhar é
            Divertido</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_controle_de_vers%C3%B5es">Controle de
            Versões</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_controle_distribu%C3%ADdo">Controle
            distribuído</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_uma_supersti%C3%A7%C3%A3o">Uma
            superstição</a></span></li>

            <li><span class="section"><a href=
            "ch01.html#_conflitos_de_mesclagem_merge">Conflitos de
            mesclagem (Merge)</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch02.html">2. Truques
          básicos</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch02.html#_salvando_estados">Salvando
            estados</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_adicionar_remover_renomear">Adicionar,
            Remover, Renomear</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_desfazer_refazer_avan%C3%A7ado">Desfazer/Refazer
            avançado</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_revertendo">Revertendo</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_gera%C3%A7%C3%A3o_do_changelog">Geração do
            Changelog</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_download_de_arquivos">Download de
            arquivos</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_a_%C3%BAltima_vers%C3%A3o">A Última
            Versão</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_publica%C3%A7%C3%A3o_instant%C3%A2nea">Publicação
            instantânea</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_o_que_eu_fiz">O que eu fiz?</a></span></li>

            <li><span class="section"><a href=
            "ch02.html#_exerc%C3%ADcios">Exercícios</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch03.html">3. Um pouco de
          clonagem</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch03.html#_sincronizando_computadores">Sincronizando
            Computadores</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_controle_cl%C3%A1ssico_de_c%C3%B3digo">Controle
            clássico de código</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_codigo_fonte_secreto">Codigo-fonte
            secreto</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_repositorios_vazios">Repositorios
            Vazios</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_push_versus_pull">Push versus
            Pull</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_fazendo_um_fork_do_projeto">Fazendo um Fork
            do Projeto</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_backup_supremos">Backup
            Supremos</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_multitarefa_na_velocidade_da_luz">Multitarefa
            na velocidade da luz</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_controle_de_vers%C3%B5es_de_guerrilha">Controle
            de Versões de Guerrilha</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_mercurial">Mercurial</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_bazaar">Bazaar</a></span></li>

            <li><span class="section"><a href=
            "ch03.html#_por_que_uso_o_git">Por que uso o
            Git?</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch04.html">4. Bruxarias
          com branch</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch04.html#_a_tecla_chefe">A “tecla”
            chefe</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_trabalho_porco">Trabalho
            porco</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_corre%C3%A7%C3%B5es_r%C3%A1pidas">Correções
            rápidas</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_merging">Merging</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_fluxo_ininterrupto">Fluxo
            ininterrupto</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_reorganizando_uma_bagun%C3%A7a">Reorganizando
            uma Bagunça</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_gerenciando_os_branches">Gerenciando os
            Branches</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_branches_tempor%C3%A1rios">Branches
            Temporários</a></span></li>

            <li><span class="section"><a href=
            "ch04.html#_trabalhe_como_quiser">Trabalhe como
            quiser</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch05.html">5. Lições de
          historia</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch05.html#_eu_corrijo">Eu corrijo</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_8230_e_tem_mais">… e tem
            mais</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_altera%C3%A7%C3%B5es_locais_por_%C3%BAltimo">
            Alterações locais por último</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_reescrevendo_o_hist%C3%B3rico">Reescrevendo
            o histórico</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_fazendo_hist%C3%B3ria">Fazendo
            história</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_onde_foi_que_tudo_deu_errado">Onde foi que
            tudo deu errado?</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_quem_fez_tudo_dar_errado">Quem fez tudo dar
            errado?</a></span></li>

            <li><span class="section"><a href=
            "ch05.html#_experi%C3%AAncia_pessoal">Experiência
            pessoal</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch06.html">6. Git
          Multiplayer</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch06.html#_quem_sou_eu">Quem sou eu?</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_sob_ssh_http">Git sob SSH,
            HTTP</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_git_sobre_qualquer_coisa">Git sobre
            qualquer coisa</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_patches_a_moeda_universal">Patches: A moeda
            Universal</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_sinto_muito_mas_mudamos">Sinto muito, mas
            mudamos</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_branches_remotos">Branches
            Remotos</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_remotos_m%C3%BAltiplos">Remotos
            Múltiplos</a></span></li>

            <li><span class="section"><a href=
            "ch06.html#_minhas_preferencias">Minhas
            preferencias</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch07.html">7. Grão-Mestre
          Git</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch07.html#_disponibiliza%C3%A7%C3%A3o_de_c%C3%B3digo">Disponibilização
            de Código</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_commit_do_que_mudou">Commit do que
            Mudou</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_meu_commit_%C3%A9_muito_grande">Meu Commit
            é muito Grande!</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_o_indice_a_%C3%A1rea_de_atua%C3%A7%C3%A3o_do_git">
            O Indice: A Área de Atuação do Git</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_n%C3%A3o_perca_a_cabe%C3%A7a_head">Não
            perca a CABEÇA (HEAD)</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_explorando_o_head">Explorando o
            HEAD</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_baseando_se_no_git">Baseando se no
            Git</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_manobras_radicais">Manobras
            Radicais</a></span></li>

            <li><span class="section"><a href=
            "ch07.html#_preven%C3%A7%C3%A3o_a_maus_commits">Prevenção
            a maus Commits</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch08.html">8. Segredos
          Revelados</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch08.html#_invisibilidade">Invisibilidade</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_integridade">Integridade</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_intelig%C3%AAncia">Inteligência</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_indexando">Indexando</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_origem_do_git">Origem do
            Git</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_o_banco_de_dados_de_objetos">O Banco de
            Dados de Objetos</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_blobs">Blobs</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_%C3%A1rvores">Árvores</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_commits">Commits</a></span></li>

            <li><span class="section"><a href=
            "ch08.html#_indistingu%C3%ADvel_da_magia">Indistinguível
            da Magia</a></span></li>
          </ul>
        </li>

        <li>
          <span class="chapter"><a href="ch09.html">9. Apêndice A:
          Deficiências do Git</a></span>

          <ul>
            <li><span class="section"><a href=
            "ch09.html#_pontos_fracos_do_sha1">Pontos fracos do
            SHA1</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_microsoft_windows">Microsoft
            Windows</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_arquivos_independentes">Arquivos
            Independentes</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_quem_est%C3%A1_editando_o_que">Quem Está
            Editando O Que?</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_arquivo_do_hist%C3%B3rico">Arquivo do
            Histórico</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_clone_inicial">Clone
            Inicial</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_projetos_vol%C3%A1teis">Projetos
            Voláteis</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_contador_global">Contador
            Global</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_subdiret%C3%B3rios_vazios">Subdiretórios
            Vazios</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_commit_inicial">Commit
            Inicial</a></span></li>

            <li><span class="section"><a href=
            "ch09.html#_peculiaridades_da_interface">Peculiaridades
            da Interface</a></span></li>
          </ul>
        </li>

        <li><span class="chapter"><a href="ch10.html">10. Apendice
        B: Traduzindo esse guia</a></span></li>
      </ul>
    </div>
<div class="content">
  <div class="chapter" title="Capítulo 7. Grão-Mestre Git">
    <div class="titlepage">
      <div>
        <div>
          <h2 class="title"><a name=
          "_gr%C3%A3o_mestre_git"></a>Capítulo 7. Grão-Mestre
          Git</h2>
        </div>
      </div>
    </div>

    <p>Até agora, você deve ser capaz de navegar pelas páginas do
    <span class="strong"><strong>git help</strong></span> e
    entender quase tudo. Entretanto, identificar o comando exato
    para resolver um dados problema pode ser tedioso. Talvez possa
    economizar algum tempo seu: a seguir estão algumas receitas que
    precisei no passado.</p>

    <div class="section" title="Disponibilização de Código">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_disponibiliza%C3%A7%C3%A3o_de_c%C3%B3digo"></a>Disponibilização
            de Código</h2>
          </div>
        </div>
      </div>

      <p>Para meus projetos, o Git organiza exatamente os arquivos
      que quero guardar e disponibilizar para os usuários. Para
      criar um tarball do código fonte, executo:</p>
      <pre class="literallayout">
$ git archive --format=tar --prefix=proj-1.2.3/ HEAD
</pre>
    </div>

    <div class="section" title="Commit do que Mudou">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_commit_do_que_mudou"></a>Commit do que Mudou</h2>
          </div>
        </div>
      </div>

      <p>Mostrar ao Git quando adicionamos, apagamos e/ou
      renomeamos arquivos pode ser problemático em alguns projetos.
      Em vez disso, você pode digitar:</p>
      <pre class="literallayout">
$ git add .
$ git add -u
</pre>

      <p>O Git analisará os arquivos no diretório atual e trabalhar
      nos detalhes, automaticamente. No lugar do segundo comando
      add, execute <code class="literal">git commit -a</code> se
      sua intenção é efetuar um commit neste momento. Veja
      <span class="strong"><strong>git help ignore</strong></span>
      para saber como especificar os arquivos que devem ser
      ignorados.</p>

      <p>Você pode executar isto em apenas um passo com:</p>
      <pre class="literallayout">
$ git ls-files -d -m -o -z | xargs -0 git update-index --add --remove
</pre>

      <p>As opções <span class="strong"><strong>-z</strong></span>
      e <span class="strong"><strong>-0</strong></span> previnem
      contra os transtornos de arquivos com caracteres estranhos no
      nome. Note que este comando adiciona os arquivos ignorados.
      Logo, você pode querer usar as opções <code class=
      "literal">-x</code> ou <code class="literal">-X</code>.</p>
    </div>

    <div class="section" title="Meu Commit é muito Grande!">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_meu_commit_%C3%A9_muito_grande"></a>Meu Commit é
            muito Grande!</h2>
          </div>
        </div>
      </div>

      <p>Você esqueceu de fazer commit por um muito tempo? Ficou
      codificando furiosamente e esqueceu do controle de versões
      até agora? Fez uma série de modificações não relacionadas
      entre si, pois este é seu estilo?</p>

      <p>Não se preocupe. Execute:</p>
      <pre class="literallayout">
$ git add -p
</pre>

      <p>Para cada modificação realizada, o Git mostrará o pedaço
      do código alterado, e perguntará se ele deve fazer parte do
      próximo commit. Responda "y" (sim) ou "n" (não). Há outras
      opções, como o adiamento dessa decisão; digite "?" para
      aprender como.</p>

      <p>Uma vez satisfeito, digite:</p>
      <pre class="literallayout">
$ git commit
</pre>

      <p>para fazer um commit exatamente com as modificações
      aprovadas (<span class="emphasis"><em>staged</em></span>).
      Lembre-se de retirar a opção <span class=
      "strong"><strong>-a</strong></span>, caso contrário o commit
      conterá todas as modificações.</p>

      <p>E se você tiver editado vários arquivos em vários locais?
      Rever cada modificação uma por uma será frustante e
      enfadonho. Neste caso, use <span class="strong"><strong>git
      add -i</strong></span>, cuja interface é menos simples, porém
      mais flexível. Com algumas poucas teclas, você pode aprovar
      ou não vários arquivos de uma vez, ou rever e selecionar as
      modificações em um arquivo especifico. Alternativamente,
      execute <span class="strong"><strong>git commit
      --interactive</strong></span> o que automaticamente efetuará
      seus commit assim que terminar de aprovar.</p>
    </div>

    <div class="section" title=
    "O Indice: A Área de Atuação do Git">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_o_indice_a_%C3%A1rea_de_atua%C3%A7%C3%A3o_do_git"></a>O
            Indice: A Área de Atuação do Git</h2>
          </div>
        </div>
      </div>

      <p>Até agora estivemos evitando o famoso <span class=
      "emphasis"><em>index</em></span> do git, mas agora teremos
      que enfrentá-lo para explicar o tópico acima. O index é uma
      área de atuação temporária. O Git frequentemente atualiza os
      dados diretamente entre seu projeto e sua historia.
      Preferencialmente, Git primeiro armazena os dados no index, e
      então copia os dados do index para seu destino final.</p>

      <p>Por exemplo, <span class="strong"><strong>commit
      -a</strong></span> é na realidade um processo em duas etapas.
      A primeira etapa coloca uma “fotografia” do estado atual de
      cada arquivo rastreado em um índice. O segundo passo registra
      permanentemente a “fotografia” localizado no índice. O commit
      sem a opção <span class="strong"><strong>-a</strong></span>
      somente executa o segundo passo, e somente faz sentido após a
      execução de um comando que de alguma maneira altera o índice,
      tal como o <span class="strong"><strong>git
      add</strong></span>.</p>

      <p>Geralmente podemos ignorar o index e supor que estamos
      lendo e escrevendo diretamente no histórico. Nessas ocasiões,
      queremos um controle mais fino, de modo que manipulamos o
      índice. Colocamos uma “fotografia” de algumas, mas não todas,
      as nossas alterações no índice, e então registramos
      permanentemente esta “fotografia” cuidadosamente
      manipulada.</p>
    </div>

    <div class="section" title="Não perca a CABEÇA (HEAD)">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_n%C3%A3o_perca_a_cabe%C3%A7a_head"></a>Não perca a
            CABEÇA (HEAD)</h2>
          </div>
        </div>
      </div>

      <p>A etiqueta HEAD (cabeçalho) é como um indicador que
      normalmente aponta para o último commit, avançando a cada
      novo commit. Alguns comandos do Git permitem movê-la. Por
      exemplo:</p>
      <pre class="literallayout">
$ git reset HEAD~3
</pre>

      <p>irá mover o HEAD três commit para trás. Assim todos os
      comandos do Git passam a agir como se você não tivesse
      realizados os últimos três commit, enquanto seus arquivos
      permanecem no presente. Consulte a página do manual para mais
      aplicações.</p>

      <p>Mas como se faz para voltar para o futuro? Os últimos
      commit não sabem do futuro.</p>

      <p>Se você tem o SHA1 do HEAD original então:</p>
      <pre class="literallayout">
$ git reset 1b6d
</pre>

      <p>Mas suponha que você não tenha anotado. Não se preocupe,
      para comandos desse tipo, o Git salva o HEAD original com uma
      etiqueta chamada de ORIG_HEAD, e você pode retornar são e
      salvo com:</p>
      <pre class="literallayout">
$ git reset ORIG_HEAD
</pre>
    </div>

    <div class="section" title="Explorando o HEAD">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_explorando_o_head"></a>Explorando o HEAD</h2>
          </div>
        </div>
      </div>

      <p>Talvez ORIG_HEAD não seja suficiente. Talvez você só tenha
      percebido que fez um erro descomunal e precisa voltar para um
      antigo commit de um branch há muito esquecido.</p>

      <p>Por default, o Git mantém um commit por pelo menos duas
      semanas, mesmo se você mandou o Git destruir o branch que o
      contêm. O problema é achar o hash certo. Você pode procurar
      por todos os valores de hash em <code class=
      "literal">.git/objects</code> e por tentativa e erro
      encontrar o que procura. Mas há um modo mais fácil.</p>

      <p>O Git guarda o hash de todos os commit que ele calcula em
      <code class="literal">.git/logs</code>. O sub-diretório refs
      contêm o histórico de toda atividade em todos os branch,
      enquanto o arquivo <code class="literal">HEAD</code> mostra
      todos os valores de hash que teve. Este último pode ser usado
      para encontrar o hash de um commit num branch que tenha sido
      acidentalmente apagado.</p>

      <p>O comando reflog fornece uma interface amigável para estes
      arquivos de log. Experimente</p>
      <pre class="literallayout">
$ git reflog
</pre>

      <p>Ao invés de copiar e colar o hash do reflog, tente:</p>
      <pre class="literallayout">
$ git checkout "@{10 minutes ago}"
</pre>

      <p>Ou faça um checkout do quinto último commit com:</p>
      <pre class="literallayout">
$ git checkout "@{5}"
</pre>

      <p>Leia a seção “Specifying Revisions” da ajuda com
      <span class="strong"><strong>git help
      rev-parse</strong></span> para mais informações.</p>

      <p>Você pode querer configurar um período mais longo de
      carência para condenar um commit. Por exemplo:</p>
      <pre class="literallayout">
$ git config gc.pruneexpire "30 days"
</pre>

      <p>significa que um commit apagado será permanentemente
      eliminado após passados 30 dias e executado o comando
      <span class="strong"><strong>git gc</strong></span>.</p>

      <p>Você também pode desativar as execuções automáticas do
      <span class="strong"><strong>git gc</strong></span>:</p>
      <pre class="literallayout">
$ git config gc.auto 0
</pre>

      <p>assim os commit só serão permanentemente eliminados quando
      executado o <span class="strong"><strong>git
      gc</strong></span> manualmente.</p>
    </div>

    <div class="section" title="Baseando se no Git">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_baseando_se_no_git"></a>Baseando se no Git</h2>
          </div>
        </div>
      </div>

      <p>Seguindo o jeito UNIX de ser, o Git permite ser facilmente
      utilizado como um componente de “baixo nível” para outros
      programas, tais como interfaces GUI, interfaces web,
      interfaces alternativas de linha de comando, ferramentas de
      gerenciamento de patchs, ferramentas de importação e
      conversão e outras. Na realidade, alguns comandos Git são
      eles mesmos, scripts apoiados em ombros de gigantes. Com
      pouco trabalho, você pode configurar o Git para suas
      preferencias.</p>

      <p>Um truque simples é criar alias (abreviações), internas ao
      Git para abreviar os comandos utilizados mais
      frequentemente:</p>
      <pre class="literallayout">
$ git config --global alias.co checkout
$ git config --global --get-regexp alias  # display current aliases
alias.co checkout
$ git co foo                              # same as 'git checkout foo'
</pre>

      <p>Outra é imprimir o branch atual no prompt, ou no título da
      janela. É só executar:</p>
      <pre class="literallayout">
$ git symbolic-ref HEAD
</pre>

      <p>que mostra o nome do branch atual. Na prática, muito
      provavelmente você não quer ver o "refs/heads/" e ignorar os
      erros:</p>
      <pre class="literallayout">
$ git symbolic-ref HEAD 2&gt; /dev/null | cut -b 12-
</pre>

      <p>O subdiretório <code class="literal">contrib</code> é um
      baú do tesouro de ferramentas construídas com o Git. Com o
      tempo algumas delas devem ser promovidas para comandos
      oficiais. Nos sistemas Debian e Ubuntu esse diretório esta em
      <code class=
      "literal">/usr/share/doc/git-core/contrib</code>.</p>

      <p>Um residente popular é <code class=
      "literal">workdir/git-new-workdir</code>. Por meio de um
      inteligente link simbólico, este script cria um novo
      diretório de trabalho cujo histórico é compartilhado com o
      repositório original:</p>
      <pre class="literallayout">
$ git-new-workdir an/existing/repo new/directory
</pre>

      <p>O novo diretório e arquivos dentro dele podem ser vistos
      como um clone, exceto que como o histórico é compartilhado,
      as duas arvores automaticamente estarão em sincronia. Não é
      necessário fazer merge, push ou pull.</p>
    </div>

    <div class="section" title="Manobras Radicais">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_manobras_radicais"></a>Manobras Radicais</h2>
          </div>
        </div>
      </div>

      <p>As versões recentes do Git tornaram mais difícil para o
      usuário destruir acidentalmente um dado. Mas se você sabe o
      que esta fazendo, você pode transpor estas salvaguardas
      utilizadas nos comandos mais comuns.</p>

      <p><span class="strong"><strong>Checkout</strong></span>: Se
      há modificações sem commit, um checkout simples falhará. Para
      destruir estas modificações, e fazer um checkout de um certo
      commit assim mesmo, use a opção force (-f):</p>
      <pre class="literallayout">
$ git checkout -f HEAD^
</pre>

      <p>Por outro lado, se for especificado algum endereço em
      particular para o checkout, então não haverá checagem de
      segurança. O endereço fornecido será silenciosamente
      sobrescrito. Tenha cuidado se você usa o checkout desse
      jeito.</p>

      <p><span class="strong"><strong>Reset</strong></span>: O
      Reset também falha na presença de modificações sem commit.
      Para obrigá-lo, execute:</p>
      <pre class="literallayout">
$ git reset --hard 1b6d
</pre>

      <p><span class="strong"><strong>Branch</strong></span>:
      Apagar um branch falha se isto levar a perda das
      modificações. Para forçar, digite:</p>
      <pre class="literallayout">
$ git branch -D dead_branch  # instead of -d
</pre>

      <p>Analogamente, a tentativa de sobrescrever um branch
      movendo-o falha for causar a perda de dados. Para forçar a
      movimentação do branch, use:</p>
      <pre class="literallayout">
$ git branch -M source target  # instead of -m
</pre>

      <p>Ao contrário do checkout e do reset, estes dois comandos
      adiarão a destruição dos dados. As modificações ainda serão
      armazenadas no subdiretório .git, e podem ser resgatados,
      recuperando o hash apropriado do <code class=
      "literal">.git/logs</code> (veja a seção "Explorando o HEAD"
      acima). Por padrão, eles serão mantidos por pelo menos duas
      semanas.</p>

      <p><span class="strong"><strong>Clean</strong></span>: Alguns
      comandos do Git recusam-se a avançar devido o receio de
      sobrescrever arquivos não “monitorados” (sem commit). Se você
      tiver certeza de que todos os arquivos e diretórios não
      monitorados são dispensáveis, então apague-os sem
      misericórdia com:</p>
      <pre class="literallayout">
$ git clean -f -d
</pre>

      <p>Da próxima vez, o maldito comando não se recusará a
      funcionar!</p>
    </div>

    <div class="section" title="Prevenção a maus Commits">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name=
            "_preven%C3%A7%C3%A3o_a_maus_commits"></a>Prevenção a
            maus Commits</h2>
          </div>
        </div>
      </div>

      <p>Erros estúpidos poluem meus repositórios. Os mais
      assustadores são os arquivos perdidos devido a comandos
      <span class="strong"><strong>git add</strong></span>
      esquecidos. Transgressões mais leves são espaço em branco e
      conflitos de merge não resolvidos: embora sem perigo, eu
      gostaria que eles nunca aparecessem nos meus registros
      públicos.</p>

      <p>Se eu tivesse comprado um seguro idiota usando
      <span class="emphasis"><em>hook</em></span> para me alertar
      sobre esses problemas:</p>
      <pre class="literallayout">
$ cd .git/hooks
$ cp pre-commit.sample pre-commit  # Older Git versions: chmod +x pre-commit
</pre>

      <p>Agora o Git aborta um commit se espaço em branco sem
      utilidade ou um conflito de merge não resolvido for
      detectado.</p>

      <p>Para este guia, eu eventualmente adiciono o seguinte ao
      inicio do hook <span class=
      "strong"><strong>pre-commit</strong></span> para proteção
      contra as “mentes sem noção”.</p>
      <pre class="literallayout">
if git ls-files -o | grep '\.txt$'; then
  echo FAIL! Untracked .txt files.
  exit 1
fi
</pre>

      <p>Várias operações do Git suportam o hook: veja <span class=
      "strong"><strong>git help hooks</strong></span>. Nós ativamos
      o hook de exemplo <span class=
      "strong"><strong>post-update</strong></span> anteriormente
      quando discutimos o Git sob HTTP. Isso executa sempre que o
      HEAD se movimenta. O script de exemplo post-update atualiza
      os arquivos que o Git necessita para a comunicação sob
      transportes agnósticos do Git, como o HTTP.</p>
    </div>
  </div><script type="text/javascript" src="find_selflink.js">
</script><script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
  </script><script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1901330-2");
  pageTracker._initData();
  pageTracker._trackPageview();
  </script>
</div>
</div><div class="footer"><a href="/~blynn/">Ben Lynn</a></div>
</body>
</html>

