<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Setting up hashes</title><style type="text/css">body { background: white; color: black; font-family: Georgia, serif; margin: 0; padding: .5em .5em .5em 1.5em; } p { text-align: justify; } table.news p { margin-top: 0; } table.news td { vertical-align: baseline; } table.news .date { text-align: right; padding-right: 0.5em; white-space: nowrap; } table.donors td { vertical-align: baseline; } table.donors li { text-align: left; } div.directive, #banner { background: #F2F2F2; margin: 1em 0 1em -1em; padding: .7em .7em .7em 1em; } div.directive { border-top: 2px solid #DDD; } div.directive th { padding-left: 0; padding-right: .5em; vertical-align: baseline; text-align: left; font-weight: normal; } div.directive td { vertical-align: baseline; } div.directive pre { padding: 0; margin: 0; } div.directive p { margin: .5em 0 0 .1em; font-size: .8em; } #banner { margin: 0 0 0 -1em; } a.notrans { color: gray; text-decoration:none; } span.initial { font-size: 200%; float: left; padding-right: 10pt;} ul, ol { margin: .5em 0 1em 1em; padding: 0 .5em; } ol { list-style-position: inside; } li { text-align: justify; padding: .5em 0 0 1px; } .compact li { padding-top: 0; } dl { margin: .5em 0 1em 0; } dt { margin: .5em 0; } .compact dt { margin-bottom: .2em; } dd { margin-left: 1.5em; padding-left: 1px; text-align: justify; } td.list { background: #F2F2F2; } blockquote { margin: 1em 0 1em 1em; padding: .5em; } li blockquote, dd blockquote { margin: .7em 0; } blockquote.note { border: 1px dotted #999; text-align: justify; } blockquote.example { border-left: 1px solid #BBB; } blockquote.example pre { padding: 0; margin: 0; } sup { font-size: 50%; }</style><script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-27974099-2']);
        _gaq.push(['_setDomainName', 'nginx.org']);
        _gaq.push(['_trackPageview']);

        (function() {
           var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
           ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
           var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script></head><body><table width="100%"><tr><td width="70%"><div id="banner"><center><table><tr><td align="center"><strong>Looking to make your web app faster? Look no further!</strong></td></tr><tr><td align="center"><i>NGINX Plus for HTTP load balancing, caching and SSL offload —
                            <a href="http://nginx.com/products/">Free 30-Day Trial</a>.</i></td></tr></table></center></div></td><td align="right"><a href="http://nginx.org"><img src="../../nginx.gif" alt="nginx" border="0"></a></td></tr><tr><td width="70%"><center><h3>Setting up hashes</h3></center></td><td rowspan="2" align="right" valign="top"><br>english<br><a href="http://nginx.org/ru/docs/hash.html">русский</a><br><br><a class="notrans">简体中文</a><br><a class="notrans">עברית</a><br><a class="notrans">日本語</a><br><a class="notrans">türkçe</a><br><a href="http://nginx.org/it/docs/hash.html">italiano</a><br><br><a href="http://nginx.org/">news</a><br><a href="http://nginx.org/en/">about</a><br><a href="http://nginx.org/en/download.html">download</a><br><a href="http://nginx.org/en/security_advisories.html">security advisories</a><br><a href="index.html">documentation</a><br><a href="http://nginx.org/en/pgp_keys.html">pgp keys</a><br><a href="faq.html">faq</a><br><a href="http://nginx.org/en/links.html">links</a><br><a href="http://nginx.org/en/books.html">books</a><br><a href="http://nginx.org/en/support.html">support</a><br><a href="http://nginx.org/en/donation.html">donation</a><br><br><a href="http://trac.nginx.org/nginx">trac</a><br><a href="http://wiki.nginx.org/">wiki</a><br><a href="http://twitter.com/nginxorg">twitter</a><br><a href="http://nginx.com/">nginx.com</a><br><a href="http://nginx.com/blog/">blog</a><br></td></tr><tr><td valign="top"><p>
To quickly process static sets of data such as server names,
<a href="http/ngx_http_map_module.html#map">map</a> directive’s values,
MIME types, names of request header strings,
nginx uses hash tables.
During the start and each re-configuration nginx selects the
minimum possible sizes of hash tables such that the bucket size
that stores keys with identical hash values does not exceed the
configured parameter (hash bucket size).
The size of a table is expressed in buckets.
The adjustment is continued until the table size exceeds the
hash max size parameter.
Most hashes have the corresponding directives that allow changing
these parameters, for example, for the server names hash they are
<a href="http/ngx_http_core_module.html#server_names_hash_max_size">server_names_hash_max_size</a>
and <a href="http/ngx_http_core_module.html#server_names_hash_bucket_size">server_names_hash_bucket_size</a>.
</p><p>
The hash bucket size parameter is aligned to the size that is a
multiple of the processor’s cache line size.  This speeds up
key search in a hash on modern processors by reducing the number
of memory accesses.
If hash bucket size is equal to one processor’s cache line size
then the number of memory accesses during the key search will be
two in the worst case — first to compute the bucket address,
and second during the key search inside the bucket.
Therefore, if nginx emits the message requesting to increase
either hash max size or hash bucket size then the first parameter
should first be increased.
</p></td></tr></table></body></html>
