<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Configuration | Kohana User Guide</title>

<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok8v=02fcfa4f56/"},atok:"eee59e90a8282bcfc7cd8af99a42a3da",petok:"59e5db4edc715c0fc1959b8265c4d713d39c348e-1394799548-1800",zone:"kohanaframework.org",rocket:"0",apps:{"ga_key":{"ua":"UA-27864271-1","ga_bs":"2"}}}];var a=document.createElement("script"),b=document.getElementsByTagName("script")[0];a.async=!0;a.src="//ajax.cloudflare.com/cdn-cgi/nexp/dok8v=b064e16429/cloudflare.min.js";b.parentNode.insertBefore(a,b);}}catch(e){};
//]]>
</script>
<link type="text/css" href="../../guide-media/css/print.css" rel="stylesheet" media="print" />
<link type="text/css" href="../../guide-media/css/screen.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../../guide-media/css/kodoc.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../../guide-media/css/shCore.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../../guide-media/css/shThemeKodoc.css" rel="stylesheet" media="screen" />

<script type="text/javascript" src="../../guide-media/js/jquery.min.js"></script>
<script type="text/javascript" src="../../guide-media/js/jquery.cookie.js"></script>
<script type="text/javascript" src="../../guide-media/js/kodoc.js"></script>
<script type="text/javascript" src="../../guide-media/js/shCore.js"></script>
<script type="text/javascript" src="../../guide-media/js/shBrushPhp.js"></script>

<!--[if lt IE 9]>
<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
<![endif]-->
<script type="text/javascript">
/* <![CDATA[ */
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-27864271-1']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

(function(b){(function(a){"__CF"in b&&"DJS"in b.__CF?b.__CF.DJS.push(a):"addEventListener"in b?b.addEventListener("load",a,!1):b.attachEvent("onload",a)})(function(){"FB"in b&&"Event"in FB&&"subscribe"in FB.Event&&(FB.Event.subscribe("edge.create",function(a){_gaq.push(["_trackSocial","facebook","like",a])}),FB.Event.subscribe("edge.remove",function(a){_gaq.push(["_trackSocial","facebook","unlike",a])}),FB.Event.subscribe("message.send",function(a){_gaq.push(["_trackSocial","facebook","send",a])}));"twttr"in b&&"events"in twttr&&"bind"in twttr.events&&twttr.events.bind("tweet",function(a){if(a){var b;if(a.target&&a.target.nodeName=="IFRAME")a:{if(a=a.target.src){a=a.split("#")[0].match(/[^?=&]+=([^&]*)?/g);b=0;for(var c;c=a[b];++b)if(c.indexOf("url")===0){b=unescape(c.split("=")[1]);break a}}b=void 0}_gaq.push(["_trackSocial","twitter","tweet",b])}})})})(window);
/* ]]> */
</script>
</head>
<body>

	<div id="kodoc-header">
		<div class="container">
			<a href="http://kohanaframework.org/" id="kodoc-logo">
				<img src="../../guide-media/img/kohana.png" />
			</a>
			<div id="kodoc-menu">
				<ul>
					<li class="guide first">
						<a href="../../guide.1.html">User Guide</a>
					</li>
										<li class="api">
						<a href="../../guide-api.html">API Browser</a>
					</li>
									</ul>
			</div>
		</div>
	</div>

	<div id="kodoc-content">
		<div class="wrapper">
			<div class="container">
				<div class="span-22 prefix-1 suffix-1">
					<ul id="kodoc-breadcrumb">
																				<li><a href="../../guide.1.html">User Guide</a></li>
																											<li><a href="../kohana.1.html">Kohana</a></li>
																											<li class="last">Configuration</li>
																		</ul>
				</div>
				<div class="span-6 prefix-1">
					<div id="kodoc-topics">
						<h2 id="kohana"><a href="index.html">Kohana</a></h2>

<ul>
<li><a href="install.html">Installation</a></li>
<li><span>Getting Started</span>

<ul>
<li><a href="conventions.html">Conventions and Style</a></li>
<li><a href="mvc.1.html">Model View Controller</a>

<ul>
<li><a href="mvc/controllers.html">Controllers</a></li>
<li><a href="mvc/models.html">Models</a></li>
<li><a href="mvc/views.html">Views</a></li>
</ul></li>
<li><a href="files.1.html">Cascading Filesystem</a>

<ul>
<li><a href="files/classes.html">Class Files</a></li>
<li><a href="files/config.html">Config Files</a></li>
<li><a href="files/i18n.html">Translation Files</a></li>
<li><a href="files/messages.html">Message Files</a></li>
</ul></li>
<li><a href="config.html">Configuration</a></li>
<li><a href="flow.html">Request Flow</a></li>
<li><a href="bootstrap.html">Bootstrap</a></li>
<li><a href="modules.html">Modules</a></li>
<li><a href="routing.html">Routing</a></li>
<li><a href="errors.html">Error Handling</a></li>
<li><a href="tips.html">Tips &amp; Common Mistakes</a></li>
<li><a href="upgrading.html">Upgrading from v3.2</a></li>
</ul></li>
<li><span>Basic Usage</span>

<ul>
<li><a href="debugging.html">Debugging</a></li>
<li><a href="autoloading.html">Loading Classes</a></li>
<li><a href="extension.html">Transparent Extension</a></li>
<li><a href="helpers.html">Helpers</a></li>
<li><a href="requests.html">Requests</a></li>
<li><a href="sessions.html">Sessions</a></li>
<li><a href="cookies.html">Cookies</a></li>
<li><a href="fragments.html">Fragments</a></li>
<li><a href="profiling.html">Profiling</a></li>
</ul></li>
<li><a href="security.1.html">Security</a>

<ul>
<li><a href="security/xss.html">XSS</a></li>
<li><a href="security/validation.html">Validation</a></li>
<li><a href="security/cookies.html">Cookies</a></li>
<li><a href="security/database.html">Database</a></li>
<li><a href="security/encryption.html">Encryption</a></li>
<li><a href="security/deploying.html">Deploying</a></li>
</ul></li>
<li><span>Tutorials</span>

<ul>
<li><a href="tutorials/hello-world.html">Hello World</a></li>
<li><a href="tutorials/simple-mvc.html">Simple MVC</a></li>
<li><a href="tutorials/error-pages.html">Custom Error Pages</a></li>
<li><a href="tutorials/clean-urls.html">Clean URLs</a></li>
<li><a href="tutorials/sharing-kohana.html">Sharing Kohana</a></li>
<li><a href="tutorials/library-kohana.html">Kohana as a Library</a></li>
<li><a href="tutorials/git.html">Working with Git</a></li>
</ul></li>
</ul>
					</div>
				</div>
				<div id="kodoc-body" class="span-16 suffix-1 last">
					<h1 id="configuration">Configuration</h1>

<div class="page-toc">
					<a href="config.html#configuration">Configuration</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="config.html#sources">Sources</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="config.html#groups">Groups</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;				<a href="config.html#alternative-methods-for-getting-setting-config">Alternative methods for getting / setting config</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="config.html#config-merging">Config Merging</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="config.html#using-different-config-sources-based-on-the-environment">Using different config sources based on the environment</a><br />
	</div>
<p>By default Kohana is setup to load configuration values from <a href="files/config.html">config files</a> in the
cascading filesystem.  However, it is very easy to adapt it to load config values in other
locations/formats.</p>

<h2 id="sources">Sources</h2>

<p>The system is designed around the concept of <strong>Config Sources</strong>, which loosely means a method of
storing configuration values.</p>

<p>To read config from a source you need a <strong>Config Reader</strong>. Similarly, to write config to a source
you need a <strong>Config Writer</strong>.</p>

<p>Implementing them is as simple as extending the
<a href="../../guide-api/Kohana_Config_Reader.html">Kohana_Config_Reader</a> / <a href="../../guide-api/Kohana_Config_Writer.html">Kohana_Config_Writer</a> interfaces:</p>

<pre><code>class Kohana_Config_Database_Reader implements Kohana_Config_Reader
class Kohana_Config_Database_Writer extends Kohana_Config_Database_Reader implements Kohana_Config_Writer
</code></pre>

<p>You'll notice in the above example that the Database Writer extends the Database Reader.
This is the convention with config sources, the reasoning being that if you can write to a
source chances are you can also read from it as well. However, this convention is not enforced
and is left to the developer's discretion.</p>

<h2 id="groups">Groups</h2>

<p>In order to aid organisation config values are split up into logical "groups".  For example,
database related settings go in a <code>database</code> group, and session related settings go in a
<code>session</code> group.</p>

<p>How these groups are stored/organised is up to the config source.  For example, the file source
puts different config groups into different files (<code>database.php</code>, <code>session.php</code>) whereas
the database source uses a column to distinguish between groups.</p>

<p>To load a config group simply call <code>Kohana::$config-&gt;load()</code> with the name of the group you wish to load:</p>

<pre><code>$config = Kohana::$config-&gt;load('my_group');
</code></pre>

<p><code>load()</code> will return an instance of <a href="../../guide-api/Config_Group.html">Config_Group</a> which encapsulates the config values and ensures
that any modifications made will be passed back to the config writers.</p>

<p>To get a config value from a <a href="../../guide-api/Config_Group.html">Config_Group</a> object simply call <a href="../../guide-api/Config_Group.html#get">Config_Group::get</a>:</p>

<pre><code>$config = Kohana::$config-&gt;load('my_group');
$value  = $config-&gt;get('var');
</code></pre>

<p>To modify a value call <a href="../../guide-api/Config_Group.html#set">Config_Group::set</a>:</p>

<pre><code>$config = Kohana::$config-&gt;load('my_group');
$config-&gt;set('var', 'new_value');
</code></pre>

<h3 id="alternative-methods-for-getting-setting-config">Alternative methods for getting / setting config</h3>

<p>In addition to the methods described above you can also access config values using dots to outline a path
from the config group to the value you want:</p>

<pre><code>// Config file: database.php
return array(
    'default' =&gt; array(
        'connection' =&gt; array(
            'hostname' =&gt; 'localhost'
        )
    )
);

// Code which needs hostname:
$hostname = Kohana::$config-&gt;load('database.default.connection.hostname');
</code></pre>

<p>Which is equivalent to:</p>

<pre><code>$config = Kohana::$config-&gt;load('database')-&gt;get('default');

$hostname = $config['connection']['hostname'];
</code></pre>

<p>Obviously this method is a lot more compact than the original. However, please bear in mind that using
<code>dot.notation</code> is a <em>lot</em> slower than calling <code>get()</code> and traversing the array yourself.  Dot notation
can be useful if you only need one specific variable, but otherwise it's best to use <code>get()</code>.</p>

<p>As <a href="../../guide-api/Config_Group.html">Config_Group</a> extends <a href="http://php.net/manual/en/class.arrayobject.php">Array_Object</a> you can also use array
syntax to get/set config vars:</p>

<pre><code>$config = Kohana::$config-&gt;load('database');

// Getting the var
$hostname = $config['default']['connection']['hostname'];

// Setting the var
$config['default']['connection']['hostname'] = '127.0.0.1';
</code></pre>

<p>Again, this syntax is more costly than calling <code>get()</code> / <code>set()</code>.</p>

<h2 id="config-merging">Config Merging</h2>

<p>One of the useful features of the config system is config group merging. This works in a similar way
to the cascading filesystem, with configuration from lower sources lower down the source stack being
merged with sources further up the stack.</p>

<p>If two sources contain the same config variables then the one from the source further up the stack will
override the one from the "lower" source.  However, if the source from higher up the stack does not contain
a particular config variable but a source lower down the stack does then the value from the lower source will
be used.</p>

<p>The position of sources in the stack is determined by how they are loaded in your bootstrap.
By default when you load a source it is pushed to the top of a stack:</p>

<pre><code>// Stack: &lt;empty&gt;
Kohana::$config-&gt;attach(new Config_File);
// Stack: Config_File
Kohana::$config-&gt;attach(new Config_Database);
// Stack: Config_Database, Config_File
</code></pre>

<p>In the example above, any config values found in the database will override those found in the filesystem.
For example, using the setup outlined above:</p>

<pre><code>// Configuration in the filesystem:
    email:
        sender:
            email: <a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="036e7a2d627466706c6e662d6267677166707043667b626e736f662d606c6e">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script>
            name:  Unknown
        method: smtp

// Configuration in the database:
    email:
        sender:
            email: <a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="395440174a4c495c4b5a56565517585d5d4b5c4a4a795e54585055175a5654">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script>
            name:  Kohana Bot

// Configuration returned by Kohana::$config-&gt;load('email')
    email:
        sender:
            email: <a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="95f8ecbbe6e0e5f0e7f6fafaf9bbf4f1f1e7f0e6e6d5f2f8f4fcf9bbf6faf8">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script>
            name:  Kohana Bot
        method: smtp
</code></pre>

<p class="note"><strong>Note:</strong> The above syntax is simply pseudo code to illustrate the concept of config merging.</p>

<p>On some occasions you may want to append a config source to the bottom of the stack, to do this pass <code>FALSE</code>
as the second parameter to <code>attach()</code>:</p>

<pre><code>// Stack: &lt;empty&gt;
Kohana::$config-&gt;attach(new Config_File);
// Stack: Config_File
Kohana::$config-&gt;attach(new Config_Database, FALSE);
// Stack: Config_File, Config_Database
</code></pre>

<p>In this example, any values found in the filesystem will override those found in the db. For example:</p>

<pre><code>// Configuration in the filesystem:
    email:
        sender:
            email: <a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="4a2733642b3d2f3925272f642b2e2e382f39390a2f322b273a262f64292527">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script>
            name:  Unknown
        method: smtp

// Configuration in the database:
    email:
        sender:
            email: <a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="d5b8acfba6a0a5b0a7b6babab9fbb4b1b1a7b0a6a695b2b8b4bcb9fbb6bab8">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script>
            name:  Kohana Bot

// Configuration returned by Kohana::$config-&gt;load('email')
    email:
        sender:
            email: <a class="__cf_email__" href="http://www.cloudflare.com/email-protection" data-cfemail="4f2236612e382a3c20222a612e2b2b3d2a3c3c0f2a372e223f232a612c2022">[email&nbsp;protected]</a><script type="text/javascript">
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
</script>
            name:  Unknown
        method: smtp
</code></pre>

<h2 id="using-different-config-sources-based-on-the-environment">Using different config sources based on the environment</h2>

<p>In some situations you'll need to use different config values depending on which state <code>Kohana::$environment</code>
is in. Unit testing is a prime example of such a situation. Most setups have two databases; one for normal
development and a separate one for unit testing (to isolate the tests from your development).</p>

<p>In this case you still need access to the config settings stored in the <code>config</code> directory as it contains generic
settings that are needed whatever environment your application is in (e.g. encryption settings),
so replacing the default <code>Config_File</code> source isn't really an option.</p>

<p>To get around this you can attach a separate config file reader which loads its config from a subdir of <code>config</code> called
"testing":</p>

<pre><code>Kohana::$config-&gt;attach(new Config_File);

Kohana::$config-&gt;attach(new Config_Database);

if (Kohana::$environment === Kohana::TESTING)
{
    Kohana::$config-&gt;attach(new Config_File('config/testing'));
}
</code></pre>

<p>During normal development the config source stack looks like <code>Config_Database, Config_File('config')</code>.  However,
when <code>Kohana::$environment === Kohana::TESTING</code> the stack looks like <code>Config_File('config/testing'), Config_Database, Config_File('config')</code></p>

									</div>
			</div>
		</div>
	</div>

	<div id="kodoc-footer">
		<div class="container">
			<div class="span-12">
							<p>&copy; 2008–2012 Kohana Team</p>
						</div>
			<div class="span-12 last right">
			<p>Powered by <a href="http://kohanaframework.org/">Kohana</a> v3.3.1</p>
			</div>
		</div>
	</div>

</body>
</html>
