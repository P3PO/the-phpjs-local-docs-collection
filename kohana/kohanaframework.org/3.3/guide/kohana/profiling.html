<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Profiling | Kohana User Guide</title>

<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok8v=02fcfa4f56/"},atok:"eee59e90a8282bcfc7cd8af99a42a3da",petok:"48da0f2b598c06652bd114a1af00e4465cacdcc6-1394799554-1800",zone:"kohanaframework.org",rocket:"0",apps:{"ga_key":{"ua":"UA-27864271-1","ga_bs":"2"}}}];var a=document.createElement("script"),b=document.getElementsByTagName("script")[0];a.async=!0;a.src="//ajax.cloudflare.com/cdn-cgi/nexp/dok8v=b064e16429/cloudflare.min.js";b.parentNode.insertBefore(a,b);}}catch(e){};
//]]>
</script>
<link type="text/css" href="../../guide-media/css/print.css" rel="stylesheet" media="print" />
<link type="text/css" href="../../guide-media/css/screen.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../../guide-media/css/kodoc.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../../guide-media/css/shCore.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../../guide-media/css/shThemeKodoc.css" rel="stylesheet" media="screen" />

<script type="text/javascript" src="../../guide-media/js/jquery.min.js"></script>
<script type="text/javascript" src="../../guide-media/js/jquery.cookie.js"></script>
<script type="text/javascript" src="../../guide-media/js/kodoc.js"></script>
<script type="text/javascript" src="../../guide-media/js/shCore.js"></script>
<script type="text/javascript" src="../../guide-media/js/shBrushPhp.js"></script>

<!--[if lt IE 9]>
<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
<![endif]-->
<script type="text/javascript">
/* <![CDATA[ */
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-27864271-1']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

(function(b){(function(a){"__CF"in b&&"DJS"in b.__CF?b.__CF.DJS.push(a):"addEventListener"in b?b.addEventListener("load",a,!1):b.attachEvent("onload",a)})(function(){"FB"in b&&"Event"in FB&&"subscribe"in FB.Event&&(FB.Event.subscribe("edge.create",function(a){_gaq.push(["_trackSocial","facebook","like",a])}),FB.Event.subscribe("edge.remove",function(a){_gaq.push(["_trackSocial","facebook","unlike",a])}),FB.Event.subscribe("message.send",function(a){_gaq.push(["_trackSocial","facebook","send",a])}));"twttr"in b&&"events"in twttr&&"bind"in twttr.events&&twttr.events.bind("tweet",function(a){if(a){var b;if(a.target&&a.target.nodeName=="IFRAME")a:{if(a=a.target.src){a=a.split("#")[0].match(/[^?=&]+=([^&]*)?/g);b=0;for(var c;c=a[b];++b)if(c.indexOf("url")===0){b=unescape(c.split("=")[1]);break a}}b=void 0}_gaq.push(["_trackSocial","twitter","tweet",b])}})})})(window);
/* ]]> */
</script>
</head>
<body>

	<div id="kodoc-header">
		<div class="container">
			<a href="http://kohanaframework.org/" id="kodoc-logo">
				<img src="../../guide-media/img/kohana.png" />
			</a>
			<div id="kodoc-menu">
				<ul>
					<li class="guide first">
						<a href="../../guide.1.html">User Guide</a>
					</li>
										<li class="api">
						<a href="../../guide-api.html">API Browser</a>
					</li>
									</ul>
			</div>
		</div>
	</div>

	<div id="kodoc-content">
		<div class="wrapper">
			<div class="container">
				<div class="span-22 prefix-1 suffix-1">
					<ul id="kodoc-breadcrumb">
																				<li><a href="../../guide.1.html">User Guide</a></li>
																											<li><a href="../kohana.1.html">Kohana</a></li>
																											<li class="last">Profiling</li>
																		</ul>
				</div>
				<div class="span-6 prefix-1">
					<div id="kodoc-topics">
						<h2 id="kohana"><a href="index.html">Kohana</a></h2>

<ul>
<li><a href="install.html">Installation</a></li>
<li><span>Getting Started</span>

<ul>
<li><a href="conventions.html">Conventions and Style</a></li>
<li><a href="mvc.1.html">Model View Controller</a>

<ul>
<li><a href="mvc/controllers.html">Controllers</a></li>
<li><a href="mvc/models.html">Models</a></li>
<li><a href="mvc/views.html">Views</a></li>
</ul></li>
<li><a href="files.1.html">Cascading Filesystem</a>

<ul>
<li><a href="files/classes.html">Class Files</a></li>
<li><a href="files/config.html">Config Files</a></li>
<li><a href="files/i18n.html">Translation Files</a></li>
<li><a href="files/messages.html">Message Files</a></li>
</ul></li>
<li><a href="config.html">Configuration</a></li>
<li><a href="flow.html">Request Flow</a></li>
<li><a href="bootstrap.html">Bootstrap</a></li>
<li><a href="modules.html">Modules</a></li>
<li><a href="routing.html">Routing</a></li>
<li><a href="errors.html">Error Handling</a></li>
<li><a href="tips.html">Tips &amp; Common Mistakes</a></li>
<li><a href="upgrading.html">Upgrading from v3.2</a></li>
</ul></li>
<li><span>Basic Usage</span>

<ul>
<li><a href="debugging.html">Debugging</a></li>
<li><a href="autoloading.html">Loading Classes</a></li>
<li><a href="extension.html">Transparent Extension</a></li>
<li><a href="helpers.html">Helpers</a></li>
<li><a href="requests.html">Requests</a></li>
<li><a href="sessions.html">Sessions</a></li>
<li><a href="cookies.html">Cookies</a></li>
<li><a href="fragments.html">Fragments</a></li>
<li><a href="profiling.html">Profiling</a></li>
</ul></li>
<li><a href="security.1.html">Security</a>

<ul>
<li><a href="security/xss.html">XSS</a></li>
<li><a href="security/validation.html">Validation</a></li>
<li><a href="security/cookies.html">Cookies</a></li>
<li><a href="security/database.html">Database</a></li>
<li><a href="security/encryption.html">Encryption</a></li>
<li><a href="security/deploying.html">Deploying</a></li>
</ul></li>
<li><span>Tutorials</span>

<ul>
<li><a href="tutorials/hello-world.html">Hello World</a></li>
<li><a href="tutorials/simple-mvc.html">Simple MVC</a></li>
<li><a href="tutorials/error-pages.html">Custom Error Pages</a></li>
<li><a href="tutorials/clean-urls.html">Clean URLs</a></li>
<li><a href="tutorials/sharing-kohana.html">Sharing Kohana</a></li>
<li><a href="tutorials/library-kohana.html">Kohana as a Library</a></li>
<li><a href="tutorials/git.html">Working with Git</a></li>
</ul></li>
</ul>
					</div>
				</div>
				<div id="kodoc-body" class="span-16 suffix-1 last">
					<h1 id="profiling">Profiling</h1>

<div class="page-toc">
					<a href="profiling.html#profiling">Profiling</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="profiling.html#profiling-your-code">Profiling your code</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="profiling.html#how-to-read-the-profiling-report">How to read the profiling report</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="profiling.html#displaying-the-profiler">Displaying the profiler</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="profiling.html#preview">Preview</a><br />
	</div>
<p>Kohana provides a very simple way to display statistics about your application:</p>

<ol>
<li>Common <a href="http://kohanaframework.org/3.3/guide-api/Kohana">Kohana</a> method calls, such as <a href="http://kohanaframework.org/3.3/guide-api/Kohana#find_file">Kohana::find_file()</a>.</li>
<li>Requests. Including the main request, as well as any sub-requests.</li>
<li><a href="../../guide-api/Database.html">Database</a> queries</li>
<li>Average execution times for your application</li>
</ol>

<p class="note">In order for profiling to work, the <code>profile</code> setting must be <code>TRUE</code> in your <a href="http://kohanaframework.org/3.3/guide-api/Kohana#init">Kohana::init()</a> call in your bootstrap.</p>

<h2 id="profiling-your-code">Profiling your code</h2>

<p>You can easily add profiling to your own functions and code.  This is done using the <a href="../../guide-api/profiler.html#start">Profiler::start()</a> function.  The first parameter is the group, the second parameter is the name of the benchmark.</p>

<pre><code>public function foobar($input)
{
    // Be sure to only profile if it's enabled
    if (Kohana::$profiling === TRUE)
    {
        // Start a new benchmark
        $benchmark = Profiler::start('Your Category', __FUNCTION__);
    }

    // Do some stuff

    if (isset($benchmark))
    {
        // Stop the benchmark
        Profiler::stop($benchmark);
    }

    return $something;
}
</code></pre>

<h2 id="how-to-read-the-profiling-report">How to read the profiling report</h2>

<p>The benchmarks are sorted into groups.  Each benchmark will show its name, how many times it was run (show in parenthesis after the benchmark name), and then the min, max, average, and total time and memory spent on that benchmark.  The total column will have shaded backgrounds to show the relative times between benchmarks in the same group.</p>

<p>At the very end is a group called "Application Execution".  This keeps track of how long each execution has taken.  The number in parenthesis is how many executions are being compared.  It shows the fastest, slowest, and average time and memory usage of the last several requsets.  The last box is the time and memory usage of the current request.</p>

<p>((This could use a picture of a profiler with some database queries, etc. with annotations to point out each area as just described.))</p>

<h2 id="displaying-the-profiler">Displaying the profiler</h2>

<p>You can display or collect the current <a href="../../guide-api/profiler.html">profiler</a> statistics at any time:</p>

<pre><code>&lt;?php echo View::factory('profiler/stats') ?&gt;
</code></pre>

<h2 id="preview">Preview</h2>

<p>(This is the actual profiler stats for this page.)</p>

<p>
<style type="text/css">
.kohana table.profiler { width: 99%; margin: 0 auto 1em; border-collapse: collapse; }
.kohana table.profiler th,
.kohana table.profiler td { padding: 0.2em 0.4em; background: #fff; border: solid 1px #999; border-width: 1px 0; text-align: left; font-weight: normal; font-size: 1em; color: #111; vertical-align: top; text-align: right; }
.kohana table.profiler th.name { text-align: left; }
.kohana table.profiler tr.group th { font-size: 1.4em; background: #222; color: #eee; border-color: #222; }
.kohana table.profiler tr.group td { background: #222; color: #777; border-color: #222; }
.kohana table.profiler tr.group td.time { padding-bottom: 0; }
.kohana table.profiler tr.headers th { text-transform: lowercase; font-variant: small-caps; background: #ddd; color: #777; }
.kohana table.profiler tr.mark th.name { width: 40%; font-size: 1.2em; background: #fff; vertical-align: middle; }
.kohana table.profiler tr.mark td { padding: 0; }
.kohana table.profiler tr.mark.final td { padding: 0.2em 0.4em; }
.kohana table.profiler tr.mark td > div { position: relative; padding: 0.2em 0.4em; }
.kohana table.profiler tr.mark td div.value { position: relative; z-index: 2; }
.kohana table.profiler tr.mark td div.graph { position: absolute; top: 0; bottom: 0; right: 0; left: 100%; background: #71bdf0; z-index: 1; }
.kohana table.profiler tr.mark.memory td div.graph { background: #acd4f0; }
.kohana table.profiler tr.mark td.current { background: #eddecc; }
.kohana table.profiler tr.mark td.min { background: #d2f1cb; }
.kohana table.profiler tr.mark td.max { background: #ead3cb; }
.kohana table.profiler tr.mark td.average { background: #ddd; }
.kohana table.profiler tr.mark td.total { background: #d0e3f0; }
.kohana table.profiler tr.time td { border-bottom: 0; font-weight: bold; }
.kohana table.profiler tr.memory td { border-top: 0; }
.kohana table.profiler tr.final th.name { background: #222; color: #fff; }
.kohana table.profiler abbr { border: 0; color: #777; font-weight: normal; }
.kohana table.profiler:hover tr.group td { color: #ccc; }
.kohana table.profiler:hover tr.mark td div.graph { background: #1197f0; }
.kohana table.profiler:hover tr.mark.memory td div.graph { background: #7cc1f0; }</style>


<div class="kohana">
		<table class="profiler">
		<tr class="group">
			<th class="name" rowspan="2">Requests</th>
			<td class="time" colspan="4">0.042563 <abbr title="seconds">s</abbr></td>
		</tr>
		<tr class="group">
			<td class="memory" colspan="4">1,569.3203 <abbr title="kilobyte">kB</abbr></td>
		</tr>
		<tr class="headers">
			<th class="name">Benchmark</th>
						<th class="min">Min</th>
						<th class="max">Max</th>
						<th class="average">Average</th>
						<th class="total">Total</th>
					</tr>
				<tr class="mark time">
						<th class="name" rowspan="2" scope="rowgroup">&quot;guide/kohana/profiling&quot; (1)</th>
						<td class="min">
				<div>
					<div class="value">0.042983 <abbr title="seconds">s</abbr></div>
									</div>
			</td>
						<td class="max">
				<div>
					<div class="value">0.042983 <abbr title="seconds">s</abbr></div>
									</div>
			</td>
						<td class="average">
				<div>
					<div class="value">0.042983 <abbr title="seconds">s</abbr></div>
									</div>
			</td>
						<td class="total">
				<div>
					<div class="value">0.042983 <abbr title="seconds">s</abbr></div>
											<div class="graph" style="left: 0%"></div>
									</div>
			</td>
					</tr>
		<tr class="mark memory">
						<td class="min">
				<div>
					<div class="value">1,577.0234 <abbr title="kilobyte">kB</abbr></div>
									</div>
			</td>
						<td class="max">
				<div>
					<div class="value">1,577.0234 <abbr title="kilobyte">kB</abbr></div>
									</div>
			</td>
						<td class="average">
				<div>
					<div class="value">1,577.0234 <abbr title="kilobyte">kB</abbr></div>
									</div>
			</td>
						<td class="total">
				<div>
					<div class="value">1,577.0234 <abbr title="kilobyte">kB</abbr></div>
											<div class="graph" style="left: 0%"></div>
									</div>
			</td>
					</tr>
			</table>
		<table class="profiler">
		<tr class="group">
			<th class="name" rowspan="2">Kohana</th>
			<td class="time" colspan="4">0.008407 <abbr title="seconds">s</abbr></td>
		</tr>
		<tr class="group">
			<td class="memory" colspan="4">15.0000 <abbr title="kilobyte">kB</abbr></td>
		</tr>
		<tr class="headers">
			<th class="name">Benchmark</th>
						<th class="min">Min</th>
						<th class="max">Max</th>
						<th class="average">Average</th>
						<th class="total">Total</th>
					</tr>
				<tr class="mark time">
						<th class="name" rowspan="2" scope="rowgroup">find_file (27)</th>
						<td class="min">
				<div>
					<div class="value">0.000050 <abbr title="seconds">s</abbr></div>
									</div>
			</td>
						<td class="max">
				<div>
					<div class="value">0.005350 <abbr title="seconds">s</abbr></div>
									</div>
			</td>
						<td class="average">
				<div>
					<div class="value">0.000311 <abbr title="seconds">s</abbr></div>
									</div>
			</td>
						<td class="total">
				<div>
					<div class="value">0.008407 <abbr title="seconds">s</abbr></div>
											<div class="graph" style="left: 0%"></div>
									</div>
			</td>
					</tr>
		<tr class="mark memory">
						<td class="min">
				<div>
					<div class="value">0.4766 <abbr title="kilobyte">kB</abbr></div>
									</div>
			</td>
						<td class="max">
				<div>
					<div class="value">0.6563 <abbr title="kilobyte">kB</abbr></div>
									</div>
			</td>
						<td class="average">
				<div>
					<div class="value">0.5556 <abbr title="kilobyte">kB</abbr></div>
									</div>
			</td>
						<td class="total">
				<div>
					<div class="value">15.0000 <abbr title="kilobyte">kB</abbr></div>
											<div class="graph" style="left: 0%"></div>
									</div>
			</td>
					</tr>
			</table>
	
	<table class="profiler">
				<tr class="final mark time">
			<th class="name" rowspan="2" scope="rowgroup">Application Execution (520)</th>
						<td class="min">0.047105 <abbr title="seconds">s</abbr></td>
						<td class="max">1.885638 <abbr title="seconds">s</abbr></td>
						<td class="average">0.161721 <abbr title="seconds">s</abbr></td>
						<td class="current">0.083328 <abbr title="seconds">s</abbr></td>
					</tr>
		<tr class="final mark memory">
						<td class="min">3,194.5938 <abbr title="kilobyte">kB</abbr></td>
						<td class="max">3,197.2188 <abbr title="kilobyte">kB</abbr></td>
						<td class="average">3,196.3743 <abbr title="kilobyte">kB</abbr></td>
						<td class="current">3,195.7656 <abbr title="kilobyte">kB</abbr></td>
					</tr>
	</table>
</div></p>

									</div>
			</div>
		</div>
	</div>

	<div id="kodoc-footer">
		<div class="container">
			<div class="span-12">
							<p>&copy; 2008–2012 Kohana Team</p>
						</div>
			<div class="span-12 last right">
			<p>Powered by <a href="http://kohanaframework.org/">Kohana</a> v3.3.1</p>
			</div>
		</div>
	</div>

</body>
</html>
