<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Views | Kohana User Guide</title>

<script type="text/javascript">
//<![CDATA[
try{if (!window.CloudFlare) {var CloudFlare=[{verbose:0,p:0,byc:0,owlid:"cf",bag2:1,mirage2:0,oracle:0,paths:{cloudflare:"/cdn-cgi/nexp/dok8v=02fcfa4f56/"},atok:"eee59e90a8282bcfc7cd8af99a42a3da",petok:"9707a9309ed313df7374672f81fad48cbc63405e-1394799547-1800",zone:"kohanaframework.org",rocket:"0",apps:{"ga_key":{"ua":"UA-27864271-1","ga_bs":"2"}}}];var a=document.createElement("script"),b=document.getElementsByTagName("script")[0];a.async=!0;a.src="//ajax.cloudflare.com/cdn-cgi/nexp/dok8v=b064e16429/cloudflare.min.js";b.parentNode.insertBefore(a,b);}}catch(e){};
//]]>
</script>
<link type="text/css" href="../../../guide-media/css/print.css" rel="stylesheet" media="print" />
<link type="text/css" href="../../../guide-media/css/screen.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../../../guide-media/css/kodoc.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../../../guide-media/css/shCore.css" rel="stylesheet" media="screen" />
<link type="text/css" href="../../../guide-media/css/shThemeKodoc.css" rel="stylesheet" media="screen" />

<script type="text/javascript" src="../../../guide-media/js/jquery.min.js"></script>
<script type="text/javascript" src="../../../guide-media/js/jquery.cookie.js"></script>
<script type="text/javascript" src="../../../guide-media/js/kodoc.js"></script>
<script type="text/javascript" src="../../../guide-media/js/shCore.js"></script>
<script type="text/javascript" src="../../../guide-media/js/shBrushPhp.js"></script>

<!--[if lt IE 9]>
<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
<![endif]-->
<script type="text/javascript">
/* <![CDATA[ */
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-27864271-1']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

(function(b){(function(a){"__CF"in b&&"DJS"in b.__CF?b.__CF.DJS.push(a):"addEventListener"in b?b.addEventListener("load",a,!1):b.attachEvent("onload",a)})(function(){"FB"in b&&"Event"in FB&&"subscribe"in FB.Event&&(FB.Event.subscribe("edge.create",function(a){_gaq.push(["_trackSocial","facebook","like",a])}),FB.Event.subscribe("edge.remove",function(a){_gaq.push(["_trackSocial","facebook","unlike",a])}),FB.Event.subscribe("message.send",function(a){_gaq.push(["_trackSocial","facebook","send",a])}));"twttr"in b&&"events"in twttr&&"bind"in twttr.events&&twttr.events.bind("tweet",function(a){if(a){var b;if(a.target&&a.target.nodeName=="IFRAME")a:{if(a=a.target.src){a=a.split("#")[0].match(/[^?=&]+=([^&]*)?/g);b=0;for(var c;c=a[b];++b)if(c.indexOf("url")===0){b=unescape(c.split("=")[1]);break a}}b=void 0}_gaq.push(["_trackSocial","twitter","tweet",b])}})})})(window);
/* ]]> */
</script>
</head>
<body>

	<div id="kodoc-header">
		<div class="container">
			<a href="http://kohanaframework.org/" id="kodoc-logo">
				<img src="../../../guide-media/img/kohana.png" />
			</a>
			<div id="kodoc-menu">
				<ul>
					<li class="guide first">
						<a href="../../../guide.1.html">User Guide</a>
					</li>
										<li class="api">
						<a href="../../../guide-api.html">API Browser</a>
					</li>
									</ul>
			</div>
		</div>
	</div>

	<div id="kodoc-content">
		<div class="wrapper">
			<div class="container">
				<div class="span-22 prefix-1 suffix-1">
					<ul id="kodoc-breadcrumb">
																				<li><a href="../../../guide.1.html">User Guide</a></li>
																											<li><a href="../../kohana.1.html">Kohana</a></li>
																											<li class="last">Views</li>
																		</ul>
				</div>
				<div class="span-6 prefix-1">
					<div id="kodoc-topics">
						<h2 id="kohana"><a href="../index.html">Kohana</a></h2>

<ul>
<li><a href="../install.html">Installation</a></li>
<li><span>Getting Started</span>

<ul>
<li><a href="../conventions.html">Conventions and Style</a></li>
<li><a href="../mvc.1.html">Model View Controller</a>

<ul>
<li><a href="controllers.html">Controllers</a></li>
<li><a href="models.html">Models</a></li>
<li><a href="views.html">Views</a></li>
</ul></li>
<li><a href="../files.1.html">Cascading Filesystem</a>

<ul>
<li><a href="../files/classes.html">Class Files</a></li>
<li><a href="../files/config.html">Config Files</a></li>
<li><a href="../files/i18n.html">Translation Files</a></li>
<li><a href="../files/messages.html">Message Files</a></li>
</ul></li>
<li><a href="../config.html">Configuration</a></li>
<li><a href="../flow.html">Request Flow</a></li>
<li><a href="../bootstrap.html">Bootstrap</a></li>
<li><a href="../modules.html">Modules</a></li>
<li><a href="../routing.html">Routing</a></li>
<li><a href="../errors.html">Error Handling</a></li>
<li><a href="../tips.html">Tips &amp; Common Mistakes</a></li>
<li><a href="../upgrading.html">Upgrading from v3.2</a></li>
</ul></li>
<li><span>Basic Usage</span>

<ul>
<li><a href="../debugging.html">Debugging</a></li>
<li><a href="../autoloading.html">Loading Classes</a></li>
<li><a href="../extension.html">Transparent Extension</a></li>
<li><a href="../helpers.html">Helpers</a></li>
<li><a href="../requests.html">Requests</a></li>
<li><a href="../sessions.html">Sessions</a></li>
<li><a href="../cookies.html">Cookies</a></li>
<li><a href="../fragments.html">Fragments</a></li>
<li><a href="../profiling.html">Profiling</a></li>
</ul></li>
<li><a href="../security.1.html">Security</a>

<ul>
<li><a href="../security/xss.html">XSS</a></li>
<li><a href="../security/validation.html">Validation</a></li>
<li><a href="../security/cookies.html">Cookies</a></li>
<li><a href="../security/database.html">Database</a></li>
<li><a href="../security/encryption.html">Encryption</a></li>
<li><a href="../security/deploying.html">Deploying</a></li>
</ul></li>
<li><span>Tutorials</span>

<ul>
<li><a href="../tutorials/hello-world.html">Hello World</a></li>
<li><a href="../tutorials/simple-mvc.html">Simple MVC</a></li>
<li><a href="../tutorials/error-pages.html">Custom Error Pages</a></li>
<li><a href="../tutorials/clean-urls.html">Clean URLs</a></li>
<li><a href="../tutorials/sharing-kohana.html">Sharing Kohana</a></li>
<li><a href="../tutorials/library-kohana.html">Kohana as a Library</a></li>
<li><a href="../tutorials/git.html">Working with Git</a></li>
</ul></li>
</ul>
					</div>
				</div>
				<div id="kodoc-body" class="span-16 suffix-1 last">
					<h1 id="views">Views</h1>

<div class="page-toc">
					<a href="views.html#views">Views</a><br />
					<a href="views.html#creating-view-files">Creating View Files</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="views.html#loading-views">Loading Views</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="views.html#variables-in-views">Variables in Views</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;				<a href="views.html#global-variables">Global Variables</a><br />
					&nbsp;&nbsp;&nbsp;&nbsp;				<a href="views.html#views-within-views">Views Within Views</a><br />
	</div>
<p>Views are files that contain the display information for your application. This is most commonly HTML, CSS and Javascript but can be anything you require such as XML or JSON for AJAX output. The purpose of views is to keep this information separate from your application logic for easy reusability and cleaner code.</p>

<p>Views themselves can contain code used for displaying the data you pass into them. For example, looping through an array of product information and display each one on a new table row. Views are still PHP files so you can use any code you normally would.  However, you should try to keep your views as "dumb" as possible and retreive all data you need in your controllers, then pass it to the view.</p>

<h1 id="creating-view-files">Creating View Files</h1>

<p>View files are stored in the <code>views</code> directory of the <a href="../files.1.html">filesystem</a>. You can also create sub-directories within the <code>views</code> directory to organize your files. All of the following examples are reasonable view files:</p>

<pre><code>APPPATH/views/home.php
APPPATH/views/pages/about.php
APPPATH/views/products/details.php
MODPATH/error/views/errors/404.php
MODPATH/common/views/template.php
</code></pre>

<h2 id="loading-views">Loading Views</h2>

<p><a href="../../../guide-api/View.html">View</a> objects will typically be created inside a <a href="controllers.html">Controller</a> using the <a href="../../../guide-api/View.html#factory">View::factory</a> method. Typically the view is then assigned as the <a href="../../../guide-api/Request.html#property:response">Request::$response</a> property or to another view.</p>

<pre><code>public function action_about()
{
    $this-&gt;response-&gt;body(View::factory('pages/about'));
}
</code></pre>

<p>When a view is assigned as the <a href="../../../guide-api/Response.html#body">Response::body</a>, as in the example above, it will automatically be rendered when necessary. To get the rendered result of a view you can call the <a href="../../../guide-api/View.html#render">View::render</a> method or just type cast it to a string. When a view is rendered, the view file is loaded and HTML is generated.</p>

<pre><code>public function action_index()
{
    $view = View::factory('pages/about');

    // Render the view
    $about_page = $view-&gt;render();

    // Or just type cast it to a string
    $about_page = (string) $view;

    $this-&gt;response-&gt;body($about_page);
}
</code></pre>

<h2 id="variables-in-views">Variables in Views</h2>

<p>Once view has been loaded, variables can be assigned to it using the <a href="../../../guide-api/View.html#set">View::set</a> and <a href="../../../guide-api/View.html#bind">View::bind</a> methods.</p>

<pre><code>public function action_roadtrip()
{
    $view = View::factory('user/roadtrip')
        -&gt;set('places', array('Rome', 'Paris', 'London', 'New York', 'Tokyo'));
        -&gt;bind('user', $this-&gt;user);

    // The view will have $places and $user variables
    $this-&gt;response-&gt;body($view);
}
</code></pre>

<p class="note">The only difference between <code>set()</code> and <code>bind()</code> is that <code>bind()</code> assigns the variable by reference. If you <code>bind()</code> a variable before it has been defined, the variable will be created with a value of <code>NULL</code>.  </p>

<p>You can also assign variables directly to the View object.  This is identical to calling <code>set()</code>;</p>

<pre><code>public function action_roadtrip()
{
    $view = View::factory('user/roadtrip');

    $view-&gt;places = array('Rome', 'Paris', 'London', 'New York', 'Tokyo');
    $view-&gt;user = $this-&gt;user;

    // The view will have $places and $user variables
    $this-&gt;response-&gt;body($view);
}
</code></pre>

<h3 id="global-variables">Global Variables</h3>

<p>An application may have several view files that need access to the same variables. For example, to display a page title in both the header of your template and in the body of the page content. You can create variables that are accessible in any view using the <a href="../../../guide-api/View.html#set_global">View::set_global</a> and <a href="../../../guide-api/View.html#bind_global">View::bind_global</a> methods.</p>

<pre><code>// Assign $page_title to all views
View::bind_global('page_title', $page_title);
</code></pre>

<p>If the application has three views that are rendered for the home page: <code>template</code>, <code>template/sidebar</code>, and <code>pages/home</code>. First, an abstract controller to create the template will be created:</p>

<pre><code>abstract class Controller_Website extends Controller_Template {

    public $page_title;

    public function before()
    {
        parent::before();

        // Make $page_title available to all views
        View::bind_global('page_title', $this-&gt;page_title);

        // Load $sidebar into the template as a view
        $this-&gt;template-&gt;sidebar = View::factory('template/sidebar');
    }

}
</code></pre>

<p>Next, the home controller will extend <code>Controller_Website</code>:</p>

<pre><code>class Controller_Home extends Controller_Website {

    public function action_index()
    {
        $this-&gt;page_title = 'Home';

        $this-&gt;template-&gt;content = View::factory('pages/home');
    }

}
</code></pre>

<h2 id="views-within-views">Views Within Views</h2>

<p>If you want to include another view within a view, there are two choices. By calling <a href="../../../guide-api/View.html#factory">View::factory</a> you can sandbox the included view. This means that you will have to provide all of the variables to the view using <a href="../../../guide-api/View.html#set">View::set</a> or <a href="../../../guide-api/View.html#bind">View::bind</a>:</p>

<pre><code>// In your view file:

// Only the $user variable will be available in "views/user/login.php"
&lt;?php echo View::factory('user/login')-&gt;bind('user', $user) ?&gt;
</code></pre>

<p>The other option is to include the view directly, which makes all of the current variables available to the included view:</p>

<pre><code>// In your view file:

// Any variable defined in this view will be included in "views/message.php"
&lt;?php include Kohana::find_file('views', 'user/login') ?&gt;
</code></pre>

<p>You can also assign a variable of your parent view to be the child view from within your controller.  For example:</p>

<pre><code>// In your controller:

public function action_index()
{
    $view = View::factory('common/template');

    $view-&gt;title = "Some title";
    $view-&gt;body = View::factory('pages/foobar');
}

// In views/common/template.php:

&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;&lt;?php echo $title&gt;&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;?php echo $body ?&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>Of course, you can also load an entire <a href="../../../guide-api/Request.html">Request</a> within a view:</p>

<pre><code>&lt;?php echo Request::factory('user/login')-&gt;execute() ?&gt;
</code></pre>

<p>This is an example of &#91;HMVC], which makes it possible to create and read calls to other URLs within your application.</p>

									</div>
			</div>
		</div>
	</div>

	<div id="kodoc-footer">
		<div class="container">
			<div class="span-12">
							<p>&copy; 2008–2012 Kohana Team</p>
						</div>
			<div class="span-12 last right">
			<p>Powered by <a href="http://kohanaframework.org/">Kohana</a> v3.3.1</p>
			</div>
		</div>
	</div>

</body>
</html>
